{"version":3,"file":"ej2-spreadsheet.umd.min.js","sources":["../src/workbook/common/address.js","../src/workbook/common/worker.js","../src/workbook/common/math.js","../src/workbook/integrations/number-format.js","../src/calculate/common/common.js","../src/calculate/common/module.js","../src/calculate/common/module-loader.js","../src/calculate/base/calculate.js","../src/workbook/common/module.js","../src/workbook/common/util.js","../src/workbook/base/cell.js","../src/workbook/base/data.js","../src/workbook/base/sheet.js","../src/workbook/base/row.js","../src/workbook/base/column.js","../src/spreadsheet/common/module.js","../src/spreadsheet/common/util.js","../src/workbook/common/event.js","../src/workbook/integrations/data-bind.js","../src/spreadsheet/common/event.js","../src/workbook/integrations/open.js","../src/workbook/workers/save-worker.js","../src/workbook/integrations/save.js","../src/calculate/common/enum.js","../src/calculate/formulas/basic.js","../src/calculate/base/parser.js","../src/workbook/integrations/formula.js","../src/workbook/integrations/sort.js","../src/workbook/integrations/filter.js","../src/workbook/integrations/image.js","../src/workbook/integrations/chart.js","../src/workbook/actions/cell-format.js","../src/workbook/actions/edit.js","../src/workbook/actions/hyperlink.js","../src/workbook/actions/insert.js","../src/workbook/actions/delete.js","../src/workbook/actions/data-validation.js","../src/workbook/actions/find-and-replace.js","../src/workbook/actions/protect-sheet.js","../src/workbook/actions/merge.js","../src/workbook/actions/conditional-formatting.js","../src/workbook/common/basic-module.js","../src/workbook/common/all-module.js","../src/workbook/common/class.js","../src/workbook/common/constant.js","../src/workbook/services/service-locator.js","../src/workbook/base/workbook.js","../src/spreadsheet/actions/clipboard.js","../src/spreadsheet/actions/edit.js","../src/spreadsheet/actions/selection.js","../src/spreadsheet/actions/scroll.js","../src/spreadsheet/actions/virtual-scroll.js","../src/spreadsheet/actions/keyboard-navigation.js","../src/spreadsheet/actions/keyboard-shortcut.js","../src/spreadsheet/actions/cell-format.js","../src/spreadsheet/actions/resize.js","../src/spreadsheet/actions/collaborative-editing.js","../src/spreadsheet/actions/show-hide.js","../src/spreadsheet/actions/hyperlink.js","../src/spreadsheet/actions/undo-redo.js","../src/spreadsheet/actions/wrap.js","../src/spreadsheet/actions/insert.js","../src/spreadsheet/actions/delete.js","../src/spreadsheet/actions/data-validation.js","../src/spreadsheet/actions/protect-sheet.js","../src/spreadsheet/actions/find-and-replace.js","../src/spreadsheet/actions/merge.js","../src/spreadsheet/actions/conditional-formatting.js","../src/ribbon/ribbon.js","../src/spreadsheet/integrations/color-picker.js","../src/spreadsheet/integrations/ribbon.js","../src/spreadsheet/integrations/formula-bar.js","../src/spreadsheet/integrations/formula.js","../src/spreadsheet/integrations/sheet-tabs.js","../src/spreadsheet/integrations/open.js","../src/spreadsheet/integrations/save.js","../src/spreadsheet/integrations/context-menu.js","../src/spreadsheet/integrations/number-format.js","../src/spreadsheet/integrations/sort.js","../src/spreadsheet/integrations/filter.js","../src/spreadsheet/integrations/image.js","../src/spreadsheet/integrations/chart.js","../src/spreadsheet/common/basic-module.js","../src/spreadsheet/common/all-module.js","../src/spreadsheet/common/class.js","../src/spreadsheet/common/constant.js","../src/spreadsheet/renderer/sheet.js","../src/spreadsheet/renderer/row.js","../src/spreadsheet/renderer/cell.js","../src/spreadsheet/renderer/render.js","../src/spreadsheet/services/dialog.js","../src/spreadsheet/services/action-events.js","../src/spreadsheet/services/overlay.js","../src/spreadsheet/base/spreadsheet.js"],"sourcesContent":["import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getSheetIndex, getSheetNameFromAddress } from '../base/index';\n/**\n * To get range indexes.\n *\n * @param {string} range - Specifies the range.\n * @returns {number[]} - To get range indexes.\n */\nexport function getRangeIndexes(range) {\n    var cellindexes;\n    var indexes = [];\n    range = range.indexOf('!') > -1 ? range.split('!')[1] : range;\n    range = range.indexOf(':') === -1 ? range + ':' + range : range;\n    range.split(':').forEach(function (address) {\n        cellindexes = getCellIndexes(address);\n        indexes.push(cellindexes[0]);\n        indexes.push(cellindexes[1]);\n    });\n    return indexes;\n}\n/**\n * To get single cell indexes\n *\n * @param {string} address - Specifies the address.\n * @returns {number[]} - To get single cell indexes\n */\nexport function getCellIndexes(address) {\n    return [parseInt(address.match(/\\d+/)[0], 10) - 1, getColIndex(address.match(/[A-Z]+/i)[0].toUpperCase())];\n}\n/**\n * To get column index from text.\n *\n * @hidden\n * @param {string} text - Specifies the text.\n * @returns {number} - To get column index from text.\n */\nexport function getColIndex(text) {\n    var colIdx = 0;\n    text = text.split('').reverse().join('');\n    for (var i = text.length - 1; i >= 0; i--) {\n        colIdx += (text[i].charCodeAt(0) - 64) * (Math.pow(26, i));\n    }\n    return colIdx - 1;\n}\n/**\n * To get cell address from given row and column index.\n *\n * @param {number} sRow - Specifies the row.\n * @param {number} sCol - Specifies the col.\n * @returns {string} - To get cell address from given row and column index.\n */\nexport function getCellAddress(sRow, sCol) {\n    return getColumnHeaderText(sCol + 1) + (sRow + 1);\n}\n/**\n * To get range address from given range indexes.\n *\n * @param {number[]} range - Specifies the range.\n * @returns {string} - To get range address from given range indexes.\n */\nexport function getRangeAddress(range) {\n    return getCellAddress(range[0], range[1]) + ':' + (!isNullOrUndefined(range[2]) ?\n        getCellAddress(range[2], range[3]) : getCellAddress(range[0], range[1]));\n}\n/**\n * To get column header cell text\n *\n * @param {number} colIndex - Specifies the colIndex.\n * @returns {string} - Get Column Header Text\n */\nexport function getColumnHeaderText(colIndex) {\n    var alphabet = 'Z';\n    if (colIndex / 26 > 1) {\n        return getColumnHeaderText((colIndex % 26 === 0) ? (colIndex / 26 - 1) : Math.floor(colIndex / 26))\n            + String.fromCharCode((colIndex % 26) === 0 ? alphabet.charCodeAt(0) : 64 + (colIndex % 26));\n    }\n    else {\n        return String.fromCharCode(64 + (colIndex));\n    }\n}\n/**\n * @hidden\n * @param {SheetModel} address - Specifies the address.\n * @returns {number[]} - Get Indexes From Address\n */\nexport function getIndexesFromAddress(address) {\n    return getRangeIndexes(getRangeFromAddress(address));\n}\n/**\n * @hidden\n * @param {SheetModel} address - Specifies the address.\n * @returns {string} - Get Range From Address.\n */\nexport function getRangeFromAddress(address) {\n    return address.split('!')[1] || address;\n}\n/**\n * Get complete address for selected range\n *\n * @hidden\n * @param {SheetModel} sheet - Specifies the sheet.\n * @returns {string} - Get complete address for selected range\n */\nexport function getAddressFromSelectedRange(sheet) {\n    return sheet.name + '!' + sheet.selectedRange;\n}\n/**\n * @param {Workbook} context - Specifies the context.\n * @param {string} address - Specifies the address.\n * @returns {Object} - To get Address Info\n * @hidden\n */\nexport function getAddressInfo(context, address) {\n    var sIdx;\n    if (address.indexOf('!') > -1) {\n        sIdx = getSheetIndex(context, getSheetNameFromAddress(address));\n    }\n    else {\n        sIdx = context.activeSheetIndex;\n    }\n    return { sheetIndex: sIdx, indices: getIndexesFromAddress(address) };\n}\n/**\n * Given range will be swapped/arranged in increasing order.\n *\n * @hidden\n * @param {number[]} range - Specifies the range.\n * @returns {number[]} - Returns the bool value.\n */\nexport function getSwapRange(range) {\n    var clonedRange = range.slice();\n    if (range[0] > range[2]) {\n        swap(clonedRange, 0, 2);\n    }\n    if (range[1] > range[3]) {\n        swap(clonedRange, 1, 3);\n    }\n    return clonedRange;\n}\n/**\n * Interchange values in an array\n *\n * @param {number[]} range - Specifies the range.\n * @param {number} x - Specifies the x.\n * @param {number} y - Specifies the y.\n * @returns {void} - Interchange values in an array.\n */\nfunction swap(range, x, y) {\n    var tmp = range[x];\n    range[x] = range[y];\n    range[y] = tmp;\n}\n/**\n * @hidden\n * @param {number[]} range - Specifies the range.\n * @returns {boolean} - Returns the bool value.\n */\nexport function isSingleCell(range) {\n    return range[0] === range[2] && range[1] === range[3];\n}\n","/**\n * Worker task.\n *\n * @param {Object} context - Specify the context.\n * @param {Function | Object} taskFn - Specify the task.\n * @param {Function} callbackFn - Specify the callbackFn.\n * @param {Object[]} data - Specify the data.\n * @param {boolean} preventCallback - Specify the preventCallback.\n * @returns {WorkerHelper} - Worker task.\n */\nexport function executeTaskAsync(context, taskFn, callbackFn, data, preventCallback) {\n    return new WorkerHelper(context, taskFn, callbackFn, data, preventCallback);\n}\n/**\n * @hidden\n *\n * The `WorkerHelper` module is used to perform multiple actions using Web Worker asynchronously.\n */\nvar WorkerHelper = /** @class */ (function () {\n    /**\n     * Constructor for WorkerHelper module in Workbook library.\n     *\n     * @private\n     * @param {Object} context - Specify the context.\n     * @param {Function | Object} task - Specify the task.\n     * @param {Function} defaultListener - Specify the defaultListener.\n     * @param {Object[]} taskData - Specify the taskData.\n     * @param {boolean} preventCallback - Specify the preventCallback.\n     */\n    function WorkerHelper(context, task, defaultListener, taskData, preventCallback) {\n        this.preventCallback = false;\n        this.context = context;\n        this.workerTask = task;\n        this.defaultListener = defaultListener;\n        this.workerData = taskData;\n        if (preventCallback) {\n            this.preventCallback = true;\n        }\n        this.initWorker();\n    }\n    /**\n     * To terminate the worker task.\n     *\n     * @private\n     * @returns {void} - To terminate the worker task.\n     */\n    WorkerHelper.prototype.terminate = function () {\n        this.worker.terminate();\n        URL.revokeObjectURL(this.workerUrl);\n    };\n    /**\n     * To initiate the worker.\n     *\n     * @private\n     * @returns {void} - To initiate the worker.\n     */\n    WorkerHelper.prototype.initWorker = function () {\n        var taskBlob = new Blob([this.getFnCode()], { type: 'text/javascript' });\n        this.workerUrl = URL.createObjectURL(taskBlob);\n        this.worker = new Worker(this.workerUrl);\n        this.worker.onmessage = this.messageFromWorker.bind(this);\n        this.worker.onerror = this.onError.bind(this);\n        this.worker.postMessage(this.workerData);\n    };\n    /**\n     * Method for getting response from worker.\n     *\n     * @param {MessageEvent} args - Specify the args.\n     * @returns {void} - Method for getting response from worker.\n     * @private\n     */\n    WorkerHelper.prototype.messageFromWorker = function (args) {\n        this.terminate();\n        this.defaultListener.apply(this.context, [args.data]);\n    };\n    /**\n     * Method for getting error message from worker if failed.\n     *\n     * @param {ErrorEvent} args - Specify the args.\n     * @returns {void} - Method for getting error message from worker if failed.\n     * @private\n     */\n    WorkerHelper.prototype.onError = function (args) {\n        this.terminate();\n        throw args.message || args;\n    };\n    /**\n     * Construct function code for worker.\n     *\n     * @private\n     * @returns {string} -  Construct function code for worker.\n     */\n    WorkerHelper.prototype.getFnCode = function () {\n        var workerCode = '';\n        var i;\n        var keys;\n        var workerFunction = '';\n        var isHaveFunction = false;\n        if (typeof this.workerTask === 'function') {\n            if (this.workerTask.toString().indexOf('function') < 0) {\n                workerFunction = 'function ' + this.workerTask.toString();\n            }\n            else {\n                workerFunction = this.workerTask.toString();\n                isHaveFunction = true;\n            }\n            workerCode += ('self.workerTask = ' + workerFunction + '; \\n');\n        }\n        else {\n            if (typeof this.workerTask === 'object') {\n                keys = Object.keys(this.workerTask);\n                for (i = 0; i < keys.length; i++) {\n                    if (this.workerTask[keys[i]].toString().indexOf('function') < 0) {\n                        workerFunction = 'function ' + this.workerTask[keys[i]].toString();\n                    }\n                    else {\n                        workerFunction = this.workerTask[keys[i]].toString();\n                        isHaveFunction = true;\n                    }\n                    workerCode += ((i === 0 ? 'self.workerTask' : keys[i]) + '= ' + workerFunction + '; \\n');\n                }\n            }\n        }\n        workerCode += 'self.onmessage = ' + (isHaveFunction ? '' : ' function ') +\n            (this.preventCallback ? this.getMessageFn.toString() : this.getCallbackMessageFn.toString()) + '; \\n';\n        return workerCode;\n    };\n    /**\n     * Get default worker task with callback.\n     *\n     * @private\n     * @param {MessageEvent} args - Specify the args.\n     * @returns {void} - Get default worker task without callback.\n     */\n    WorkerHelper.prototype.getCallbackMessageFn = function (args) {\n        postMessage(this.workerTask.apply(this, args.data));\n    };\n    /**\n     * Get default worker task without callback.\n     *\n     * @private\n     * @param {MessageEvent} args - Specify the args.\n     * @returns {void} - Get default worker task without callback.\n     */\n    WorkerHelper.prototype.getMessageFn = function (args) {\n        this.workerTask.apply(this, args.data);\n    };\n    return WorkerHelper;\n}());\n","/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\nimport { isNullOrUndefined, IntlBase, cldrData } from '@syncfusion/ej2-base';\n/**\n * @hidden\n * @param {number} val - Specifies the val.\n * @returns {string} - To get Fraction.\n */\nexport function toFraction(val) {\n    var strVal = val.toString();\n    if (val === parseInt(strVal, 10)) {\n        return parseInt(strVal, 10) + '  ';\n    }\n    else {\n        var top_1 = strVal.indexOf('.') > -1 ? strVal.split('.')[1] : 0;\n        var bottom = Math.pow(10, top_1.toString().replace('-', '').length);\n        var abs = Math.abs(getGcd(top_1, bottom));\n        return (top_1 / abs) + '/' + (bottom / abs);\n    }\n}\n/**\n * @hidden\n * @param {string | number} a - Specifies the a.\n * @param {string | number} b - Specifies the b.\n * @returns {number} - To get Gcd.\n */\nexport function getGcd(a, b) {\n    a = Number(a);\n    b = Number(b);\n    return (b) ? getGcd(b, a % b) : a;\n}\n/**\n * @hidden\n * @param {number} val - Specifies the value.\n * @returns {Date} - Returns Date.\n */\nexport function intToDate(val) {\n    val = Number(val);\n    val = (val > 0 && val < 1) ? (1 + val) : (val === 0) ? 1 : val;\n    if (val > 60) {\n        val -= 1; // Due to leap year issue of 1900 in MSExcel.\n    }\n    var startDate = new Date('01/01/1900');\n    var startDateUTC = Date.UTC(startDate.getFullYear(), startDate.getMonth(), startDate.getDate(), startDate.getHours(), startDate.getMinutes(), startDate.getSeconds(), startDate.getMilliseconds());\n    return new Date(new Date(((val - 1) * (1000 * 3600 * 24)) + startDateUTC).toUTCString().replace(' GMT', ''));\n}\n/* eslint-disable  @typescript-eslint/no-explicit-any */\n/**\n * @hidden\n * @param {number} val - Specifies the value.\n * @param {boolean} isTime - Specifies the boolean value.\n * @param {boolean} isTimeOnly - Specifies the value is only a time without date.\n * @returns {number} - Returns number.\n */\nexport function dateToInt(val, isTime, isTimeOnly) {\n    var startDate = new Date('01/01/1900');\n    var date = isDateTime(val) ? val : new Date(val);\n    var startDateUTC = Date.UTC(startDate.getFullYear(), startDate.getMonth(), startDate.getDate(), startDate.getHours(), startDate.getMinutes(), startDate.getSeconds(), startDate.getMilliseconds());\n    var dateUTC = Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n    var diffDays = ((dateUTC - startDateUTC) / (1000 * 3600 * 24));\n    return (isTime ? diffDays : parseInt(diffDays.toString(), 10)) + (isTimeOnly ? 0 : (diffDays > 60 ? 2 : 1));\n}\n/**\n * @hidden\n * @param {any} date - Specifies the date.\n * @returns {boolean} - Returns boolean value.\n */\nexport function isDateTime(date) {\n    return Object.prototype.toString.call(date) === '[object Date]' && !isNaN(date.valueOf());\n}\n/**\n * @hidden\n * @param {string} val - Specifies the value.\n * @returns {boolean} - Returns boolean value.\n */\nexport function isNumber(val) {\n    return val - parseFloat(val) >= 0;\n}\n/**\n * @hidden\n * @param {Date | string | number} text - Specifies the text.\n * @param {Internationalization} intl - Specifies the Internationalization.\n * @param {string} format - Specifies the string.\n * @returns {ToDateArgs} - Returns Date format.\n */\nexport function toDate(text, intl, locale, format) {\n    var defaultDateFormats = IntlBase.getDependables(cldrData, locale, null).dateObject;\n    var availabelDateTimeFormat = defaultDateFormats.dateTimeFormats.availableFormats;\n    var dObj = { dateObj: null, isCustom: false, type: '' };\n    if (typeof text === 'string') {\n        text = text.toUpperCase();\n    }\n    if (format) {\n        dObj.dateObj = intl.parseDate(text, { format: format });\n        if (dObj.dateObj) {\n            dObj.type = text.toString().indexOf(':') > -1 ? 'time' : 'datetime';\n            dObj.isCustom = true;\n        }\n    }\n    if (isNullOrUndefined(dObj.dateObj)) {\n        for (var _i = 0, _a = Object.keys(defaultDateFormats.dateFormats); _i < _a.length; _i++) {\n            var key = _a[_i];\n            dObj.dateObj = intl.parseDate(text, { format: defaultDateFormats.dateFormats[key], skeleton: key });\n            if (dObj.dateObj) {\n                dObj.type = 'date';\n                dObj.isCustom = false;\n                break;\n            }\n        }\n        if (isNullOrUndefined(dObj.dateObj)) {\n            for (var _b = 0, _c = Object.keys(availabelDateTimeFormat); _b < _c.length; _b++) {\n                var key = _c[_b];\n                dObj.dateObj = intl.parseDate(text, { format: availabelDateTimeFormat[key], skeleton: key });\n                if (dObj.dateObj) {\n                    dObj.type = text.toString().indexOf(':') > -1 ? 'time' : 'datetime';\n                    if (dObj.type === 'time') {\n                        var time = dObj.dateObj.toLocaleTimeString();\n                        dObj.dateObj = new Date('01/01/1900 ' + time);\n                    }\n                    dObj.isCustom = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(dObj.dateObj)) {\n            for (var _d = 0, _e = Object.keys(defaultDateFormats.timeFormats); _d < _e.length; _d++) {\n                var key = _e[_d];\n                dObj.dateObj = intl.parseDate(text, { format: defaultDateFormats.timeFormats[key], skeleton: key });\n                if (dObj.dateObj) {\n                    var time = dObj.dateObj.toLocaleTimeString();\n                    dObj.dateObj = new Date('01/01/1900 ' + time);\n                    dObj.type = 'time';\n                    dObj.isCustom = false;\n                    break;\n                }\n            }\n        }\n    }\n    if (text !== '#DIV/0!' && !dObj.dateObj && new Date(text).toString() !== 'Invalid Date') {\n        dObj.dateObj = new Date(text);\n    }\n    return dObj;\n}\n/**\n * @hidden\n * @param {string} value - Specifies the value.\n * @returns { string | number} - ReturnsparseIntValue.\n */\nexport function parseIntValue(value) {\n    return (value && /^\\d*\\.?\\d*$/.test(value)) ? parseFloat(value) : value;\n}\n","import { getRangeIndexes } from '../common/index';\nimport { getCell, getSheet, setCell, getSheetIndex } from '../base/index';\nimport { Internationalization, getNumberDependable, getNumericObject, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { isNumber, toFraction, intToDate, toDate, dateToInt } from '../common/math';\nimport { applyNumberFormatting, getFormattedCellObject, refreshCellElement, checkDateFormat, getFormattedBarText } from '../common/event';\n/**\n * Specifies number format.\n */\nvar WorkbookNumberFormat = /** @class */ (function () {\n    function WorkbookNumberFormat(parent) {\n        this.parent = parent;\n        this.localeObj = getNumericObject(this.parent.locale);\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        this.decimalSep = this.localeObj.decimal;\n        this.groupSep = this.localeObj.group;\n        this.addEventListener();\n    }\n    WorkbookNumberFormat.prototype.numberFormatting = function (args) {\n        var activeSheetIndex = this.parent.activeSheetIndex;\n        if (args.range && args.range.indexOf('!') > -1) {\n            activeSheetIndex = getSheetIndex(this.parent, args.range.split('!')[0]);\n        }\n        var sheet = this.parent.sheets[activeSheetIndex];\n        var formatRange = args.range ? ((args.range.indexOf('!') > -1) ?\n            args.range.split('!')[1] : args.range) : sheet.selectedRange;\n        var selectedRange = getRangeIndexes(formatRange);\n        var cell;\n        for (var i = selectedRange[0]; i <= selectedRange[2]; i++) {\n            for (var j = selectedRange[1]; j <= selectedRange[3]; j++) {\n                setCell(i, j, sheet, { format: args.format }, true);\n                cell = getCell(i, j, sheet, true);\n                this.getFormattedCell({\n                    type: getTypeFromFormat(cell.format), value: cell.value,\n                    format: cell.format, rowIndex: i, colIndex: j,\n                    sheetIndex: activeSheetIndex, cell: cell\n                });\n            }\n        }\n    };\n    /**\n     * @hidden\n     *\n     * @param {Object} args - Specifies the args.\n     * @returns {string} - to get formatted cell.\n     */\n    WorkbookNumberFormat.prototype.getFormattedCell = function (args) {\n        var fResult = isNullOrUndefined(args.value) ? '' : args.value;\n        var sheet = this.parent.sheets[isNullOrUndefined(args.sheetIndex) ? this.parent.activeSheetIndex :\n            args.sheetIndex];\n        var range = getRangeIndexes(sheet.activeCell);\n        var sheetIdx = Number(args.sheetIndex) ? Number(args.sheetIndex) : this.parent.activeSheetIndex;\n        var cell = args.cell ? args.cell : getCell(range[0], range[1], sheet);\n        var rowIdx = args.cell && !isNullOrUndefined(args.rowIdx) ? args.rowIdx : range[0];\n        var colIdx = args.cell && !isNullOrUndefined(args.colIdx) ? args.colIdx : range[1];\n        var rightAlign = false;\n        var option = {};\n        var intl = new Internationalization();\n        intl.getNumberFormat(option);\n        var currencySymbol = getNumberDependable(this.parent.locale, option.currency);\n        if (args.format === '' || args.format === 'General') {\n            cell = cell ? cell : {};\n            var dateEventArgs = {\n                value: args.value, rowIndex: rowIdx, colIndex: colIdx, sheetIndex: this.parent.activeSheetIndex,\n                updatedVal: args.value, isDate: false, isTime: false\n            };\n            this.checkDateFormat(dateEventArgs);\n            if (dateEventArgs.isDate) {\n                rightAlign = true;\n                cell.value = args.value = dateEventArgs.updatedVal;\n                cell.format = args.format = getFormatFromType('ShortDate');\n            }\n            else if (dateEventArgs.isTime) {\n                rightAlign = true;\n                cell.value = args.value = dateEventArgs.updatedVal;\n                cell.format = args.format = getFormatFromType('Time');\n            }\n        }\n        args.type = args.format ? getTypeFromFormat(args.format) : 'General';\n        var result = this.processFormats(args, fResult, rightAlign, cell, intl, currencySymbol, option.currency);\n        if ((this.parent.getActiveSheet().id - 1 === sheetIdx)) {\n            this.parent.notify(refreshCellElement, {\n                isRightAlign: result.rightAlign, result: result.fResult || args.value,\n                rowIndex: args.rowIndex, colIndex: args.colIndex, sheetIndex: args.sheetIndex,\n                type: args.type, curSymbol: currencySymbol, value: args.value || ''\n            });\n        }\n        if (!args.onLoad && (args.rowIndex > sheet.usedRange.rowIndex || args.colIndex > sheet.usedRange.colIndex)) {\n            this.parent.setUsedRange(args.rowIndex, args.colIndex);\n        }\n        args.formattedText = result.fResult || args.value;\n        args.isRightAlign = result.rightAlign;\n        args.curSymbol = currencySymbol;\n        return args.formattedText;\n    };\n    WorkbookNumberFormat.prototype.processFormats = function (args, fResult, isRightAlign, cell, intl, currencySymbol, currencyCode) {\n        var result;\n        args.format = args.format ? args.format : 'General';\n        if (fResult !== '') {\n            switch (args.type) {\n                case 'General':\n                    result = this.autoDetectGeneralFormat({\n                        args: args, currencySymbol: currencySymbol, fResult: fResult, intl: intl,\n                        isRightAlign: isRightAlign, curCode: currencyCode, cell: cell, rowIdx: Number(args.rowIdx),\n                        colIdx: Number(args.colIdx)\n                    });\n                    fResult = result.fResult;\n                    isRightAlign = result.isRightAlign;\n                    break;\n                case 'Number':\n                    if (isNumber(fResult)) {\n                        fResult = this.applyNumberFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Currency':\n                    if (isNumber(fResult)) {\n                        fResult = this.currencyFormat(args, intl, currencyCode);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Percentage':\n                    if (isNumber(fResult)) {\n                        fResult = this.percentageFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Accounting':\n                    if (isNumber(fResult)) {\n                        fResult = this.accountingFormat(args, intl, currencySymbol, currencyCode);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'ShortDate':\n                    fResult = this.shortDateFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'LongDate':\n                    fResult = this.longDateFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'Time':\n                    fResult = this.timeFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'Fraction':\n                    if (isNumber(fResult)) {\n                        fResult = this.fractionFormat(args);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Scientific':\n                    if (isNumber(fResult)) {\n                        fResult = this.scientificFormat(args);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Text':\n                    isRightAlign = false;\n                    break;\n            }\n        }\n        return { fResult: fResult, rightAlign: isRightAlign };\n    };\n    WorkbookNumberFormat.prototype.autoDetectGeneralFormat = function (options) {\n        if (isNumber(options.fResult)) {\n            if (options.args.format && options.args.format !== '') {\n                if (options.args.format.toString().indexOf('%') > -1) {\n                    options.fResult = this.percentageFormat(options.args, options.intl);\n                }\n                else if (options.args.format.toString().indexOf(options.currencySymbol) > -1) {\n                    options.fResult = this.currencyFormat(options.args, options.intl, options.curCode);\n                }\n                else {\n                    options.fResult = this.applyNumberFormat(options.args, options.intl);\n                }\n            }\n            if (options.args.format === 'General' && options.fResult && options.fResult.toString().split(this.decimalSep)[0].length > 11) {\n                options.fResult = this.scientificFormat(options.args);\n            }\n            options.isRightAlign = true;\n        }\n        if (!isNullOrUndefined(options.fResult)) {\n            var res = options.fResult.toString();\n            if (res.indexOf('%') > -1 && res.split('%')[0] !== '' && res.split('%')[1].trim() === '' &&\n                Number(res.split('%')[0].split(this.groupSep).join('')).toString() !== 'NaN') {\n                options.args.value = Number(res.split('%')[0].split(this.groupSep).join('')) / 100;\n                options.cell.format = options.args.format = this.getPercentageFormat(res);\n                options.fResult = this.percentageFormat(options.args, options.intl);\n                options.cell.value = options.args.value.toString();\n                options.isRightAlign = true;\n            }\n            else if (res.indexOf(options.currencySymbol) > -1 && res.split(options.currencySymbol)[1] !== '' &&\n                Number(res.split(options.currencySymbol)[1].split(this.groupSep).join('')).toString() !== 'NaN') {\n                options.args.value = Number(res.split(options.currencySymbol)[1].split(this.groupSep).join(''));\n                options.cell.format = options.args.format = getFormatFromType('Currency');\n                options.fResult = this.currencyFormat(options.args, options.intl, options.curCode);\n                options.cell.value = options.args.value.toString();\n                setCell(options.rowIdx, options.colIdx, this.parent.getActiveSheet(), options.cell, true);\n                options.isRightAlign = true;\n            }\n        }\n        return { isRightAlign: options.isRightAlign, fResult: options.fResult };\n    };\n    WorkbookNumberFormat.prototype.getPercentageFormat = function (value) {\n        return value.indexOf(this.decimalSep) > -1 ? getFormatFromType('Percentage') : '0%';\n    };\n    WorkbookNumberFormat.prototype.findSuffix = function (zeros, resultSuffix) {\n        var len = zeros.length;\n        var suffixLen = len - resultSuffix.length;\n        return zeros.substr(0, suffixLen < 0 ? 0 : suffixLen) + resultSuffix;\n    };\n    WorkbookNumberFormat.prototype.applyNumberFormat = function (args, intl) {\n        args.format = this.isCustomFormat(args.format.toString());\n        var formatArr = args.format.toString().split(';');\n        if (Number(args.value) > 0) {\n            args.format = formatArr[0];\n        }\n        else if (Number(args.value) === 0) {\n            args.format = formatArr[2] ? formatArr[2] : formatArr[0];\n            if (args.format.indexOf('\"') > -1 && args.format.indexOf('#') === -1) {\n                args.format = args.format.split('_').join(' ').split('*').join(' ').split('?').join(' ').split('\"').join('');\n                return args.format;\n            }\n        }\n        else if (Number(args.value) < 0) {\n            args.format = !isNullOrUndefined(formatArr[1]) ? formatArr[1].split('*').join(' ') : formatArr[0];\n            if (args.format.indexOf('-') > -1) {\n                args.value = args.value.toString().split('-').join('');\n            }\n        }\n        else {\n            args.format = formatArr[3] ? formatArr[3] : formatArr[0];\n            args.format = args.format.split('_').join(' ').split('*').join(' ').split('?').join(' ');\n            if (args.format.indexOf('@') > -1) {\n                return args.format.split('@').join(args.value.toString());\n            }\n        }\n        args.format = args.format.split('_').join(' ').split('*').join(' ').split('\"').join('');\n        if (args.format.indexOf('?') > -1 && args.format.indexOf(this.decimalSep) > -1) {\n            var formatDecimalLen = args.format.split(this.decimalSep)[1].length;\n            var replaceString = '';\n            if (Number(args.value) % 1) {\n                var valueDecimalLen = args.value.toString().split('.')[1].length;\n                if (formatDecimalLen > valueDecimalLen) {\n                    replaceString = ' ';\n                }\n                else {\n                    replaceString = '0';\n                }\n            }\n            args.format = args.format.split('?').join(replaceString);\n        }\n        else {\n            args.format = args.format.split('?').join(' ');\n        }\n        if (Number(args.value) < 0 && args.cell) {\n            args.format = args.cell.format;\n        }\n        return intl.formatNumber(Number(args.value), {\n            format: args.format\n        });\n    };\n    WorkbookNumberFormat.prototype.isCustomFormat = function (format) {\n        if (format === '_-* #,##0.00_-;-* #,##0.00_-;_-* \"-\"_-;_-@_-' || format === '_-* #,##0_-;-* #,##0_-;_-* \"-\"_-;_-@_-') {\n            format = '';\n        }\n        format = format === '' ? getFormatFromType('Number') : format;\n        format = format.toString().split('_)').join(' ').split('_(').join(' ').split('[Red]').join('');\n        return format;\n    };\n    WorkbookNumberFormat.prototype.currencyFormat = function (args, intl, currencyCode) {\n        args.format = args.format === '' ? getFormatFromType('Currency') : args.format;\n        args.format = args.format.toString().split('_(').join(' ').split('_)').join(' ').split('[Red]').join('');\n        var formatArr = args.format.toString().split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = isNullOrUndefined(formatArr[1]) ? formatArr[0] : formatArr[1].split('*').join(' ');\n        }\n        args.format = this.getFormatForOtherCurrency(args.format);\n        return intl.formatNumber(Number(args.value), { format: args.format, currency: currencyCode });\n    };\n    WorkbookNumberFormat.prototype.percentageFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Percentage') : args.format;\n        return intl.formatNumber(Number(args.value), {\n            format: args.format\n        });\n    };\n    WorkbookNumberFormat.prototype.accountingFormat = function (args, intl, currencySymbol, currencyCode) {\n        args.format = args.format === '' ? getFormatFromType('Accounting') : args.format;\n        args.format = args.format.split('_(').join(' ').split('_)').join(' ').split('[Red]').join('').split('_').join('');\n        var formatArr = args.format.split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = formatArr[1].split('*').join(' ');\n        }\n        args.format = this.getFormatForOtherCurrency(args.format);\n        if (Number(args.value) === 0) {\n            return currencySymbol + '- ';\n        }\n        else {\n            return intl.formatNumber(Number(args.value), { format: args.format, currency: currencyCode }).split('-').join('');\n        }\n    };\n    WorkbookNumberFormat.prototype.getFormatForOtherCurrency = function (format) {\n        if (format.indexOf('[$') > -1) {\n            var symbol = format.split(']')[0].split('[$')[1].split('-')[0];\n            if (format.indexOf('0') > format.indexOf('[$')) {\n                format = symbol + format.slice(format.indexOf(']') + 1, format.length);\n            }\n            else {\n                format = format.slice(0, format.indexOf('[$')) + symbol;\n            }\n        }\n        return format;\n    };\n    WorkbookNumberFormat.prototype.shortDateFormat = function (args, intl) {\n        var shortDate = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('ShortDate')\n            : args.format.toString();\n        var dateObj;\n        if (code === getFormatFromType('ShortDate')) {\n            code = 'M/d/yy';\n            dateObj = {\n                type: 'date',\n                skeleton: 'yMd'\n            };\n        }\n        else {\n            dateObj = {\n                type: 'date',\n                format: code\n            };\n        }\n        return intl.formatDate(shortDate, dateObj);\n    };\n    WorkbookNumberFormat.prototype.longDateFormat = function (args, intl) {\n        var longDate = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('LongDate')\n            : args.format.toString();\n        if (code === getFormatFromType('LongDate')) {\n            code = 'EEEE, MMMM d, y';\n        }\n        return intl.formatDate(longDate, {\n            type: 'date',\n            format: code\n        });\n    };\n    WorkbookNumberFormat.prototype.timeFormat = function (args, intl) {\n        if (isNullOrUndefined(args.value)) {\n            return '';\n        }\n        if (!isNullOrUndefined(args.value.toString().split(this.decimalSep)[1])) {\n            args.value = parseFloat('1' + this.decimalSep + args.value.toString().split(this.decimalSep)[1]) || args.value;\n        }\n        var time = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('Time')\n            : args.format.toString();\n        if (code === getFormatFromType('Time')) {\n            code = 'h:mm:ss a';\n        }\n        return intl.formatDate(time, {\n            type: 'time',\n            skeleton: 'medium',\n            format: code\n        });\n    };\n    WorkbookNumberFormat.prototype.scientificFormat = function (args) {\n        args.format = args.format === '' ? getFormatFromType('Scientific') : args.format;\n        var zeros = args.format.split('+')[1];\n        var prefix = this.findDecimalPlaces(args.format, 'Scientific');\n        var fResult = Number(args.value).toExponential(prefix);\n        if (fResult.indexOf('e+') > -1) {\n            fResult = fResult.split('e+')[0] + 'E+' + this.findSuffix(zeros, fResult.split('e+')[1]);\n        }\n        else if (fResult.indexOf('e-') > -1) {\n            fResult = fResult.split('e-')[0] + 'E-' + +this.findSuffix(zeros, fResult.split('e-')[1]);\n        }\n        return fResult;\n    };\n    WorkbookNumberFormat.prototype.fractionFormat = function (args) {\n        args.format = args.format === '' ? getFormatFromType('Fraction') : args.format;\n        var suffix = '';\n        var fractionResult;\n        if (args.value.toString().indexOf(this.decimalSep) > -1 && isNumber(args.value)) {\n            suffix = args.value.toString().split(this.decimalSep)[0];\n            fractionResult = toFraction(Number(args.value));\n            return (Number(suffix) === 0) ? ' ' + fractionResult : suffix + ' ' + fractionResult;\n        }\n        return suffix;\n    };\n    WorkbookNumberFormat.prototype.findDecimalPlaces = function (code, type) {\n        var eIndex;\n        var decIndex;\n        switch (type) {\n            case 'Scientific':\n                eIndex = code.toUpperCase().indexOf('E');\n                decIndex = code.indexOf(this.decimalSep);\n                if (eIndex > -1) {\n                    return code.substring(decIndex + 1, eIndex).length;\n                }\n        }\n        return 2;\n    };\n    WorkbookNumberFormat.prototype.checkDateFormat = function (args) {\n        var dateObj;\n        var intl = new Internationalization();\n        var value = !isNullOrUndefined(args.value) ? args.value.toString() : '';\n        var cell = getCell(args.rowIndex, args.colIndex, getSheet(this.parent, isNullOrUndefined(args.sheetIndex) ? this.parent.activeSheetIndex : args.sheetIndex));\n        var checkedDate = this.checkCustomDateFormat(value);\n        if (value && (value.indexOf('/') > -1 || value.indexOf('-') > 0 || value.indexOf(':') > -1) && checkedDate !== 'Invalid') {\n            value = checkedDate;\n            if (value && value.indexOf('/') > -1 || value.indexOf('-') > 0 || value.indexOf(':') > -1) {\n                dateObj = toDate(value, intl, this.parent.locale, cell && cell.format);\n                if (!isNullOrUndefined(dateObj.dateObj) && dateObj.dateObj.toString() !== 'Invalid Date') {\n                    cell = cell ? cell : {};\n                    value = dateToInt(dateObj.dateObj, value.indexOf(':') > -1, dateObj.type && dateObj.type === 'time').toString();\n                    if (!cell.format || cell.format === '') {\n                        if (dateObj.type === 'time') {\n                            cell.format = getFormatFromType('Time');\n                        }\n                        else {\n                            cell.format = getFormatFromType('ShortDate');\n                        }\n                    }\n                    args.isDate = dateObj.type === 'date' || dateObj.type === 'datetime';\n                    args.isTime = dateObj.type === 'time';\n                    args.dateObj = dateObj.dateObj;\n                }\n            }\n            args.updatedVal = value;\n        }\n    };\n    WorkbookNumberFormat.prototype.checkCustomDateFormat = function (val) {\n        var dateArr = val.indexOf('/') > -1 ? val.split('/') : val.indexOf('-') > 0 ? val.split('-') : [''];\n        var months = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'sept', 'oct', 'nov', 'dec'];\n        if (dateArr.length === 2) {\n            if (months.indexOf(dateArr[0].toLowerCase()) > -1 && Number(dateArr[1]) <= 31) {\n                return '01-' + dateArr[0] + '-' + dateArr[1];\n            }\n            else if (months.indexOf(dateArr[1].toLowerCase()) > -1 && Number(dateArr[0]) <= 31) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            else if (Number(dateArr[0]) <= 31 && Number(dateArr[1]) <= 12) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            if (Number(dateArr[1]) <= 31 && Number(dateArr[0]) <= 12) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            if (Number(dateArr[0]) <= 12 && Number(dateArr[1]) <= 9999 && Number(dateArr[1]) >= 1900) {\n                return '01-' + dateArr[0] + '-' + dateArr[1];\n            }\n            else {\n                return 'Invalid';\n            }\n        }\n        else if (dateArr.length > 2) {\n            var _loop_1 = function (i) {\n                if (!(Number(dateArr[i]) > -1)) {\n                    if (!months.filter(function (month) { return dateArr[i].toLowerCase().includes(month); }).length) {\n                        return { value: 'Invalid' };\n                    }\n                }\n            };\n            for (var i = 0; i < dateArr.length; i++) {\n                var state_1 = _loop_1(i);\n                if (typeof state_1 === \"object\")\n                    return state_1.value;\n            }\n        }\n        return val;\n    };\n    WorkbookNumberFormat.prototype.formattedBarText = function (args) {\n        var type = getTypeFromFormat(args.cell ? args.cell.format : '');\n        var intl = new Internationalization();\n        var beforeText = args.value;\n        var date = (type === 'ShortDate' && args.cell && args.cell.format) ?\n            args.cell.format : getFormatFromType('ShortDate');\n        var time = getFormatFromType('Time');\n        switch (type) {\n            case 'ShortDate':\n            case 'LongDate':\n                args.value = this.shortDateFormat({ type: type, value: args.value, format: date }, intl);\n                break;\n            case 'Time':\n                args.value = this.shortDateFormat({ type: type, value: args.value, format: date }, intl) + ' ' +\n                    this.timeFormat({ type: type, value: args.value, format: time }, intl);\n                break;\n        }\n        if (!args.value || (args.value && args.value.toString().indexOf('null') > -1)) {\n            args.value = beforeText;\n        }\n    };\n    /**\n     * Adding event listener for number format.\n     *\n     * @returns {void} - Adding event listener for number format.\n     */\n    WorkbookNumberFormat.prototype.addEventListener = function () {\n        this.parent.on(applyNumberFormatting, this.numberFormatting, this);\n        this.parent.on(getFormattedCellObject, this.getFormattedCell, this);\n        this.parent.on(checkDateFormat, this.checkDateFormat, this);\n        this.parent.on(getFormattedBarText, this.formattedBarText, this);\n    };\n    /**\n     * Removing event listener for number format.\n     *\n     * @returns {void} -  Removing event listener for number format.\n     */\n    WorkbookNumberFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyNumberFormatting, this.numberFormatting);\n            this.parent.off(getFormattedCellObject, this.getFormattedCell);\n            this.parent.off(checkDateFormat, this.checkDateFormat);\n            this.parent.off(getFormattedBarText, this.formattedBarText);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     *\n     * @returns {void} - To Remove the event listeners.\n     */\n    WorkbookNumberFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook number format module name.\n     *\n     * @returns {string} - Get the module name.\n     */\n    WorkbookNumberFormat.prototype.getModuleName = function () {\n        return 'workbookNumberFormat';\n    };\n    return WorkbookNumberFormat;\n}());\nexport { WorkbookNumberFormat };\n/**\n * To Get the number built-in format code from the number format type.\n *\n * @param {string} type - Specifies the type of the number formatting.\n * @returns {string} - To Get the number built-in format code from the number format type.\n */\nexport function getFormatFromType(type) {\n    var code = 'General';\n    switch (type.split(' ').join('')) {\n        case 'Number':\n            code = '0.00';\n            break;\n        case 'Currency':\n            code = '$#,##0.00';\n            break;\n        case 'Accounting':\n            code = '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)';\n            break;\n        case 'ShortDate':\n            code = 'mm-dd-yyyy';\n            break;\n        case 'LongDate':\n            code = 'dddd, mmmm dd, yyyy';\n            break;\n        case 'Time':\n            code = 'h:mm:ss AM/PM';\n            break;\n        case 'Percentage':\n            code = '0.00%';\n            break;\n        case 'Fraction':\n            code = '# ?/?';\n            break;\n        case 'Scientific':\n            code = '0.00E+00';\n            break;\n        case 'Text':\n            code = '@';\n            break;\n    }\n    return code;\n}\n/**\n * @hidden\n * @param {string} format -  Specidfies the format.\n * @returns {string} - To get type from format.\n */\nexport function getTypeFromFormat(format) {\n    var code = 'General';\n    switch (format) {\n        case '0.00':\n        case '_-* #,##0.00_-;-* #,##0.00_-;_-* \"-\"_-;_-@_-':\n        case '_-* #,##0_-;-* #,##0_-;_-* \"-\"_-;_-@_-':\n            code = 'Number';\n            break;\n        case '$#,##0.00':\n        case '$#,##0_);[Red]($#,##0)':\n        case '$#,##0.00_);[Red]($#,##0.00)':\n        case '$#,##0.00_);($#,##0.00)':\n        case '$#,##0_);($#,##0)':\n            code = 'Currency';\n            break;\n        case '_($*#,##0.00_);_($*(#,##0.00);_($*\"-\"??_);_(@_)':\n        case '_($*#,##0.00_);_($* (#,##0.00);_($*\"-\"??_);_(@_)':\n        case '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)':\n        case '_ $ * #,##0.00_ ;_ $ * -#,##0.00_ ;_ $ * \"-\"??_ ;_ @_ ':\n            code = 'Accounting';\n            break;\n        case 'mm-dd-yyyy':\n        case 'dd-mm-yyyy':\n        case 'dd-mm-yy':\n        case 'mm-dd-yy':\n        case 'dd/MM/yyyy':\n        case 'yyyy-MM-dd':\n            code = 'ShortDate';\n            break;\n        case 'dddd, mmmm dd, yyyy':\n            code = 'LongDate';\n            break;\n        case 'h:mm:ss AM/PM':\n            code = 'Time';\n            break;\n        case '0.00%':\n        case '0%':\n            code = 'Percentage';\n            break;\n        case '# ?/?':\n        case '# ??/??':\n        case '# ???/???':\n            code = 'Fraction';\n            break;\n        case '0.00E+00':\n            code = 'Scientific';\n            break;\n        case '@':\n            code = 'Text';\n            break;\n        default:\n            if (format) {\n                if (format.indexOf('[$') > -1) {\n                    if (format.indexOf('* ') > -1) {\n                        code = 'Accounting';\n                    }\n                    else {\n                        code = 'Currency';\n                    }\n                }\n            }\n            break;\n    }\n    return code;\n}\n","/**\n * Represent the common codes for calculate\n */\nvar CalculateCommon = /** @class */ (function () {\n    function CalculateCommon(parent) {\n        this.parent = parent;\n    }\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @private\n     * @returns {string} - Get the module name.\n     */\n    CalculateCommon.prototype.getModuleName = function () {\n        return 'calc-common';\n    };\n    return CalculateCommon;\n}());\nexport { CalculateCommon };\n/**\n * To check whether the object is undefined.\n *\n * @param {Object} value - To check the object is undefined\n * @returns {boolean} - Returns boolean value.\n * @private\n */\nexport function isUndefined(value) {\n    return ('undefined' === typeof value);\n}\n/**\n * @hidden\n * @param {string} value - specify the value\n * @returns {string} - get Skeleton Value.\n */\nexport function getSkeletonVal(value) {\n    switch (value) {\n        case 'dd-MMM-yyyy':\n        case 'dd MMM yyyy':\n            value = 'medium';\n            break;\n        case 'MMM-yyyy':\n        case 'MMM yyyy':\n            value = 'yMMM';\n            break;\n        case 'MM-dd-yyyy': //short\n        case 'dd-MM-yyyy':\n        case 'dd-MM-yy':\n        case 'MM/dd/yyyy':\n        case 'dd/MM/yyyy':\n        case 'dd/MM/yy':\n            value = 'short';\n            break;\n        case 'dddd MMMM dd yyyy': //long\n        case 'dd MMMM yyyy':\n            value = 'long';\n            break;\n        case 'd MMMM yyyy':\n            value = 'yMMMd';\n            break;\n        case 'yyyy':\n            value = 'y';\n            break;\n        case 'h:mm':\n            value = 'Hm';\n            break;\n        case 'h:mm tt':\n            value = 'hm';\n            break;\n        case 'h':\n            value = 'H';\n            break;\n        case 'h tt':\n            value = 'h';\n            break;\n        case 'dddd':\n            value = 'E';\n            break;\n        case 'h:mm:ss tt':\n            value = 'hms';\n            break;\n        case 'h:mm:ss':\n            value = 'Hms';\n            break;\n        case 'd':\n            value = 'd';\n            break;\n        case 'd dddd':\n            value = 'Ed';\n            break;\n        case 'M':\n            value = 'M';\n            break;\n        case 'Md':\n            value = 'Md';\n            break;\n        case 'MMM':\n            value = 'MMM';\n            break;\n        case 'ddd MMM d':\n            value = 'MMMEd';\n            break;\n        case 'MMM d':\n            value = 'MMMd';\n            break;\n        case 'M/yyyy':\n            value = 'yM';\n            break;\n        default:\n            value = '';\n            break;\n    }\n    return value;\n}\n","/**\n * Represents the getModules function.\n *\n * @param {Calculate} context - specify the context\n * @returns {ModuleDeclaration[]} - Represents the getModules function.\n */\nexport function getModules(context) {\n    var modules = [];\n    if (context.includeBasicFormulas) {\n        modules.push({\n            member: 'basic-formulas',\n            args: [context]\n        });\n    }\n    return modules;\n}\n","/**\n * Module loading operations\n */\nimport { isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nvar MODULE_SUFFIX = 'Module';\n/**\n * To get nameSpace value from the desired object.\n *\n * @param {string} nameSpace - String value to the get the inner object\n * @param {any} obj - Object to get the inner object value.\n * @returns {any} - To get nameSpace value from the desired object.\n * @private\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function getValue(nameSpace, obj) {\n    /* eslint-disable  @typescript-eslint/no-explicit-any */\n    var value = obj;\n    var splits = nameSpace.replace(/\\[/g, '.').replace(/\\]/g, '').split('.');\n    for (var j = 0; j < splits.length && !isUndefined(value); j++) {\n        value = value[splits[j]];\n    }\n    return value;\n}\n/**\n * To set value for the nameSpace in desired object.\n *\n * @param {string} nameSpace - String value to get the inner object\n * @param {any} value - Value that you need to set.\n * @param {any} obj - Object to get the inner object value.\n * @returns {void} - To set value for the nameSpace in desired object.\n * @private\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function setValue(nameSpace, value, obj) {\n    var keyValues = nameSpace.replace(/\\[/g, '.').replace(/\\]/g, '').split('.');\n    var start = obj || {};\n    var fromObj = start;\n    var j;\n    var length = keyValues.length;\n    var key;\n    for (j = 0; j < length; j++) {\n        key = keyValues[j];\n        if (j + 1 === length) {\n            fromObj[key] = value === undefined ? {} : value;\n        }\n        else if (isNullOrUndefined(fromObj[key])) {\n            fromObj[key] = {};\n        }\n        fromObj = fromObj[key];\n    }\n    return start;\n}\nvar ModuleLoader = /** @class */ (function () {\n    function ModuleLoader(parent) {\n        this.loadedModules = [];\n        this.parent = parent;\n    }\n    /**\n     * Inject required modules in component library\n     *\n     * @param {ModuleDeclaration[]} requiredModules -  specify the required modules\n     * @param {Function[]} moduleList - specify the module list\n     * @returns {void} - Inject required modules in component library\n     * @hidden\n     */\n    ModuleLoader.prototype.inject = function (requiredModules, moduleList) {\n        var reqLengthVal = requiredModules.length;\n        if (reqLengthVal === 0) {\n            this.clean();\n            return;\n        }\n        if (this.loadedModules.length) {\n            this.clearUnusedModule(requiredModules);\n        }\n        for (var i = 0; i < reqLengthVal; i++) {\n            var modl = requiredModules[i];\n            for (var _i = 0, moduleList_1 = moduleList; _i < moduleList_1.length; _i++) {\n                var module = moduleList_1[_i];\n                var modName = modl.member;\n                if (module.prototype.getModuleName() === modl.member && !this.isModuleLoaded(modName)) {\n                    var moduleObject = this.createInstance(module, modl.args);\n                    var memberName = this.getMemberName(modName);\n                    if (modl.isProperty) {\n                        setValue(memberName, module, this.parent);\n                    }\n                    else {\n                        setValue(memberName, moduleObject, this.parent);\n                    }\n                    var loadedModule = modl;\n                    loadedModule.member = memberName;\n                    this.loadedModules.push(loadedModule);\n                }\n            }\n        }\n    };\n    /**\n     * Create Instance from constructor function with desired parameters.\n     *\n     * @param {Function} classFunction - Class function to which need to create instance\n     * @param {any[]} params - Parameters need to passed while creating instance\n     * @returns {any} - Create Instance from constructor function with desired parameters.\n     * @private\n     */\n    ModuleLoader.prototype.createInstance = function (classFunction, params) {\n        var arrayParam = params;\n        arrayParam.unshift(undefined);\n        return new (Function.prototype.bind.apply(classFunction, arrayParam));\n    };\n    /**\n     * To remove the created object while control is destroyed\n     *\n     * @hidden\n     * @returns {void} - To remove the created object while control is destroyed\n     */\n    ModuleLoader.prototype.clean = function () {\n        for (var _i = 0, _a = this.loadedModules; _i < _a.length; _i++) {\n            var modules = _a[_i];\n            if (!modules.isProperty) {\n                getValue(modules.member, this.parent).destroy();\n            }\n        }\n        this.loadedModules = [];\n    };\n    /**\n     * Removes all unused modules\n     *\n     * @param {ModuleDeclaration[]} moduleListName -  specify the module list name\n     * @returns {void} - Removes all unused modules\n     */\n    ModuleLoader.prototype.clearUnusedModule = function (moduleListName) {\n        var _this = this;\n        var usedModule = moduleListName.map(function (arg) { return _this.getMemberName(arg.member); });\n        var removeModule = this.loadedModules.filter(function (module) {\n            return usedModule.indexOf(module.member) === -1;\n        });\n        for (var _i = 0, removeModule_1 = removeModule; _i < removeModule_1.length; _i++) {\n            var moduleName = removeModule_1[_i];\n            if (!moduleName.isProperty) {\n                getValue(moduleName.member, this.parent).destroy();\n            }\n            this.loadedModules.splice(this.loadedModules.indexOf(moduleName), 1);\n            this.deleteObject(this.parent, moduleName.member);\n        }\n    };\n    /**\n     * To get the name of the member.\n     *\n     * @param {string} name - specify the name\n     * @returns {string} - To get the name of the member.\n     */\n    ModuleLoader.prototype.getMemberName = function (name) {\n        return name[0].toLowerCase() + name.substring(1) + MODULE_SUFFIX;\n    };\n    /**\n     * Delete an item from Object\n     *\n     * @param {any} obj - Object in which we need to delete an item.\n     * @param {string} key - String value to the get the inner object\n     * @returns {void} - Delete an item from Object\n     * @private\n     */\n    ModuleLoader.prototype.deleteObject = function (obj, key) {\n        delete obj[key];\n    };\n    /**\n     * Returns boolean based on whether the module specified is loaded or not\n     *\n     * @param {string} modName - specify the name\n     * @returns {boolean} - Returns boolean value\n     */\n    ModuleLoader.prototype.isModuleLoaded = function (modName) {\n        for (var _i = 0, _a = this.loadedModules; _i < _a.length; _i++) {\n            var mod = _a[_i];\n            if (mod.member === this.getMemberName(modName)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    return ModuleLoader;\n}());\nexport { ModuleLoader };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { getValue, Event, NotifyPropertyChanges, Base, Property, isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nimport { BasicFormulas } from './../formulas/index';\nimport { getModules, ModuleLoader } from '../common/index';\nimport { CommonErrors, FormulasErrorsStrings } from '../common/enum';\nimport { Parser } from './parser';\n/**\n * Represents the calculate library.\n */\nvar Calculate = /** @class */ (function (_super) {\n    __extends(Calculate, _super);\n    /**\n     * Base constructor for creating Calculate library.\n     *\n     * @param {Object} parent - specify the parent\n     */\n    function Calculate(parent) {\n        var _this = _super.call(this, null, null) || this;\n        _this.lFormulas = new Map();\n        /** @hidden */\n        _this.storedData = new Map();\n        _this.keyToRowsMap = new Map();\n        _this.rowsToKeyMap = new Map();\n        /** @hidden */\n        _this.rightBracket = String.fromCharCode(161);\n        /** @hidden */\n        _this.leftBracket = String.fromCharCode(162);\n        /** @hidden */\n        _this.sheetToken = '!';\n        _this.emptyString = '';\n        _this.leftBrace = '{';\n        _this.rightBrace = '}';\n        _this.cell = _this.emptyString;\n        _this.cellPrefix = '!0!A';\n        _this.treatEmptyStringAsZero = false;\n        /** @hidden */\n        // eslint-disable-next-line no-useless-escape\n        _this.tic = '\\\"';\n        /** @hidden */\n        _this.singleTic = '\\'';\n        /** @hidden */\n        _this.trueValue = 'TRUE';\n        /** @hidden */\n        _this.falseValue = 'FALSE';\n        _this.parseDecimalSeparator = '.';\n        /** @hidden */\n        _this.arithMarker = String.fromCharCode(180);\n        /** @hidden */\n        _this.arithMarker2 = _this.arithMarker + _this.arithMarker;\n        _this.dependentCells = null;\n        _this.dependentFormulaCells = null;\n        _this.minValue = Number.MIN_SAFE_INTEGER;\n        _this.maxValue = Number.MAX_SAFE_INTEGER;\n        _this.categoryCollection = ['All'];\n        _this.dependencyLevel = 0;\n        _this.refreshedCells = new Map();\n        _this.computedValues = null;\n        /** @hidden */\n        _this.randomValues = new Map();\n        /** @hidden */\n        _this.isRandomVal = false;\n        /** @hidden */\n        _this.randCollection = [];\n        /** @hidden */\n        _this.dependencyCollection = [];\n        /** @hidden */\n        _this.uniqueRange = [];\n        /**\n         * @hidden\n         */\n        _this.formulaErrorStrings = [\n            'binary operators cannot start an expression',\n            'cannot parse',\n            'bad library',\n            'invalid char in front of',\n            'number contains 2 decimal points',\n            'expression cannot end with an operator',\n            'invalid characters following an operator',\n            'invalid character in number',\n            'mismatched parentheses',\n            'unknown formula name',\n            'requires a single argument',\n            'requires 3 arguments',\n            'invalid Math argument',\n            'requires 2 arguments',\n            '#NAME?',\n            'too complex',\n            'circular reference: ',\n            'missing formula',\n            'improper formula',\n            'invalid expression',\n            'cell empty',\n            'bad formula',\n            'empty expression',\n            '',\n            'mismatched string quotes',\n            'wrong number of arguments',\n            'invalid arguments',\n            'iterations do not converge',\n            'Control is already registered',\n            'Calculation overflow',\n            'Missing sheet',\n            'cannot_parse',\n            'expression_cannot_end_with_an_operator',\n            '#SPILL!'\n        ];\n        _this.errorStrings = null;\n        _this.parseArgumentSeparator = ',';\n        _this.dateTime1900 = new Date(1900, 0, 1, 0, 0, 0);\n        _this.isParseDecimalSeparatorChanged = false;\n        _this.isArgumentSeparatorChanged = false;\n        _this.sheetFamilyID = 0;\n        _this.defaultFamilyItem = null;\n        _this.sheetFamiliesList = null;\n        _this.modelToSheetID = null;\n        /** @hidden */\n        _this.tokenCount = 0;\n        _this.sortedSheetNames = null;\n        _this.tempSheetPlaceHolder = String.fromCharCode(133);\n        /** @hidden */\n        _this.namedRanges = new Map();\n        _this.formulaInfoTable = null;\n        _this.oaDate = new Date(1899, 11, 30);\n        _this.millisecondsOfaDay = 24 * 60 * 60 * 1000;\n        _this.parseDateTimeSeparator = '/';\n        var moduleLoader = new ModuleLoader(_this);\n        if (_this.includeBasicFormulas) {\n            Calculate_1.Inject(BasicFormulas);\n        }\n        if (_this.injectedModules && _this.injectedModules.length) {\n            moduleLoader.inject(_this.requiredModules(), _this.injectedModules);\n        }\n        _this.parentObject = isNullOrUndefined(parent) ? _this : parent;\n        _this.grid = _this.parentObject;\n        _this.parser = new Parser(_this);\n        return _this;\n    }\n    Calculate_1 = Calculate;\n    Object.defineProperty(Calculate.prototype, \"libraryFormulas\", {\n        get: function () {\n            return this.lFormulas;\n        },\n        // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n        set: function (formulaColl) {\n            this.lFormulas.set(formulaColl.fName, { handler: formulaColl.handler, category: formulaColl.category, description: formulaColl.description });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * To get the argument separator to split the formula arguments.\n     *\n     * @returns {string} - To get the argument separator to split the formula arguments.\n     */\n    Calculate.prototype.getParseArgumentSeparator = function () {\n        var seperator = ',';\n        if (!this.isArgumentSeparatorChanged && seperator !== this.parseArgumentSeparator) {\n            this.parseArgumentSeparator = seperator;\n        }\n        return this.parseArgumentSeparator;\n    };\n    /**\n     * To set the argument separator to split the formula arguments.\n     *\n     * @param {string} value - Argument separator based on the culture.\n     * @returns {void} - To set the argument separator to split the formula arguments.\n     */\n    Calculate.prototype.setParseArgumentSeparator = function (value) {\n        this.parseArgumentSeparator = value;\n        this.isArgumentSeparatorChanged = true;\n    };\n    /**\n     * To get the date separator to split the date value.\n     *\n     * @returns {string} - To get the date separator to split the date value.\n     */\n    Calculate.prototype.getParseDateTimeSeparator = function () {\n        return this.parseDateTimeSeparator;\n    };\n    /**\n     * To set whether the empty string is treated as zero or not.\n     *\n     * @param {boolean} value - specify the boolean.\n     * @returns {void} - To set whether the empty string is treated as zero or not.\n     */\n    Calculate.prototype.setTreatEmptyStringAsZero = function (value) {\n        this.treatEmptyStringAsZero = value;\n    };\n    /**\n     * To get whether the empty string is treated as zero or not.\n     *\n     * @returns {boolean} - To get whether the empty string is treated as zero or not.\n     */\n    Calculate.prototype.getTreatEmptyStringAsZero = function () {\n        return this.treatEmptyStringAsZero;\n    };\n    /**\n     * To set the date separator to split the date value.\n     *\n     * @param {string} value - Argument separator based on the culture.\n     * @returns {void} - To set the date separator to split the date value.\n     */\n    Calculate.prototype.setParseDateTimeSeparator = function (value) {\n        this.parseDateTimeSeparator = value;\n    };\n    /**\n     * To provide the array of modules needed.\n     *\n     * @hidden\n     * @returns {ModuleDeclaration[]} - To provide the array of modules needed.\n     */\n    Calculate.prototype.requiredModules = function () {\n        return getModules(this);\n    };\n    /**\n     * Dynamically injects the required modules to the library.\n     *\n     * @hidden\n     * @param {Function[]} moduleList - Specify the module list\n     * @returns {void} - Dynamically injects the required modules to the library.\n     */\n    Calculate.Inject = function () {\n        var moduleList = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            moduleList[_i] = arguments[_i];\n        }\n        if (!this.prototype.injectedModules) {\n            this.prototype.injectedModules = [];\n        }\n        for (var j = 0; j < moduleList.length; j++) {\n            if (this.prototype.injectedModules.indexOf(moduleList[j]) === -1) {\n                this.prototype.injectedModules.push(moduleList[j]);\n            }\n        }\n    };\n    /**\n     * Get injected modules\n     *\n     * @hidden\n     * @returns {Function[]} - get Injected Modules\n     */\n    Calculate.prototype.getInjectedModules = function () {\n        return this.injectedModules;\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Calculate.prototype.onPropertyChanged = function (newProp, oldProp) {\n        /** code snippets */\n    };\n    Calculate.prototype.getModuleName = function () {\n        return 'calculate';\n    };\n    /**\n     * @hidden\n     * @returns {string} - get Formula Character.\n     */\n    Calculate.prototype.getFormulaCharacter = function () {\n        return '=';\n    };\n    /**\n     * @hidden\n     * @param {string} text - specify the text\n     * @returns {boolean} - Returns boolean value.\n     */\n    Calculate.prototype.isUpperChar = function (text) {\n        var charCode = text.charCodeAt(0);\n        return ((charCode > 64) && (charCode < 91));\n    };\n    Calculate.prototype.resetKeys = function () {\n        this.storedData.clear();\n        this.keyToRowsMap.clear();\n        this.rowsToKeyMap.clear();\n    };\n    /**\n     * @hidden\n     * @param {string} cellRef -  specify the cell reference\n     * @returns {void} - update Dependent Cell\n     */\n    Calculate.prototype.updateDependentCell = function (cellRef) {\n        var family = this.getSheetFamilyItem(this.grid);\n        var cell = this.cell;\n        if (cell !== this.emptyString) {\n            if (family.sheetNameToParentObject !== null) {\n                var token = family.parentObjectToToken.get(this.grid);\n                if (cell.indexOf(this.sheetToken) === -1) {\n                    cell = token + cell;\n                }\n                if (cellRef.indexOf(this.sheetToken) === -1) {\n                    cellRef = token + cellRef;\n                }\n            }\n            if (this.getDependentCells().has(cellRef)) {\n                var formulaCells = this.getDependentCells().get(cellRef);\n                if (formulaCells.indexOf(cell) < 0) {\n                    formulaCells.push(cell);\n                }\n            }\n            else {\n                this.getDependentCells().set(cellRef, [cell]);\n            }\n            this.addToFormulaDependentCells(cellRef);\n        }\n    };\n    Calculate.prototype.addToFormulaDependentCells = function (cellRef) {\n        var cell1 = this.cell;\n        var family = this.getSheetFamilyItem(this.grid);\n        if (family.sheetNameToParentObject != null && cell1.indexOf(this.sheetToken) === -1) {\n            var token = family.parentObjectToToken.get(this.grid);\n            cell1 = token + cell1;\n        }\n        if (!this.getDependentFormulaCells().has(cell1)) {\n            this.getDependentFormulaCells().set(cell1, new Map());\n            this.getDependentFormulaCells().get(cell1).set(cellRef, cellRef);\n        }\n        else if (!(this.getDependentFormulaCells().get(cell1)).has(cellRef)) {\n            this.getDependentFormulaCells().get(cell1).set(cellRef, cellRef);\n        }\n    };\n    /**\n     * @hidden\n     * @returns {Map<string, string[]>} - get Dependent Cells\n     */\n    Calculate.prototype.getDependentCells = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetDependentCells == null) {\n                family.sheetDependentCells = new Map();\n            }\n            return family.sheetDependentCells;\n        }\n        else {\n            if (this.dependentCells == null) {\n                this.dependentCells = new Map();\n            }\n            return this.dependentCells;\n        }\n    };\n    /**\n     * @hidden\n     * @returns {Map<string, Map<string, string>>} - get Dependent Formula Cells\n     */\n    Calculate.prototype.getDependentFormulaCells = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetDependentFormulaCells == null) {\n                family.sheetDependentFormulaCells = new Map();\n            }\n            return family.sheetDependentFormulaCells;\n        }\n        else {\n            if (this.dependentFormulaCells == null) {\n                this.dependentFormulaCells = new Map();\n            }\n            return this.dependentFormulaCells;\n        }\n    };\n    /**\n     * To get library formulas collection.\n     *\n     * @returns {Map<string, Function>} - To get library formulas collection.\n     */\n    Calculate.prototype.getLibraryFormulas = function () {\n        return this.lFormulas;\n    };\n    /**\n     * To get library function.\n     *\n     * @param {string} libFormula - Library formula to get a corresponding function.\n     * @returns {Function} - To get library function.\n     */\n    Calculate.prototype.getFunction = function (libFormula) {\n        if (this.getLibraryFormulas().has(libFormula.toUpperCase())) {\n            return this.getLibraryFormulas().get(libFormula.toUpperCase()).handler;\n        }\n        else {\n            return null;\n        }\n    };\n    /**\n     * @hidden\n     * @param {string} val - specify the value.\n     * @returns {Date} - convert integer to date.\n     */\n    Calculate.prototype.intToDate = function (val) {\n        var dateVal = Number(val);\n        dateVal = (dateVal > 0 && dateVal < 1) ? (1 + dateVal) : (dateVal === 0) ? 1 : dateVal;\n        if (dateVal > 60) {\n            dateVal -= 1; // Due to leap year issue of 1900 in MSExcel.\n        }\n        return new Date(((dateVal - 1) * (1000 * 3600 * 24)) + new Date('01/01/1900').getTime());\n    };\n    Calculate.prototype.getFormulaInfoTable = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetFormulaInfotable === null) {\n                family.sheetFormulaInfotable = new Map();\n            }\n            return family.sheetFormulaInfotable;\n        }\n        else {\n            if (this.formulaInfoTable === null) {\n                this.formulaInfoTable = new Map();\n            }\n            return this.formulaInfoTable;\n        }\n    };\n    /**\n     * To get the formula text.\n     *\n     * @private\n     * @param {string} key - specify the key.\n     * @returns {string} - To get the formula text.\n     */\n    Calculate.prototype.getFormula = function (key) {\n        key = key.toUpperCase();\n        if (this.storedData.has(key)) {\n            return this.storedData.get(key).getFormulaText();\n        }\n        return '';\n    };\n    /**\n     * To get the formula text.\n     *\n     * @returns {void} - To get the formula text.\n     */\n    Calculate.prototype.getParseDecimalSeparator = function () {\n        var seperator = '.';\n        if (!this.isParseDecimalSeparatorChanged && seperator !== this.parseDecimalSeparator) {\n            this.parseDecimalSeparator = seperator;\n        }\n        return this.parseDecimalSeparator;\n    };\n    /**\n     * To get the formula text.\n     *\n     * @param {string} value - Specifies the decimal separator value.\n     * @returns {void} - To get the formula text.\n     */\n    Calculate.prototype.setParseDecimalSeparator = function (value) {\n        this.parseDecimalSeparator = value;\n        this.isParseDecimalSeparatorChanged = true;\n    };\n    /**\n     * @hidden\n     * @param {string} cellRef -  specify the cell reference\n     * @returns {string} - get sheet token.\n     */\n    Calculate.prototype.getSheetToken = function (cellRef) {\n        var i = 0;\n        var temp = this.emptyString;\n        if (i < cellRef.length && cellRef[i] === this.sheetToken) {\n            i++;\n            while (i < cellRef.length && cellRef[i] !== this.sheetToken) {\n                i++;\n            }\n            temp = cellRef.substring(0, i + 1);\n        }\n        if (i < cellRef.length) {\n            return temp;\n        }\n        throw this.formulaErrorStrings[FormulasErrorsStrings.bad_index];\n    };\n    /**\n     * @hidden\n     * @param {Object} grd - specify the id\n     * @returns {number} - get sheet id.\n     */\n    Calculate.prototype.getSheetID = function (grd) {\n        var family = this.getSheetFamilyItem(grd);\n        if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.size > 0) {\n            var token = family.parentObjectToToken.get(grd);\n            if (token) {\n                token = token.split(this.sheetToken).join(this.emptyString);\n                var id = this.parseFloat(token);\n                if (!this.isNaN(id)) {\n                    return id;\n                }\n            }\n        }\n        return -1;\n    };\n    /**\n     * @hidden\n     * @param {string | number} value - specify the value.\n     * @returns {number} - parse float\n     */\n    Calculate.prototype.parseFloat = function (value) {\n        return Number(value);\n    };\n    /**\n     * To get the row index of the given cell.\n     *\n     * @param {string} cell - Cell address for getting row index.\n     * @returns {number} - To get the row index of the given cell.\n     */\n    Calculate.prototype.rowIndex = function (cell) {\n        var i = 0;\n        var isLetter = false;\n        if (i < cell.length && cell[i] === this.sheetToken) {\n            i++;\n            while (i < cell.length && cell[i] !== this.sheetToken) {\n                i++;\n            }\n            i++;\n        }\n        while (i < cell.length && this.isChar(cell[i])) {\n            isLetter = true;\n            i++;\n        }\n        var result = parseInt(cell.substring(i), 10);\n        if (i < cell.length && !this.isNaN(result)) {\n            return result;\n        }\n        if (isLetter) {\n            return -1;\n        }\n        throw this.formulaErrorStrings[FormulasErrorsStrings.bad_index];\n    };\n    /**\n     * To get the column index of the given cell.\n     *\n     * @param {string} cell - Cell address for getting column index.\n     * @returns {number} - To get the column index of the given cell.\n     */\n    Calculate.prototype.colIndex = function (cell) {\n        var j = 0;\n        var k = 0;\n        cell = cell.toUpperCase();\n        if (j < cell.length && cell[j] === this.sheetToken) {\n            j++;\n            while (j < cell.length && cell[j] !== this.sheetToken) {\n                j++;\n            }\n            j++;\n        }\n        while (j < cell.length && this.isChar(cell[j])) {\n            var charCode = cell[j].charCodeAt(0);\n            k = k * 26 + charCode - 64;\n            j++;\n        }\n        if (k === 0) {\n            return -1;\n        }\n        return k;\n    };\n    /**\n     * To get the valid error strings.\n     *\n     * @hidden\n     * @returns {string[]} - to get error strings.\n     */\n    Calculate.prototype.getErrorStrings = function () {\n        if (this.errorStrings === null) {\n            this.errorStrings = ['#N/A', '#VALUE!', '#REF!', '#DIV/0!', '#NUM!', '#NAME?', '#NULL!'];\n        }\n        return this.errorStrings;\n    };\n    /**\n     * @hidden\n     * @param {string} text - specify the text\n     * @param {number} startIndex - specify the start index\n     * @param {number} length - specify the length\n     * @returns {string} - Returns sub string\n     */\n    Calculate.prototype.substring = function (text, startIndex, length) {\n        return text.substring(startIndex, length + startIndex);\n    };\n    /**\n     * @hidden\n     * @param {string} c - specify the characer of the string\n     * @returns {boolean} - Return the boolean type\n     */\n    Calculate.prototype.isChar = function (c) {\n        if ((c.charCodeAt(0) >= 65 && c.charCodeAt(0) <= 90) || (c.charCodeAt(0) >= 97 && c.charCodeAt(0) <= 122)) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @hidden\n     * @param {Object} model - specify the model\n     * @returns {CalcSheetFamilyItem} - get Sheet Family Item.\n     */\n    Calculate.prototype.getSheetFamilyItem = function (model) {\n        if (this.sheetFamilyID === 0) {\n            if (this.defaultFamilyItem == null) {\n                this.defaultFamilyItem = new CalcSheetFamilyItem();\n            }\n            return this.defaultFamilyItem;\n        }\n        if (this.sheetFamiliesList == null) {\n            this.sheetFamiliesList = new Map();\n        }\n        var i = this.modelToSheetID.get(model);\n        if (!this.sheetFamiliesList.has(i)) {\n            this.sheetFamiliesList.set(i, new CalcSheetFamilyItem());\n        }\n        return this.sheetFamiliesList.get(i);\n    };\n    /**\n     * Register a key value pair for formula.\n     *\n     * @param {string} key - Key for formula reference .\n     * @param {string | number} value - Value for the corresponding key.\n     * @returns {void} - Register a key value pair for formula.\n     */\n    Calculate.prototype.setKeyValue = function (key, value) {\n        key = key.toUpperCase();\n        var str = value.toString().trim();\n        if (!this.storedData.get(key) || str.indexOf(this.leftBrace) === 0) {\n            this.storedData.set(key, new FormulaInfo());\n            this.keyToRowsMap.set(key, this.keyToRowsMap.size + 1);\n            this.rowsToKeyMap.set(this.rowsToKeyMap.size + 1, key);\n        }\n        var fInfo = this.storedData.get(key);\n        if (fInfo.getFormulaText() != null && fInfo.getFormulaText().length > 0 && fInfo.getFormulaText() !== str) {\n            var s1 = this.cellPrefix + this.keyToRowsMap.get(key).toString();\n            var formulaDependent = this.getDependentFormulaCells().get(s1);\n            if (formulaDependent != null) {\n                this.clearFormulaDependentCells(s1);\n            }\n        }\n        if (str.length > 0 && str[0] === this.getFormulaCharacter()) {\n            fInfo.setFormulaText(str);\n        }\n        else if (fInfo.getFormulaValue() !== str) {\n            fInfo.setFormulaText('');\n            fInfo.setParsedFormula('');\n            fInfo.setFormulaValue(str);\n        }\n    };\n    /**\n     * @hidden\n     * @param {string} cell - specify the cell\n     * @returns {void} - clears the  Formula Dependent Cells.\n     */\n    Calculate.prototype.clearFormulaDependentCells = function (cell) {\n        var _this = this;\n        var dependentFormula = this.getDependentFormulaCells().get(cell);\n        if (dependentFormula != null) {\n            dependentFormula.forEach(function (value, key) {\n                var s = key;\n                var dependent = _this.getDependentCells().get(s);\n                _this.arrayRemove(dependent, cell);\n                if (dependent.length === 0) {\n                    _this.getDependentCells().delete(s);\n                }\n            });\n            this.getDependentFormulaCells().delete(cell);\n        }\n    };\n    Calculate.prototype.arrayRemove = function (array, value) {\n        var index = array.indexOf(value);\n        if (index !== -1) {\n            array.splice(index, 1);\n        }\n        return array;\n    };\n    /**\n     * Register a key value pair for formula.\n     *\n     * @param {string} key - Key for getting the corresponding value.\n     * @returns {string | number} - to get key value.\n     */\n    Calculate.prototype.getKeyValue = function (key) {\n        key = key.toUpperCase();\n        if (this.storedData.has(key) !== null) {\n            var fInfo = this.storedData.get(key);\n            var fText = fInfo.getFormulaText();\n            if (fText.length > 0 && fText[0] === this.getFormulaCharacter()) {\n                this.cell = this.cellPrefix + this.keyToRowsMap.get(key).toString();\n                fText = fText.substring(1);\n                try {\n                    fInfo.setParsedFormula(this.parser.parseFormula(fText, key));\n                }\n                catch (ex) {\n                    var args = {\n                        message: ex.message, exception: ex, isForceCalculable: false,\n                        computeForceCalculate: false\n                    };\n                    this.trigger('onFailure', args);\n                    fInfo.setFormulaValue(args.message);\n                    return this.storedData.get(key).getFormulaValue();\n                }\n                try {\n                    fInfo.setFormulaValue(this.computeFormula(fInfo.getParsedFormula()));\n                }\n                catch (ex) {\n                    var args = {\n                        message: ex.message, exception: ex, isForceCalculable: false,\n                        computeForceCalculate: false\n                    };\n                    this.trigger('onFailure', args);\n                    var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n                    return (isNullOrUndefined(this.getErrorLine(ex)) ? '' : '#' + this.getErrorLine(ex) + ': ') + errorMessage;\n                }\n            }\n            return this.storedData.get(key).getFormulaValue();\n        }\n        else {\n            return this.emptyString;\n        }\n    };\n    Calculate.prototype.getNamedRanges = function () {\n        return this.namedRanges;\n    };\n    /**\n     * Adds a named range to the NamedRanges collection.\n     *\n     * @param {string} name - Name of the named range.\n     * @param {string} range - Range for the specified name.\n     * @returns {boolean} - Adds a named range to the NamedRanges collection.\n     */\n    Calculate.prototype.addNamedRange = function (name, range) {\n        var sheetScopeName = name.split(this.sheetToken);\n        if (sheetScopeName.length > 1) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (!family.parentObjectToToken.get(sheetScopeName[0])) {\n                return false;\n            }\n            name = sheetScopeName[0] + this.sheetToken + sheetScopeName[1].toUpperCase();\n        }\n        else {\n            name = name.toUpperCase();\n        }\n        this.namedRanges.set(name, range);\n        return true;\n    };\n    /**\n     * Remove the specified named range form the named range collection.\n     *\n     * @param {string} name - Name of the specified named range.\n     * @returns {boolean} - Remove the specified named range form the named range collection.\n     */\n    Calculate.prototype.removeNamedRange = function (name) {\n        name = name.toUpperCase();\n        if (this.namedRanges.get(name) != null) {\n            this.namedRanges.delete(name);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @hidden\n     * @param {number} col - specify the column\n     * @returns {string} - to convert the alpha.\n     */\n    Calculate.prototype.convertAlpha = function (col) {\n        var arrCol = [];\n        var n = 0;\n        var charText = 'A';\n        while (col > 0) {\n            col--;\n            var aCharValue = charText.charCodeAt(0);\n            arrCol[n] = String.fromCharCode(col % 26 + aCharValue);\n            col = parseInt((col / 26).toString(), 10);\n            n++;\n        }\n        var arr = [];\n        for (var i = 0; i < n; i++) {\n            arr[n - i - 1] = arrCol[i];\n        }\n        return arr.join('');\n    };\n    /**\n     * @hidden\n     * @param {string} cellRange - specify the cell range.\n     * @returns {string} - to get cell collection.\n     */\n    Calculate.prototype.getCellCollection = function (cellRange) {\n        if (cellRange.indexOf(':') < 0) {\n            if (!this.isCellReference(cellRange)) {\n                return cellRange.split(this.getParseArgumentSeparator());\n            }\n            else {\n                cellRange = cellRange + ':' + cellRange;\n            }\n        }\n        var token = this.emptyString;\n        var sheetTokenIndex = cellRange.indexOf(this.sheetToken);\n        if (sheetTokenIndex > -1) {\n            var index = sheetTokenIndex;\n            var s = index + 1;\n            while (s < cellRange.length) {\n                if (cellRange[s] === this.sheetToken) {\n                    token = cellRange.substr(0, s + 1);\n                    break;\n                }\n                s++;\n            }\n        }\n        var i = cellRange.indexOf(':');\n        var row1;\n        var row2;\n        var col1;\n        var col2;\n        if (i > 0 && this.isChar(cellRange[i - 1])) {\n            var k = i - 2;\n            while (k >= 0 && this.isDigit(cellRange[k])) {\n                k--;\n            }\n        }\n        row1 = this.rowIndex(this.substring(cellRange, 0, i));\n        row2 = this.rowIndex(this.substring(cellRange, i + 1, i + cellRange.length - i - 1));\n        col1 = this.colIndex(this.substring(cellRange, 0, i));\n        col2 = this.colIndex(this.substring(cellRange, i + 1, i + cellRange.length - i - 1));\n        if (row1 > row2) {\n            i = row2;\n            row2 = row1;\n            row1 = i;\n        }\n        if (col1 > col2) {\n            i = col2;\n            col2 = col1;\n            col1 = i;\n        }\n        var cells = [];\n        var j;\n        var c = 0;\n        for (i = row1; i <= row2; i++) {\n            for (j = col1; j <= col2; j++) {\n                cells[c] = token + this.emptyString + this.convertAlpha(j) + i.toString();\n                c++;\n            }\n        }\n        return cells;\n    };\n    /**\n     * Compute the given formula.\n     *\n     * @param {string} formulaText - Specifies to compute the given formula.\n     * @returns {string | number} - compute the given formula\n     */\n    Calculate.prototype.computeFormula = function (formulaText) {\n        return this.calculateFormula(formulaText, false);\n    };\n    Calculate.prototype.calculateFormula = function (formulaText, refresh) {\n        var parsedText;\n        var lastIndexOfq;\n        var formulatResult;\n        var nestedFormula = false;\n        var fNested;\n        if (this.parser.isError) {\n            return formulaText;\n        }\n        if (!this.parser.isFormulaParsed) {\n            parsedText = this.parser.parseFormula(formulaText);\n        }\n        else {\n            parsedText = formulaText;\n        }\n        this.parser.isFormulaParsed = false;\n        try {\n            lastIndexOfq = this.findLastIndexOfq(parsedText);\n            if (lastIndexOfq > 0) {\n                nestedFormula = true;\n            }\n            if (parsedText !== this.emptyString && lastIndexOfq > -1) {\n                var i = lastIndexOfq + 1;\n                while (i > -1) {\n                    if (parsedText[i] !== this.rightBracket) {\n                        i++;\n                        continue;\n                    }\n                    var sFormula = parsedText.substring(lastIndexOfq, i + 1);\n                    var libFormula = sFormula.split(this.leftBracket)[0].split('q').join(this.emptyString);\n                    var args = void 0;\n                    if (this.getLibraryFormulas().get(libFormula.toUpperCase()).isCustom) {\n                        args = sFormula.substring(sFormula.indexOf(this.leftBracket) + 1, sFormula.indexOf(this.rightBracket))\n                            .split(this.getParseArgumentSeparator());\n                        var j = 0;\n                        var customArgs = [];\n                        for (j = 0; j < args.length; j++) {\n                            customArgs.push(this.getValueFromArg(args[j]));\n                        }\n                        args = customArgs;\n                    }\n                    else {\n                        args = sFormula.substring(sFormula.indexOf(this.leftBracket) + 1, sFormula.indexOf(this.rightBracket))\n                            .replace(',n', ',').split(this.getParseArgumentSeparator());\n                        if (sFormula.includes(this.getParseArgumentSeparator() + this.tic)) {\n                            var joinIdx = null;\n                            for (var k = 0; k < args.length; k++) {\n                                if (args[k] && args[k][0] === this.tic && args[k][args[k].length - 1] !== this.tic) {\n                                    joinIdx = k;\n                                }\n                                if (joinIdx !== null && joinIdx === k - 1 && args[k][0] != this.tic && args[k][args[k].length - 1] ===\n                                    this.tic) {\n                                    args[joinIdx] = args[joinIdx] + this.getParseArgumentSeparator() + args[k];\n                                    args.splice(k, 1);\n                                    joinIdx = null;\n                                }\n                            }\n                        }\n                        if (nestedFormula && libFormula && libFormula === 'IF') {\n                            args.push('nestedFormulaTrue');\n                        }\n                    }\n                    formulatResult = isNullOrUndefined(this.getFunction(libFormula)) ? this.getErrorStrings()[CommonErrors.name] : this.getFunction(libFormula).apply(void 0, args);\n                    if (nestedFormula) {\n                        fNested = this.processNestedFormula(parsedText, sFormula, formulatResult);\n                        var q = this.findLastIndexOfq(fNested);\n                        if (q === 0) {\n                            nestedFormula = false;\n                        }\n                        if (q === -1) {\n                            formulatResult = this.computeValue(fNested, refresh);\n                        }\n                        lastIndexOfq = i = q;\n                        parsedText = fNested;\n                        continue;\n                    }\n                    break;\n                }\n            }\n            else if (this.formulaErrorStrings.indexOf(parsedText) > -1) {\n                formulatResult = parsedText;\n            }\n            else if (parsedText !== this.emptyString && lastIndexOfq === -1) {\n                formulatResult = this.computeValue(parsedText, refresh);\n            }\n        }\n        catch (ex) {\n            var args = { message: ex.message, exception: ex, isForceCalculable: false, computeForceCalculate: false };\n            this.trigger('onFailure', args);\n            var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n            formulatResult = (isNullOrUndefined(this.getErrorLine(ex)) ? '' : '#' + this.getErrorLine(ex) + ': ') + errorMessage;\n        }\n        return formulatResult;\n    };\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range\n     * @returns {number[] | string} - to compute if and average if.\n     */\n    Calculate.prototype.computeSumIfAndAvgIf = function (range) {\n        if (isNullOrUndefined(range) || range[0] === this.emptyString || range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = range;\n        for (var i = 0; i < argArr.length; i++) {\n            if (this.isCellReference(argArr[i]) && isNullOrUndefined(argArr[i].match(/[0-9]/)) && argArr[i].indexOf('!') < 0) {\n                var splitArray = argArr[i].split(':');\n                argArr[i] = splitArray[0] + '1' + ':' + splitArray[1] + this.spreadSheetUsedRange[0];\n            }\n        }\n        var argCount = argArr.length;\n        if (argCount !== 2 && argCount !== 3 && argCount === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var rangevalue = argArr[0];\n        var criteria = argArr[1].trim();\n        criteria = criteria.split(this.tic).join(this.emptyString);\n        if (criteria.length > 255) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        var isAsterisk = criteria.includes('*');\n        var criteriaValue = isAsterisk ? criteria.replace(/\\*/g, '').trim() : criteria;\n        criteriaValue = this.isCellReference(criteriaValue) ? this.getValueFromArg(criteriaValue) : criteria;\n        if (isAsterisk) {\n            if (criteria[0] === '*') {\n                criteriaValue = '*' + criteriaValue;\n            }\n            if (criteria[criteria.length - 1] === '*') {\n                criteriaValue += '*';\n            }\n        }\n        criteria = criteriaValue;\n        var opt = this.parser.tokenEqual;\n        if (criteria.startsWith('<=')) {\n            opt = this.parser.tokenLessEq;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('>=')) {\n            opt = this.parser.tokenGreaterEq;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('<>')) {\n            opt = this.parser.tokenNotEqual;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('<')) {\n            opt = this.parser.tokenLess;\n            criteria = criteria.substring(1);\n        }\n        else if (criteria.startsWith('>')) {\n            opt = this.parser.tokenGreater;\n            criteria = criteria.substring(1);\n        }\n        else if (criteria.startsWith('=')) {\n            opt = this.parser.tokenEqual;\n            criteria = criteria.substring(1);\n        }\n        var checkCriteria = this.parseFloat(criteria);\n        var criteriaRangeArray = argArr[0];\n        var sumRange = this.getCellCollection(argCount > 2 ? argArr[2] : rangevalue);\n        var criteriaRange = this.getCellCollection(criteriaRangeArray);\n        var result = this.getComputeSumIfValue(criteriaRange, sumRange, criteria, checkCriteria, opt, isAsterisk);\n        return [result[0], result[1]];\n    };\n    // Commented unused method\n    // /**\n    //  * @hidden\n    //  * @param {string[]} range - specify the range\n    //  * @returns {string} - to compute lookup\n    //  */\n    // public computeLookup(range: string[]): string {\n    //     if (range.length === 0) {\n    //         return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n    //     }\n    //     const checkCrte: string[] = [];\n    //     const findMaxVal: string[] | string = [];\n    //     const argArr: string[] = range;\n    //     const argCount: number = argArr.length;\n    //     const criterias: string = argArr[0].split(this.tic).join(this.emptyString);\n    //     const rangevalue: string = argArr[1];\n    //     const lookupRangeArray: string = argCount === 2 ? rangevalue : argArr[2];\n    //     const criteriaRange: string[] | string = this.getCellCollection(argArr[1]);\n    //     const lookupRange: string[] | string = this.getCellCollection(lookupRangeArray);\n    //     for (let i: number = 0; i < criteriaRange.length; i++) {\n    //         findMaxVal[i] = this.getValueFromArg(criteriaRange[i]).split(this.tic).join('');\n    //     }\n    //     const s: string[] = findMaxVal.toString().split(this.getParseArgumentSeparator());\n    //     const maxVal: number = this.parseFloat(s[s.sort().length - 1]);\n    //     const minVal: number = this.parseFloat(s[0]);\n    //     for (let j: number = 0; j < criteriaRange.length; j++) {\n    //         checkCrte[j] = this.getValueFromArg(criteriaRange[j]).split(this.tic).join('');\n    //         if (criterias === checkCrte[j]) {\n    //             return this.getValueFromArg(lookupRange[j]).split(this.tic).join('');\n    //         } else if (this.parseFloat(criterias) === this.parseFloat(checkCrte[j])) {\n    //             return this.getValueFromArg(lookupRange[j]).split(this.tic).join('');\n    //         } else if (this.parseFloat(criterias) < minVal) {\n    //             return this.getErrorStrings()[CommonErrors.na];\n    //         } else if (this.parseFloat(criterias) > maxVal) {\n    //             const index: number = findMaxVal.indexOf(maxVal.toString());\n    //             return this.getValueFromArg(lookupRange[index]).split(this.tic).join('');\n    //         }\n    //     }\n    //     if (findMaxVal.indexOf(criterias) < 0) {\n    //         const temp: string[] = [];\n    //         for (let n: number = 0; n < s.length; n++) {\n    //             if (this.parseFloat(criterias) > this.parseFloat(s[n])) {\n    //                 temp.push(s[n]);\n    //             }\n    //         }\n    //         const index: number = findMaxVal.indexOf(temp[temp.length - 1]);\n    //         return this.getValueFromArg(lookupRange[index]).split(this.tic).join('');\n    //     }\n    //     return this.getErrorStrings()[CommonErrors.na];\n    // }\n    // public computeVLookup(range: string[]): string {\n    //     const argArr: string[] = range;\n    //     const findMaxValue: string[] | string = [];\n    //     let lookupValue: string = argArr[0].split(this.tic).join('');\n    //     if (lookupValue.indexOf(':') > - 1) {\n    //         return this.getErrorStrings()[CommonErrors.value];\n    //     }\n    //     if (this.isCellReference(lookupValue)) {\n    //         lookupValue = this.getValueFromArg(lookupValue);\n    //     }\n    //     if (argArr[1].indexOf(':') < - 1) {\n    //         return this.getErrorStrings()[CommonErrors.na];\n    //     }\n    //     let lookupRange: string[] | string = [];\n    //     let firstCol: string = '';\n    //     let secCol: string = '';\n    //     if (this.isCellReference(argArr[1])) {\n    //         lookupRange = this.getCellCollection(argArr[1]);\n    //         if (argArr[1].indexOf(':') > - 1) {\n    //             const index: number = argArr[1].indexOf(':');\n    //             for (let i: number = 0; i < index; i++) {\n    //                 const tempCell: string = this.isChar(argArr[1][i]) ? argArr[1][i] : '';\n    //                 firstCol = firstCol + tempCell;\n    //             }\n    //             for (let j: number = index; j < argArr[1].length; j++) {\n    //                 const tempCell2: string = this.isChar(argArr[1][j]) ? argArr[1][j] : '';\n    //                 secCol = secCol + tempCell2;\n    //             }\n    //         }\n    //     }\n    //     const lookupCol: number = this.colIndex(firstCol) + this.parseFloat(argArr[2]);\n    //     if (lookupCol > this.colIndex(secCol)) {\n    //         return this.getErrorStrings()[CommonErrors.na];\n    //     }\n    //     if (lookupCol === this.colIndex(firstCol)) {\n    //         return this.getErrorStrings()[CommonErrors.na];\n    //     }\n    //     const lookupCell: string = this.convertAlpha(lookupCol);\n    //     argArr[3] = isNullOrUndefined(argArr[3]) ? this.trueValue : argArr[3].split(this.tic).join('');\n    //     let cellValue: string = '';\n    //     for (let i: number = 0; i < lookupRange.length; i++) {\n    //         findMaxValue[i] = this.getValueFromArg(lookupRange[i]).split(this.tic).join('');\n    //     }\n    //     const s: string[] = findMaxValue.toString().split(this.getParseArgumentSeparator());\n    //     const maxValue: number = this.parseFloat(s[s.sort().length - 1]);\n    //     const minValue: number = this.parseFloat(s[0]);\n    //     for (let j: number = 0; j < lookupRange.length; j++) {\n    //         cellValue = this.getValueFromArg(lookupRange[j]);\n    //         if (argArr[3].toUpperCase() === this.trueValue) {\n    //             if (lookupValue === cellValue) {\n    //                 return this.getValueFromArg(lookupCell + j).split(this.tic).join('');\n    //             } else if (this.parseFloat(lookupValue) === this.parseFloat(cellValue)) {\n    //                 return this.getValueFromArg(lookupCell + j).split(this.tic).join('');\n    //             } else if (this.parseFloat(lookupValue) < minValue) {\n    //                 return this.getErrorStrings()[CommonErrors.na];\n    //             } else if (this.parseFloat(lookupValue) > maxValue) {\n    //                 const index: number = findMaxValue.indexOf(maxValue.toString());\n    //                 return this.getValueFromArg(lookupCell + index).split(this.tic).join('');\n    //             }\n    //         }\n    //         if (argArr[3] === this.falseValue) {\n    //             if (lookupValue === cellValue) {\n    //                 return this.getValueFromArg(lookupCell + j);\n    //             }\n    //         }\n    //     }\n    //     return this.getErrorStrings()[CommonErrors.na];\n    // }\n    Calculate.prototype.findWildCardValue = function (lookVal, cellValue) {\n        var finalText = '';\n        if (lookVal.indexOf('?') > -1) {\n            var index = lookVal.indexOf('?');\n            var checStr1 = lookVal[index - 1];\n            var checStr2 = lookVal[index + 1];\n            if (cellValue.indexOf(checStr1) > -1 && cellValue.indexOf(checStr2) > -1) {\n                var newIndex = cellValue.indexOf(checStr1);\n                if (cellValue[newIndex] === checStr1 && cellValue[newIndex + 2] === checStr2) {\n                    finalText = lookVal;\n                }\n                else {\n                    finalText = cellValue;\n                }\n            }\n            else {\n                finalText = cellValue;\n            }\n        }\n        else if (lookVal.indexOf('*') > -1) {\n            var index = lookVal.indexOf('*');\n            var left = '';\n            var right = '';\n            var compRight = this.falseValue;\n            var compLeft = this.falseValue;\n            for (var i = index - 1; i >= 0; i--) {\n                left = left + lookVal[i];\n                compLeft = this.trueValue;\n            }\n            for (var i = index + 1; i < lookVal.length; i++) {\n                right = right + lookVal[i];\n                compRight = this.trueValue;\n            }\n            var leftVal = left === '' ? -1 : cellValue.indexOf(left.split('').reverse().join(''));\n            var rightVal = right === '' ? -1 : cellValue.indexOf(right);\n            if (leftVal > -1 || rightVal > -1) {\n                if (compLeft === this.trueValue) {\n                    finalText = (left.split('').reverse().join('') === cellValue.substr(0, left.length)) ? lookVal : cellValue;\n                }\n                else if (compRight === this.trueValue) {\n                    finalText = (right === cellValue.substring(cellValue.length - right.length, cellValue.length)) ? lookVal : cellValue;\n                }\n            }\n            else {\n                finalText = cellValue;\n            }\n        }\n        return finalText;\n    };\n    /** @hidden */\n    /* eslint-disable-next-line */\n    Calculate.prototype.getComputeSumIfValue = function (criteriaRange, sumRange, criteria, checkCriteria, op, isAsterisk) {\n        var sum = 0;\n        var count = 0;\n        var isFirst = isAsterisk && criteria && criteria[0] === '*';\n        switch (op) {\n            case this.parser.tokenEqual:\n                {\n                    var criteriaValue = isAsterisk ? criteria.replace(/\\*/g, '') : criteria;\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (value === criteria && val === checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                        else if (value === criteria) {\n                            sum = sum + this.getValueFromRange(sumRange, i);\n                            count = count + 1;\n                        }\n                        else if (isAsterisk && criteriaValue && value) {\n                            if (criteria[0] === '*' && criteriaValue.length <= value.length && criteriaValue === value.slice(0, criteriaValue.length)) {\n                                sum = sum + this.getValueFromRange(sumRange, i);\n                                count = count + 1;\n                            }\n                            if (criteria[criteria.length - 1] === '*' && criteriaValue.length <= value.length && criteriaValue ===\n                                value.slice(value.length - criteriaValue.length, value.length)) {\n                                sum = sum + this.getValueFromRange(sumRange, i);\n                                count = count + 1;\n                            }\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenLess:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val < checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenGreater:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val > checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenLessEq:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val <= checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenGreaterEq:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val >= checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenNotEqual:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (value !== criteria && val !== checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n        }\n        return [sum, count];\n    };\n    Calculate.prototype.getValueFromRange = function (sumRange, index) {\n        var sumRangeVal = sumRange[index];\n        sumRangeVal = this.getValueFromArg(sumRangeVal);\n        return this.parseFloat(sumRangeVal.toString());\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specifies the args\n     * @param {string} op - specify the operator.\n     * @returns {string} - Compute and or.\n     */\n    Calculate.prototype.computeAndOr = function (args, op) {\n        var result = op === 'and' ? true : false;\n        var value;\n        var parseVal;\n        if (args.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var l = 0, len = args.length; l < len; l++) {\n            if (args[l].split(this.tic).join('').trim() === this.emptyString) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var ranges = args;\n        for (var i = 0; i < ranges.length; i++) {\n            if (ranges[i] === (this.tic)) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n            if (ranges[i].indexOf(':') > -1 && this.isCellReference(ranges[i])) {\n                var cells = this.getCellCollection(ranges[i]);\n                for (var j = 0; j < cells.length; j++) {\n                    if (this.getErrorStrings().indexOf(cells[j]) > -1) {\n                        return cells[j];\n                    }\n                    else if (cells[j][0] === this.tic) {\n                        return this.getErrorStrings()[CommonErrors.name];\n                    }\n                    value = this.getValueFromArg(cells[j]);\n                    if (value === '') {\n                        value = this.trueValue;\n                    }\n                    if (this.getErrorStrings().indexOf(value) > -1) {\n                        return value;\n                    }\n                    parseVal = this.parseFloat(value);\n                }\n            }\n            else {\n                value = this.getValueFromArg(ranges[i]).split(this.tic).join('').toUpperCase();\n                if (this.getErrorStrings().indexOf(value) > -1) {\n                    return value;\n                }\n                var tempdate = Date.parse(value.split(this.tic).join(''));\n                if (!isNaN(tempdate)) {\n                    result = true;\n                }\n                else if (!(value === this.trueValue || value === this.falseValue)) {\n                    return this.getErrorStrings()[CommonErrors.value].toString();\n                }\n                parseVal = this.parseFloat(value);\n            }\n            result = op === 'and' ? (result && ((value === this.trueValue) || !(isNaN(parseVal)))) :\n                (result || ((value === this.trueValue) || !(isNaN(parseVal))));\n        }\n        return result ? this.trueValue : this.falseValue;\n    };\n    /**\n     * @hidden\n     * @param {string} text - specify the text\n     * @returns {string} - to strip out the tic from the formula arguments.\n     */\n    // To strip out the tic from the formula arguments.\n    Calculate.prototype.removeTics = function (text) {\n        if (text.length > 1 && text[0] === this.tic[0] && text[text.length - 1] === this.tic[0]) {\n            text = this.substring(text, 1, text.length - 2);\n        }\n        return text;\n    };\n    /**\n     * @hidden\n     * @param {string} range - specify the range\n     * @returns {string} - to get cell from the range.\n     */\n    Calculate.prototype.getCellFrom = function (range) {\n        var cellRange = '';\n        var cells = range.indexOf(':') > -1 ? range.split(':') : [range];\n        //this.getCellsFromArgs(range);\n        var last = cells.length - 1;\n        var r1 = this.rowIndex(cells[0]);\n        var x;\n        if (r1 === this.rowIndex(cells[last])) {\n            var c1 = this.colIndex(cells[0]);\n            var c2 = this.colIndex(cells[last]);\n            var c = this.colIndex(this.cell);\n            if (c >= c1 && c <= c2) {\n                cellRange = getAlphalabel(c).toString() + r1.toString();\n            }\n        }\n        else if (this.colIndex(cells[0]) === this.colIndex(cells[last])) {\n            x = this.colIndex(cells[0]);\n            var r2 = this.rowIndex(cells[last]);\n            var r = this.rowIndex(this.cell);\n            if (r >= r1 && r <= r2) {\n                cellRange = getAlphalabel(x).toString() + r.toString();\n            }\n        }\n        return cellRange;\n    };\n    Calculate.prototype.computeValue = function (pFormula, refresh) {\n        try {\n            var stack = [];\n            var i = 0;\n            var sheet = '';\n            stack.length = 0;\n            while (i < pFormula.length) {\n                var uFound = pFormula[i] === 'u'; // for 3*-2\n                if (pFormula[i] === this.arithMarker) {\n                    i = i + 1;\n                    continue;\n                }\n                else if (this.isDigit(pFormula[i])) {\n                    var s = this.emptyString;\n                    while (i < pFormula.length && (this.isDigit(pFormula[i]) || pFormula[i] === this.parseDecimalSeparator)) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s);\n                    if (!pFormula[i]) {\n                        return stack.toString();\n                    }\n                }\n                if (pFormula[i] === this.sheetToken) {\n                    sheet = pFormula[i];\n                    i = i + 1;\n                    while (i < pFormula.length && pFormula[i] !== this.sheetToken) {\n                        sheet = sheet + pFormula[i];\n                        i = i + 1;\n                    }\n                    if (i < pFormula.length) {\n                        sheet = sheet + pFormula[i];\n                        i = i + 1;\n                    }\n                }\n                else if (this.isUpperChar(pFormula[i])) {\n                    var s = this.emptyString;\n                    var textName = '';\n                    while (i < pFormula.length && this.isUpperChar(pFormula[i])) {\n                        var char = pFormula[i];\n                        s = s + char;\n                        i = i + 1;\n                    }\n                    while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                        var digit = pFormula[i];\n                        s = s + digit;\n                        i = i + 1;\n                    }\n                    if (i < pFormula.length && pFormula[i] === ':') {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                        if (i < pFormula.length && pFormula[i] === this.sheetToken) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                            while (i < pFormula.length && pFormula[i] !== this.sheetToken) {\n                                s = s + pFormula[i];\n                                i = i + 1;\n                            }\n                        }\n                        while (i < pFormula.length && this.isUpperChar(pFormula[i])) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                        }\n                        while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                        }\n                        s = sheet + this.getCellFrom(s);\n                    }\n                    else {\n                        s = sheet + s;\n                    }\n                    textName = this.getParentObjectCellValue(s, refresh).toString();\n                    sheet = '';\n                    if (typeof textName === 'string' && this.getErrorStrings().indexOf(textName) > -1) {\n                        return textName;\n                    }\n                    stack.push(textName);\n                }\n                else if (pFormula[i] === 'q') {\n                    var leftIdx = pFormula.substring(i + 1).indexOf(this.leftBracket);\n                    var j = pFormula.substring(i + leftIdx + 1).indexOf(this.rightBracket);\n                    pFormula = this.substring(pFormula, i + leftIdx + 2, j - 1);\n                }\n                else if (pFormula[i] === this.tic[0]) {\n                    var s = pFormula[i].toString();\n                    i = i + 1;\n                    while (i < pFormula.length && pFormula[i] !== this.tic[0]) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s.split(this.tic).join(this.emptyString));\n                    i = i + 1;\n                }\n                else if (pFormula[i] === '%' && stack.length > 0) {\n                    var stackValue = stack[0];\n                    var value = this.parseFloat(stackValue);\n                    if (!this.isNaN(value)) {\n                        stack.pop();\n                        stack.push((value / 100).toString());\n                    }\n                    i = i + 1;\n                }\n                else if ((pFormula.substring(i)).indexOf(this.trueValue) === 0) {\n                    stack.push(this.trueValue);\n                    i += this.trueValue.length;\n                }\n                else if (pFormula.substring(i).indexOf(this.falseValue) === 0) {\n                    stack.push(this.falseValue);\n                    i += this.falseValue.length;\n                }\n                else if (pFormula[i] === this.tic[0] || pFormula[i] === '|') {\n                    var s = pFormula[i].toString();\n                    i++;\n                    while (i < pFormula.length && pFormula[i] !== this.tic[0]) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s + this.tic);\n                    i += 1;\n                }\n                else {\n                    switch (pFormula[i]) {\n                        case '#':\n                            {\n                                var errIndex = 0;\n                                if (this.getErrorStrings().indexOf(pFormula.substring(i)) > -1) {\n                                    if (pFormula.indexOf('!') === -1 || pFormula.substring(i).indexOf('!') === -1) {\n                                        errIndex = pFormula.indexOf('#N/A') > -1 ?\n                                            (pFormula.indexOf('#N/A') + 4 + i) : pFormula.indexOf('?') + 1 + i;\n                                    }\n                                    else {\n                                        errIndex = pFormula.indexOf('!') + 1 + i;\n                                    }\n                                    stack.push(this.substring(pFormula, i, errIndex - i));\n                                }\n                                else {\n                                    errIndex = i + 1;\n                                    stack.push(this.substring(pFormula, i, errIndex - i));\n                                }\n                                i = errIndex;\n                            }\n                            break;\n                        case 'n':\n                            {\n                                i = i + 1;\n                                var s = '';\n                                if (pFormula.substring(i).indexOf('Infinity') === 0) {\n                                    s = 'Infinity';\n                                    i += s.length;\n                                }\n                                else {\n                                    if (pFormula[i] === 'u' || uFound || pFormula[i] === '-') {\n                                        s = '-';\n                                        if (!uFound) {\n                                            i = i + 1;\n                                        }\n                                        else {\n                                            uFound = false;\n                                        }\n                                    }\n                                    while (i < pFormula.length && (this.isDigit(pFormula[i]))\n                                        || pFormula[i] === this.getParseDecimalSeparator()) {\n                                        s = s + pFormula[i];\n                                        i = i + 1;\n                                    }\n                                    if (i < pFormula.length && pFormula[i] === '%') {\n                                        i = i + 1;\n                                        if (s === '') {\n                                            if (stack.length > 0) {\n                                                var stackValue = stack[0];\n                                                var value = this.parseFloat(stackValue);\n                                                if (!this.isNaN(value)) {\n                                                    stack.pop();\n                                                    stack.push((value / 100).toString());\n                                                }\n                                            }\n                                        }\n                                        else {\n                                            s = (this.parseFloat(s) / 100).toString();\n                                        }\n                                    }\n                                }\n                                stack.push(s);\n                            }\n                            break;\n                        case this.parser.tokenAdd:\n                            {\n                                this.getValArithmetic(stack, 'add');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenSubtract:\n                            {\n                                this.getValArithmetic(stack, 'sub');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenMultiply:\n                            {\n                                this.getValArithmetic(stack, 'mul');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenDivide:\n                            {\n                                this.getValArithmetic(stack, 'div');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenLess:\n                            {\n                                this.processLogical(stack, 'less');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenGreater:\n                            {\n                                this.processLogical(stack, 'greater');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenGreaterEq:\n                            {\n                                this.processLogical(stack, 'greaterEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenLessEq:\n                            {\n                                this.processLogical(stack, 'lessEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenNotEqual:\n                            {\n                                this.processLogical(stack, 'notEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenOr:\n                            {\n                                this.processLogical(stack, 'or');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenAnd:\n                            {\n                                this.processLogical(stack, 'and');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenEqual:\n                            {\n                                this.processLogical(stack, 'equal');\n                                i = i + 1;\n                            }\n                            break;\n                        default: {\n                            return this.getErrorStrings()[CommonErrors.value];\n                        }\n                    }\n                }\n            }\n            if (stack.length === 0) {\n                return this.emptyString;\n            }\n            else {\n                var s = this.emptyString;\n                var countValue = stack.length;\n                while (countValue > 0) {\n                    s = stack.pop() + s;\n                    if (s === this.emptyString && this.isCellReference(pFormula) &&\n                        this.getTreatEmptyStringAsZero()) {\n                        return '0';\n                    }\n                    countValue--;\n                }\n                return s;\n            }\n        }\n        catch (ex) {\n            if (this.getErrorStrings().indexOf(ex) > -1 || this.formulaErrorStrings.indexOf(ex) > -1) {\n                throw ex;\n            }\n            throw new FormulaError(this.formulaErrorStrings[FormulasErrorsStrings.invalid_expression]);\n        }\n    };\n    Calculate.prototype.getValArithmetic = function (stack, operator) {\n        var num1 = stack.pop();\n        num1 = num1 === this.emptyString ? '0' : num1;\n        var num = Number(num1);\n        if (isNaN(num)) {\n            if (num1 === this.getErrorStrings()[CommonErrors.divzero]) {\n                throw this.getErrorStrings()[CommonErrors.divzero];\n            }\n            else {\n                throw this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var num2 = stack.pop();\n        num2 = num2 === this.emptyString ? (stack.length ? stack.pop() : '0') : num2;\n        num = Number(num2);\n        if (isNaN(num)) {\n            if (num1 === this.getErrorStrings()[CommonErrors.divzero]) {\n                throw this.getErrorStrings()[CommonErrors.divzero];\n            }\n            else {\n                throw this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (operator === 'add') {\n            stack.push((Number(num2) + Number(num1)).toString());\n        }\n        if (operator === 'sub') {\n            stack.push((Number(num2) - Number(num1)).toString());\n        }\n        if (operator === 'mul') {\n            stack.push((Number(num2) * Number(num1)).toString());\n        }\n        if (operator === 'div') {\n            if (this.isNaN(this.parseFloat(num1)) || this.isNaN(this.parseFloat(num2))) {\n                stack.push(this.getErrorStrings()[CommonErrors.value]);\n            }\n            else if (this.parseFloat(num1) === 0) {\n                stack.push(this.getErrorStrings()[CommonErrors.divzero]);\n            }\n            else {\n                stack.push((Number(num2) / Number(num1)).toString());\n            }\n        }\n    };\n    /**\n     * @hidden\n     * @param {string[]} stack - specify the stack\n     * @param {string} operator - specify the operator.\n     * @returns {string} - To process the logical.\n     */\n    Calculate.prototype.processLogical = function (stack, operator) {\n        var val1;\n        var val2;\n        var value1;\n        var value2;\n        if (operator !== 'and' && operator !== 'equal') {\n            val1 = stack.pop();\n            val2 = stack.pop();\n            value1 = val1.indexOf(this.tic) > -1 ? val1 : this.parseFloat(val1);\n            value2 = val2.indexOf(this.tic) > -1 ? val2 : this.parseFloat(val2);\n        }\n        var result;\n        if (operator === 'less') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 < value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) < 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'greater') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 > value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) > 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'lessEq') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 <= value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) <= 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'greaterEq') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 >= value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) >= 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'notEq') {\n            result = (val2 !== val1) ? this.trueValue : this.falseValue;\n        }\n        if (operator === 'and') {\n            val1 = stack.pop().toString();\n            val2 = '';\n            if (stack.length > 0) {\n                val2 = stack.pop().toString();\n            }\n            result = this.emptyString + val2 + val1 + this.emptyString;\n            result = result.split(this.tic).join('');\n        }\n        if (operator === 'equal') {\n            val1 = stack.pop().toString();\n            val2 = stack.pop().toString();\n            if (val2 === '' && val1 !== '') {\n                val2 = '0';\n            }\n            result = val1 === val2 ? this.trueValue : this.falseValue;\n        }\n        if (operator === 'or') {\n            result = Math.pow(this.parseFloat(value2), this.parseFloat(value1)).toString();\n        }\n        stack.push(result);\n        return result;\n    };\n    /**\n     * @hidden\n     * @param {StoredCellInfo} sCell - specified the cell information\n     * @returns {string[]} - compute stored cells\n     */\n    Calculate.prototype.computeStoreCells = function (sCell) {\n        var cellValue = sCell.cellValue;\n        var cellRanges = sCell.cellRange;\n        var criterias = sCell.criteria;\n        var argArr = sCell.argArray;\n        var isCriteria = sCell.isCriteria;\n        var storeCell = sCell.storedCells;\n        var isCountIfs = sCell.isCountIfS;\n        var i = sCell.countVal;\n        var rangeLength = isCriteria === this.trueValue ? storeCell : cellValue;\n        var tempStoredCell = [];\n        for (var j = 0; j < rangeLength.length; j++) {\n            var stack = [];\n            var cellVal = this.getValueFromArg(cellValue[j]);\n            var criteria = void 0;\n            var newCell = '';\n            criteria = argArr[2].split(this.tic).join(this.emptyString);\n            criteria = this.isCellReference(criteria) ? this.getValueFromArg(criteria) : criteria;\n            isCriteria = isCountIfs === this.trueValue ? this.trueValue : isCriteria;\n            if (isCriteria === this.trueValue) {\n                var cell = '';\n                var count = 0;\n                var newCount = 0;\n                storeCell[j] = isCountIfs === this.trueValue && i === 0 ? cellValue[j] : storeCell[j];\n                cell = storeCell[j];\n                // convert the new cell ranges  for find in range with criteria.\n                while (!this.isDigit(cell[count])) {\n                    count = count + 1;\n                }\n                if (this.isCellReference(cellRanges[i]) && cellRanges[i].indexOf(':') > -1) {\n                    var k = cellRanges[i].indexOf(':');\n                    newCell = this.substring(cellRanges[i], k);\n                    while (!this.isDigit(newCell[newCount])) {\n                        newCount = newCount + 1;\n                    }\n                }\n                var cellAlpha = this.substring(cell, count);\n                var newCellAlpha = this.substring(newCell, newCount);\n                newCell = storeCell[j].split(cellAlpha).join(newCellAlpha);\n                cellVal = this.getValueFromArg(newCell);\n                criteria = isCountIfs === this.trueValue ? criterias[i].split(this.tic).join(this.emptyString) :\n                    criterias[i - 1].split(this.tic).join(this.emptyString);\n            }\n            var op = 'equal';\n            if (criteria.startsWith('<=')) {\n                op = 'lessEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('>=')) {\n                op = 'greaterEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('<>')) {\n                op = 'notEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('<')) {\n                op = 'less';\n                criteria = criteria.substring(1);\n            }\n            else if (criteria.startsWith('>')) {\n                op = 'greater';\n                criteria = criteria.substring(1);\n            }\n            else if (criteria.startsWith('=')) {\n                op = 'equal';\n                criteria = criteria.substring(1);\n            }\n            if (criteria.indexOf('*') > -1 || criteria.indexOf('?') > -1) {\n                cellVal = this.findWildCardValue(criteria, cellVal);\n            }\n            stack.push(cellVal.toLowerCase());\n            stack.push(criteria.toLowerCase());\n            if (this.processLogical(stack, op) === this.trueValue) {\n                if (isCriteria === this.falseValue) {\n                    tempStoredCell.push(cellValue[j]);\n                }\n                else {\n                    tempStoredCell.push(newCell);\n                }\n            }\n        }\n        storeCell = tempStoredCell;\n        tempStoredCell = [];\n        return storeCell;\n    };\n    Calculate.prototype.computeIfsFormulas = function (range, isCountIfs, isAvgIfs) {\n        if (isNullOrUndefined(range) || range[0] === '' || range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (argCount < 2 || argCount > 127) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellRanges = [];\n        var criterias = [];\n        var storedCell = [];\n        var storedCellLength = 0;\n        var sum = 0;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.isCellReference(argArr[i])) {\n                cellRanges.push(argArr[i]);\n            }\n            else {\n                criterias.push(argArr[i]);\n            }\n        }\n        cellRanges = cellRanges.toString().split(',,').join(',');\n        cellRanges = cellRanges.split(this.getParseArgumentSeparator());\n        var len = [];\n        for (var i = 0; i < cellRanges.length; i++) {\n            len.push(this.getCellCollection(cellRanges[i]).length);\n        }\n        for (var j = 0; j < len.length; j++) {\n            if (len[j] && len[j + 1] && len[j] !== len[j + 1]) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var cellvalue;\n        var isCriteria;\n        if (isCountIfs === this.falseValue) {\n            isCriteria = this.falseValue;\n            cellvalue = this.getCellCollection(cellRanges[1]);\n            var sCell = {\n                cellValue: cellvalue, cellRange: cellRanges, criteria: criterias,\n                argArray: argArr, isCriteria: isCriteria, storedCells: storedCell, isCountIfS: isCountIfs\n            };\n            storedCell = this.computeStoreCells(sCell);\n            storedCellLength = storedCell.length;\n            if (storedCellLength === 0) {\n                return isAvgIfs === this.trueValue ? this.getErrorStrings()[CommonErrors.divzero] : 0;\n            }\n        }\n        // Compare criteria and convert the new cell ranges.\n        var startRange = isCountIfs === this.trueValue ? 0 : 2;\n        for (var i = startRange; i < cellRanges.length; i++) {\n            isCriteria = this.trueValue;\n            isCriteria = isCountIfs === this.trueValue && i === 0 ? this.falseValue : this.trueValue;\n            cellvalue = this.getCellCollection(cellRanges[i]);\n            var sCell = {\n                cellValue: cellvalue, cellRange: cellRanges, criteria: criterias,\n                argArray: argArr, isCriteria: isCriteria, storedCells: storedCell, isCountIfS: isCountIfs, countVal: i\n            };\n            storedCell = this.computeStoreCells(sCell);\n            storedCellLength = storedCell.length;\n            if (storedCellLength === 0) {\n                return 0;\n            }\n        }\n        var avgValCount = 0;\n        for (var j = 0; j < storedCell.length; j++) {\n            // convert the new cell ranges  for find sum in range 0(first range)\n            var cell = '';\n            var newCell = '';\n            var count = 0;\n            var newCount = 0;\n            cell = storedCell[j];\n            while (!this.isDigit(cell[count])) {\n                count = count + 1;\n            }\n            if (this.isCellReference(cellRanges[0]) && cellRanges[0].indexOf(':') > -1) {\n                var k = cellRanges[0].indexOf(':');\n                newCell = this.substring(cellRanges[0], k);\n                while (!this.isDigit(newCell[newCount])) {\n                    newCount = newCount + 1;\n                }\n            }\n            var cellAlpha = this.substring(cell, count);\n            var newCellAlpha = this.substring(newCell, newCount);\n            cellvalue = storedCell[j].split(cellAlpha).join(newCellAlpha);\n            if (isCountIfs === this.trueValue) {\n                sum = sum + 1;\n            }\n            else {\n                avgValCount++;\n                var argValue = this.getValueFromArg(cellvalue);\n                sum = sum + parseFloat(argValue === '' ? '0' : argValue);\n            }\n        }\n        if (isAvgIfs === this.trueValue) {\n            sum = sum / avgValCount;\n        }\n        return sum;\n    };\n    Calculate.prototype.processNestedFormula = function (pText, sFormula, fResult) {\n        var interiorCalcFString = pText.split(sFormula).join('n' + fResult);\n        return interiorCalcFString;\n    };\n    /**\n     * @hidden\n     * @param {string | number} value - Specify the value\n     * @returns {boolean} -  Returns boolean value\n     */\n    Calculate.prototype.isNaN = function (value) {\n        if (value.toString() === 'NaN' || typeof value === 'string') {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @hidden\n     * @param {number} doubleNumber - To specify the double number\n     * @returns {Date} - Returns date.\n     */\n    Calculate.prototype.fromOADate = function (doubleNumber) {\n        var result = new Date();\n        result.setTime((doubleNumber * this.millisecondsOfaDay) + Date.parse(this.oaDate.toString()));\n        return result;\n    };\n    /**\n     * @hidden\n     * @param {number} year - Specify the year.\n     * @param {number} month - Specify the month.\n     * @param {number} day - Specify the day.\n     * @returns {number} -  to get serial date from date.\n     */\n    Calculate.prototype.getSerialDateFromDate = function (year, month, day) {\n        var days = 0;\n        if (year < 1900) {\n            year += 1900;\n        }\n        var isValidMonth = false;\n        while (!isValidMonth) {\n            while (month > 12) {\n                year++;\n                month -= 12;\n            }\n            isValidMonth = true;\n            var tempDay = new Date(year, month, 1, -1).getDate();\n            while (day > tempDay) {\n                tempDay = new Date(year, month, 1, -1).getDate();\n                month++;\n                day -= tempDay;\n                isValidMonth = false;\n            }\n            if (day < 1) {\n                month--;\n                tempDay = new Date(year, month, 1, -1).getDate();\n                day = tempDay - day;\n            }\n        }\n        var dateTime = Date.parse(year.toString() + this.getParseDateTimeSeparator() + month.toString() +\n            this.getParseDateTimeSeparator() + day.toString());\n        if (!this.isNaN(dateTime)) {\n            days = this.toOADate(new Date(dateTime));\n        }\n        return days;\n    };\n    /**\n     * @hidden\n     * @param {Date} dateTime - Specify the date Time\n     * @returns {number} -  returns to date.\n     */\n    Calculate.prototype.toOADate = function (dateTime) {\n        var result = (dateTime.getTime() - Date.parse(this.oaDate.toString())) / this.millisecondsOfaDay;\n        return result;\n    };\n    /**\n     * @hidden\n     * @param {string} date - Specify the date\n     * @returns {string} -  returns calculate Date\n     */\n    Calculate.prototype.calculateDate = function (date) {\n        return (this.parseFloat(date) < 10) ? '0' + date : date;\n    };\n    /**\n     * @hidden\n     * @param {string} s - Specify the s\n     * @returns {boolean} -  returns boolean value.\n     */\n    Calculate.prototype.isTextEmpty = function (s) {\n        return s === null || s === '';\n    };\n    /**\n     * @hidden\n     * @param {string} text - Specify the text\n     * @returns {boolean} -  returns boolean value.\n     */\n    Calculate.prototype.isDigit = function (text) {\n        var charCode = text.charCodeAt(0);\n        if ((charCode > 47) && (charCode < 58)) {\n            return true;\n        }\n        return false;\n    };\n    Calculate.prototype.findLastIndexOfq = function (fString) {\n        return fString.lastIndexOf('q');\n    };\n    /**\n     * To get the exact value from argument.\n     *\n     * @param {string} arg - Formula argument for getting a exact value.\n     * @param {boolean} isUnique - It specifies unique formula or not.\n     * @returns {string} - To get the exact value from argument.\n     */\n    Calculate.prototype.getValueFromArg = function (arg, isUnique) {\n        arg = arg.trim();\n        var s = arg;\n        var dateTime = this.dateTime1900;\n        var pObjCVal = s;\n        if (isNullOrUndefined(s) || this.isTextEmpty(s)) {\n            return s;\n        }\n        else if (arg[0] === this.tic || arg[0] === this.singleTic) {\n            dateTime = this.isDate(arg.split(this.tic).join(''));\n            if (this.isNaN(this.parseFloat(arg.split(this.tic).join(''))) && !isNullOrUndefined(dateTime) &&\n                !this.isNaN(dateTime.getDate()) && this.dateTime1900 <= dateTime) {\n                return this.toOADate(dateTime).toString();\n            }\n            return arg;\n        }\n        else {\n            arg = arg.split('u').join('-');\n            if (!this.isUpperChar(s[0]) && (this.isDigit(s[0]) || s[0] === this.getParseDecimalSeparator() || s[0] === '-' || s[0] === 'n')) {\n                if (s[0] === 'n') {\n                    s = s.substring(1);\n                    if (s.indexOf('\"n') > -1) {\n                        s = s.replace('\"n', '\"');\n                    }\n                }\n                return s;\n            }\n        }\n        var symbolArray = ['+', '-', '/', '*', ')', ')', '{'];\n        if ((this.parser.indexOfAny(s, symbolArray) === -1 && this.isUpperChar(s[0])) || s[0] === this.sheetToken) {\n            if (s !== this.trueValue && s !== this.falseValue && this.isCellReference(s)) {\n                var f = this.getSheetFamilyItem(this.grid);\n                if (f.sheetNameToParentObject !== null && f.sheetNameToParentObject.size > 0 && s.indexOf(this.sheetToken) === -1) {\n                    var token = f.parentObjectToToken.get(this.grid);\n                    s = token + s;\n                }\n            }\n            if (s === this.cell) {\n                var dependent = this.getDependentCells().get(s);\n                if (dependent != null && dependent.indexOf(s) > -1) {\n                    this.arrayRemove(dependent, s);\n                }\n                if (!this.getDependentFormulaCells().has(this.cell)) {\n                    this.clearFormulaDependentCells(this.cell);\n                }\n                // eslint-disable-next-line no-throw-literal\n                if (!isUnique) {\n                    throw this.formulaErrorStrings[FormulasErrorsStrings.circular_reference] + s;\n                }\n            }\n            pObjCVal = this.getParentObjectCellValue(s, false, isUnique);\n            this.updateDependentCell(s);\n            return pObjCVal.toString();\n        }\n        if (this.getErrorStrings().indexOf(arg) > -1) {\n            return arg;\n        }\n        return this.computeValue(pObjCVal.toString(), false);\n    };\n    /* eslint-disable-next-line */\n    Calculate.prototype.isDate = function (date) {\n        if (typeof date === 'object' || Date.parse(date) !== null) {\n            var dateval = new Date(Date.parse(date));\n            if (dateval >= this.dateTime1900) {\n                return dateval;\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            return null;\n        }\n    };\n    Calculate.prototype.isValidCellReference = function (text) {\n        var start = 0;\n        var end = 0;\n        var j = 0;\n        var numArr = [89, 71, 69];\n        var cellTxt = this.emptyString;\n        if (this.namedRanges.has(text)) {\n            return false;\n        }\n        for (var i = 0; i < text.length; i++) {\n            if (this.isChar(text[i])) {\n                end++;\n            }\n        }\n        cellTxt = text.substring(start, end);\n        if (cellTxt.length < 4) {\n            while (j < cellTxt.length) {\n                if (!isNullOrUndefined(cellTxt[j]) && cellTxt[j].charCodeAt(0) < numArr[j]) {\n                    j++;\n                    continue;\n                }\n                else if (isNullOrUndefined(cellTxt[j]) && j > 0) {\n                    break;\n                }\n                else {\n                    return false;\n                }\n            }\n            var cellNum = this.parseFloat(text.substring(end, text.length));\n            if (cellNum < 1048576) { // Maximum number of rows in excel.\n                return true;\n            }\n        }\n        return false;\n    };\n    /** @hidden */\n    /* eslint-disable-next-line */\n    Calculate.prototype.parseDate = function (date) {\n        if (!this.isNaN(date)) {\n            if (date instanceof Date) {\n                return new Date(date);\n            }\n            var d = parseInt(date, 10);\n            if (d < 0) {\n                return this.getErrorStrings()[CommonErrors.num];\n            }\n            if (d <= 60) {\n                return new Date(this.dateTime1900.getTime() + (d - 1) * 86400000);\n            }\n            return new Date(this.dateTime1900.getTime() + (d - 2) * 86400000);\n        }\n        if (typeof date === 'string') {\n            date = new Date(date);\n            if (!this.isNaN(date)) {\n                return date;\n            }\n        }\n        return this.getErrorStrings()[CommonErrors.value];\n    };\n    /**\n     * @hidden\n     * @param {string} args - Specify the args\n     * @returns {boolean} - Returns boolean value.\n     */\n    Calculate.prototype.isCellReference = function (args) {\n        if (args === this.emptyString) {\n            return false;\n        }\n        args = args.trim();\n        args = this.setTokensForSheets(args);\n        var sheetToken1 = this.getSheetToken(args);\n        var containsBoth = false;\n        if (sheetToken1 !== '') {\n            args = args.split(sheetToken1).join(this.emptyString);\n        }\n        var isAlpha = false;\n        var isNum = false;\n        if (args.indexOf(':') !== args.lastIndexOf(':')) {\n            return false;\n        }\n        var charArray = (args.split('').join(this.getParseArgumentSeparator())).split(this.getParseArgumentSeparator());\n        for (var c = 0; c < charArray.length; c++) {\n            if (this.isChar(charArray[c])) {\n                isAlpha = true;\n            }\n            else if (this.isDigit(charArray[c])) {\n                isNum = true;\n            }\n            else if (charArray[c] === ':') {\n                if (isAlpha && isNum) {\n                    containsBoth = true;\n                }\n                isAlpha = false;\n                isNum = false;\n            }\n            else {\n                return false;\n            }\n        }\n        if (args.indexOf(':') > -1 && args.indexOf(this.tic) === -1) {\n            if (containsBoth && isAlpha && isNum) {\n                return true;\n            }\n            else if (((isAlpha && !isNum) || (!isAlpha && isNum)) && !containsBoth) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n        if (isAlpha && isNum && args.indexOf(this.tic) === -1) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @hidden\n     * @param {string} text - Specify the text.\n     * @returns {string} - set Tokens For Sheets.\n     */\n    Calculate.prototype.setTokensForSheets = function (text) {\n        var family = this.getSheetFamilyItem(this.grid);\n        var sortedSheetNamesCollection = this.getSortedSheetNames();\n        if (sortedSheetNamesCollection != null) {\n            for (var n = 0; n < sortedSheetNamesCollection.length; n++) {\n                var token = family.sheetNameToToken.get(sortedSheetNamesCollection[n]);\n                token = token.split(this.sheetToken).join(this.tempSheetPlaceHolder);\n                var s = this.singleTic + 'SHEET' + sortedSheetNamesCollection[n] + this.singleTic + this.sheetToken;\n                if (text.indexOf(s) === -1) {\n                    s = 'SHEET' + sortedSheetNamesCollection[n] + this.sheetToken;\n                }\n                text = text.split(s).join(token);\n                s = sortedSheetNamesCollection[n] + this.sheetToken;\n                text = text.split(s).join(token);\n            }\n        }\n        text = text.split(this.tempSheetPlaceHolder).join(this.sheetToken);\n        if (text.indexOf('!!') > -1) {\n            text = text.replace('!!', '!');\n            var textSplit = text.split('');\n            textSplit[1] = (parseInt(textSplit[1], 10) + 1).toString();\n            text = textSplit.join('');\n        }\n        return text;\n    };\n    Calculate.prototype.getParentObjectCellValue = function (val, refresh, isUnique) {\n        if (val === this.trueValue || val === this.falseValue) {\n            return val;\n        }\n        var i = val.lastIndexOf(this.sheetToken);\n        var row = 0;\n        var col = 0;\n        var grid = this.grid;\n        var family = this.getSheetFamilyItem(grid);\n        if (i > -1 && family.tokenToParentObject !== null) {\n            this.grid = family.tokenToParentObject.get(val.substring(0, i + 1));\n            row = this.rowIndex(val);\n            col = this.colIndex(val);\n        }\n        else if (i === -1) {\n            var j = 0;\n            while (j < val.length && this.isChar(val[j])) {\n                j++;\n            }\n            if (j === val.length) {\n                val = val.toLowerCase();\n                return val === '' ? this.getErrorStrings()[CommonErrors.value] : this.getErrorStrings()[CommonErrors.name];\n            }\n            else {\n                row = this.rowIndex(val);\n                col = this.colIndex(val);\n                if (family.isSheetMember && family.parentObjectToToken != null) {\n                    val = family.parentObjectToToken.get(this.grid) + val;\n                }\n            }\n        }\n        var saveCell = (this.cell === '' || this.cell === null) ? '' : this.cell;\n        this.cell = val;\n        if (saveCell === this.cell && !isUnique) {\n            throw this.formulaErrorStrings[FormulasErrorsStrings.circular_reference];\n        }\n        var cValue = this.getParentCellValue(row, col, this.grid, saveCell, grid, refresh);\n        this.grid = grid;\n        this.cell = saveCell;\n        return cValue;\n    };\n    Calculate.prototype.getParentCellValue = function (row, col, grd, fromCell, fromCellGrd, refresh) {\n        // formulainfotable\n        var cValue;\n        var gridId = grd && typeof grd === 'string' && Number(grd) > -1 ? Number(grd) : this.getSheetID(grd);\n        if (this.parentObject.getValueRowCol === undefined) {\n            cValue = this.getValueRowCol(gridId, row, col);\n        }\n        else {\n            if (fromCell) {\n                fromCell = fromCellGrd === grd ? '' : fromCell + ',' +\n                    (fromCellGrd && typeof fromCellGrd === 'string' && Number(fromCellGrd) > -1 ? fromCellGrd : this.getSheetID(fromCellGrd));\n            }\n            cValue = this.parentObject.getValueRowCol(gridId, row, col, fromCell, refresh);\n            return isNullOrUndefined(cValue) ? this.emptyString : cValue.toString();\n        }\n        if (cValue === '' || cValue === undefined) {\n            cValue = '';\n        }\n        // if (cValue[cValue.length - 1] == (\"%\") && !this.isNaN(d)) {\n        //     cValue = (Number(d) / 100).toString();\n        // }\n        return cValue;\n    };\n    /**\n     * Getting the formula result.\n     *\n     * @param {Object} grid - Specifies the parent object.\n     * @param {number} row - Row index of the parent object or key.\n     * @param {number} col - Column index of the parent object.\n     * @returns {string} - Getting the formula result.\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Calculate.prototype.getValueRowCol = function (grid, row, col) {\n        var key = this.rowsToKeyMap.get(row).toString();\n        var result = this.getKeyValue(key).toString();\n        if (result != null && result[result.length - 1] === ('%') && result.length > 1) {\n            var d = this.parseFloat(result.substring(0, result.length - 1));\n            if (this.isNaN(d)) {\n                result = (Number(d) / 100).toString();\n            }\n        }\n        return result;\n    };\n    /**\n     * To add custom library formula.\n     *\n     * @param {string} formulaName - Custom Formula name.\n     * @param {string} functionName - Custom function name.\n     * @returns {void} - To add custom library formula.\n     */\n    Calculate.prototype.defineFunction = function (formulaName, functionName) {\n        if (typeof functionName === 'string') {\n            functionName = getValue(functionName, window);\n        }\n        formulaName = formulaName.toUpperCase();\n        this.libraryFormulas.set(formulaName, { handler: functionName, isCustom: true });\n    };\n    /**\n     * Specifies when changing the value.\n     *\n     * @param {string} grid - Parent object reference name.\n     * @param {ValueChangedArgs} changeArgs - Value changed arguments.\n     * @param {boolean} isCalculate - Value that allow to calculate.\n     * @param {number[]} usedRangeCol - Specify the used range collection.\n     * @returns {void} - Specifies when changing the value.\n     */\n    Calculate.prototype.valueChanged = function (grid, changeArgs, isCalculate, usedRangeCol, refresh) {\n        var pgrid = grid;\n        this.spreadSheetUsedRange = usedRangeCol;\n        this.grid = grid;\n        var isComputedValueChanged = true;\n        var isCompute = true;\n        var calcFamily = this.getSheetFamilyItem(pgrid);\n        var cellTxt = getAlphalabel(changeArgs.getColIndex()) + changeArgs.getRowIndex().toString();\n        this.actCell = cellTxt;\n        if (calcFamily.sheetNameToParentObject !== null && calcFamily.sheetNameToParentObject.size > 0) {\n            var token = calcFamily.parentObjectToToken.get(pgrid);\n            cellTxt = token + cellTxt;\n        }\n        var argVal = changeArgs.getValue().toUpperCase();\n        if (argVal.indexOf('=RAND()') > -1 || argVal.indexOf('RAND()') > -1 || argVal.indexOf('=RANDBETWEEN(') > -1 ||\n            argVal.indexOf('RANDBETWEEN(') > -1 || this.randomValues.has(cellTxt)) {\n            var randStrVal = this.randCollection.toString();\n            if (!this.randomValues.has(cellTxt)) {\n                this.randomValues.set(cellTxt, changeArgs.getValue());\n                this.randCollection.push(cellTxt);\n                this.isRandomVal = true;\n            }\n            else if (this.randomValues.has(cellTxt)) {\n                if (argVal.indexOf('=RAND()') > -1 || argVal.indexOf('RAND()') > -1 || argVal.indexOf('=RANDBETWEEN(') > -1 ||\n                    argVal.indexOf('RANDBETWEEN(') > -1) {\n                    this.randomValues.set(cellTxt, changeArgs.getValue());\n                }\n                else if (changeArgs.getValue().toUpperCase() !== this.randomValues.get(cellTxt.toUpperCase())) {\n                    this.randomValues.delete(cellTxt);\n                    randStrVal = randStrVal.split(cellTxt + this.parseArgumentSeparator).join('').split(this.parseArgumentSeparator + cellTxt).join('').split(cellTxt).join('');\n                    this.randCollection = randStrVal.split(this.parseArgumentSeparator);\n                }\n                if (this.randomValues.size === 0 && this.randCollection.length) {\n                    this.isRandomVal = false;\n                    this.randomValues.clear();\n                    this.randCollection = [];\n                }\n            }\n        }\n        if (changeArgs.getValue() && changeArgs.getValue()[0] === this.getFormulaCharacter()) {\n            this.cell = cellTxt;\n            var formula = void 0;\n            if (!isNullOrUndefined(isCompute)) {\n                isCompute = isCalculate;\n            }\n            if (this.getFormulaInfoTable().has(cellTxt)) {\n                formula = this.getFormulaInfoTable().get(cellTxt);\n                if (changeArgs.getValue() !== formula.getFormulaText() || formula.getParsedFormula() == null) {\n                    formula.setFormulaText(changeArgs.getValue());\n                    if (this.getDependentFormulaCells().has(this.cell)) {\n                        this.clearFormulaDependentCells(this.cell);\n                    }\n                    try {\n                        formula.setParsedFormula(this.parser.parseFormula(changeArgs.getValue()));\n                    }\n                    catch (ex) {\n                        formula.setFormulaValue(ex);\n                        isCompute = false;\n                    }\n                }\n                if (isCompute) {\n                    this.parser.isFormulaParsed = true;\n                    var cValue = this.calculateFormula(formula.getParsedFormula(), refresh);\n                    isComputedValueChanged = (cValue !== formula.getFormulaValue());\n                    formula.setFormulaValue(cValue);\n                }\n            }\n            else {\n                formula = new FormulaInfo();\n                formula.setFormulaText(changeArgs.getValue());\n                if (!this.getDependentFormulaCells().has(cellTxt)) {\n                    this.getDependentFormulaCells().set(cellTxt, new Map());\n                }\n                try {\n                    formula.setParsedFormula(this.parser.parseFormula(changeArgs.getValue()));\n                }\n                catch (ex) {\n                    formula.setFormulaValue(ex);\n                    isCompute = false;\n                }\n                if (isCompute) {\n                    formula.setFormulaValue(this.calculateFormula(formula.getParsedFormula(), refresh));\n                }\n                if (this.getFormulaInfoTable().has(cellTxt)) {\n                    this.getFormulaInfoTable().set(cellTxt, formula);\n                }\n                else {\n                    this.getFormulaInfoTable().set(cellTxt, formula);\n                }\n            }\n            if (isCompute) {\n                /* eslint-disable */\n                if (this.parentObject.setValueRowCol === undefined) {\n                    this.setValueRowCol(this.getSheetID(pgrid) + 1, formula.getFormulaValue(), changeArgs.getRowIndex(), changeArgs.getColIndex());\n                }\n                else {\n                    this.parentObject.setValueRowCol(this.getSheetID(pgrid) + 1, formula.getFormulaValue(), changeArgs.getRowIndex(), changeArgs.getColIndex());\n                }\n                /* eslint-enable */\n            }\n        }\n        else if (this.getFormulaInfoTable().has(cellTxt)) {\n            this.getFormulaInfoTable().delete(cellTxt);\n            if (this.getDependentFormulaCells().has(cellTxt)) {\n                this.clearFormulaDependentCells(cellTxt);\n            }\n        }\n        if (isCompute && isComputedValueChanged && this.getDependentCells().has(cellTxt) &&\n            this.getDependentCells().get(cellTxt).toString() !== cellTxt) {\n            this.getComputedValue().clear();\n            this.refresh(cellTxt);\n        }\n    };\n    /**\n     * @hidden\n     * @returns {Map<string, string | number>} - To get computed value.\n     */\n    Calculate.prototype.getComputedValue = function () {\n        if (this.computedValues === null) {\n            this.computedValues = new Map();\n        }\n        return this.computedValues;\n    };\n    /**\n     * @hidden\n     * @param {number} value - specify the value\n     * @param {string | number} formulaValue -  specify the formula value.\n     * @param {number} row - specify the row\n     * @param {number} col - specify the col.\n     * @returns {void} - to set value row and column.\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Calculate.prototype.setValueRowCol = function (value, formulaValue, row, col) {\n        /* No Implementation */\n    };\n    Calculate.prototype.getSortedSheetNames = function () {\n        var family = this.getSheetFamilyItem(this.grid);\n        if (family != null && family.sheetNameToToken != null) {\n            var arr_1 = [];\n            family.sheetNameToToken.forEach(function (value, key) {\n                arr_1.push(key);\n                arr_1.sort();\n            });\n            this.sortedSheetNames = arr_1;\n            this.sortedSheetNames.sort();\n            if (this.sortedSheetNames.length > 9 && this.sortedSheetNames[0].includes('1') && this.sortedSheetNames[1].includes('10')) {\n                this.sortedSheetNames.splice(this.sortedSheetNames.indexOf('2'), 0, this.sortedSheetNames[0]);\n                this.sortedSheetNames.splice(0, 1);\n            }\n        }\n        return this.sortedSheetNames;\n    };\n    /**\n     * @hidden\n     * @param {string} error -  specify the string\n     * @returns {string} - to get error line.\n     */\n    Calculate.prototype.getErrorLine = function (error) {\n        /* eslint-disable-next-line */\n        var errorStack = error.stack ? error.stack.split('\\n')[1].split(':') : null;\n        return errorStack ? errorStack[errorStack.length - 2] : null; // Getting row number of the error file.\n    };\n    /** @hidden\n     * @returns {number} - to return the sheet id\n     */\n    Calculate.prototype.createSheetFamilyID = function () {\n        if (this.sheetFamilyID === Number.MAX_SAFE_INTEGER) {\n            this.sheetFamilyID = Number.MIN_SAFE_INTEGER;\n        }\n        return this.sheetFamilyID++;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - Specify the args.\n     * @param {string} operation - Specify the operation.\n     * @returns {string} - To compute min max.\n     */\n    Calculate.prototype.computeMinMax = function (args, operation) {\n        var result;\n        var argVal;\n        var countStrVal = 0;\n        if (isNullOrUndefined(args) || args.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var k = 0, len = args.length; k < len; k++) {\n            if (args[k].split(this.tic).join('').trim() === this.emptyString) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        result = (operation === 'max') ? this.minValue : this.maxValue;\n        var argArr = args;\n        if (argArr.length > 255) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.isCellReference(argArr[i])) {\n                var cellValue = this.getCellCollection(argArr[i]);\n                for (var j = 0; j < cellValue.length; j++) {\n                    argVal = this.getValueFromArg(cellValue[j]);\n                    if (this.getErrorStrings().indexOf(argVal) > -1) {\n                        return argVal;\n                    }\n                    var cellVal = this.parseFloat(argVal);\n                    if (argVal === '' || this.isNaN(this.parseFloat(cellVal))) {\n                        countStrVal = countStrVal + 1;\n                        if (countStrVal === cellValue.length) {\n                            result = 0;\n                        }\n                        continue;\n                    }\n                    else {\n                        result = (operation === 'max') ? Math.max(result, cellVal) : Math.min(result, cellVal);\n                    }\n                }\n            }\n            else {\n                var val = this.getValueFromArg(argArr[i]);\n                if (this.getErrorStrings().indexOf(val) > -1) {\n                    return val;\n                }\n                var cellVal = this.parseFloat(val);\n                if (val === '' || this.isNaN(this.parseFloat(cellVal))) {\n                    countStrVal = countStrVal + 1;\n                    if (countStrVal === argVal.length) {\n                        result = 0;\n                    }\n                    continue;\n                }\n                else {\n                    result = (operation === 'max') ? Math.max(result, cellVal) : Math.min(result, cellVal);\n                }\n            }\n        }\n        return result.toString();\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - Specify the args.\n     * @returns {string} - to calculate average.\n     */\n    Calculate.prototype.calculateAvg = function (args) {\n        var sumCell = 0;\n        var argArr = args;\n        var cellVal = [];\n        var avgVal = 0;\n        var countNum = 0;\n        var countNum1 = 0;\n        for (var k = 0; k < argArr.length; k++) {\n            if (argArr[k].indexOf(':') > -1 && this.isCellReference(argArr[k])) {\n                countNum = 0;\n                cellVal = this.getCellCollection(argArr[k]);\n                avgVal = 0;\n                for (var i = 0; i < cellVal.length; i++) {\n                    var value = this.getValueFromArg(cellVal[i]);\n                    if (isNullOrUndefined(value) || isNaN(this.parseFloat(value))) {\n                        continue;\n                    }\n                    avgVal = avgVal + this.parseFloat(value);\n                    countNum = countNum + 1;\n                }\n                if (countNum === 0) {\n                    return this.getErrorStrings()[CommonErrors.divzero];\n                }\n                avgVal = avgVal / countNum;\n                sumCell = avgVal + sumCell;\n            }\n            else {\n                if (argArr[k].indexOf(this.tic) > -1) {\n                    if (isNaN(parseFloat(argArr[k].split(this.tic).join('')))) {\n                        return this.getErrorStrings()[CommonErrors.value];\n                    }\n                }\n                if (argArr[k].length === 0) {\n                    argArr[k] = '1';\n                }\n                var value = this.getValueFromArg(argArr[k].split(this.tic).join(''));\n                if (isNullOrUndefined(value) || isNaN(this.parseFloat(value))) {\n                    return this.getErrorStrings()[CommonErrors.name];\n                }\n                sumCell = sumCell + this.parseFloat(value);\n            }\n        }\n        return (sumCell / (argArr.length - countNum1)).toString();\n    };\n    /**\n     * @hidden\n     * @param {string} refName - specify the reference name.\n     * @param {Object | string } model - model - Specify the model.model\n     * @param {number} sheetFamilyID - specify the sheet family id.\n     * @returns {string} - register Grid As Sheet.\n     */\n    Calculate.prototype.registerGridAsSheet = function (refName, model, sheetFamilyID) {\n        if (isNullOrUndefined(this.modelToSheetID)) {\n            this.modelToSheetID = new Map();\n        }\n        if (isNullOrUndefined(this.modelToSheetID.get(model))) {\n            this.modelToSheetID.set(model, sheetFamilyID);\n        }\n        var family = this.getSheetFamilyItem(model);\n        family.isSheetMember = true;\n        var tempRef = refName.toUpperCase();\n        if (family.parentObjectToToken.size === 0) {\n            family.parentObjectToToken = new Map();\n        }\n        if (family.sheetNameToParentObject.size === 0) {\n            family.sheetNameToParentObject = new Map();\n        }\n        if (family.sheetNameToToken.size === 0) {\n            family.sheetNameToToken = new Map();\n        }\n        if (family.tokenToParentObject.size === 0) {\n            family.tokenToParentObject = new Map();\n        }\n        if (!isUndefined(family.sheetNameToParentObject.get(tempRef))) {\n            var token = family.sheetNameToToken.get(tempRef);\n            family.tokenToParentObject.set(token, model);\n            family.parentObjectToToken.set(model, token);\n        }\n        else {\n            var token = this.sheetToken + this.tokenCount.toString() + this.sheetToken;\n            this.tokenCount++;\n            family.tokenToParentObject.set(token, model);\n            family.parentObjectToToken.set(model, token);\n            family.sheetNameToToken.set(tempRef, token);\n            family.sheetNameToParentObject.set(tempRef, model);\n        }\n        return refName;\n    };\n    /**\n     * @hidden\n     * @param {string} refName - Specify the reference name\n     * @param {string | Object} model - Specify the model\n     * @param {boolean} unRegisterAll - Un registed all the availbe model.\n     * @returns {void} - To un register grid sheet.\n     */\n    Calculate.prototype.unregisterGridAsSheet = function (refName, model, unRegisterAll) {\n        var _this = this;\n        var modelArr = [model];\n        if (unRegisterAll) {\n            modelArr = [];\n            if (!isNullOrUndefined(this.modelToSheetID)) {\n                this.modelToSheetID.forEach(function (value, key) {\n                    modelArr.push(key);\n                });\n            }\n        }\n        modelArr.forEach(function (value) {\n            var family = _this.getSheetFamilyItem(value);\n            var refName1 = (unRegisterAll ? value : refName).toUpperCase();\n            if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.has(refName1)) {\n                family.sheetNameToParentObject.delete(refName1);\n                var token = family.sheetNameToToken.get(refName1);\n                family.sheetNameToToken.delete(refName1);\n                family.tokenToParentObject.delete(token);\n                family.parentObjectToToken.delete(value);\n                if (unRegisterAll) {\n                    family.sheetDependentCells = new Map();\n                }\n            }\n        });\n    };\n    /**\n     * @hidden\n     * @param {string} formula - Specify the formula\n     * @returns {string | number} - To compute the expression.\n     */\n    Calculate.prototype.computeExpression = function (formula) {\n        var parsedFormula = this.parser.parseFormula(formula);\n        var calcValue = this.computeFormula(parsedFormula);\n        return calcValue;\n    };\n    Calculate.prototype.isSheetMember = function () {\n        var family = this.getSheetFamilyItem(this.grid);\n        return isNullOrUndefined(family) ? false : family.isSheetMember;\n    };\n    /**\n     * To dispose the calculate engine.\n     *\n     * @returns {void} - To dispose the calculate engine.\n     */\n    Calculate.prototype.dispose = function () {\n        this.resetKeys();\n        // this.dependentCells.clear();\n        // this.dependentFormulaCells.clear();\n        this.namedRanges.clear();\n        // this.sheetFamiliesList.clear();\n        this.lFormulas.clear();\n    };\n    Calculate.prototype.refreshRandValues = function (cellRef) {\n        var rowIdx;\n        var colIdx;\n        var value;\n        var tokenRef = '';\n        var stringCollection = this.randCollection.toString();\n        var family;\n        if (this.randomValues.has(cellRef)) {\n            this.randomValues.delete(cellRef);\n            stringCollection = stringCollection.split(cellRef + this.parseArgumentSeparator).join('').split(this.parseArgumentSeparator + cellRef).join('').split(cellRef).join('');\n            if (this.randomValues.size === 0 && stringCollection === '') {\n                this.randomValues.clear();\n                this.randCollection = [];\n            }\n            else {\n                this.randCollection = stringCollection.split(this.parseArgumentSeparator);\n            }\n        }\n        for (var i = 0; i < this.randomValues.size; i++) {\n            rowIdx = this.rowIndex(this.randCollection[i]);\n            colIdx = this.colIndex(this.randCollection[i]);\n            tokenRef = (parseFloat(this.getSheetToken(this.randCollection[i]).split(this.sheetToken).join('')) + 1).toString();\n            family = this.getSheetFamilyItem(tokenRef);\n            this.grid = family.sheetNameToParentObject.get(tokenRef);\n            value = this.randomValues.get(this.randCollection[i]);\n            value = this.computeFormula(value);\n            if (this.parentObject.setValueRowCol === undefined) {\n                this.setValueRowCol(this.getSheetID(this.grid) + 1, value, rowIdx, colIdx);\n            }\n            else {\n                this.parentObject.setValueRowCol(this.getSheetID(this.grid) + 1, value, rowIdx, colIdx);\n            }\n        }\n    };\n    Calculate.prototype.refresh = function (cellRef) {\n        if (this.dependencyLevel === 0) {\n            this.refreshedCells.clear();\n        }\n        if (this.getDependentCells().has(cellRef) && this.getDependentCells().get(cellRef) !== null) {\n            var family = this.getSheetFamilyItem(this.grid);\n            this.dependencyLevel = this.dependencyLevel + 1;\n            try {\n                var dependentCells = this.getDependentCells().get(cellRef);\n                var i = void 0;\n                for (i = 0; i < dependentCells.length; i++) {\n                    var dCell = dependentCells[i];\n                    var token = this.getSheetToken(dCell);\n                    this.actCell = dCell.split(token)[1];\n                    if (token.length) {\n                        this.grid = family.tokenToParentObject.get(token);\n                    }\n                    try {\n                        var rowIdx = this.rowIndex(dCell);\n                        var colIdx = this.colIndex(dCell);\n                        var formulaInfo = this.getFormulaInfoTable().get(dCell);\n                        var result = void 0;\n                        if (formulaInfo) {\n                            this.cell = dCell;\n                            if (!this.getComputedValue().has(dCell)) {\n                                this.parser.isFormulaParsed = true;\n                                result = this.calculateFormula(formulaInfo.getParsedFormula(), true);\n                                this.computedValues.set(dCell, result);\n                            }\n                            else {\n                                result = this.getComputedValue().get(dCell);\n                            }\n                            formulaInfo.setFormulaValue(result);\n                        }\n                        if (this.parentObject.setValueRowCol === undefined) {\n                            this.setValueRowCol(this.getSheetID(this.grid) + 1, formulaInfo.getFormulaValue(), rowIdx, colIdx);\n                        }\n                        else {\n                            this.parentObject.setValueRowCol(this.getSheetID(this.grid) + 1, formulaInfo.getFormulaValue(), rowIdx, colIdx);\n                        }\n                        if (!this.refreshedCells.has(dCell)) {\n                            this.refreshedCells.set(dCell, []);\n                            this.refresh(dCell);\n                        }\n                    }\n                    catch (ex) {\n                        continue;\n                    }\n                }\n            }\n            finally {\n                this.grid = family.tokenToParentObject.get(this.getSheetToken(cellRef));\n                this.dependencyLevel--;\n                if (this.dependencyLevel === 0) {\n                    this.refreshedCells.clear();\n                }\n            }\n        }\n    };\n    var Calculate_1;\n    __decorate([\n        Property(true)\n    ], Calculate.prototype, \"includeBasicFormulas\", void 0);\n    __decorate([\n        Event()\n    ], Calculate.prototype, \"onFailure\", void 0);\n    Calculate = Calculate_1 = __decorate([\n        NotifyPropertyChanges\n    ], Calculate);\n    return Calculate;\n}(Base));\nexport { Calculate };\n/** @hidden */\nvar FormulaError = /** @class */ (function () {\n    function FormulaError(errorMessage, formulaAutoCorrection) {\n        this.formulaCorrection = false;\n        this.message = errorMessage;\n        this.formulaCorrection = formulaAutoCorrection;\n    }\n    return FormulaError;\n}());\nexport { FormulaError };\n/** @hidden */\nvar FormulaInfo = /** @class */ (function () {\n    function FormulaInfo() {\n        /**\n         * @hidden\n         */\n        this.calcID = Number.MIN_VALUE + 1;\n        this.calcID1 = Number.MIN_VALUE + 1;\n    }\n    /**\n     * @hidden\n     * @returns {void} - To get Formula Text\n     */\n    FormulaInfo.prototype.getFormulaText = function () {\n        return this.formulaText;\n    };\n    /**\n     * @hidden\n     * @param {string} value - Specify the value\n     * @returns {void} - To set Formula Text\n     */\n    FormulaInfo.prototype.setFormulaText = function (value) {\n        this.formulaText = value;\n    };\n    /**\n     * @hidden\n     * @returns {string} - To get Formula Value\n     */\n    FormulaInfo.prototype.getFormulaValue = function () {\n        return this.formulaValue;\n    };\n    /**\n     * @hidden\n     * @param {string | number} value - Specify the value\n     * @returns {void} - To set Parsed Formula\n     */\n    FormulaInfo.prototype.setFormulaValue = function (value) {\n        this.formulaValue = value;\n    };\n    /**\n     * @hidden\n     * @returns {string} - To get Parsed Formula\n     */\n    FormulaInfo.prototype.getParsedFormula = function () {\n        return this.parsedFormula;\n    };\n    /**\n     * @hidden\n     * @param {string} value - Specify the value\n     * @returns {void} - To set Parsed Formula\n     */\n    FormulaInfo.prototype.setParsedFormula = function (value) {\n        this.parsedFormula = value;\n    };\n    return FormulaInfo;\n}());\nexport { FormulaInfo };\n/** @hidden */\nvar CalcSheetFamilyItem = /** @class */ (function () {\n    function CalcSheetFamilyItem() {\n        /**\n         * @hidden\n         */\n        this.isSheetMember = false;\n        /**\n         * @hidden\n         */\n        this.parentObjectToToken = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetDependentCells = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetDependentFormulaCells = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetNameToParentObject = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetNameToToken = new Map();\n        /**\n         * @hidden\n         */\n        this.tokenToParentObject = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetFormulaInfotable = new Map();\n    }\n    return CalcSheetFamilyItem;\n}());\nexport { CalcSheetFamilyItem };\n/**\n * @hidden\n * @param {number} col - Specify the column\n * @returns {string} - To returns get Alphalabel.\n */\nexport function getAlphalabel(col) {\n    var cols = [];\n    var n = 0;\n    var charText = 'A';\n    while (col > 0 && n < 9) {\n        col--;\n        var aCharNo = charText.charCodeAt(0);\n        cols[n] = String.fromCharCode(col % 26 + aCharNo);\n        col = parseInt((col / 26).toString(), 10);\n        n++;\n    }\n    var chs = [];\n    for (var i = 0; i < n; i++) {\n        chs[n - i - 1] = cols[i];\n    }\n    return chs.join('');\n}\nvar ValueChangedArgs = /** @class */ (function () {\n    function ValueChangedArgs(row, col, value) {\n        this.row = row;\n        this.col = col;\n        this.value = value;\n        this.getRowIndex = function () {\n            return row;\n        };\n        this.setRowIndex = function (value) {\n            row = value;\n        };\n        this.getColIndex = function () {\n            return col;\n        };\n        this.setColIndex = function (value) {\n            col = value;\n        };\n        this.getValue = function () {\n            return value;\n        };\n        // this.setValue = (value: number): void => {\n        //     value = value;\n        // };\n        return this;\n    }\n    return ValueChangedArgs;\n}());\nexport { ValueChangedArgs };\n","/**\n * To get Workbook required modules.\n *\n * @hidden\n * @param {Workbook} context - Specifies the context.\n * @param {ModuleDeclaration[]} modules - Specifies the modules.\n * @returns {ModuleDeclaration[]} - To get Workbook required modules.\n */\nexport function getWorkbookRequiredModules(context, modules) {\n    if (modules === void 0) { modules = []; }\n    modules.push({ member: 'workbookBasic', args: [] });\n    modules.push({ member: 'workbookAll', args: [] });\n    modules.push({\n        member: 'dataBind',\n        args: [context]\n    });\n    modules.push({\n        member: 'workbookProtectSheet',\n        args: [context]\n    });\n    if (context.allowSave) {\n        modules.push({\n            member: 'workbookSave',\n            args: [context]\n        });\n    }\n    if (context.allowOpen) {\n        modules.push({\n            member: 'workbookOpen',\n            args: [context]\n        });\n    }\n    if (context.allowEditing) {\n        modules.push({\n            member: 'workbookEdit',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookFormula',\n            args: [context]\n        });\n    }\n    if (context.allowNumberFormatting) {\n        modules.push({\n            member: 'workbookNumberFormat',\n            args: [context]\n        });\n    }\n    if (context.allowCellFormatting) {\n        modules.push({\n            member: 'workbookcellformat',\n            args: [context]\n        });\n    }\n    if (context.allowSorting) {\n        modules.push({ member: 'workbookSort', args: [context] });\n    }\n    if (context.allowHyperlink) {\n        modules.push({ member: 'workbookHyperlink', args: [context] });\n    }\n    if (context.allowFiltering) {\n        modules.push({ member: 'workbookFilter', args: [context] });\n    }\n    if (context.allowFindAndReplace) {\n        modules.push({ member: 'workbookfindAndReplace', args: [context] });\n    }\n    if (context.allowInsert) {\n        modules.push({ member: 'workbookinsert', args: [context] });\n    }\n    if (context.allowDelete) {\n        modules.push({ member: 'workbookdelete', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'workbookDataValidation', args: [context] });\n    }\n    if (context.allowMerge) {\n        modules.push({ member: 'workbookmerge', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'workbookConditionalFormatting', args: [context] });\n    }\n    if (context.allowImage) {\n        modules.push({ member: 'workbookImage', args: [context] });\n    }\n    if (context.allowChart) {\n        modules.push({ member: 'workbookChart', args: [context] });\n    }\n    return modules;\n}\n","import { getCell } from './../base/index';\nimport { getCellAddress, getRangeIndexes } from './address';\n/**\n * Check whether the text is formula or not.\n *\n * @param {string} text - Specify the text.\n * @returns {boolean} - Check whether the text is formula or not.\n */\nexport function checkIsFormula(text, isEditing) {\n    return text && text[0] === '=' && (text.length > 1 || isEditing);\n}\n/**\n * Check whether the value is cell reference or not.\n *\n * @param {string} value - Specify the value to check.\n * @returns {boolean} - Returns boolean value\n */\nexport function isCellReference(value) {\n    var range = value;\n    range = range.split('$').join('');\n    if (range.indexOf(':') > -1) {\n        var rangeSplit = range.split(':');\n        if (isValidCellReference(rangeSplit[0]) && isValidCellReference(rangeSplit[1])) {\n            return true;\n        }\n    }\n    else if (range.indexOf(':') < 0) {\n        if (isValidCellReference(range)) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Check whether the value is character or not.\n *\n * @param {string} value - Specify the value to check.\n * @returns {boolean} - Returns boolean value\n */\nexport function isChar(value) {\n    if ((value.charCodeAt(0) >= 65 && value.charCodeAt(0) <= 90) || (value.charCodeAt(0) >= 97 && value.charCodeAt(0) <= 122)) {\n        return true;\n    }\n    return false;\n}\n/**\n * @param {number[]} range - Specify the range\n * @param {number} rowIdx - Specify the row index\n * @param {number} colIdx - Specify the col index\n * @returns {boolean} - Returns boolean value\n */\nexport function inRange(range, rowIdx, colIdx) {\n    return range && (rowIdx >= range[0] && rowIdx <= range[2] && colIdx >= range[1] && colIdx <= range[3]);\n}\n/** @hidden\n * @param {number[]} range - Specify the range\n * @param {number[]} testRange - Specify the test range\n * @param {boolean} isModify - Specify the boolean value\n * @returns {boolean} - Returns boolean value\n */\nexport function isInRange(range, testRange, isModify) {\n    var inRange = range[0] <= testRange[0] && range[2] >= testRange[2] && range[1] <= testRange[1] && range[3] >= testRange[3];\n    if (inRange) {\n        return true;\n    }\n    if (isModify) {\n        if (testRange[0] < range[0] && testRange[2] < range[0] || testRange[0] > range[2] && testRange[2] > range[2]) {\n            return false;\n        }\n        else {\n            if (testRange[0] < range[0] && testRange[2] > range[0]) {\n                testRange[0] = range[0];\n                inRange = true;\n            }\n            if (testRange[2] > range[2]) {\n                testRange[2] = range[2];\n                inRange = true;\n            }\n        }\n        if (testRange[1] < range[1] && testRange[3] < range[1] || testRange[1] > range[3] && testRange[3] > range[3]) {\n            return false;\n        }\n        else {\n            if (testRange[1] < range[1] && testRange[3] > range[1]) {\n                testRange[1] = range[1];\n                inRange = true;\n            }\n            if (testRange[3] > range[3]) {\n                testRange[3] = range[3];\n                inRange = true;\n            }\n        }\n    }\n    return inRange;\n}\n/**\n * Check whether the cell is locked or not\n *\n * @param {CellModel} cell - Specify the cell.\n * @param {ColumnModel} column - Specify the column.\n * @returns {boolean} - Returns boolean value\n * @hidden\n */\nexport function isLocked(cell, column) {\n    if (!cell) {\n        cell = {};\n    }\n    if (cell.isLocked) {\n        return true;\n    }\n    else if (cell.isLocked === false) {\n        return false;\n    }\n    else if (column && column.isLocked) {\n        return true;\n    }\n    else if (!cell.isLocked && (column && column.isLocked !== false)) {\n        return true;\n    }\n    return false;\n}\n/**\n * Check whether the value is cell reference or not.\n *\n * @param {string} value - Specify the value to check.\n * @returns {boolean} - Returns boolean value\n * @hidden\n */\nexport function isValidCellReference(value) {\n    var text = value;\n    var startNum = 0;\n    var endNum = 0;\n    var j = 0;\n    var numArr = [89, 71, 69];\n    // XFD is the last column, for that we are using ascii values of Z, G, E (89, 71, 69) to restrict the flow.\n    var cellText = '';\n    var textLength = text.length;\n    for (var i = 0; i < textLength; i++) {\n        if (isChar(text[i])) {\n            endNum++;\n        }\n    }\n    cellText = text.substring(startNum, endNum);\n    var cellTextLength = cellText.length;\n    if (cellTextLength !== textLength) {\n        if (cellTextLength < 4) {\n            if (textLength !== 1 && (isNaN(parseInt(text, 10)))) {\n                while (j < cellTextLength) {\n                    if ((cellText[j]) && cellText[j].charCodeAt(0) < numArr[j]) {\n                        j++;\n                        continue;\n                    }\n                    else if (!(cellText[j]) && j > 0) {\n                        break;\n                    }\n                    else {\n                        return false;\n                    }\n                }\n                var cellNumber = parseFloat(text.substring(endNum, textLength));\n                if (cellNumber > 0 && cellNumber < 1048577) { // 1048576 - Maximum number of rows in excel.\n                    return true;\n                }\n            }\n        }\n    }\n    return false;\n}\n/**\n * @param {number[]} currIndexes - current indexes in which formula get updated\n * @param {number[]} prevIndexes - copied indexes\n * @param {SheetModel} sheet - sheet model\n * @param {CellModel} prevCell - copied or prev cell\n * @returns {string} - retruns updated formula\n * @hidden\n */\nexport function getUpdatedFormula(currIndexes, prevIndexes, sheet, prevCell) {\n    var cIdxValue;\n    var cell;\n    if (prevIndexes) {\n        cell = prevCell || getCell(prevIndexes[0], prevIndexes[1], sheet, false, true);\n        cIdxValue = cell.formula ? cell.formula.toUpperCase() : '';\n    }\n    if (cIdxValue) {\n        if (cIdxValue.indexOf('=') === 0) {\n            cIdxValue = cIdxValue.slice(1);\n        }\n        cIdxValue = cIdxValue.split('(').join(',').split(')').join(',');\n        var formulaOperators = ['+', '-', '*', '/', '>=', '<=', '<>', '>', '<', '=', '%'];\n        var splitArray = void 0;\n        var value = cIdxValue;\n        for (var i = 0; i < formulaOperators.length; i++) {\n            splitArray = value.split(formulaOperators[i]);\n            value = splitArray.join(',');\n        }\n        splitArray = value.split(',');\n        var newAddress = [];\n        var newRef = void 0;\n        var refObj = void 0;\n        for (var j = 0; j < splitArray.length; j++) {\n            if (isCellReference(splitArray[j])) {\n                var range = getRangeIndexes(splitArray[j]);\n                var newRange = [currIndexes[0] - (prevIndexes[0] - range[0]), currIndexes[1] - (prevIndexes[1] - range[1]),\n                    currIndexes[0] - (prevIndexes[0] - range[2]), currIndexes[1] - (prevIndexes[1] - range[3])];\n                if (newRange[0] < 0 || newRange[1] < 0 || newRange[2] < 0 || newRange[3] < 0) {\n                    newRef = '#REF!';\n                }\n                else {\n                    newRef = getCellAddress(newRange[0], newRange[1]);\n                    if (splitArray[j].includes(':')) {\n                        newRef += (':' + getCellAddress(newRange[2], newRange[3]));\n                    }\n                    newRef = isCellReference(newRef) ? newRef : '#REF!';\n                }\n                refObj = {};\n                refObj[splitArray[j]] = newRef;\n                if (splitArray[j].includes(':')) {\n                    newAddress.splice(0, 0, refObj);\n                }\n                else {\n                    newAddress.push(refObj);\n                }\n            }\n        }\n        var objKey = void 0;\n        cIdxValue = cell.formula;\n        for (var j = 0; j < newAddress.length; j++) {\n            objKey = Object.keys(newAddress[j])[0];\n            cIdxValue = cIdxValue.replace(new RegExp(objKey, 'gi'), newAddress[j][objKey].toUpperCase());\n        }\n        return cIdxValue;\n    }\n    else {\n        return null;\n    }\n}\n/**\n * @param {number} rowIdx - row index\n * @param {number} colIdx - column index\n * @param {SheetModel} sheet - sheet model\n * @returns {number[]} - retruns data range\n * @hidden\n */\nexport function getDataRange(rowIdx, colIdx, sheet) {\n    var topIdx = rowIdx;\n    var btmIdx = rowIdx;\n    var leftIdx = colIdx;\n    var prevleftIdx;\n    var rightIdx = colIdx;\n    var prevrightIdx;\n    var topReached;\n    var btmReached;\n    var leftReached;\n    var rightReached;\n    for (var i = 1;; i++) {\n        if (!btmReached && getCell(rowIdx + i, colIdx, sheet, null, true).value) {\n            btmIdx = rowIdx + i;\n        }\n        else {\n            btmReached = true;\n        }\n        if (!topReached && getCell(rowIdx - i, colIdx, sheet, null, true).value) {\n            topIdx = rowIdx - i;\n        }\n        else {\n            topReached = true;\n        }\n        if (topReached && btmReached) {\n            break;\n        }\n    }\n    for (var j = 1;; j++) {\n        prevleftIdx = leftIdx;\n        prevrightIdx = rightIdx;\n        for (var i = topIdx; i <= btmIdx; i++) {\n            if (!leftReached && getCell(i, leftIdx - 1, sheet, null, true).value) {\n                leftIdx = prevleftIdx - 1;\n            }\n            if (!rightReached && getCell(i, rightIdx + 1, sheet, null, true).value) {\n                rightIdx = prevrightIdx + 1;\n            }\n            if (i === btmIdx) {\n                if (leftIdx === prevleftIdx) {\n                    leftReached = true;\n                }\n                if (rightIdx === prevrightIdx) {\n                    rightReached = true;\n                }\n            }\n            if (rightReached && leftReached) {\n                return [topIdx, leftIdx, btmIdx, rightIdx];\n            }\n        }\n    }\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { extend, Property, ChildProperty, Complex, Collection } from '@syncfusion/ej2-base';\nimport { CellStyle, wrapEvent, Chart } from '../common/index';\nimport { Image } from '../common/index';\nimport { getRow } from './index';\nimport { getSheet } from './sheet';\n/**\n * Represents the cell.\n */\nvar Cell = /** @class */ (function (_super) {\n    __extends(Cell, _super);\n    function Cell() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Collection([], Image)\n    ], Cell.prototype, \"image\", void 0);\n    __decorate([\n        Collection([], Chart)\n    ], Cell.prototype, \"chart\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"value\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"formula\", void 0);\n    __decorate([\n        Property(0)\n    ], Cell.prototype, \"index\", void 0);\n    __decorate([\n        Property('General')\n    ], Cell.prototype, \"format\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Cell.prototype, \"style\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"hyperlink\", void 0);\n    __decorate([\n        Property(false)\n    ], Cell.prototype, \"wrap\", void 0);\n    __decorate([\n        Property(true)\n    ], Cell.prototype, \"isLocked\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"validation\", void 0);\n    __decorate([\n        Property(1)\n    ], Cell.prototype, \"colSpan\", void 0);\n    __decorate([\n        Property(1)\n    ], Cell.prototype, \"rowSpan\", void 0);\n    return Cell;\n}(ChildProperty));\nexport { Cell };\n/**\n * @hidden\n * @param {number} rowIndex - Specifies the rowIndex.\n * @param {number} colIndex - Specifies the colIndex.\n * @param {SheetModel} sheet - Specifies the sheet.\n * @param {boolean} isInitRow - Specifies the isInitRow.\n * @param {boolean} returnEmptyObjIfNull - Specifies the bool value.\n * @returns {CellModel} - get the cell.\n */\nexport function getCell(rowIndex, colIndex, sheet, isInitRow, returnEmptyObjIfNull) {\n    var row = getRow(sheet, rowIndex);\n    if (!row || !row.cells) {\n        if (isInitRow) {\n            if (!row) {\n                sheet.rows[rowIndex] = { cells: [] };\n            }\n            else {\n                sheet.rows[rowIndex].cells = [];\n            }\n        }\n        else {\n            return returnEmptyObjIfNull ? {} : null;\n        }\n    }\n    return sheet.rows[rowIndex].cells[colIndex] || (returnEmptyObjIfNull ? {} : null);\n}\n/**\n * @hidden\n * @param {number} rowIndex - Specifies the rowIndex.\n * @param {number} colIndex - Specifies the colIndex.\n * @param {SheetModel} sheet - Specifies the sheet.\n * @param {CellModel} cell - Specifies the cell.\n * @param {boolean} isExtend - Specifies the bool value.\n * @returns {void} - set the cell.\n */\nexport function setCell(rowIndex, colIndex, sheet, cell, isExtend) {\n    if (!sheet.rows[rowIndex]) {\n        sheet.rows[rowIndex] = { cells: [] };\n    }\n    else if (!sheet.rows[rowIndex].cells) {\n        sheet.rows[rowIndex].cells = [];\n    }\n    if (isExtend && sheet.rows[rowIndex].cells[colIndex]) {\n        extend(sheet.rows[rowIndex].cells[colIndex], cell, null, true);\n    }\n    else {\n        sheet.rows[rowIndex].cells[colIndex] = cell;\n    }\n}\n/**\n * @hidden\n * @param {CellStyleModel} style - Specifies the style.\n * @param {boolean} defaultKey - Specifies the defaultKey.\n * @returns {CellStyleModel} - Specifies the CellStyleModel.\n */\nexport function skipDefaultValue(style, defaultKey) {\n    var defaultProps = { fontFamily: 'Calibri', verticalAlign: 'bottom', textIndent: '0pt', backgroundColor: '#ffffff',\n        color: '#000000', textAlign: 'left', fontSize: '11pt', fontWeight: 'normal', fontStyle: 'normal', textDecoration: 'none',\n        border: '', borderLeft: '', borderTop: '', borderRight: '', borderBottom: '' };\n    var changedProps = {};\n    Object.keys(defaultKey ? defaultProps : style).forEach(function (propName) {\n        if (style[propName] !== defaultProps[propName]) {\n            changedProps[propName] = style[propName];\n        }\n    });\n    return changedProps;\n}\n/**\n * @hidden\n * @param {string} address - Specifies the address.\n * @param {boolean} wrap - Specifies the wrap.\n * @param {Workbook} context - Specifies the context.\n * @returns {void} - Specifies the wrap.\n */\nexport function wrap(address, wrap, context) {\n    if (wrap === void 0) { wrap = true; }\n    var addressInfo = context.getAddressInfo(address);\n    var rng = addressInfo.indices;\n    var sheet = getSheet(context, addressInfo.sheetIndex);\n    for (var i = rng[0]; i <= rng[2]; i++) {\n        for (var j = rng[1]; j <= rng[3]; j++) {\n            setCell(i, j, sheet, { wrap: wrap }, true);\n        }\n    }\n    context.setProperties({ sheets: context.sheets }, true);\n    if (addressInfo.sheetIndex === context.activeSheetIndex) {\n        context.notify(wrapEvent, { range: rng, wrap: wrap, sheet: sheet });\n    }\n}\n","import { getSheetNameFromAddress, getSheetIndex, getSheet } from '../base/index';\nimport { getCellAddress, getIndexesFromAddress, getColumnHeaderText, updateSheetFromDataSource, checkDateFormat, checkUniqueRange } from '../common/index';\nimport { queryCellInfo, cFDelete, workbookFormulaOperation } from '../common/index';\nimport { getRow, getCell, isHiddenRow, isHiddenCol, getMaxSheetId, getSheetNameCount } from './index';\nimport { isUndefined, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { setCell } from './cell';\n/**\n * Update data source to Sheet and returns Sheet\n *\n * @param {Workbook} context - Specifies the context.\n * @param {string} address - Specifies the address.\n * @param {boolean} columnWiseData - Specifies the bool value.\n * @param {boolean} valueOnly - Specifies the valueOnly.\n * @param {number[]} frozenIndexes - Specifies the freeze row and column start indexes, if it is scrolled.\n * @param {boolean} filterDialog - Specifies the bool value.\n * @returns {Promise<Map<string, CellModel> | Object[]>} - To get the data\n * @hidden\n */\nexport function getData(context, address, columnWiseData, valueOnly, frozenIndexes, filterDialog, formulaCellRef, idx, skipHiddenRows) {\n    if (skipHiddenRows === void 0) { skipHiddenRows = true; }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    return new Promise(function (resolve, reject) {\n        resolve((function () {\n            var i;\n            var row;\n            var data = new Map();\n            var sheetIdx = address.indexOf('!') > -1 ? getSheetIndex(context, getSheetNameFromAddress(address))\n                : context.activeSheetIndex;\n            var sheet = getSheet(context, sheetIdx);\n            var indexes = getIndexesFromAddress(address);\n            var sRow = indexes[0];\n            var index = 0;\n            var args = {\n                sheet: sheet, indexes: indexes, formulaCellRef: formulaCellRef, sheetIndex: idx, promise: \n                // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                new Promise(function (resolve, reject) { resolve((function () { })()); })\n            };\n            context.notify(updateSheetFromDataSource, args);\n            return args.promise.then(function () {\n                var frozenRow = context.frozenRowCount(sheet);\n                var frozenCol = context.frozenColCount(sheet);\n                while (sRow <= indexes[2]) {\n                    var cells = {};\n                    row = getRow(sheet, sRow);\n                    i = indexes[1];\n                    while (i <= indexes[3]) {\n                        if (columnWiseData) {\n                            if (skipHiddenRows && isHiddenRow(sheet, sRow) && !filterDialog) {\n                                sRow++;\n                                continue;\n                            }\n                            if (data instanceof Map) {\n                                data = [];\n                            }\n                            var key = getColumnHeaderText(i + 1);\n                            var rowKey = '__rowIndex';\n                            if (valueOnly) {\n                                cells[key] = row ? getValueFromFormat(context, sRow, i, sheetIdx, sheet) : '';\n                            }\n                            else {\n                                cells[key] = row ? getCell(sRow, i, sheet) : null;\n                            }\n                            if (indexes[3] < i + 1) {\n                                cells[rowKey] = (sRow + 1).toString();\n                            }\n                            data[index.toString()] = cells;\n                        }\n                        else {\n                            var eventArgs = { cell: getCell(sRow, i, sheet), address: getCellAddress(sRow, i),\n                                rowIndex: sRow, colIndex: i };\n                            context.trigger(queryCellInfo, eventArgs);\n                            var cellObj = {};\n                            Object.assign(cellObj, row ? getCell(sRow, i, sheet) : null);\n                            if (cellObj.colSpan > 1 && cellObj.rowSpan > 1) {\n                                var cell = void 0;\n                                for (var j = sRow, len = sRow + cellObj.rowSpan; j < len; j++) {\n                                    for (var k = i, len_1 = i + cellObj.colSpan; k < len_1; k++) {\n                                        if (j === sRow && k === i) {\n                                            continue;\n                                        }\n                                        cell = new Object();\n                                        if (j !== sRow) {\n                                            cell.rowSpan = sRow - j;\n                                        }\n                                        if (k !== i) {\n                                            cell.colSpan = i - k;\n                                        }\n                                        if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[k]) {\n                                            delete sheet.rows[j].cells[k].value;\n                                            delete sheet.rows[j].cells[k].formula;\n                                        }\n                                        setCell(j, k, sheet, cell, true);\n                                    }\n                                }\n                            }\n                            else if (cellObj.colSpan > 1) {\n                                for (var j = i + 1, len = i + cellObj.colSpan; j < len; j++) {\n                                    setCell(sRow, j, sheet, { colSpan: i - j }, true);\n                                    if (sheet.rows[sRow] && sheet.rows[sRow].cells && sheet.rows[sRow].cells[j]) {\n                                        delete sheet.rows[sRow].cells[j].value;\n                                        delete sheet.rows[sRow].cells[j].formula;\n                                    }\n                                }\n                            }\n                            else if (cellObj.rowSpan > 1) {\n                                for (var j = sRow + 1, len = sRow + cellObj.rowSpan; j < len; j++) {\n                                    setCell(j, i, sheet, { rowSpan: sRow - j }, true);\n                                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[i]) {\n                                        delete sheet.rows[j].cells[i].value;\n                                        delete sheet.rows[j].cells[i].formula;\n                                    }\n                                }\n                            }\n                            if (!valueOnly && isHiddenRow(sheet, sRow)) {\n                                sRow++;\n                                continue;\n                            }\n                            if (!valueOnly && isHiddenCol(sheet, i)) {\n                                i++;\n                                continue;\n                            }\n                            if (!valueOnly && frozenIndexes && frozenIndexes.length) {\n                                if (sRow >= frozenRow && sRow < frozenIndexes[0]) {\n                                    sRow++;\n                                    continue;\n                                }\n                                if (i >= frozenCol && i < frozenIndexes[1]) {\n                                    i++;\n                                    continue;\n                                }\n                            }\n                            if (cellObj.style) {\n                                var style = {};\n                                Object.assign(style, cellObj.style);\n                                cellObj.style = style;\n                            }\n                            data.set(eventArgs.address, cellObj);\n                        }\n                        i++;\n                    }\n                    sRow++;\n                    index++;\n                }\n                return data;\n            });\n        })());\n    });\n}\n/**\n * @hidden\n * @param {Workbook} context - Specifies the context.\n * @param {number} rowIndex - Specifies the rowIndex.\n * @param {number} colIndex - Specifies the colIndex.\n * @param {number} sheetIdx - Specifies the sheetIdx.\n * @param {SheetModel} sheet - Specifies the sheet.\n * @returns {string | Date} - To get the value format.\n */\nfunction getValueFromFormat(context, rowIndex, colIndex, sheetIdx, sheet) {\n    var cell = getCell(rowIndex, colIndex, sheet);\n    if (cell) {\n        if (cell.format) {\n            var args = {\n                value: context.getDisplayText(cell), rowIndex: rowIndex, colIndex: colIndex,\n                sheetIndex: sheetIdx, dateObj: '', isDate: false, isTime: false\n            };\n            context.notify(checkDateFormat, args);\n            if (args.isDate) {\n                return args.dateObj;\n            }\n            else {\n                return cell.value;\n            }\n        }\n        else {\n            return cell.value;\n        }\n    }\n    else {\n        return '';\n    }\n}\n/**\n * @hidden\n * @param {SheetModel | RowModel | CellModel} model - Specifies the sheet model.\n * @param {number} idx - Specifies the index value.\n * @returns {SheetModel | RowModel | CellModel} - To process the index\n */\nexport function getModel(model, idx) {\n    var diff;\n    var j;\n    var prevIdx;\n    if (isUndefined(model[idx]) || !(model[idx] && model[idx].index === idx)) {\n        for (var i = 0; i <= idx; i++) {\n            if (model && model[i]) {\n                diff = model[i].index - i;\n                if (diff > 0) {\n                    model.forEach(function (value, index) {\n                        if (value && value.index) {\n                            prevIdx = value.index;\n                            j = 1;\n                        }\n                        if (value && !value.index && index !== 0) {\n                            value.index = prevIdx + j;\n                        }\n                        j++;\n                    });\n                    while (diff--) {\n                        model.splice(i, 0, null);\n                    }\n                    i += diff;\n                }\n            }\n            else if (model) {\n                model[i] = null;\n            }\n            else {\n                model = [];\n            }\n        }\n    }\n    return model[idx];\n}\n/**\n * @hidden\n * @param {SheetModel | RowModel | CellModel} model - Specifies the sheet model.\n * @param {boolean} isSheet - Specifies the bool value.\n * @param {Workbook} context - Specifies the Workbook.\n * @returns {void} - To process the index\n */\nexport function processIdx(model, isSheet, context) {\n    var j;\n    var diff = 0;\n    var cnt;\n    var len = model.length;\n    var _loop_1 = function (i) {\n        if (!isNullOrUndefined(model[i]) && !isUndefined(model[i].index)) {\n            cnt = diff = model[i].index - i;\n            delete model[i].index;\n        }\n        if (diff > 0) {\n            j = 0;\n            while (diff--) {\n                if (isSheet) {\n                    context.createSheet(i + j);\n                    j++;\n                }\n                else {\n                    model.splice(i, 0, null);\n                }\n            }\n            i += cnt;\n            len += cnt;\n        }\n        if (isSheet) {\n            if (model[i].id < 1) {\n                model[i].id = getMaxSheetId(context.sheets);\n                if (model[i].properties) {\n                    model[i].properties.id = model[i].id;\n                }\n            }\n            if (!model[i].name) {\n                context.setSheetPropertyOnMute(model[i], 'name', 'Sheet' + getSheetNameCount(context));\n            }\n            var cellCnt_1 = 0;\n            model[i].rows.forEach(function (row) {\n                cellCnt_1 = Math.max(cellCnt_1, (row && row.cells && row.cells.length - 1) || 0);\n            });\n            context.setSheetPropertyOnMute(model[i], 'usedRange', { rowIndex: model[i].rows.length ? model[i].rows.length - 1 : 0, colIndex: cellCnt_1 });\n        }\n        out_i_1 = i;\n    };\n    var out_i_1;\n    for (var i = 0; i < len; i++) {\n        _loop_1(i);\n        i = out_i_1;\n    }\n}\n/**\n * @hidden\n * @param {Workbook} context - Specifies the context.\n * @param {string} address - Specifies the address.\n * @param {number} sheetIdx - Specifies the sheetIdx.\n * @param {boolean} valueOnly - Specifies the bool value.\n * @returns {void} - To clear the range.\n */\nexport function clearRange(context, address, sheetIdx, valueOnly) {\n    var sheet = getSheet(context, sheetIdx);\n    var range = getIndexesFromAddress(address);\n    var sRIdx = range[0];\n    var eRIdx = range[2];\n    var sCIdx;\n    var eCIdx;\n    var cellValue;\n    for (sRIdx; sRIdx <= eRIdx; sRIdx++) {\n        sCIdx = range[1];\n        eCIdx = range[3];\n        for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n            var args = { cellIdx: [sRIdx, sCIdx], isUnique: false, uniqueRange: '' };\n            context.notify(checkUniqueRange, args);\n            var skip = false;\n            if (args.uniqueRange !== '') {\n                var rangeIndex = getIndexesFromAddress(args.uniqueRange);\n                skip = getCell(rangeIndex[0], rangeIndex[1], sheet).value === '#SPILL!';\n            }\n            if (!args.isUnique || skip) {\n                var cell = getCell(sRIdx, sCIdx, sheet);\n                cellValue = cell && cell.value;\n                context.notify(cFDelete, { rowIdx: sRIdx, colIdx: sCIdx });\n                if (!isNullOrUndefined(cell) && valueOnly) {\n                    delete cell.value;\n                    if (!isNullOrUndefined(cell.formula)) {\n                        delete cell.formula;\n                    }\n                    if (!isNullOrUndefined(cell.hyperlink)) {\n                        delete cell.hyperlink;\n                    }\n                }\n                if (!isNullOrUndefined(cellValue) && cellValue !== '') {\n                    context.notify(workbookFormulaOperation, { action: 'refreshCalculate', rowIndex: sRIdx, colIndex: sCIdx });\n                }\n            }\n        }\n    }\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { processIdx } from './data';\nimport { ConditionalFormat, getCellIndexes, moveOrDuplicateSheet, workbookFormulaOperation } from '../common/index';\nimport { ProtectSettings, getCellAddress } from '../common/index';\nimport { isUndefined, ChildProperty, Property, Complex, Collection, extend } from '@syncfusion/ej2-base';\n/**\n * Configures the range processing for the spreadsheet.\n *  ```html\n * <div id='Spreadsheet'></div>\n * ```\n * ```typescript\n * let spreadsheet: Spreadsheet = new Spreadsheet({\n *      sheets: [{\n *                  name: 'First Sheet',\n *                  ranges: [{ dataSource: defaultData }],\n *                  rows: [{\n *                          index: 30,\n *                          cells: [{ index: 4, value: 'Total Amount:' },\n *                                  { formula: '=SUM(F2:F30)', style: { fontWeight: 'bold' } }]\n *                  }]\n * ...\n * });\n * spreadsheet.appendTo('#Spreadsheet');\n * ```\n */\nvar Range = /** @class */ (function (_super) {\n    __extends(Range, _super);\n    function Range() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Range.prototype.setProperties = function (prop, muteOnChange) {\n        var _this = this;\n        var name = 'name';\n        var instance = 'instance';\n        var parentObj = 'parentObj';\n        var currRangeIdx = 'currRangeIdx';\n        var controlParent = 'controlParent';\n        if (this[parentObj].isComplexArraySetter && this[controlParent] && this[controlParent].isAngular) {\n            if (Object.keys(prop).length) {\n                if (this[parentObj][currRangeIdx] === undefined) {\n                    this[parentObj][currRangeIdx] = 0;\n                }\n                else {\n                    this[parentObj][currRangeIdx] += 1;\n                }\n                var range = this[parentObj].ranges[this[parentObj][currRangeIdx]];\n                if (range && range.info) {\n                    this.info = range.info;\n                }\n                setTimeout(function () {\n                    if (_this[parentObj][currRangeIdx] !== undefined) {\n                        delete _this[parentObj][currRangeIdx];\n                    }\n                });\n            }\n            else if (this[controlParent].tagObjects[0].instance && this[controlParent].tagObjects[0].instance.hasChanges\n                && !this[controlParent].tagObjects[0].instance.isInitChanges) {\n                var sheetIdx = this[controlParent].sheets.indexOf(this[parentObj]);\n                if (this[parentObj].changedRangeIdx === undefined) {\n                    var rangeIdx_1;\n                    var tagObjects = this[controlParent].tagObjects[0].instance.list[sheetIdx].tagObjects;\n                    for (var i = 0; i < tagObjects.length; i++) {\n                        if (tagObjects[i][name] === 'ranges') {\n                            tagObjects[i][instance].list\n                                .forEach(function (range, idx) {\n                                if (range.hasChanges) {\n                                    rangeIdx_1 = idx;\n                                }\n                            });\n                            break;\n                        }\n                    }\n                    this[parentObj].changedRangeIdx = rangeIdx_1;\n                }\n            }\n        }\n        _super.prototype.setProperties.call(this, prop, muteOnChange);\n    };\n    __decorate([\n        Property(null)\n    ], Range.prototype, \"dataSource\", void 0);\n    __decorate([\n        Property('A1')\n    ], Range.prototype, \"startCell\", void 0);\n    __decorate([\n        Property(null)\n    ], Range.prototype, \"query\", void 0);\n    __decorate([\n        Property(true)\n    ], Range.prototype, \"showFieldAsHeader\", void 0);\n    __decorate([\n        Property('')\n    ], Range.prototype, \"template\", void 0);\n    __decorate([\n        Property('A1')\n    ], Range.prototype, \"address\", void 0);\n    return Range;\n}(ChildProperty));\nexport { Range };\n/**\n * Used range which contains end row index and end column index of the last used cell in sheet .\n */\nvar UsedRange = /** @class */ (function (_super) {\n    __extends(UsedRange, _super);\n    function UsedRange() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], UsedRange.prototype, \"rowIndex\", void 0);\n    __decorate([\n        Property(0)\n    ], UsedRange.prototype, \"colIndex\", void 0);\n    return UsedRange;\n}(ChildProperty));\nexport { UsedRange };\n/**\n * Configures the sheet behavior for the spreadsheet.\n */\nvar Sheet = /** @class */ (function (_super) {\n    __extends(Sheet, _super);\n    function Sheet() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], Sheet.prototype, \"rows\", void 0);\n    __decorate([\n        Property([])\n    ], Sheet.prototype, \"columns\", void 0);\n    __decorate([\n        Complex({}, ProtectSettings)\n    ], Sheet.prototype, \"protectSettings\", void 0);\n    __decorate([\n        Collection([], Range)\n    ], Sheet.prototype, \"ranges\", void 0);\n    __decorate([\n        Collection([], ConditionalFormat)\n    ], Sheet.prototype, \"conditionalFormats\", void 0);\n    __decorate([\n        Property(0)\n    ], Sheet.prototype, \"index\", void 0);\n    __decorate([\n        Property('')\n    ], Sheet.prototype, \"name\", void 0);\n    __decorate([\n        Property(100)\n    ], Sheet.prototype, \"rowCount\", void 0);\n    __decorate([\n        Property(100)\n    ], Sheet.prototype, \"colCount\", void 0);\n    __decorate([\n        Property('A1:A1')\n    ], Sheet.prototype, \"selectedRange\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"activeCell\", void 0);\n    __decorate([\n        Property({})\n    ], Sheet.prototype, \"usedRange\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"topLeftCell\", void 0);\n    __decorate([\n        Property(true)\n    ], Sheet.prototype, \"showHeaders\", void 0);\n    __decorate([\n        Property(true)\n    ], Sheet.prototype, \"showGridLines\", void 0);\n    __decorate([\n        Property(false)\n    ], Sheet.prototype, \"isProtected\", void 0);\n    __decorate([\n        Property('Visible')\n    ], Sheet.prototype, \"state\", void 0);\n    __decorate([\n        Property(0)\n    ], Sheet.prototype, \"frozenRows\", void 0);\n    __decorate([\n        Property(0)\n    ], Sheet.prototype, \"frozenColumns\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"paneTopLeftCell\", void 0);\n    return Sheet;\n}(ChildProperty));\nexport { Sheet };\n/**\n * To get sheet index from address.\n *\n * @hidden\n * @param {Workbook} context - Specifies the context.\n * @param {string} name - Specifies the name.\n * @returns {number} - To gget sheet index from address.\n */\nexport function getSheetIndex(context, name) {\n    var idx;\n    for (var i = 0; i < context.sheets.length; i++) {\n        if (context.sheets[i].name.toLowerCase() === name.toLowerCase()) {\n            idx = i;\n            break;\n        }\n    }\n    return idx;\n}\n/**\n * To get sheet index from sheet id.\n *\n * @hidden\n * @param {Workbook} context - Specifies the context.\n * @param {number} id - Specifies the id.\n * @returns {number} - To get the sheet index from id.\n */\nexport function getSheetIndexFromId(context, id) {\n    var idx;\n    for (var i = 0; i < context.sheets.length; i++) {\n        if (context.sheets[i].id === id) {\n            idx = i;\n            break;\n        }\n    }\n    return idx;\n}\n/**\n * To get sheet name from address.\n *\n * @hidden\n * @param {string} address - Specifies the address.\n * @returns {address} - To get Sheet Name From Address.\n */\nexport function getSheetNameFromAddress(address) {\n    // eslint-disable-next-line no-useless-escape\n    return address.split('!')[0].replace(/\\'/gi, '');\n}\n/**\n * To get sheet index from sheet name.\n *\n * @hidden\n * @param {Workbook} context - Specifies the context.\n * @param {string} name - Specifies the name.\n * @param {SheetModel} info - Specifies the sheet info.\n * @returns {number} - To get the sheet index by name.\n */\nexport function getSheetIndexByName(context, name, info) {\n    var len = info.length;\n    for (var i = 0; i < len; i++) {\n        if (info[i].sheet.toUpperCase() === name.toUpperCase()) {\n            return info[i].index;\n        }\n    }\n    return -1;\n}\n/**\n * update selected range\n *\n * @hidden\n * @param {Workbook} context - Specifies the context.\n * @param {string} range - Specifies the range.\n * @param {SheetModel} sheet - Specifies the sheet.\n * @param {boolean} isMultiRange - Specifies the boolean value.\n * @returns {void} - Update the selected range.\n */\nexport function updateSelectedRange(context, range, sheet, isMultiRange) {\n    if (sheet === void 0) { sheet = {}; }\n    context.setSheetPropertyOnMute(sheet, 'selectedRange', isMultiRange ? sheet.selectedRange + ' ' + range : range);\n}\n/**\n * get selected range\n *\n * @hidden\n * @param {SheetModel} sheet - Specifies the sheet.\n * @returns {string} - Get selected range.\n */\nexport function getSelectedRange(sheet) {\n    return sheet && sheet.selectedRange || 'A1';\n}\n/**\n * @hidden\n * @param {SheetModel} sheet - Specifies the sheet.\n * @returns {string} - To get single selected range.\n */\nexport function getSingleSelectedRange(sheet) {\n    return sheet.selectedRange.split(' ')[0];\n}\n/**\n * @hidden\n * @param {Workbook} context - Specifies the context.\n * @param {number} idx - Specifies the idx.\n * @returns {SheetModel} - To get sheet.\n */\nexport function getSheet(context, idx) {\n    return context.sheets[idx];\n}\n/**\n * @hidden\n * @param {Workbook} context - Specifies the context.\n * @returns {number} - To get sheet name count.\n */\nexport function getSheetNameCount(context) {\n    var name = [];\n    context.sheets.forEach(function (sheet) {\n        name.push(sheet.name.toLowerCase());\n    });\n    for (var i = 0; i < name.length; i++) {\n        if (name.indexOf('sheet' + context.sheetNameCount) > -1) {\n            context.sheetNameCount++;\n        }\n        else {\n            return context.sheetNameCount++;\n        }\n    }\n    return context.sheetNameCount++;\n}\n/**\n * @hidden\n * @param {SheetModel[]} sheets - Specifies the sheets.\n * @returns {number} - To get sheet id.\n */\nexport function getMaxSheetId(sheets) {\n    var cnt = 0;\n    sheets.forEach(function (sheet) {\n        cnt = Math.max(sheet.id, cnt);\n    });\n    return cnt + 1;\n}\n/**\n * @hidden\n * @param {Workbook} context - Specifies the context.\n * @param {SheetModel[]} sheet - Specifies the sheet.\n * @returns {void} - To initiate sheet.\n */\nexport function initSheet(context, sheet) {\n    var sheets = sheet ? sheet : context.sheets;\n    sheets.forEach(function (sheet) {\n        sheet.id = sheet.id || 0;\n        sheet.name = sheet.name || '';\n        sheet.rowCount = isUndefined(sheet.rowCount) ? 100 : sheet.rowCount;\n        sheet.colCount = isUndefined(sheet.colCount) ? 100 : sheet.colCount;\n        sheet.topLeftCell = sheet.topLeftCell || 'A1';\n        sheet.activeCell = sheet.activeCell || 'A1';\n        sheet.selectedRange = sheet.selectedRange || 'A1:A1';\n        sheet.usedRange = sheet.usedRange || { rowIndex: 0, colIndex: 0 };\n        context.setSheetPropertyOnMute(sheet, 'ranges', sheet.ranges ? sheet.ranges : []);\n        context.setSheetPropertyOnMute(sheet, 'rows', (sheet.rows && extend([], sheet.rows, null, true)) || []);\n        context.setSheetPropertyOnMute(sheet, 'columns', sheet.columns || []);\n        sheet.showHeaders = isUndefined(sheet.showHeaders) ? true : sheet.showHeaders;\n        sheet.showGridLines = isUndefined(sheet.showGridLines) ? true : sheet.showGridLines;\n        sheet.state = sheet.state || 'Visible';\n        sheet.maxHgts = [];\n        sheet.protectSettings = sheet.protectSettings || { selectCells: false, formatCells: false, formatRows: false, formatColumns: false,\n            insertLink: false };\n        sheet.isProtected = sheet.isProtected || false;\n        if (!sheet.paneTopLeftCell || sheet.paneTopLeftCell === 'A1') {\n            sheet.frozenRows = sheet.frozenRows ? sheet.frozenRows : 0;\n            sheet.frozenColumns = sheet.frozenColumns ? sheet.frozenColumns : 0;\n            var indexes = getCellIndexes(sheet.topLeftCell);\n            context.setSheetPropertyOnMute(sheet, 'paneTopLeftCell', getCellAddress(sheet.frozenRows ? indexes[0] + sheet.frozenRows : indexes[0], sheet.frozenColumns ? indexes[1] + sheet.frozenColumns : indexes[1]));\n        }\n        processIdx(sheet.columns);\n        initRow(sheet.rows);\n    });\n    processIdx(sheets, true, context);\n}\n// function initRangeSettings(ranges: RangeModel[]): RangeModel[] {\n//     ranges.forEach((range: RangeModel) => {\n//         range.startCell = range.startCell || 'A1';\n//         range.address = range.address || 'A1';\n//         range.template = range.template || '';\n//         range.showFieldAsHeader = isUndefined(range.showFieldAsHeader) ? true : range.showFieldAsHeader;\n//     });\n//     return ranges;\n// }\n/**\n * @param {RowModel[]} rows - Specifies the rows.\n * @returns {void} - Specifies the row.\n */\nfunction initRow(rows) {\n    rows.forEach(function (row) {\n        if (row && row.cells) {\n            processIdx(row.cells);\n        }\n    });\n    processIdx(rows);\n}\n/**\n * get sheet name\n *\n * @param {Workbook} context - Specifies the context.\n * @param {number} idx - Specifies the idx.\n * @returns {string} - To get sheet name.\n * @hidden\n */\nexport function getSheetName(context, idx) {\n    if (idx === void 0) { idx = context.activeSheetIndex; }\n    return getSheet(context, idx).name;\n}\n/**\n * @param {Workbook} context - Specifies context\n * @param {number} position - position to move a sheet in the list of sheets\n * @param {number[]} sheetIndexes - Specifies the sheet indexes of the sheets which is to be moved\n * @param {boolean} action - Specifies to trigger events\n * @returns {void}\n * @hidden\n */\nexport function moveSheet(context, position, sheetIndexes, action) {\n    var needRefresh = !!sheetIndexes;\n    sheetIndexes = sheetIndexes || [context.activeSheetIndex];\n    position = getNextPrevVisibleSheetIndex(context.sheets, position, context.activeSheetIndex > position);\n    var args = {\n        action: 'moveSheet', position: position,\n        sheetIndexes: sheetIndexes, cancel: false\n    };\n    if (action) {\n        context.trigger('actionBegin', args);\n    }\n    if (!args.cancel) {\n        sheetIndexes.forEach(function (sIdx, idx) {\n            context.sheets.splice(position + idx, 0, context.sheets.splice(sIdx + (position > sIdx ? -1 * idx : 0), 1)[0]);\n        });\n        context.setProperties({ activeSheetIndex: position > sheetIndexes[0] ? position - (sheetIndexes.length - 1) : position }, true);\n        context.notify(moveOrDuplicateSheet, { refresh: needRefresh });\n        if (action) {\n            delete args.cancel;\n            context.trigger('actionComplete', args);\n        }\n    }\n}\n/**\n * @param {Workbook} context - Specifies context\n * @param {number} sheetIndex - Specifies sheetIndex to be duplicated\n * @param {boolean} action - Specifies to trigger events\n * @returns {void}\n * @hidden\n */\nexport function duplicateSheet(context, sheetIndex, action) {\n    sheetIndex = isUndefined(sheetIndex) ? context.activeSheetIndex : sheetIndex;\n    var args = {\n        action: 'duplicateSheet', sheetIndex: sheetIndex, cancel: false\n    };\n    if (action) {\n        context.trigger('actionBegin', args);\n    }\n    if (!args.cancel) {\n        var originalSheet = getSheet(context, sheetIndex);\n        var sheet = extend({}, originalSheet.properties ?\n            originalSheet.properties : originalSheet, true);\n        sheet.id = getMaxSheetId(context.sheets);\n        var name_1 = sheet.name;\n        if (/^\\(\\d+\\)$/.test('(' + name_1.split(' (')[1])) {\n            name_1 = name_1.split(' (')[0];\n        }\n        var sheetNames_1 = [];\n        context.sheets.forEach(function (sheet) {\n            sheetNames_1.push(sheet.name);\n        });\n        for (var i = 2;; i++) {\n            if (sheetNames_1.indexOf(name_1 + ' (' + i + ')') === -1) {\n                sheet.name = name_1 + ' (' + i + ')';\n                break;\n            }\n        }\n        context.createSheet(sheetIndex + 1, [sheet]);\n        context.notify(workbookFormulaOperation, { action: 'addSheet', sheetName: 'Sheet' + sheet.id, visibleName: sheet.name });\n        context.setProperties({ activeSheetIndex: sheetIndex + 1 }, true);\n        context.notify(moveOrDuplicateSheet, { refresh: true, isDuplicate: true });\n        if (action) {\n            delete args.cancel;\n            context.trigger('actionComplete', args);\n        }\n    }\n}\n/**\n * @param {SheetModel[]} sheets - sheets of spreadsheet\n * @param {number} startIndex - index of the sheet to search from\n * @param {boolean} isPrevious - if set to `true`, its find the previous visible sheet index\n * @returns {number} - return next visible sheet\n */\nfunction getNextPrevVisibleSheetIndex(sheets, startIndex, isPrevious) {\n    for (var i = startIndex; isPrevious ? i >= 0 : i < sheets.length; isPrevious ? i-- : i++) {\n        if (!(sheets[i].state === 'Hidden' || sheets[i].state === 'VeryHidden')) {\n            startIndex = i;\n            break;\n        }\n    }\n    return startIndex;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Collection, Property, Complex } from '@syncfusion/ej2-base';\nimport { Cell } from './cell';\nimport { Format } from '../common/index';\n/**\n * Configures the Row behavior for the spreadsheet.\n *  ```html\n * <div id='Spreadsheet'></div>\n * ```\n * ```typescript\n * let spreadsheet: Spreadsheet = new Spreadsheet({\n *      sheets: [{\n *                rows: [{\n *                        index: 30,\n *                        cells: [{ index: 4, value: 'Total Amount:' },\n *                               { formula: '=SUM(F2:F30)', style: { fontWeight: 'bold' } }]\n *                }]\n * ...\n * });\n * spreadsheet.appendTo('#Spreadsheet');\n * ```\n */\nvar Row = /** @class */ (function (_super) {\n    __extends(Row, _super);\n    function Row() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Collection([], Cell)\n    ], Row.prototype, \"cells\", void 0);\n    __decorate([\n        Property(0)\n    ], Row.prototype, \"index\", void 0);\n    __decorate([\n        Property(20)\n    ], Row.prototype, \"height\", void 0);\n    __decorate([\n        Property(false)\n    ], Row.prototype, \"customHeight\", void 0);\n    __decorate([\n        Property(false)\n    ], Row.prototype, \"hidden\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], Row.prototype, \"format\", void 0);\n    return Row;\n}(ChildProperty));\nexport { Row };\n/**\n * @hidden\n * @param {SheetModel} sheet - Specifies the sheet.\n * @param {number} rowIndex - Specifies the rowIndex.\n * @returns {RowModel} - To get the row.\n */\nexport function getRow(sheet, rowIndex) {\n    return sheet.rows[rowIndex];\n}\n/**\n * @hidden\n * @param {SheetModel} sheet - Specifies the sheet.\n * @param {number} rowIndex - Specifies the rowIndex.\n * @param {RowModel} row - Specifies the row.\n * @returns {void} - To set the row.\n */\nexport function setRow(sheet, rowIndex, row) {\n    if (!sheet.rows[rowIndex]) {\n        sheet.rows[rowIndex] = {};\n    }\n    Object.keys(row).forEach(function (key) {\n        sheet.rows[rowIndex][key] = row[key];\n    });\n}\n/**\n * @hidden\n * @param {SheetModel} sheet - Specifies the sheet.\n * @param {number} index - Specifies the index.\n * @returns {boolean} - To return the bool value.\n */\nexport function isHiddenRow(sheet, index) {\n    return sheet.rows[index] && sheet.rows[index].hidden;\n}\n/**\n * @hidden\n * @param {SheetModel} sheet - Specifies the sheet.\n * @param {number} rowIndex - Specifies the rowIndex.\n * @param {boolean} checkDPR - Specifies the bool value.\n * @returns {number} - To get the row height.\n */\nexport function getRowHeight(sheet, rowIndex, checkDPR) {\n    var hgt;\n    if (sheet && sheet.rows && sheet.rows[rowIndex]) {\n        if (sheet.rows[rowIndex].hidden) {\n            return 0;\n        }\n        hgt = sheet.rows[rowIndex].height === undefined ? 20 : sheet.rows[rowIndex].height;\n    }\n    else {\n        hgt = 20;\n    }\n    if (checkDPR && window.devicePixelRatio % 1 > 0) {\n        var pointValue = (hgt * window.devicePixelRatio) % 1;\n        return hgt + (pointValue ? ((pointValue > 0.5 ? (1 - pointValue) : -1 * pointValue) / window.devicePixelRatio) : 0);\n    }\n    else {\n        return hgt;\n    }\n}\n/**\n * @hidden\n * @param {SheetModel} sheet - Specifies the sheet.\n * @param {number} rowIndex - Specifies the rowIndex.\n * @param {number} height - Specifies the height.\n * @returns {void} - To set the row height.\n */\nexport function setRowHeight(sheet, rowIndex, height) {\n    if (sheet && sheet.rows) {\n        if (!sheet.rows[rowIndex]) {\n            sheet.rows[rowIndex] = {};\n        }\n        sheet.rows[rowIndex].height = height;\n    }\n}\n/**\n * @hidden\n * @param {SheetModel} sheet - Specifies the sheet.\n * @param {number} startRow - Specifies the startRow.\n * @param {number} endRow - Specifies the endRow.\n * @param {boolean} checkDPR - Specifies the boolean value.\n * @returns {number} - To get the rows height.\n */\nexport function getRowsHeight(sheet, startRow, endRow, checkDPR) {\n    if (endRow === void 0) { endRow = startRow; }\n    var height = 0;\n    var swap;\n    if (startRow > endRow) {\n        swap = startRow;\n        startRow = endRow;\n        endRow = swap;\n    }\n    for (var i = startRow; i <= endRow; i++) {\n        height += getRowHeight(sheet, i, checkDPR);\n    }\n    return height;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Property, Complex } from '@syncfusion/ej2-base';\nimport { Format } from '../common/index';\n/**\n * Configures the Column behavior for the spreadsheet.\n */\nvar Column = /** @class */ (function (_super) {\n    __extends(Column, _super);\n    function Column() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], Column.prototype, \"index\", void 0);\n    __decorate([\n        Property(64)\n    ], Column.prototype, \"width\", void 0);\n    __decorate([\n        Property(false)\n    ], Column.prototype, \"customWidth\", void 0);\n    __decorate([\n        Property(false)\n    ], Column.prototype, \"hidden\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], Column.prototype, \"format\", void 0);\n    __decorate([\n        Property(true)\n    ], Column.prototype, \"isLocked\", void 0);\n    __decorate([\n        Property('')\n    ], Column.prototype, \"validation\", void 0);\n    return Column;\n}(ChildProperty));\nexport { Column };\n/**\n * @hidden\n * @param {SheetModel} sheet - Specifies the sheet.\n * @param {number} colIndex - Specifies the colIndex.\n * @returns {ColumnModel} - To get Column.\n */\nexport function getColumn(sheet, colIndex) {\n    if (sheet.columns) {\n        if (!sheet.columns[colIndex]) {\n            sheet.columns[colIndex] = {};\n        }\n    }\n    else {\n        sheet.columns = [];\n        sheet.columns[colIndex] = {};\n    }\n    return sheet.columns[colIndex];\n}\n/** @hidden\n * @param {SheetModel} sheet - Specifies the sheet.\n * @param {number} colIndex - Specifies the colIndex.\n * @param {ColumnModel} column - Specifies the column.\n * @returns {void} - To set Column.\n */\nexport function setColumn(sheet, colIndex, column) {\n    var curColumn = getColumn(sheet, colIndex);\n    Object.keys(column).forEach(function (key) {\n        curColumn[key] = column[key];\n    });\n}\n/**\n * @hidden\n * @param {SheetModel} sheet - Specifies the sheet.\n * @param {number} index - Specifies the index.\n * @param {boolean} skipHidden - Specifies the bool.\n * @param {boolean} checkDPR - Specifies the bool.\n * @returns {number} - To get Column width.\n */\nexport function getColumnWidth(sheet, index, skipHidden, checkDPR) {\n    var width;\n    if (sheet && sheet.columns && sheet.columns[index]) {\n        if (!skipHidden && sheet.columns[index].hidden) {\n            return 0;\n        }\n        width = (sheet.columns[index].width || sheet.columns[index].customWidth) ? sheet.columns[index].width : 64;\n    }\n    else {\n        width = 64;\n    }\n    if (checkDPR && window.devicePixelRatio % 1 > 0) {\n        var pointValue = (width * window.devicePixelRatio) % 1;\n        return width + (pointValue ? ((pointValue > 0.5 ? (1 - pointValue) : -1 * pointValue) / window.devicePixelRatio) : 0);\n    }\n    else {\n        return width;\n    }\n}\n/**\n * @hidden\n * @param {SheetModel} sheet - Specifies the sheet.\n * @param {number} startCol - Specifies the startCol.\n * @param {number} endCol - Specifies the endCol.\n * @param {boolean} checkDPR - Specifies the boolean value.\n * @returns {number} - returns the column width.\n */\nexport function getColumnsWidth(sheet, startCol, endCol, checkDPR) {\n    if (endCol === void 0) { endCol = startCol; }\n    var width = 0;\n    if (startCol > endCol) {\n        var swap = startCol;\n        startCol = endCol;\n        endCol = swap;\n    }\n    for (var i = startCol; i <= endCol; i++) {\n        width += getColumnWidth(sheet, i, null, checkDPR);\n    }\n    return width;\n}\n/**\n * @hidden\n * @param {SheetModel} sheet - Specifies the sheet.\n * @param {number} index - Specifies the index.\n * @returns {boolean} - returns the boolean value.\n */\nexport function isHiddenCol(sheet, index) {\n    return sheet.columns[index] && sheet.columns[index].hidden;\n}\n","import { getWorkbookRequiredModules } from '../../workbook/common/module';\n/**\n * To get Spreadsheet required modules.\n *\n * @hidden\n * @param {Spreadsheet} context - To get Spreadsheet required modules.\n * @returns {ModuleDeclaration[]} - To get Spreadsheet required modules.\n */\nexport function getRequiredModules(context) {\n    var modules = [];\n    pushBasicModules(context, modules);\n    getWorkbookRequiredModules(context, modules);\n    return modules;\n}\n// eslint-disable-next-line\nfunction pushBasicModules(context, modules) {\n    modules.push({ member: 'basic', args: [] });\n    modules.push({ member: 'all', args: [] });\n    if (context.showRibbon) {\n        modules.push({\n            member: 'ribbon',\n            args: [context]\n        });\n    }\n    if (context.showFormulaBar) {\n        modules.push({\n            member: 'formulaBar',\n            args: [context]\n        });\n    }\n    if (context.showSheetTabs) {\n        modules.push({\n            member: 'sheetTabs',\n            args: [context]\n        });\n    }\n    if (context.allowEditing) {\n        modules.push({\n            member: 'edit',\n            args: [context]\n        });\n        modules.push({\n            member: 'formula',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookFormula',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookEdit',\n            args: [context]\n        });\n    }\n    if (context.allowOpen) {\n        modules.push({\n            member: 'open',\n            args: [context]\n        });\n    }\n    if (context.allowSave) {\n        modules.push({\n            member: 'save',\n            args: [context]\n        });\n    }\n    if (context.enableContextMenu) {\n        modules.push({\n            member: 'contextMenu',\n            args: [context]\n        });\n    }\n    if (context.selectionSettings.mode !== 'None') {\n        modules.push({\n            member: 'selection',\n            args: [context]\n        });\n    }\n    if (context.enableKeyboardNavigation) {\n        modules.push({\n            member: 'keyboardNavigation',\n            args: [context]\n        });\n    }\n    if (context.allowNumberFormatting) {\n        modules.push({\n            member: 'numberFormat',\n            args: [context]\n        });\n    }\n    if (context.enableKeyboardShortcut) {\n        modules.push({\n            member: 'keyboardShortcut',\n            args: [context]\n        });\n    }\n    if (context.enableClipboard) {\n        modules.push({\n            member: 'clipboard',\n            args: [context]\n        });\n    }\n    if (context.allowCellFormatting) {\n        modules.push({\n            member: 'cellformat',\n            args: [context]\n        });\n    }\n    if (context.allowSorting) {\n        modules.push({ member: 'sort', args: [context] });\n    }\n    if (context.allowResizing) {\n        modules.push({\n            member: 'resize',\n            args: [context]\n        });\n    }\n    modules.push({\n        member: 'collaborativeEditing',\n        args: [context]\n    });\n    modules.push({\n        member: 'protectSheet',\n        args: [context]\n    });\n    if (context.allowHyperlink) {\n        modules.push({\n            member: 'spreadsheetHyperlink',\n            args: [context]\n        });\n    }\n    if (context.allowUndoRedo) {\n        modules.push({\n            member: 'undoredo',\n            args: [context]\n        });\n    }\n    if (context.allowFiltering) {\n        modules.push({ member: 'filter', args: [context] });\n    }\n    if (context.allowWrap) {\n        modules.push({ member: 'wrapText', args: [context] });\n    }\n    if (context.allowInsert) {\n        modules.push({ member: 'insert', args: [context] });\n    }\n    if (context.allowDelete) {\n        modules.push({ member: 'delete', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'dataValidation', args: [context] });\n    }\n    if (context.allowFindAndReplace) {\n        modules.push({ member: 'findAndReplace', args: [context] });\n    }\n    if (context.allowMerge) {\n        modules.push({ member: 'merge', args: [context] });\n    }\n    if (context.allowConditionalFormat) {\n        modules.push({ member: 'conditionalFormatting', args: [context] });\n    }\n    if (context.allowImage) {\n        modules.push({ member: 'spreadsheetImage', args: [context] });\n    }\n    if (context.allowChart) {\n        modules.push({ member: 'spreadsheetChart', args: [context] });\n    }\n}\n","import { Browser, setStyleAttribute as setBaseStyleAttribute, getComponent, detach, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { clearViewer, deleteImage, createImageElement, refreshImgCellObj } from './index';\nimport { getRowsHeight, getColumnsWidth, getSwapRange, clearCells, cFUndo } from '../../workbook/index';\nimport { getRangeIndexes, wrap, setRowHeight, insertModel, getColumnWidth } from '../../workbook/index';\nimport { initiateSort, getIndexesFromAddress, getRowHeight, setMerge, isLocked } from '../../workbook/index';\nimport { setValidation, removeValidation, clearCFRule, setCFRule, getColumn } from '../../workbook/index';\nimport { removeSheetTab, rowHeightChanged } from './index';\nimport { getCell, setChart, refreshChartSize } from '../../workbook/index';\nimport { deleteChart } from '../../spreadsheet/index';\nimport { initiateFilterUI } from './event';\n/**\n * The function used to update Dom using requestAnimationFrame.\n *\n * @param  {Function} fn - Function that contains the actual action\n * @returns {void}\n * @hidden\n */\nexport function getUpdateUsingRaf(fn) {\n    requestAnimationFrame(function () {\n        fn();\n    });\n}\n/**\n * The function used to remove the dom element children.\n *\n * @param  {Element} parent - Specify the parent\n * @returns {void} - The function used to get colgroup width based on the row index.\n * @hidden\n */\nexport function removeAllChildren(parent) {\n    while (parent.firstChild) {\n        parent.removeChild(parent.firstChild);\n    }\n}\n/**\n * The function used to get colgroup width based on the row index.\n *\n * @param  {number} index - Specify the index\n * @returns {number} - The function used to get colgroup width based on the row index.\n * @hidden\n */\nexport function getColGroupWidth(index) {\n    var width = 30;\n    if (index.toString().length > 3) {\n        width = index.toString().length * 10;\n    }\n    return width;\n}\nvar scrollAreaWidth = null;\n/**\n * @hidden\n * @returns {number} - To get scrollbar width\n */\nexport function getScrollBarWidth() {\n    if (scrollAreaWidth !== null) {\n        return scrollAreaWidth;\n    }\n    var htmlDivNode = document.createElement('div');\n    var result = 0;\n    htmlDivNode.style.cssText = 'width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;';\n    document.body.appendChild(htmlDivNode);\n    result = (htmlDivNode.offsetWidth - htmlDivNode.clientWidth) | 0;\n    document.body.removeChild(htmlDivNode);\n    return scrollAreaWidth = result;\n}\nvar classes = ['e-ribbon', 'e-formula-bar-panel', 'e-sheet-tab-panel', 'e-header-toolbar'];\n/**\n * @hidden\n * @param {HTMLElement} element - Specify the element.\n * @param {string[]} classList - Specify the classList.\n * @returns {number} - get Siblings Height\n */\nexport function getSiblingsHeight(element, classList) {\n    if (classList === void 0) { classList = classes; }\n    var previous = getHeightFromDirection(element, 'previous', classList);\n    var next = getHeightFromDirection(element, 'next', classList);\n    return previous + next;\n}\n/**\n * @param {HTMLElement} element - Specify the element.\n * @param {string} direction - Specify the direction.\n * @param {string[]} classList - Specify the classList.\n * @returns {number} - get Height FromDirection\n */\nfunction getHeightFromDirection(element, direction, classList) {\n    var sibling = (element)[direction + 'ElementSibling'];\n    var result = 0;\n    while (sibling) {\n        if (classList.some(function (value) { return sibling.classList.contains(value); })) {\n            result += sibling.offsetHeight;\n        }\n        sibling = (sibling)[direction + 'ElementSibling'];\n    }\n    return result;\n}\n/**\n * @hidden\n * @param {Spreadsheet} context - Specify the spreadsheet.\n * @param {number[]} range - Specify the range.\n * @param {boolean} isModify - Specify the boolean value.\n * @returns {boolean} - Returns boolean value.\n */\nexport function inView(context, range, isModify) {\n    if (context.scrollSettings.enableVirtualization) {\n        var topIdx = context.viewport.topIndex;\n        var leftIdx = context.viewport.leftIndex;\n        var bottomIdx = topIdx + context.viewport.rowCount + context.getThreshold('row') * 2;\n        var rightIdx = leftIdx + context.viewport.colCount + context.getThreshold('col') * 2;\n        var sheet = context.getActiveSheet();\n        var inView_1;\n        if (sheet.frozenRows || sheet.frozenColumns) {\n            return context.insideViewport(range[0], range[1]) || context.insideViewport(range[2], range[3]);\n        }\n        else {\n            inView_1 = topIdx <= range[0] && bottomIdx >= range[2] && leftIdx <= range[1] && rightIdx >= range[3];\n            if (inView_1) {\n                return true;\n            }\n        }\n        if (isModify) {\n            if (range[0] < topIdx && range[2] < topIdx || range[0] > bottomIdx && range[2] > bottomIdx) {\n                return false;\n            }\n            else {\n                if (range[0] < topIdx && range[2] > topIdx) {\n                    range[0] = topIdx;\n                    inView_1 = true;\n                }\n                if (range[2] > bottomIdx) {\n                    range[2] = bottomIdx;\n                    inView_1 = true;\n                }\n            }\n            if (range[1] < leftIdx && range[3] < leftIdx || range[1] > rightIdx && range[3] > rightIdx) {\n                return false;\n            }\n            else {\n                if (range[1] < leftIdx && range[3] > leftIdx) {\n                    range[1] = leftIdx;\n                    inView_1 = true;\n                }\n                if (range[3] > rightIdx) {\n                    range[3] = rightIdx;\n                    inView_1 = true;\n                }\n            }\n        }\n        return inView_1;\n    }\n    else {\n        return true;\n    }\n}\n/**\n * To get the top left cell position in viewport.\n *\n * @hidden\n * @param {SheetModel} sheet - Specify the sheet.\n * @param {number[]} indexes - Specify the indexes.\n * @param {number} frozenRow - Specify the frozen row.\n * @param {number} frozenColumn - Specify the frozen column\n * @param {number} freezeScrollHeight - Specify the freeze scroll height\n * @param {number} freezeScrollWidth - Specify the freeze scroll width\n * @param {number} rowHdrWidth - Specify the row header width\n * @returns {number} - To get the top left cell position in viewport.\n */\nexport function getCellPosition(sheet, indexes, frozenRow, frozenColumn, freezeScrollHeight, freezeScrollWidth, rowHdrWidth) {\n    var i;\n    var offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } };\n    var top = offset.top.size;\n    var left = offset.left.size;\n    for (i = offset.top.idx; i < indexes[0]; i++) {\n        if (frozenRow) {\n            if (frozenRow - 1 < indexes[0] && i < frozenRow) {\n                continue;\n            }\n        }\n        top += getRowHeight(sheet, i, true);\n    }\n    for (i = offset.left.idx; i < indexes[1]; i++) {\n        if (frozenColumn && frozenColumn - 1 < indexes[1] && i < frozenColumn) {\n            continue;\n        }\n        left += getColumnWidth(sheet, i, null, true);\n    }\n    if (frozenRow && indexes[0] < frozenRow) {\n        if (sheet.showHeaders) {\n            top += 30;\n        }\n        if (freezeScrollHeight) {\n            top -= freezeScrollHeight;\n        }\n    }\n    if (frozenColumn && indexes[1] < frozenColumn) {\n        if (sheet.showHeaders) {\n            left += rowHdrWidth ? rowHdrWidth : 30;\n        }\n        if (freezeScrollWidth) {\n            left -= freezeScrollWidth;\n        }\n    }\n    return { top: top, left: left };\n}\n/**\n * @param {Spreadsheet} parent - Specify the parent\n * @param {HTMLElement} ele - Specify the element\n * @param {number[]} range - Specify the range\n * @param {string} cls - Specify the class name\n * @returns {void} - To set the position\n * @hidden\n */\nexport function setPosition(parent, ele, range, cls) {\n    if (cls === void 0) { cls = 'e-selection'; }\n    var sheet = parent.getActiveSheet();\n    if (sheet.frozenRows || sheet.frozenColumns) {\n        var content_1;\n        var frozenRow_1 = parent.frozenRowCount(sheet);\n        var frozenCol_1 = parent.frozenColCount(sheet);\n        if (cls === 'e-active-cell') {\n            if (range[0] < frozenRow_1 || range[1] < frozenCol_1) {\n                ele.style.display = 'none';\n                content_1 = range[0] < frozenRow_1 && range[1] < frozenCol_1 ? parent.getSelectAllContent() :\n                    (range[0] < frozenRow_1 ? parent.getColumnHeaderContent() : parent.getRowHeaderContent());\n                var rangeEle = content_1.querySelector('.' + cls);\n                if (!rangeEle) {\n                    rangeEle = ele.cloneNode(true);\n                    content_1.appendChild(rangeEle);\n                }\n                ele = rangeEle;\n                locateElem(ele, range, sheet, parent.enableRtl, frozenRow_1, frozenCol_1, true, parent.viewport.beforeFreezeHeight, parent.viewport.beforeFreezeWidth, parent.sheetModule.colGroupWidth);\n            }\n            else {\n                locateElem(ele, range, sheet, parent.enableRtl, frozenRow_1, frozenCol_1);\n            }\n            if (ele.style.display) {\n                ele.style.display = '';\n            }\n            removeRangeEle(parent.getSelectAllContent(), content_1, true);\n            removeRangeEle(parent.getColumnHeaderContent(), content_1, true);\n            removeRangeEle(parent.getRowHeaderContent(), content_1, true);\n        }\n        else {\n            var swapRange = getSwapRange(range);\n            if (swapRange[0] < frozenRow_1 || swapRange[1] < frozenCol_1) {\n                ele.classList.add('e-hide');\n                var ranges_1 = [];\n                if (swapRange[0] < frozenRow_1 && swapRange[1] < frozenCol_1) {\n                    if (swapRange[2] < frozenRow_1 && swapRange[3] < frozenCol_1) {\n                        ranges_1.push(range);\n                        removeRangeEle(parent.getColumnHeaderContent(), content_1, false);\n                        removeRangeEle(parent.getRowHeaderContent(), content_1, false);\n                    }\n                    else if (swapRange[2] > frozenRow_1 - 1) {\n                        if (swapRange[3] < frozenCol_1) {\n                            removeRangeEle(parent.getColumnHeaderContent(), content_1, false);\n                            ranges_1.push([swapRange[0], swapRange[1], frozenRow_1 - 1, swapRange[3]]);\n                            ranges_1.push([frozenRow_1, swapRange[1], swapRange[2], swapRange[3]]);\n                        }\n                        else {\n                            ranges_1.push([swapRange[0], swapRange[1], frozenRow_1 - 1, frozenCol_1 - 1]);\n                            ranges_1.push([frozenRow_1, swapRange[1], swapRange[2], frozenCol_1 - 1]);\n                            ranges_1.push([swapRange[0], frozenCol_1, frozenRow_1 - 1, swapRange[3]]);\n                            ranges_1.push([frozenRow_1, frozenCol_1, swapRange[2], swapRange[3]]);\n                        }\n                    }\n                    else {\n                        if (swapRange[2] < frozenRow_1) {\n                            ranges_1.push([swapRange[0], swapRange[1], swapRange[2], frozenCol_1 - 1]);\n                            ranges_1.push([swapRange[0], frozenCol_1, swapRange[2], swapRange[3]]);\n                            removeRangeEle(parent.getRowHeaderContent(), content_1, false);\n                        }\n                        else {\n                            ranges_1.push([frozenRow_1, swapRange[1], swapRange[2], frozenCol_1 - 1]);\n                            ranges_1.push([swapRange[0], swapRange[1], frozenRow_1 - 1, frozenCol_1 - 1]);\n                            ranges_1.push([frozenRow_1, frozenCol_1, swapRange[2], swapRange[3]]);\n                            ranges_1.push([swapRange[0], frozenCol_1, frozenRow_1 - 1, swapRange[3]]);\n                        }\n                    }\n                }\n                else if (swapRange[0] < frozenRow_1) {\n                    if (swapRange[2] < frozenRow_1) {\n                        ranges_1.push(range);\n                    }\n                    else {\n                        ranges_1.push([swapRange[0], swapRange[1], frozenRow_1 - 1, swapRange[3]]);\n                        ranges_1.push([frozenRow_1, swapRange[1], swapRange[2], swapRange[3]]);\n                        removeRangeEle(parent.getSelectAllContent(), content_1, false);\n                        removeRangeEle(parent.getRowHeaderContent(), content_1, false);\n                    }\n                }\n                else {\n                    if (swapRange[3] < frozenCol_1) {\n                        ranges_1.push(range);\n                    }\n                    else {\n                        ranges_1.push([swapRange[0], swapRange[1], swapRange[2], frozenCol_1 - 1]);\n                        ranges_1.push([swapRange[0], frozenCol_1, swapRange[2], swapRange[3]]);\n                        removeRangeEle(parent.getSelectAllContent(), content_1, false);\n                        removeRangeEle(parent.getColumnHeaderContent(), content_1, false);\n                    }\n                }\n                var removeEle_1;\n                ranges_1.forEach(function (rng) {\n                    content_1 = rng[2] < frozenRow_1 && rng[3] < frozenCol_1 ? parent.getSelectAllContent() :\n                        (rng[2] < frozenRow_1 ? parent.getColumnHeaderContent() : (rng[3] < frozenCol_1 ?\n                            parent.getRowHeaderContent() : parent.getMainContent()));\n                    var rangeEle;\n                    if (cls === 'e-copy-indicator' || cls === 'e-range-indicator') {\n                        rangeEle = ele.cloneNode(true);\n                        content_1.appendChild(rangeEle);\n                        if (frozenRow_1) {\n                            if (rng[2] + 1 === frozenRow_1) {\n                                ranges_1.forEach(function (subRng) {\n                                    if (subRng !== rng) {\n                                        removeEle_1 = rangeEle.getElementsByClassName('e-bottom')[0];\n                                        if (removeEle_1 && subRng[0] === frozenRow_1) {\n                                            detach(removeEle_1);\n                                        }\n                                    }\n                                });\n                            }\n                            if (rng[0] === frozenRow_1 && content_1.parentElement.classList.contains('e-main-panel')) {\n                                ranges_1.forEach(function (subRng) {\n                                    if (subRng !== rng) {\n                                        removeEle_1 = rangeEle.getElementsByClassName('e-top')[0];\n                                        if (removeEle_1 && subRng[2] + 1 === frozenRow_1) {\n                                            detach(removeEle_1);\n                                        }\n                                    }\n                                });\n                            }\n                        }\n                        if (frozenCol_1) {\n                            if (rng[3] + 1 === frozenCol_1) {\n                                ranges_1.forEach(function (subRng) {\n                                    if (subRng !== rng) {\n                                        removeEle_1 = rangeEle.getElementsByClassName('e-right')[0];\n                                        if (removeEle_1 && subRng[1] === frozenCol_1) {\n                                            detach(removeEle_1);\n                                        }\n                                    }\n                                });\n                            }\n                            if (rng[1] === frozenCol_1 && (content_1.classList.contains('e-sheet-content') || content_1.classList.contains('e-column-header'))) {\n                                ranges_1.forEach(function (subRng) {\n                                    if (subRng !== rng) {\n                                        removeEle_1 = rangeEle.getElementsByClassName('e-left')[0];\n                                        if (removeEle_1 && subRng[3] + 1 === frozenCol_1) {\n                                            detach(removeEle_1);\n                                        }\n                                    }\n                                });\n                            }\n                        }\n                    }\n                    else {\n                        rangeEle = content_1.querySelector('.' + cls);\n                        if (!rangeEle) {\n                            rangeEle = ele.cloneNode(true);\n                            content_1.appendChild(rangeEle);\n                        }\n                    }\n                    locateElem(rangeEle, rng, sheet, parent.enableRtl, frozenRow_1, frozenCol_1, false, parent.viewport.beforeFreezeHeight, parent.viewport.beforeFreezeWidth, parent.sheetModule.colGroupWidth);\n                    if (rangeEle.classList.contains('e-hide')) {\n                        rangeEle.classList.remove('e-hide');\n                    }\n                });\n            }\n            else {\n                removeRangeEle(parent.getSelectAllContent(), null, false);\n                removeRangeEle(parent.getColumnHeaderContent(), null, false);\n                removeRangeEle(parent.getRowHeaderContent(), null, false);\n                locateElem(ele, range, sheet, parent.enableRtl, frozenRow_1, frozenCol_1);\n                if (cls === 'e-range-indicator' || !parent.getMainContent().querySelector('.' + cls)) {\n                    parent.getMainContent().appendChild(ele);\n                }\n            }\n        }\n    }\n    else {\n        locateElem(ele, range, sheet, parent.enableRtl, 0, 0);\n        if (ele && !parent.getMainContent().querySelector('.' + cls)) {\n            parent.getMainContent().appendChild(ele);\n        }\n    }\n}\n/**\n * @param {Element} content - Specify the content element.\n * @param {HTMLElement} checkElement - Specify the element.\n * @param {boolean} checkActiveCell - Specify the boolean value.\n * @returns {void} - remove element with given range\n */\nexport function removeRangeEle(content, checkElement, checkActiveCell) {\n    var ele;\n    if (checkActiveCell) {\n        if (content !== checkElement) {\n            ele = content.querySelector('.e-active-cell');\n            if (ele) {\n                detach(ele);\n            }\n        }\n    }\n    else {\n        ele = content.querySelector('.e-selection');\n        if (ele) {\n            detach(ele);\n        }\n    }\n}\n/**\n * Position element with given range\n *\n * @hidden\n * @param {HTMLElement} ele - Specify the element.\n * @param {number[]} range - specify the range.\n * @param {SheetModel} sheet - Specify the sheet.\n * @param {boolean} isRtl - Specify the boolean value.\n * @param {number} frozenRow - Specidy the frozen row.\n * @param {number} frozenColumn - Specify the frozen column\n * @param {boolean} isActiveCell - Specidy the boolean value.\n * @param {number} freezeScrollHeight - Specify the freeze scroll height\n * @param {number} freezeScrollWidth - Specify the freeze scroll width\n * @param {number} rowHdrWidth - Specify the row header width\n * @returns {void} - Position element with given range\n */\nexport function locateElem(ele, range, sheet, isRtl, frozenRow, frozenColumn, isActiveCell, freezeScrollHeight, freezeScrollWidth, rowHdrWidth) {\n    var swapRange = getSwapRange(range);\n    var cellPosition = getCellPosition(sheet, swapRange, frozenRow, frozenColumn, freezeScrollHeight, freezeScrollWidth, rowHdrWidth);\n    var startIndex = [skipHiddenIdx(sheet, 0, true), skipHiddenIdx(sheet, 0, true, 'columns')];\n    var height = getRowsHeight(sheet, range[0], range[2], true);\n    var width = getColumnsWidth(sheet, range[1], range[3], true);\n    var attrs = {\n        'top': (swapRange[0] === startIndex[0] ? cellPosition.top : cellPosition.top - getDPRValue(1)) + 'px',\n        'height': height && height + (swapRange[0] === startIndex[0] ? 0 : getDPRValue(1)) + 'px',\n        'width': width && width + (swapRange[1] === startIndex[1] ? 0 : getDPRValue(1)) + (isActiveCell\n            && frozenColumn && swapRange[1] < frozenColumn && swapRange[3] >= frozenColumn ? 1 : 0) + 'px'\n    };\n    attrs[isRtl ? 'right' : 'left'] = (swapRange[1] === startIndex[1] ? cellPosition.left : cellPosition.left - 1) + 'px';\n    if (ele) {\n        setStyleAttribute([{ element: ele, attrs: attrs }]);\n    }\n}\n/**\n * To update element styles using request animation frame\n *\n * @hidden\n * @param {StyleType[]} styles - Specify the styles\n * @returns {void} - To update element styles using request animation frame\n */\nexport function setStyleAttribute(styles) {\n    requestAnimationFrame(function () {\n        styles.forEach(function (style) {\n            setBaseStyleAttribute(style.element, style.attrs);\n        });\n    });\n}\n/**\n * @hidden\n * @returns {string} - to get Start Event\n */\nexport function getStartEvent() {\n    return (Browser.isPointer ? 'pointerdown' : 'mousedown touchstart');\n}\n/**\n * @hidden\n * @returns {string} - to get Move Event\n */\nexport function getMoveEvent() {\n    return (Browser.isPointer ? 'pointermove' : 'mousemove touchmove');\n}\n/**\n * @hidden\n * @returns {string} - Returns string value.\n */\nexport function getEndEvent() {\n    return (Browser.isPointer ? 'pointerup' : 'mouseup touchend');\n}\n/**\n * @hidden\n * @param {Event} e - To specify the event.\n * @returns {boolean} - Returns boolean value.\n */\nexport function isTouchStart(e) {\n    return e.type === 'touchstart' || (e.type === 'pointerdown' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n * @param {Event} e - To specify the event.\n * @returns {boolean} - Returns boolean value.\n */\nexport function isTouchMove(e) {\n    return e.type === 'touchmove' || (e.type === 'pointermove' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n * @param {Event} e - To specify the event.\n * @returns {boolean} - Returns boolean value.\n */\nexport function isTouchEnd(e) {\n    return e.type === 'touchend' || (e.type === 'pointerup' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n * @param {TouchEvent | MouseEvent} e - To specify the mouse and touch event.\n * @returns {number} - To get client value\n */\nexport function isMouseDown(e) {\n    return e && (e.type === 'mousedown' || e.type === 'pointerdown');\n}\n/**\n * @param {MouseEvent} e - Specify the event.\n * @returns {boolean} - To get boolean value.\n * @hidden\n */\nexport function isMouseMove(e) {\n    return e && (e.type === 'mousemove' || e.type === 'pointermove');\n}\n/**\n * @param {MouseEvent} e - Specify the event.\n * @returns {boolean} - To get boolean value\n * @hidden\n */\nexport function isMouseUp(e) {\n    return e && (e.type === 'mouseup' || e.type === 'pointerup');\n}\n/**\n * @param {MouseEvent | TouchEvent} e - To specify the mouse or touch event.\n * @returns {number} - To get client X value.\n * @hidden\n */\nexport function getClientX(e) {\n    return e.changedTouches ? e.changedTouches[0].clientX : e.clientX;\n}\n/**\n * @hidden\n * @param {MouseEvent | TouchEvent} e - To specify the mouse and touch event.\n * @returns {number} - To get client value\n */\nexport function getClientY(e) {\n    return e.changedTouches ? e.changedTouches[0].clientY : e.clientY;\n}\n/**\n * Get even number based on device pixel ratio\n *\n * @param {number} value - Specify the number\n * @param {boolean} preventDecrease - Specify the boolean value\n * @returns {number} - To get DPR value\n * @hidden\n */\nexport function getDPRValue(value, preventDecrease) {\n    if (window.devicePixelRatio % 1 > 0) {\n        var pointValue = (value * window.devicePixelRatio) % 1;\n        return value + (pointValue ? (((pointValue > 0.5 || preventDecrease) ? (1 - pointValue) : -1 * pointValue)\n            / window.devicePixelRatio) : 0);\n    }\n    else {\n        return value;\n    }\n}\nvar config = {\n    role: 'role',\n    selected: 'aria-selected',\n    multiselectable: 'aria-multiselectable',\n    busy: 'aria-busy',\n    colcount: 'aria-colcount'\n};\n/**\n * @hidden\n * @param {HTMLElement} target - specify the target.\n * @param {IAriaOptions<boolean>} options - Specify the options.\n * @returns {void} -  to set Aria Options\n */\nexport function setAriaOptions(target, options) {\n    var props = Object.keys(options);\n    props.forEach(function (name) {\n        if (target) {\n            target.setAttribute(config[name], options[name]);\n        }\n    });\n}\n/**\n * @hidden\n * @param {HTMLElement} element - specify the element.\n * @param {Object} component - Specify the component.\n * @returns {void} -  to destroy the component.\n */\nexport function destroyComponent(element, component) {\n    if (element) {\n        var compObj = getComponent(element, component);\n        if (compObj) {\n            compObj.destroy();\n        }\n    }\n}\n/**\n * @hidden\n * @param {number} idx - Specify the index\n * @param {number} index - Specify the index\n * @param {string} value - Specify the value.\n * @param {boolean} isCol - Specify the boolean value.\n * @param {Spreadsheet} parent - Specify the parent.\n * @returns {void} - To set resize.\n */\nexport function setResize(idx, index, value, isCol, parent) {\n    var curEle;\n    var curEleH;\n    var curEleC;\n    var preEle;\n    var preEleH;\n    var preEleC;\n    var nxtEle;\n    var nxtEleH;\n    var nxtEleC;\n    var sheet = parent.getActiveSheet();\n    var frozenRow = parent.frozenRowCount(sheet);\n    var frozenCol = parent.frozenColCount(sheet);\n    if (isCol) {\n        var header = idx < frozenCol ? parent.getSelectAllContent() : parent.getColumnHeaderContent();\n        curEle = header.getElementsByTagName('th')[index];\n        curEleH = header.getElementsByTagName('col')[index];\n        curEleC = (idx < frozenCol ? parent.getRowHeaderContent() : parent.getMainContent()).getElementsByTagName('col')[index];\n    }\n    else {\n        curEle = curEleH = frozenRow || frozenCol ? parent.getRow(idx, null, frozenCol - 1) :\n            parent.getRow(idx, parent.getRowHeaderTable());\n        curEleH.style.height = parseInt(value, 10) > 0 ? getDPRValue(parseInt(value, 10)) + 'px' : '2px';\n        curEleC = parent.getRow(idx, null, frozenCol);\n        curEleC.style.height = parseInt(value, 10) > 0 ? getDPRValue(parseInt(value, 10)) + 'px' : '0px';\n        var hdrFntSize = void 0;\n        if (sheet.showHeaders) {\n            var hdrRow = parent.getRowHeaderContent().getElementsByClassName('e-row');\n            var hdrClone = [];\n            hdrClone[0] = hdrRow[index].getElementsByTagName('td')[0].cloneNode(true);\n            hdrFntSize = findMaxValue(parent.getRowHeaderTable(), hdrClone, false, parent) + 1;\n        }\n        var contentRow = parent.getMainContent().getElementsByClassName('e-row');\n        var contentClone = [];\n        for (var idx_1 = 0; idx_1 < contentRow[index].getElementsByTagName('td').length; idx_1++) {\n            contentClone[idx_1] = contentRow[index].getElementsByTagName('td')[idx_1].cloneNode(true);\n        }\n        var cntFntSize = findMaxValue(parent.getContentTable(), contentClone, false, parent) + 1;\n        var fntSize = hdrFntSize >= cntFntSize ? hdrFntSize : cntFntSize;\n        if (parseInt(curEleC.style.height, 10) < fntSize ||\n            (curEle && curEle.classList.contains('e-reach-fntsize') && parseInt(curEleC.style.height, 10) === fntSize)) {\n            if (sheet.showHeaders) {\n                curEle.classList.add('e-reach-fntsize');\n                curEleH.style.lineHeight = parseInt(value, 10) >= 4 ? ((parseInt(value, 10)) - 4) + 'px' :\n                    parseInt(value, 10) > 0 ? ((parseInt(value, 10)) - 1) + 'px' : '0px';\n            }\n            curEleC.style.lineHeight = parseInt(value, 10) > 0 ? ((parseInt(value, 10)) - 1) + 'px' : '0px';\n        }\n        else {\n            if (curEleH) {\n                curEleH.style.removeProperty('line-height');\n            }\n            curEleC.style.removeProperty('line-height');\n            if (curEle && curEle.classList.contains('e-reach-fntsize')) {\n                curEle.classList.remove('e-reach-fntsize');\n            }\n        }\n    }\n    preEleC = curEleC.previousElementSibling;\n    nxtEleC = curEleC.nextElementSibling;\n    if (preEleC) {\n        if (sheet.showHeaders) {\n            preEle = curEle.previousElementSibling;\n            preEleH = curEleH.previousElementSibling;\n        }\n        preEleC = curEleC.previousElementSibling;\n    }\n    if (nxtEleC) {\n        if (sheet.showHeaders) {\n            nxtEle = curEle.nextElementSibling;\n            nxtEleH = curEleH.nextElementSibling;\n        }\n        nxtEleC = curEleC.nextElementSibling;\n    }\n    if (parseInt(value, 10) <= 0 && !(curEleC.classList.contains('e-zero') || curEleC.classList.contains('e-zero-start'))) {\n        if (preEleC && nxtEleC) {\n            if (isCol) {\n                if (sheet.showHeaders) {\n                    curEleH.style.width = '2px';\n                }\n                curEleC.style.width = '0px';\n            }\n            else {\n                if (sheet.showHeaders) {\n                    curEleH.style.height = '2px';\n                }\n                curEleC.style.height = '0px';\n            }\n            if (preEleC.classList.contains('e-zero-start')) {\n                if (sheet.showHeaders) {\n                    curEle.classList.add('e-zero-start');\n                }\n                curEleC.classList.add('e-zero-start');\n            }\n            else {\n                if (sheet.showHeaders) {\n                    curEle.classList.add('e-zero');\n                }\n                curEleC.classList.add('e-zero');\n            }\n            if (nxtEle && !nxtEle.classList.contains('e-zero') && !nxtEle.classList.contains('e-zero-last')) {\n                if (sheet.showHeaders) {\n                    curEle.classList.add('e-zero-last');\n                }\n                curEleC.classList.add('e-zero-last');\n            }\n            if (preEleC.classList.contains('e-zero-last')) {\n                if (sheet.showHeaders) {\n                    preEle.classList.remove('e-zero-last');\n                }\n                preEleC.classList.remove('e-zero-last');\n            }\n            if (sheet.showHeaders && preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero-end')) {\n                    setWidthAndHeight(preEleH, -2, isCol);\n                }\n                else {\n                    setWidthAndHeight(preEleH, -2, isCol);\n                }\n            }\n            else if (sheet.showHeaders) {\n                setWidthAndHeight(preEleH, -1, isCol);\n            }\n            if (sheet.showHeaders && preEle.classList.contains('e-zero-start')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            if (sheet.showHeaders && nxtEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero-start')) {\n                    while (nxtEle) {\n                        if (nxtEle.classList.contains('e-zero') && (parseInt(nxtEleH.style.height, 10) !== 0 && !isCol) ||\n                            (parseInt(nxtEleH.style.width, 10) !== 0 && isCol)) {\n                            if (isCol) {\n                                curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                                nxtEleH.style.width = parseInt(nxtEleH.style.width, 10) - 1 + 'px';\n                            }\n                            else {\n                                curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                                nxtEleH.style.height = parseInt(nxtEleH.style.height, 10) - 1 + 'px';\n                            }\n                            nxtEle.classList.remove('e-zero');\n                            nxtEle.classList.add('e-zero-start');\n                            break;\n                        }\n                        else {\n                            var nxtIndex = void 0;\n                            nxtEle.classList.remove('e-zero');\n                            nxtEle.classList.add('e-zero-start');\n                            if (isCol) {\n                                nxtIndex = parseInt(nxtEle.getAttribute('aria-colindex'), 10) - 1;\n                                nxtEle = parent.getColHeaderTable().getElementsByTagName('th')[nxtIndex + 1];\n                                nxtEleH = parent.getColHeaderTable().getElementsByTagName('col')[nxtIndex + 1];\n                            }\n                            else {\n                                nxtIndex = parseInt(nxtEle.getAttribute('aria-rowindex'), 10) - 1;\n                                nxtEle = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                                nxtEleH = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                            }\n                        }\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -2, isCol);\n                }\n            }\n            else if (sheet.showHeaders) {\n                if (nxtEle.classList.contains('e-zero-end')) {\n                    if (isCol) {\n                        curEleH.style.width = '0px';\n                    }\n                    else {\n                        curEleH.style.height = '0px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(nxtEleH, -1, isCol);\n                }\n            }\n        }\n        else if (preEleC) {\n            if (isCol) {\n                if (sheet.showHeaders) {\n                    curEleH.style.width = '1px';\n                }\n                curEleC.style.width = '0px';\n            }\n            else {\n                if (sheet.showHeaders) {\n                    curEleH.style.height = '1px';\n                }\n                curEleC.style.height = '0px';\n            }\n            if (sheet.showHeaders) {\n                curEle.classList.add('e-zero-end');\n            }\n            curEleC.classList.add('e-zero-end');\n            if (sheet.showHeaders) {\n                curEle.classList.add('e-zero-last');\n            }\n            curEleC.classList.add('e-zero-last');\n            if (sheet.showHeaders && preEle.classList.contains('e-zero')) {\n                setWidthAndHeight(preEleH, -2, isCol);\n            }\n            else {\n                setWidthAndHeight(preEleH, -1, isCol);\n            }\n        }\n        else if (nxtEle) {\n            curEle.classList.add('e-zero-start');\n            curEleC.classList.add('e-zero-start');\n            if (!nxtEle.classList.contains('e-zero')) {\n                curEle.classList.add('e-zero-last');\n                curEleC.classList.add('e-zero-last');\n            }\n            if (isCol) {\n                curEleH.style.width = '1px';\n                curEleC.style.width = '0px';\n            }\n            else {\n                curEleH.style.height = '1px';\n                curEleC.style.height = '0px';\n            }\n            if (sheet.showHeaders && nxtEle.classList.contains('e-zero')) {\n                while (nxtEle) {\n                    if (nxtEle.classList.contains('e-zero') && (parseInt(nxtEleH.style.width, 10) !== 0\n                        && isCol) || (parseInt(nxtEleH.style.height, 10) !== 0 && !isCol)) {\n                        if (isCol) {\n                            nxtEleH.style.width = parseInt(nxtEleH.style.width, 10) - 1 + 'px';\n                            curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        }\n                        else {\n                            nxtEleH.style.height = parseInt(nxtEleH.style.height, 10) - 1 + 'px';\n                            curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        }\n                        nxtEle.classList.add('e-zero-start');\n                        nxtEle.classList.remove('e-zero');\n                        break;\n                    }\n                    else {\n                        var nxtIndex = void 0;\n                        nxtEle.classList.add('e-zero-start');\n                        nxtEle.classList.remove('e-zero');\n                        if (isCol) {\n                            nxtIndex = parseInt(nxtEle.getAttribute('aria-colindex'), 10) - 1;\n                            nxtEleH = parent.getColHeaderTable().getElementsByTagName('col')[nxtIndex + 1];\n                            nxtEle = parent.getColHeaderTable().getElementsByTagName('th')[nxtIndex + 1];\n                        }\n                        else {\n                            nxtIndex = parseInt(nxtEle.getAttribute('aria-rowindex'), 10) - 1;\n                            nxtEleH = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                            nxtEle = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                        }\n                    }\n                }\n            }\n            else if (sheet.showHeaders) {\n                setWidthAndHeight(nxtEleH, -1, isCol);\n            }\n        }\n    }\n    else if (parseInt(value, 10) > 0) {\n        var DPRValue = getDPRValue(parseInt(value, 10)) + 'px';\n        if (isCol) {\n            curEleH.style.width = DPRValue;\n            curEleC.style.width = DPRValue;\n        }\n        else {\n            curEleH.style.height = DPRValue;\n            curEleC.style.height = DPRValue;\n        }\n        if (sheet.showHeaders && preEle && nxtEle) {\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero')) {\n                    if (isCol) {\n                        preEleH.style.width = parseInt(preEleH.style.width, 10) + 2 + 'px';\n                        curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                    }\n                    else {\n                        preEleH.style.height = parseInt(preEleH.style.height, 10) + 2 + 'px';\n                        curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            else {\n                if (curEle.classList.contains('e-zero')) {\n                    setWidthAndHeight(preEleH, 1, isCol);\n                }\n                else {\n                    if (curEle.classList.contains('e-zero-start')) {\n                        if (isCol) {\n                            preEleH.style.width = parseInt(preEleH.style.width, 10) + 1 + 'px';\n                            curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        }\n                        else {\n                            preEleH.style.height = parseInt(preEleH.style.height, 10) + 1 + 'px';\n                            curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        }\n                    }\n                }\n            }\n            if (nxtEle.classList.contains('e-zero')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            else {\n                if (curEle.classList.contains('e-zero') || curEle.classList.contains('e-zero-start')) {\n                    setWidthAndHeight(nxtEleH, 1, isCol);\n                }\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-start')) {\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero-start')) {\n                curEleC.classList.remove('e-zero-start');\n            }\n            if (curEle.classList.contains('e-zero-last')) {\n                curEle.classList.remove('e-zero-last');\n            }\n            if (curEleC.classList.contains('e-zero-last')) {\n                curEleC.classList.remove('e-zero-last');\n            }\n            if (preEle.classList.contains('e-zero') || preEle.classList.contains('e-zero-start')) {\n                preEle.classList.add('e-zero-last');\n                preEleC.classList.add('e-zero-last');\n            }\n        }\n        else if (sheet.showHeaders && preEle) {\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero')) {\n                    if (isCol) {\n                        curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        preEleH.style.width = parseInt(preEleH.style.width, 10) + 2 + 'px';\n                    }\n                    else {\n                        curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        preEleH.style.height = parseInt(preEleH.style.height, 10) + 2 + 'px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            else {\n                if (curEle.classList.contains('e-zero')) {\n                    setWidthAndHeight(preEleH, 1, isCol);\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-end')) {\n                curEle.classList.remove('e-zero-end');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero-end')) {\n                curEleC.classList.remove('e-zero-end');\n            }\n        }\n        else if (sheet.showHeaders && nxtEle) {\n            if (nxtEle.classList.contains('e-zero')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            else if (curEle.classList.contains('e-zero-start')) {\n                setWidthAndHeight(nxtEleH, 1, isCol);\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-start')) {\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEleC.classList.contains('e-zero-start')) {\n                curEleC.classList.remove('e-zero-start');\n            }\n        }\n    }\n}\n/**\n * @hidden\n * @param {HTMLElement} trgt - Specify the target element.\n * @param {number} value - specify the number.\n * @param {boolean} isCol - Specify the boolean vlaue.\n * @returns {void} -  to set width and height.\n */\nexport function setWidthAndHeight(trgt, value, isCol) {\n    if (isCol) {\n        trgt.style.width = parseInt(trgt.style.width, 10) + value + 'px';\n    }\n    else {\n        trgt.style.height = parseInt(trgt.style.height, 10) + value + 'px';\n    }\n}\n/**\n * @hidden\n * @param {HTMLElement} table - Specify the table.\n * @param {HTMLElement[]} text - specify the text.\n * @param {boolean} isCol - Specifyt boolean value\n * @param {Spreadsheet} parent - Specify the parent.\n * @param {string} prevData - specify the prevData.\n * @param {boolean} isWrap - Specifyt boolean value\n * @returns {number} - To find maximum value.\n */\nexport function findMaxValue(table, text, isCol, parent, prevData, isWrap) {\n    var myTableDiv = parent.createElement('div', { className: parent.element.className, styles: 'display: block' });\n    var myTable = parent.createElement('table', {\n        className: table.className + 'e-resizetable',\n        styles: 'width: auto;height: auto'\n    });\n    var myTr = parent.createElement('tr');\n    if (isCol) {\n        text.forEach(function (element) {\n            var tr = myTr.cloneNode();\n            tr.appendChild(element);\n            myTable.appendChild(tr);\n        });\n    }\n    else {\n        text.forEach(function (element) {\n            myTr.appendChild(element.cloneNode(true));\n        });\n        myTable.appendChild(myTr);\n    }\n    myTableDiv.appendChild(myTable);\n    document.body.appendChild(myTableDiv);\n    var offsetWidthValue;\n    var offsetHeightValue;\n    var tableMaxWidth = myTable.getBoundingClientRect().width;\n    var tableMaxHeight = myTable.getBoundingClientRect().height;\n    if (!isWrap) {\n        offsetHeightValue = tableMaxHeight;\n        offsetWidthValue = tableMaxWidth;\n    }\n    else {\n        if (isCol && parseInt(prevData, 10) > tableMaxWidth) {\n            offsetWidthValue = tableMaxWidth;\n        }\n        else {\n            offsetWidthValue = parseInt(prevData, 10);\n        }\n        if (!isCol && parseInt(prevData, 10) > tableMaxHeight) {\n            offsetHeightValue = tableMaxHeight;\n        }\n        else {\n            offsetHeightValue = parseInt(prevData, 10);\n        }\n    }\n    document.body.removeChild(myTableDiv);\n    if (isCol) {\n        return Math.ceil(offsetWidthValue);\n    }\n    else {\n        return Math.ceil(offsetHeightValue);\n    }\n}\n/**\n * @hidden\n * @param {CollaborativeEditArgs} options - Specify the collaborative edit arguments.\n * @param {Spreadsheet} spreadsheet - specify the spreadsheet.\n * @param {boolean} isRedo - Specifyt he boolean value.\n * @returns {void} - To update the Action.\n */\nexport function updateAction(options, spreadsheet, isRedo, undoCollections) {\n    /* eslint-disable-next-line  @typescript-eslint/no-explicit-any */\n    var eventArgs = options.eventArgs;\n    var chartElement;\n    var element;\n    var args;\n    var promise;\n    var sortArgs;\n    var cellEvtArgs;\n    var cellValue;\n    var clipboardPromise;\n    var model;\n    switch (options.action) {\n        case 'sorting':\n            args = {\n                range: options.eventArgs.range,\n                sortOptions: options.eventArgs.sortOptions,\n                cancel: false\n            };\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            promise = new Promise(function (resolve, reject) {\n                resolve((function () { })());\n            });\n            sortArgs = { args: args, promise: promise };\n            spreadsheet.notify(initiateSort, sortArgs);\n            sortArgs.promise.then(function (args) {\n                spreadsheet.serviceLocator.getService('cell').refreshRange(getIndexesFromAddress(args.range));\n            });\n            break;\n        case 'cellSave':\n            cellEvtArgs = options.eventArgs;\n            cellValue = eventArgs.formula ? (isRedo ? { value: cellEvtArgs.formula } : { formula: cellEvtArgs.formula })\n                : { value: cellEvtArgs.value };\n            spreadsheet.updateCell(cellValue, cellEvtArgs.address);\n            break;\n        case 'cellDelete':\n            spreadsheet.clearRange(options.eventArgs.address, null, true);\n            spreadsheet.serviceLocator.getService('cell').refreshRange(getRangeIndexes(options.eventArgs.address));\n            break;\n        case 'format':\n            if (eventArgs.requestType === 'CellFormat') {\n                if (eventArgs.style && eventArgs.style.border && !isNullOrUndefined(eventArgs.borderType)) {\n                    var style = {};\n                    Object.assign(style, eventArgs.style, null, true);\n                    eventArgs.style.border = undefined;\n                    spreadsheet.cellFormat(eventArgs.style, eventArgs.range);\n                    eventArgs.style.border = style.border;\n                    spreadsheet.setBorder(eventArgs.style, eventArgs.range, eventArgs.borderType);\n                    eventArgs.style = style;\n                }\n                else {\n                    spreadsheet.cellFormat(eventArgs.style, eventArgs.range);\n                }\n            }\n            else {\n                spreadsheet.numberFormat(eventArgs.format, eventArgs.range);\n            }\n            break;\n        case 'clipboard':\n            if (eventArgs.copiedInfo.isCut && !isRedo) {\n                return;\n            }\n            clipboardPromise = eventArgs.copiedInfo.isCut ? spreadsheet.cut(eventArgs.copiedRange)\n                : spreadsheet.copy(eventArgs.copiedRange);\n            clipboardPromise.then(function () {\n                spreadsheet.paste(eventArgs.pastedRange, eventArgs.type);\n            });\n            break;\n        case 'gridLines':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.sheetIdx], 'showGridLines', eventArgs.isShow);\n            break;\n        case 'headers':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.sheetIdx], 'showHeaders', eventArgs.isShow);\n            break;\n        case 'resize':\n        case 'resizeToFit':\n            if (eventArgs.isCol) {\n                if (eventArgs.hide === undefined) {\n                    spreadsheet.setColWidth(eventArgs.width, eventArgs.index, eventArgs.sheetIdx);\n                }\n                else {\n                    spreadsheet.hideColumn(eventArgs.index, eventArgs.index, eventArgs.hide);\n                }\n            }\n            else {\n                if (eventArgs.hide === undefined) {\n                    spreadsheet.setRowHeight(eventArgs.height, eventArgs.index, eventArgs.sheetIdx + 1);\n                }\n                else {\n                    spreadsheet.hideRow(eventArgs.index, eventArgs.index, eventArgs.hide);\n                }\n            }\n            break;\n        case 'renameSheet':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.index - 1], 'name', eventArgs.value);\n            break;\n        case 'removeSheet':\n            spreadsheet.notify(removeSheetTab, {\n                index: eventArgs.index,\n                isAction: true,\n                count: eventArgs.sheetCount,\n                clicked: true\n            });\n            break;\n        case 'wrap':\n            wrap(options.eventArgs.address, options.eventArgs.wrap, spreadsheet);\n            break;\n        case 'hideShow':\n            if (eventArgs.isCol) {\n                spreadsheet.hideColumn(eventArgs.startIndex, eventArgs.endIndex, eventArgs.hide);\n            }\n            else {\n                spreadsheet.hideRow(eventArgs.startIndex, eventArgs.endIndex, eventArgs.hide);\n            }\n            break;\n        case 'replace':\n            spreadsheet.updateCell({ value: eventArgs.compareVal }, eventArgs.address);\n            break;\n        case 'filter':\n            spreadsheet.notify(initiateFilterUI, { predicates: null, range: eventArgs.range, sIdx: eventArgs.index, isCut: true });\n            break;\n        case 'insert':\n            if (isRedo === false) {\n                spreadsheet.delete(options.eventArgs.index, options.eventArgs.index + (options.eventArgs.model.length - 1), options.eventArgs.modelType);\n            }\n            else {\n                spreadsheet.notify(insertModel, {\n                    model: options.eventArgs.modelType === 'Sheet' ? spreadsheet :\n                        spreadsheet.getActiveSheet(), start: options.eventArgs.index, end: options.eventArgs.index +\n                        (options.eventArgs.model.length - 1), modelType: options.eventArgs.modelType,\n                    isAction: false, checkCount: options.eventArgs.sheetCount,\n                    activeSheetIndex: options.eventArgs.activeSheetIndex\n                });\n            }\n            break;\n        case 'delete':\n            if (isRedo === false) {\n                spreadsheet.notify(insertModel, {\n                    model: options.eventArgs.modelType === 'Sheet' ? spreadsheet :\n                        spreadsheet.getActiveSheet(), start: options.eventArgs.deletedModel, modelType: options.eventArgs.modelType,\n                    isAction: false, columnCellsModel: options.eventArgs.deletedCellsModel\n                });\n            }\n            else {\n                spreadsheet.delete(options.eventArgs.startIndex, options.eventArgs.endIndex, options.eventArgs.modelType);\n            }\n            break;\n        case 'validation':\n            if (isRedo) {\n                var rules = {\n                    type: eventArgs.type, operator: eventArgs.operator, value1: eventArgs.value1,\n                    value2: eventArgs.value2, ignoreBlank: eventArgs.ignoreBlank, inCellDropDown: eventArgs.inCellDropDown\n                };\n                spreadsheet.notify(setValidation, { rules: rules, range: eventArgs.range });\n            }\n            else {\n                spreadsheet.notify(removeValidation, { range: eventArgs.range });\n            }\n            break;\n        case 'merge':\n            options.eventArgs.isAction = false;\n            model = [];\n            for (var rIdx = 0, rCnt = eventArgs.model.length; rIdx < rCnt; rIdx++) {\n                model.push({ cells: [] });\n                for (var cIdx = 0, cCnt = eventArgs.model[rIdx].cells.length; cIdx < cCnt; cIdx++) {\n                    model[rIdx].cells[cIdx] = {};\n                    Object.assign(model[rIdx].cells[cIdx], eventArgs.model[rIdx].cells[cIdx]);\n                }\n            }\n            spreadsheet.notify(setMerge, options.eventArgs);\n            eventArgs.model = model;\n            break;\n        case 'clear':\n            spreadsheet.notify(clearViewer, { options: options.eventArgs, isPublic: true });\n            break;\n        case 'conditionalFormat':\n            if (isRedo) {\n                var conditionalFormat = {\n                    type: eventArgs.type, cFColor: eventArgs.cFColor, value: eventArgs.value,\n                    range: eventArgs.range\n                };\n                spreadsheet.notify(setCFRule, { conditionalFormat: conditionalFormat, sheetIdx: eventArgs.sheetIdx, isUndoRedo: true });\n            }\n            else {\n                spreadsheet.notify(clearCFRule, { range: eventArgs.range, sheetIdx: eventArgs.sheetIdx, isUndoRedo: true });\n                for (var undoCollIdx = 0; undoCollIdx < undoCollections.length; undoCollIdx++) {\n                    if (undoCollections[undoCollIdx].action === 'conditionalFormat') {\n                        var conditionalFormat = {\n                            type: undoCollections[undoCollIdx].eventArgs.type, cFColor: undoCollections[undoCollIdx].eventArgs.cFColor,\n                            value: undoCollections[undoCollIdx].eventArgs.value, range: undoCollections[undoCollIdx].eventArgs.range\n                        };\n                        spreadsheet.notify(cFUndo, { conditionalFormat: conditionalFormat, sheetIdx: undoCollections[undoCollIdx].eventArgs.sheetIdx });\n                    }\n                }\n            }\n            break;\n        case 'clearCF':\n            if (isRedo) {\n                spreadsheet.notify(clearCFRule, { range: eventArgs.selectedRange, sheetIdx: eventArgs.sheetIdx, isClearCF: true, isUndoRedo: true });\n            }\n            else {\n                spreadsheet.notify(clearCells, {\n                    conditionalFormats: eventArgs.cFormats,\n                    oldRange: eventArgs.oldRange, selectedRange: eventArgs.selectedRange\n                });\n            }\n            break;\n        case 'insertImage':\n            if (isRedo) {\n                spreadsheet.notify(createImageElement, {\n                    options: {\n                        src: options.eventArgs.imageData,\n                        height: options.eventArgs.imageHeight, width: options.eventArgs.imageWidth, imageId: options.eventArgs.id\n                    },\n                    range: options.eventArgs.range, isPublic: false, isUndoRedo: true\n                });\n            }\n            else {\n                spreadsheet.notify(deleteImage, {\n                    id: options.eventArgs.id, sheetIdx: options.eventArgs.sheetIndex + 1, range: options.eventArgs.range\n                });\n            }\n            break;\n        case 'imageRefresh':\n            element = document.getElementById(options.eventArgs.id);\n            if (isRedo) {\n                options.eventArgs.isUndoRedo = true;\n                spreadsheet.notify(refreshImgCellObj, options.eventArgs);\n            }\n            else {\n                spreadsheet.notify(refreshImgCellObj, {\n                    prevTop: options.eventArgs.currentTop, prevLeft: options.eventArgs.currentLeft,\n                    currentTop: options.eventArgs.prevTop, currentLeft: options.eventArgs.prevLeft, id: options.eventArgs.id,\n                    currentHeight: options.eventArgs.prevHeight, currentWidth: options.eventArgs.prevWidth, requestType: 'imageRefresh',\n                    prevHeight: options.eventArgs.currentHeight, prevWidth: options.eventArgs.currentWidth, isUndoRedo: true\n                });\n            }\n            element.style.height = isRedo ? options.eventArgs.currentHeight + 'px' : options.eventArgs.prevHeight + 'px';\n            element.style.width = isRedo ? options.eventArgs.currentWidth + 'px' : options.eventArgs.prevWidth + 'px';\n            element.style.top = isRedo ? options.eventArgs.currentTop + 'px' : options.eventArgs.prevTop + 'px';\n            element.style.left = isRedo ? options.eventArgs.currentLeft + 'px' : options.eventArgs.prevLeft + 'px';\n            break;\n        case 'insertChart':\n            if (isRedo) {\n                var chartOptions = [{\n                        type: eventArgs.type, theme: eventArgs.theme, isSeriesInRows: eventArgs.isSeriesInRows,\n                        range: eventArgs.range, id: eventArgs.id, height: eventArgs.height, width: eventArgs.width\n                    }];\n                spreadsheet.notify(setChart, {\n                    chart: chartOptions, isInitCell: eventArgs.isInitCell, isUndoRedo: false, range: eventArgs.posRange\n                });\n            }\n            else {\n                spreadsheet.notify(deleteChart, { id: eventArgs.id, isUndoRedo: true });\n            }\n            break;\n        case 'deleteChart':\n            if (isRedo) {\n                spreadsheet.notify(deleteChart, { id: eventArgs.id });\n            }\n            else {\n                var chartOpts = [{\n                        type: eventArgs.type, theme: eventArgs.theme, isSeriesInRows: eventArgs.isSeriesInRows,\n                        range: eventArgs.range, id: eventArgs.id, height: eventArgs.height, width: eventArgs.width,\n                        top: eventArgs.top, left: eventArgs.left\n                    }];\n                spreadsheet.notify(setChart, {\n                    chart: chartOpts, isInitCell: eventArgs.isInitCell, isUndoRedo: false, range: eventArgs.posRange\n                });\n            }\n            break;\n        case 'chartRefresh':\n            chartElement = document.getElementById(options.eventArgs.id);\n            if (chartElement) {\n                chartElement.style.height = isRedo ? options.eventArgs.currentHeight + 'px' : options.eventArgs.prevHeight + 'px';\n                chartElement.style.width = isRedo ? options.eventArgs.currentWidth + 'px' : options.eventArgs.prevWidth + 'px';\n                chartElement.style.top = isRedo ? options.eventArgs.currentTop + 'px' : options.eventArgs.prevTop + 'px';\n                chartElement.style.left = isRedo ? options.eventArgs.currentLeft + 'px' : options.eventArgs.prevLeft + 'px';\n            }\n            if (isRedo) {\n                options.eventArgs.isUndoRedo = true;\n                spreadsheet.notify(refreshChartSize, {\n                    height: chartElement.style.height, width: chartElement.style.width, overlayEle: chartElement\n                });\n            }\n            else {\n                spreadsheet.notify(refreshChartSize, {\n                    height: chartElement.style.height, width: chartElement.style.width, overlayEle: chartElement\n                });\n            }\n            break;\n    }\n}\n/**\n * @hidden\n * @param {Workbook} workbook - Specify the workbook\n * @param {number} rowIdx - specify the roe index\n * @param {number} colIdx - specify the column Index.\n * @param {number} sheetIdx - specify the sheet index.\n * @returns {boolean} - Returns the boolean value.\n */\nexport function hasTemplate(workbook, rowIdx, colIdx, sheetIdx) {\n    var sheet = workbook.sheets[sheetIdx];\n    var ranges = sheet.ranges;\n    var range;\n    for (var i = 0, len = ranges.length; i < len; i++) {\n        if (ranges[i].template) {\n            range = getRangeIndexes(ranges[i].address.length ? ranges[i].address : ranges[i].startCell);\n            if (range[0] <= rowIdx && range[1] <= colIdx && range[2] >= rowIdx && range[3] >= colIdx) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n/**\n * Setting row height in view an model.\n *\n * @hidden\n * @param {Spreadsheet} parent - Specify the parent\n * @param {SheetModel} sheet - specify the column width\n * @param {number} height - specify the style.\n * @param {number} rowIdx - specify the rowIdx\n * @param {HTMLElement} row - specify the row\n * @param {HTMLElement} hRow - specify the hRow.\n * @param {boolean} notifyRowHgtChange - specify boolean value.\n * @returns {void} - Setting row height in view an model.\n */\nexport function setRowEleHeight(parent, sheet, height, rowIdx, row, hRow, notifyRowHgtChange) {\n    if (notifyRowHgtChange === void 0) { notifyRowHgtChange = true; }\n    var prevHgt = getRowHeight(sheet, rowIdx, true);\n    var frozenCol = parent.frozenColCount(sheet);\n    var dprHgt = getDPRValue(height);\n    row = row || (sheet.frozenRows ? parent.getRow(rowIdx, null, frozenCol) : parent.getRow(rowIdx));\n    if (row) {\n        row.style.height = dprHgt + \"px\";\n    }\n    hRow = hRow || (sheet.frozenColumns ? parent.getRow(rowIdx, null, frozenCol - 1) :\n        parent.getRow(rowIdx, parent.getRowHeaderTable()));\n    if (hRow) {\n        hRow.style.height = dprHgt + \"px\";\n    }\n    setRowHeight(sheet, rowIdx, height);\n    parent.setProperties({ sheets: parent.sheets }, true);\n    if (notifyRowHgtChange) {\n        parent.notify(rowHeightChanged, { rowIdx: rowIdx, threshold: dprHgt - prevHgt });\n    }\n}\n/**\n * @hidden\n * @param {Workbook} context - Specify the context\n * @param {CellStyleModel} style - specify the style.\n * @param {number} lines - specify the lines\n * @returns {number} - get Text Height\n */\nexport function getTextHeight(context, style, lines) {\n    if (lines === void 0) { lines = 1; }\n    var fontSize = (style && style.fontSize) || context.cellStyle.fontSize;\n    var fontSizePx = fontSize.indexOf('pt') > -1 ? parseInt(fontSize, 10) * 1.33 : parseInt(fontSize, 10);\n    var hgt = fontSizePx * getLineHeight(style) * lines;\n    return Math.ceil(hgt % 1 > 0.9 ? hgt + 1 : hgt); // 0.9 -> if it is nearest value adding extra 1 pixel\n}\n/**\n * @param {CellStyleModel} style - cell style\n * @returns {number} - returns line height\n */\nfunction getLineHeight(style) {\n    var lineHeight = 1.24;\n    if (style) {\n        if (style.fontFamily === 'Arial Black') {\n            lineHeight = 1.44;\n        }\n        else if (style.fontFamily === '\"Segoe UI\", sans-serif') {\n            lineHeight = 1.36;\n        }\n    }\n    return lineHeight;\n}\n/**\n * @hidden\n * @param {string} text - Specify the text\n * @param {CellStyleModel} style - specify the style.\n * @param {CellStyleModel} parentStyle - specify the parentStyle\n * @returns {number} - get Text Width\n */\nexport function getTextWidth(text, style, parentStyle) {\n    if (!style) {\n        style = parentStyle;\n    }\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext('2d');\n    context.font = (style.fontStyle || parentStyle.fontStyle) + ' ' + (style.fontWeight || parentStyle.fontWeight) + ' '\n        + (style.fontSize || parentStyle.fontSize) + ' ' + (style.fontFamily || parentStyle.fontFamily);\n    return getDPRValue(context.measureText(text).width, true);\n}\n/**\n * @hidden\n * @param {string} text - Specify the text\n * @param {number} colwidth - specify the column width\n * @param {CellStyleModel} style - specify the style.\n * @param {CellStyleModel} parentStyle - specify the parentStyle\n * @returns {number} - Setting maximum height while doing formats and wraptext\n */\nexport function getLines(text, colwidth, style, parentStyle) {\n    var width;\n    var prevWidth = 0;\n    var textArr = text.toString().split(' ');\n    var spaceWidth = getTextWidth(' ', style, parentStyle);\n    var lines;\n    var cnt = 0;\n    textArr.forEach(function (txt) {\n        var lWidth = 0;\n        var cWidth = 0;\n        width = getTextWidth(txt, style, parentStyle);\n        if (textArr[textArr.length - 1] !== txt) {\n            width = width + spaceWidth;\n        }\n        lines = (prevWidth + width) / colwidth;\n        if (lines >= 1) {\n            if (prevWidth) {\n                cnt++;\n            }\n            if (width / colwidth >= 1) {\n                txt.split('').forEach(function (val) {\n                    cWidth = getTextWidth(val, style, parentStyle);\n                    lWidth += cWidth;\n                    if (lWidth > colwidth) {\n                        cnt++;\n                        lWidth = cWidth;\n                    }\n                });\n                prevWidth = lWidth + spaceWidth;\n            }\n            else {\n                prevWidth = width;\n            }\n        }\n        else {\n            prevWidth += width;\n        }\n    });\n    if (prevWidth) {\n        cnt += Math.ceil((prevWidth - spaceWidth) / colwidth);\n    }\n    return cnt;\n}\n/**\n * calculation for width taken by border inside a cell\n *\n * @param {number} rowIdx - Specify the row index.\n * @param {number} colIdx - Specify the column index.\n * @param {SheetModel} sheet - Specify the sheet.\n * @returns {number} - get border width.\n */\nfunction getBorderWidth(rowIdx, colIdx, sheet) {\n    var width = 0;\n    var cell = getCell(rowIdx, colIdx, sheet, null, true);\n    var rightSideCell = getCell(rowIdx, colIdx + 1, sheet, null, true);\n    if (cell.style) {\n        if (cell.style.border) {\n            width = (colIdx === 0 ? 2 : 1) * parseFloat(cell.style.border.split('px')[0]);\n        }\n        else {\n            if (colIdx === 0 && cell.style.borderLeft) {\n                width = parseFloat(cell.style.borderLeft.split('px')[0]);\n            }\n            if (cell.style.borderRight) {\n                width += parseFloat(cell.style.borderRight.split('px')[0]);\n            }\n        }\n    }\n    if (!(cell.style && (cell.style.border || cell.style.borderRight)) && rightSideCell.style && rightSideCell.style.borderLeft) {\n        width += parseFloat(rightSideCell.style.borderLeft.split('px')[0]);\n    }\n    return width;\n}\n/**\n * calculation for height taken by border inside a cell\n *\n * @param {number} rowIdx - Specify the row index.\n * @param {number} colIdx - Specify the column index.\n * @param {SheetModel} sheet - Specify the sheet.\n * @returns {number} - get border height.\n * @hidden\n */\nexport function getBorderHeight(rowIdx, colIdx, sheet) {\n    var height = 0;\n    var cell = getCell(rowIdx, colIdx, sheet, null, true);\n    var bottomSideCell = getCell(rowIdx + 1, colIdx, sheet, null, true);\n    if (cell.style) {\n        if (cell.style.border) {\n            height = (rowIdx === 0 ? 2 : 1) * parseFloat(cell.style.border.split('px')[0]);\n        }\n        else {\n            if (rowIdx === 0 && cell.style.borderTop) {\n                height = parseFloat(cell.style.borderTop.split('px')[0]);\n            }\n            if (cell.style.borderBottom) {\n                height += parseFloat(cell.style.borderBottom.split('px')[0]);\n            }\n        }\n    }\n    if (!(cell.style && (cell.style.border || cell.style.borderBottom)) && bottomSideCell.style && bottomSideCell.style.borderTop) {\n        height += parseFloat(bottomSideCell.style.borderTop.split('px')[0]);\n    }\n    return height;\n}\n/**\n * Calculating column width by excluding cell padding and border width\n *\n * @param {SheetModel} sheet - Specify the sheet\n * @param {number} rowIdx - Specify the row index.\n * @param {number} startColIdx - Specify the start column index.\n * @param {number} endColIdx - Specify the end column index.\n * @returns {number} - get excluded column width.\n * @hidden\n */\nexport function getExcludedColumnWidth(sheet, rowIdx, startColIdx, endColIdx) {\n    if (endColIdx === void 0) { endColIdx = startColIdx; }\n    return getColumnsWidth(sheet, startColIdx, endColIdx, true) - getDPRValue((4 + getBorderWidth(rowIdx, startColIdx, sheet))); // 4 -> For cell padding\n}\n/**\n * @param {Workbook} context - Specify the Workbook.\n * @param {number} rowIdx - Specify the row index.\n * @param {number} colIdx - Specify the column index.\n * @param {SheetModel} sheet - Specify the sheet.\n * @param {CellStyleModel} style - Specify the style.\n * @param {number} lines - Specify the lines.\n * @returns {number} - get text height with border.\n * @hidden\n */\nexport function getTextHeightWithBorder(context, rowIdx, colIdx, sheet, style, lines) {\n    return getTextHeight(context, style, lines) + (getBorderHeight(rowIdx, colIdx, sheet) || 1); // 1 -> For default bottom border\n}\n/**\n * Setting maximum height while doing formats and wraptext\n *\n * @hidden\n * @param {SheetModel} sheet - Specify the sheet\n * @param {number} rIdx - specify the row Index\n * @param {number} cIdx - specify the column Index.\n * @param {number} hgt - specify the hgt\n * @returns {void} - Setting maximum height while doing formats and wraptext\n */\nexport function setMaxHgt(sheet, rIdx, cIdx, hgt) {\n    if (!sheet.maxHgts[rIdx]) {\n        sheet.maxHgts[rIdx] = {};\n    }\n    sheet.maxHgts[rIdx][cIdx] = hgt;\n}\n/**\n * Getting maximum height by comparing each cell's modified height.\n *\n * @hidden\n * @param {SheetModel} sheet - Specify the sheet.\n * @param {number} rIdx - Specify the row index.\n * @returns {number} - Getting maximum height by comparing each cell's modified height.\n */\nexport function getMaxHgt(sheet, rIdx) {\n    var maxHgt = 0;\n    var rowHgt = sheet.maxHgts[rIdx];\n    if (rowHgt) {\n        Object.keys(rowHgt).forEach(function (key) {\n            if (rowHgt[key] > maxHgt) {\n                maxHgt = rowHgt[key];\n            }\n        });\n    }\n    return maxHgt;\n}\n/**\n * @hidden\n * @param {SheetModel} sheet - Specify the sheet\n * @param {number} index - specify the index\n * @param {boolean} increase - specify the boolean value.\n * @param {string} layout - specify the string\n * @returns {number} - To skip the hidden index\n *\n */\nexport function skipHiddenIdx(sheet, index, increase, layout) {\n    if (layout === void 0) { layout = 'rows'; }\n    if (index < 0) {\n        index = -1;\n    }\n    if ((sheet[layout])[index] && (sheet[layout])[index].hidden) {\n        if (increase) {\n            index++;\n        }\n        else {\n            index--;\n        }\n        index = skipHiddenIdx(sheet, index, increase, layout);\n    }\n    return index;\n}\n/**\n * @hidden\n * @param {HTMLElement} ele - Specify the element.\n * @returns {void} - Specify the focus.\n */\nexport function focus(ele) {\n    if (!document.activeElement.classList.contains('e-text-findNext-short')) {\n        if (Browser.isIE) {\n            var scrollX_1 = window.scrollX;\n            var scrollY_1 = window.scrollY;\n            ele.focus();\n            window.scrollTo(scrollX_1, scrollY_1);\n        }\n        else {\n            /* eslint-disable-next-line  @typescript-eslint/no-explicit-any */\n            ele.focus({ preventScroll: true });\n        }\n    }\n}\n/**\n * Checks whether a specific range of cells is locked or not.\n *\n * @param {number[]} range - Specify the range.\n * @returns {boolean} - Returns true if any of the cells is locked and returns false if none of the cells is locked.\n * @hidden\n */\nexport function isLockedCells(parent, rangeIndexes) {\n    var sheet = parent.getActiveSheet();\n    var hasLockCell;\n    var address = !isNullOrUndefined(rangeIndexes) ? rangeIndexes : getSwapRange(getRangeIndexes(sheet.selectedRange));\n    for (var row = address[0]; row <= address[2]; row++) {\n        for (var col = address[1]; col <= address[3]; col++) {\n            var cell = getCell(row, col, sheet);\n            if (isLocked(cell, getColumn(sheet, col))) {\n                hasLockCell = true;\n                break;\n            }\n        }\n    }\n    return hasLockCell;\n}\n","/**\n * Specifies Workbook internal events.\n */\n/** @hidden */\nexport var workbookDestroyed = 'workbookDestroyed';\n/** @hidden */\nexport var updateSheetFromDataSource = 'updateSheetFromDataSource';\n/** @hidden */\nexport var dataSourceChanged = 'dataSourceChanged';\n/** @hidden */\nexport var dataChanged = 'dataChanged';\n/** @hidden */\nexport var triggerDataChange = 'triggerDataChange';\n/** @hidden */\nexport var workbookOpen = 'workbookOpen';\n/** @hidden */\nexport var beginSave = 'beginSave';\n/** @hidden */\nexport var checkUniqueRange = 'checkUniqueRange';\n/** @hidden */\nexport var sortImport = 'sortImport';\n/** @hidden */\nexport var ribbonFind = 'ribbonFind';\n/** @hidden */\nexport var getFilteredCollection = 'getFilteredCollection';\n/** @hidden */\nexport var getUniqueRange = 'getUniqueRange';\n/** @hidden */\nexport var removeUniquecol = 'removeUniquecol';\n/** @hidden */\nexport var saveCompleted = 'saveCompleted';\n/** @hidden */\nexport var applyNumberFormatting = 'applyNumber';\n/** @hidden */\nexport var getFormattedCellObject = 'getFormattedCell';\n/** @hidden */\nexport var refreshCellElement = 'refreshCellElem';\n/** @hidden */\nexport var setCellFormat = 'setCellFormat';\n/** @hidden */\nexport var findAllValues = 'findAllValues';\n/** @hidden */\nexport var textDecorationUpdate = 'textDecorationUpdate';\n/** @hidden */\nexport var applyCellFormat = 'applyCellFormat';\n/** @hidden */\nexport var updateUsedRange = 'updateUsedRange';\n/** @hidden */\nexport var workbookFormulaOperation = 'workbookFormulaOperation';\n/** @hidden */\nexport var workbookEditOperation = 'workbookEditOperation';\n/** @hidden */\nexport var checkDateFormat = 'checkDateFormat';\n/** @hidden */\nexport var getFormattedBarText = 'getFormattedBarText';\n/** @hidden */\nexport var activeCellChanged = 'activeCellChanged';\n/** @hidden */\nexport var openSuccess = 'openSuccess';\n/** @hidden */\nexport var openFailure = 'openFailure';\n/** @hidden */\nexport var sheetCreated = 'sheetCreated';\n/** @hidden */\nexport var sheetsDestroyed = 'sheetsDestroyed';\n/** @hidden */\nexport var aggregateComputation = 'aggregateComputation';\n/** @hidden */\nexport var beforeSort = 'beforeSort';\n/** @hidden */\nexport var initiateSort = 'initiateSort';\n/** @hidden */\nexport var sortComplete = 'sortComplete';\n/** @hidden */\nexport var sortRangeAlert = 'sortRangeAlert';\n/** @hidden */\nexport var initiatelink = 'initiatelink';\n/** @hidden */\nexport var beforeHyperlinkCreate = 'beforeHyperlinkCreate';\n/** @hidden */\nexport var afterHyperlinkCreate = 'afterHyperlinkCreate';\n/** @hidden */\nexport var beforeHyperlinkClick = 'beforeHyperlinkClick';\n/** @hidden */\nexport var afterHyperlinkClick = 'afterHyperlinkClick';\n/** @hidden */\nexport var addHyperlink = 'addHyperlink';\n/** @hidden */\nexport var setLinkModel = 'setLinkModel';\n/** @hidden */\nexport var beforeFilter = 'beforeFilter';\n/** @hidden */\nexport var initiateFilter = 'initiateFilter';\n/** @hidden */\nexport var filterComplete = 'filterComplete';\n/** @hidden */\nexport var filterRangeAlert = 'filterRangeAlert';\n/** @hidden */\nexport var clearAllFilter = 'clearAllFilter';\n/** @hidden */\nexport var wrapEvent = 'wrapText';\n/** @hidden */\nexport var onSave = 'onSave';\n/** @hidden */\nexport var insert = 'insert';\n/** @hidden */\nexport var deleteAction = 'delete';\n/** @hidden */\nexport var insertModel = 'insertModel';\n/** @hidden */\nexport var deleteModel = 'deleteModel';\n/** @hidden */\nexport var isValidation = 'isValidation';\n/** @hidden */\nexport var setValidation = 'setValidation';\n/** @hidden */\nexport var addHighlight = 'addHighlight';\n/** @hidden */\nexport var dataValidate = 'dataValidate';\n/** @hidden */\nexport var findNext = 'findNext';\n/** @hidden */\nexport var findPrevious = 'findPrevious';\n/** @hidden */\nexport var goto = 'gotoHandler';\n/** @hidden */\nexport var findWorkbookHandler = 'findHandler';\n/** @hidden */\nexport var replaceHandler = 'replace';\n/** @hidden */\nexport var replaceAllHandler = 'replaceAll';\n/** @hidden */\nexport var showDialog = 'ShowDialog';\n/** @hidden */\nexport var findUndoRedo = 'findUndoRedo';\n/** @hidden */\nexport var findKeyUp = 'findKeyUp';\n/** @hidden */\nexport var removeValidation = 'removeValidation';\n/** @hidden */\nexport var removeHighlight = 'removeHighlight';\n/** @hidden */\nexport var queryCellInfo = 'queryCellInfo';\n/** @hidden */\nexport var count = 'count';\n/** @hidden */\nexport var findCount = 'findCount';\n/** @hidden */\nexport var protectSheetWorkBook = 'protectSheet';\n/** @hidden */\nexport var updateToggle = 'updateToggleItem';\n/** @hidden */\nexport var protectsheetHandler = 'protectsheetHandler';\n/** @hidden */\nexport var replaceAllDialog = 'replaceAllDialog';\n/** @hidden */\nexport var unprotectsheetHandler = 'unprotectsheetHandler';\n/** @hidden */\nexport var workBookeditAlert = 'editAlert';\n/** @hidden */\nexport var setLockCells = 'setLockCells';\n/** @hidden */\nexport var applyLockCells = 'applyLockCells';\n/** @hidden */\nexport var setMerge = 'setMerge';\n/** @hidden */\nexport var applyMerge = 'applyMerge';\n/** @hidden */\nexport var mergedRange = 'mergedRange';\n/** @hidden */\nexport var activeCellMergedRange = 'activeCellMergedRange';\n/** @hidden */\nexport var insertMerge = 'insertMerge';\n/** @hidden */\nexport var pasteMerge = 'pasteMerge';\n/** @hidden */\nexport var setCFRule = 'setCFRule';\n/** @hidden */\nexport var cFInitialCheck = 'cFInitialCheck';\n/** @hidden */\nexport var clearCFRule = 'clearCFRule';\n/** @hidden */\nexport var initiateClearCFRule = 'initiateClearCFRule';\n/** @hidden */\nexport var cFRender = 'cFRender';\n/** @hidden */\nexport var cFDelete = 'cFDelete';\n/** @hidden */\nexport var clear = 'clear';\n/** @hidden */\nexport var clearCF = 'clearCF';\n/** @hidden */\nexport var clearCells = 'clearCells';\n/** @hidden */\nexport var setImage = 'setImage';\n/** @hidden */\nexport var setChart = 'setChart';\n/** @hidden */\nexport var initiateChart = 'initiateChart';\n/** @hidden */\nexport var refreshRibbonIcons = 'refreshRibbonIcons';\n/** @hidden */\nexport var refreshChart = 'refreshChart';\n/** @hidden */\nexport var refreshChartSize = 'refreshChartSize';\n/** @hidden */\nexport var updateChart = 'updateChart';\n/** @hidden */\nexport var deleteChartColl = 'deleteChartColl';\n/** @hidden */\nexport var initiateChartModel = 'initiateChartModel';\n/** @hidden */\nexport var focusChartBorder = 'focusChartBorder';\n/** @hidden */\nexport var saveError = 'saveError';\n/** @hidden */\nexport var validationHighlight = 'validationHighlight';\n/** @hidden */\nexport var dataRefresh = 'dataRefresh';\n/** @hidden */\nexport var updateFilter = 'updateFilter';\n/** @hidden */\nexport var beforeInsert = 'beforeInsert';\n/** @hidden */\nexport var beforeDelete = 'beforeDelete';\n/** @hidden */\nexport var deleteHyperlink = 'deleteHyperlink';\n/** @hidden */\nexport var moveOrDuplicateSheet = 'moveOrDuplicateSheet';\n/** @hidden */\nexport var cFUndo = 'cFUndo';\n/** @hidden */\nexport var refreshClipboard = 'refreshClipboard';\n/** @hidden */\nexport var updateView = 'updateView';\n","import { DataManager, Query, Deferred } from '@syncfusion/ej2-data';\nimport { getCell, setCell, getSheetIndexFromId } from '../base/index';\nimport { getRangeIndexes, checkIsFormula, updateSheetFromDataSource, checkDateFormat, dataSourceChanged } from '../common/index';\nimport { getCellIndexes, dataChanged, getCellAddress, isInRange } from '../common/index';\nimport { triggerDataChange } from '../common/index';\nimport { getFormatFromType } from './number-format';\n/**\n * Data binding module\n */\nvar DataBind = /** @class */ (function () {\n    function DataBind(parent) {\n        this.parent = parent;\n        this.requestedInfo = [];\n        this.addEventListener();\n    }\n    DataBind.prototype.addEventListener = function () {\n        this.parent.on(updateSheetFromDataSource, this.updateSheetFromDataSourceHandler, this);\n        this.parent.on(dataSourceChanged, this.dataSourceChangedHandler, this);\n        this.parent.on(dataChanged, this.dataChangedHandler, this);\n        this.parent.on(triggerDataChange, this.triggerDataChangeHandler, this);\n    };\n    DataBind.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(updateSheetFromDataSource, this.updateSheetFromDataSourceHandler);\n            this.parent.off(dataSourceChanged, this.dataSourceChangedHandler);\n            this.parent.off(dataChanged, this.dataChangedHandler);\n        }\n    };\n    /**\n     * Update given data source to sheet.\n     *\n     * @param {Object} args - Specify the args.\n     * @param {ExtendedSheet} args.sheet - Specify the sheet.\n     * @param {number[]} args.indexes - Specify the indexes.\n     * @param {Promise<CellModel>} args.promise - Specify the promise.\n     * @param {number} args.rangeSettingCount - Specify the rangeSettingCount.\n     * @returns {void} - Update given data source to sheet.\n     */\n    // eslint-disable-next-line\n    DataBind.prototype.updateSheetFromDataSourceHandler = function (args) {\n        var _this = this;\n        var cell;\n        var flds;\n        var sCellIdx;\n        var result;\n        var remoteUrl;\n        var isLocal;\n        var dataManager;\n        var requestedRange = [];\n        var sRanges = [];\n        var rowIdx;\n        var deferred = new Deferred();\n        var sRowIdx;\n        var sColIdx;\n        var loadedInfo;\n        args.promise = deferred.promise;\n        if (args.sheet && args.sheet.ranges.length) {\n            var _loop_1 = function (k) {\n                var sRange = args.indexes[0];\n                var eRange = args.indexes[2];\n                var range = args.sheet.ranges[k];\n                sRowIdx = getRangeIndexes(range.startCell)[0];\n                dataManager = range.dataSource instanceof DataManager ? range.dataSource\n                    : range.dataSource ? new DataManager(range.dataSource) : new DataManager();\n                remoteUrl = remoteUrl || dataManager.dataSource.url;\n                args.sheet.isLocalData = isLocal || !dataManager.dataSource.url;\n                if (sRowIdx <= sRange) {\n                    sRange = sRange - sRowIdx;\n                }\n                else {\n                    if (sRowIdx <= eRange) {\n                        eRange = eRange - sRowIdx;\n                        sRange = 0;\n                    }\n                    else {\n                        sRange = -1;\n                    }\n                }\n                if (range.showFieldAsHeader && sRange !== 0) {\n                    sRange -= 1;\n                }\n                var isEndReached = false;\n                var insertRowCount = 0;\n                this_1.initRangeInfo(range);\n                var count = this_1.getMaxCount(range);\n                loadedInfo = this_1.getLoadedInfo(sRange, eRange, range);\n                sRange = loadedInfo.unloadedRange[0];\n                eRange = loadedInfo.unloadedRange[1];\n                if (range.info.insertRowRange) {\n                    range.info.insertRowRange.forEach(function (range) {\n                        insertRowCount += ((range[1] - range[0]) + 1);\n                    });\n                    sRange -= insertRowCount;\n                    eRange -= insertRowCount;\n                }\n                if (sRange > count) {\n                    isEndReached = true;\n                }\n                else if (eRange > count) {\n                    eRange = count;\n                }\n                this_1.requestedInfo.push({ deferred: deferred, indexes: args.indexes, isNotLoaded: loadedInfo.isNotLoaded });\n                if (sRange >= 0 && loadedInfo.isNotLoaded && !isEndReached) {\n                    sRanges[k] = sRange;\n                    requestedRange[k] = false;\n                    var query = (range.query ? range.query : new Query()).clone();\n                    dataManager.executeQuery(query.range(sRange, eRange >= count ? eRange : eRange + 1)\n                        .requiresCount()).then(function (e) {\n                        if (!_this.parent || _this.parent.isDestroyed) {\n                            return;\n                        }\n                        result = (e.result && e.result.result ? e.result.result : e.result);\n                        sCellIdx = getRangeIndexes(range.startCell);\n                        sRowIdx = sCellIdx[0];\n                        sColIdx = sCellIdx[1];\n                        if (result && result.length) {\n                            if (!range.info.count) {\n                                count = e.count;\n                                range.info.count = e.count;\n                            }\n                            flds = Object.keys(result[0]);\n                            if (!range.info.fldLen) {\n                                range.info.fldLen = flds.length;\n                                range.info.flds = flds;\n                            }\n                            if (range.info.insertColumnRange) {\n                                var insertCount_1 = 0;\n                                range.info.insertColumnRange.forEach(function (insertRange) {\n                                    for (var i = insertRange[0]; i <= insertRange[1]; i++) {\n                                        if (i <= sColIdx) {\n                                            flds.splice(0, 0, \"emptyCell\" + insertCount_1);\n                                        }\n                                        else {\n                                            flds.splice(i - sColIdx, 0, \"emptyCell\" + insertCount_1);\n                                        }\n                                        insertCount_1++;\n                                    }\n                                });\n                            }\n                            if (sRanges[k] === 0 && range.showFieldAsHeader) {\n                                rowIdx = sRowIdx + sRanges[k] + insertRowCount;\n                                flds.forEach(function (field, i) {\n                                    cell = getCell(rowIdx, sColIdx + i, args.sheet, true);\n                                    if (!cell) {\n                                        args.sheet.rows[sRowIdx + sRanges[k]].cells[sColIdx + i] = field.includes('emptyCell') ? {}\n                                            : { value: field };\n                                    }\n                                    else if ((!cell.value || args.dataSourceChange) && !field.includes('emptyCell')) {\n                                        cell.value = field;\n                                    }\n                                });\n                            }\n                            var curSheetIdx_1 = args.formulaCellRef ? getSheetIndexFromId(_this.parent, args.sheet.id) : undefined;\n                            result.forEach(function (item, i) {\n                                rowIdx = sRowIdx + sRanges[k] + i + (range.showFieldAsHeader ? 1 : 0) + insertRowCount;\n                                for (var j = 0; j < flds.length; j++) {\n                                    cell = getCell(rowIdx, sColIdx + j, args.sheet, true);\n                                    if (cell) {\n                                        if ((!cell.value || args.dataSourceChange) && !flds[j].includes('emptyCell')) {\n                                            setCell(rowIdx, sColIdx + j, args.sheet, _this.getCellDataFromProp(item[flds[j]]), true);\n                                        }\n                                    }\n                                    else {\n                                        args.sheet.rows[rowIdx].cells[sColIdx + j] =\n                                            flds[j].includes('emptyCell') ? {} : _this.getCellDataFromProp(item[flds[j]]);\n                                    }\n                                    _this.checkDataForFormat({\n                                        args: args, cell: cell, colIndex: sColIdx + j, rowIndex: rowIdx, i: i, j: j, k: k, range: range,\n                                        sRanges: sRanges, value: item[flds[j]], sheetIndex: curSheetIdx_1\n                                    });\n                                }\n                            });\n                        }\n                        else {\n                            flds = [];\n                        }\n                        args.sheet.usedRange.rowIndex = Math.max((sRowIdx + (count || e.count) + (range.showFieldAsHeader ? 1 : 0) + insertRowCount) - 1, args.sheet.usedRange.rowIndex);\n                        args.sheet.usedRange.colIndex = Math.max(sColIdx + flds.length - 1, args.sheet.usedRange.colIndex);\n                        if (insertRowCount) {\n                            loadedInfo = _this.getLoadedInfo(sRange, eRange, range);\n                            sRange = loadedInfo.unloadedRange[0];\n                            eRange = loadedInfo.unloadedRange[1];\n                            if (sRange > count) {\n                                loadedInfo.isNotLoaded = false;\n                            }\n                            if (loadedInfo.isNotLoaded) {\n                                if (eRange > count) {\n                                    eRange = count;\n                                }\n                                range.info.loadedRange.push([sRange, eRange]);\n                            }\n                        }\n                        else {\n                            range.info.loadedRange.push([sRange, eRange]);\n                        }\n                        requestedRange[k] = true;\n                        if (requestedRange.indexOf(false) === -1) {\n                            if (eRange + sRowIdx < sRowIdx + range.info.count) {\n                                if (!args.rangeSettingCount) {\n                                    args.rangeSettingCount = [];\n                                }\n                                args.rangeSettingCount.push(k);\n                                //if (remoteUrl) {\n                                var unloadedArgs = {\n                                    sheet: args.sheet, indexes: [0, 0, args.sheet.usedRange.rowIndex, args.sheet.usedRange.colIndex],\n                                    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                                    promise: new Promise(function (resolve, reject) { resolve((function () { })()); }),\n                                    rangeSettingCount: args.rangeSettingCount\n                                };\n                                _this.updateSheetFromDataSourceHandler(unloadedArgs);\n                                unloadedArgs.promise.then(function () {\n                                    if (_this.parent.getModuleName() === 'workbook') {\n                                        return;\n                                    }\n                                    args.rangeSettingCount.pop();\n                                    if (!args.rangeSettingCount.length) {\n                                        _this.parent.notify('created', null);\n                                    }\n                                    if (args.formulaCellRef) {\n                                        _this.notfyFormulaCellRefresh(args.formulaCellRef, args.sheetIndex);\n                                    }\n                                });\n                                //}\n                            }\n                            else if (args.formulaCellRef) {\n                                _this.notfyFormulaCellRefresh(args.formulaCellRef, args.sheetIndex);\n                            }\n                            _this.checkResolve(args.indexes);\n                        }\n                    });\n                }\n                else if (k === 0 && requestedRange.indexOf(false) === -1) {\n                    this_1.checkResolve(args.indexes);\n                }\n            };\n            var this_1 = this;\n            for (var k = args.sheet.ranges.length - 1; k >= 0; k--) {\n                _loop_1(k);\n            }\n        }\n        else {\n            deferred.resolve();\n        }\n    };\n    DataBind.prototype.notfyFormulaCellRefresh = function (formulaCellRef, sheetIndex) {\n        this.parent.formulaRefCell = null;\n        this.parent.notify('updateView', { indexes: getRangeIndexes(formulaCellRef), sheetIndex: sheetIndex, refreshing: true });\n    };\n    DataBind.prototype.checkResolve = function (indexes) {\n        var resolved;\n        var isSameRng;\n        var cnt = 0;\n        this.requestedInfo.forEach(function (info, idx) {\n            isSameRng = JSON.stringify(info.indexes) === JSON.stringify(indexes);\n            if (isSameRng || resolved) {\n                if (idx === 0) {\n                    info.deferred.resolve();\n                    cnt++;\n                    resolved = true;\n                }\n                else {\n                    if (resolved && (info.isLoaded || !info.isNotLoaded)) {\n                        info.deferred.resolve();\n                        cnt++;\n                    }\n                    else if (isSameRng && resolved) {\n                        info.deferred.resolve();\n                        cnt++;\n                    }\n                    else if (isSameRng) {\n                        info.isLoaded = true;\n                    }\n                    else {\n                        resolved = false;\n                    }\n                }\n            }\n        });\n        this.requestedInfo.splice(0, cnt);\n    };\n    DataBind.prototype.getCellDataFromProp = function (prop) {\n        var data = {};\n        if (Object.prototype.toString.call(prop) === '[object Object]') {\n            if (prop.formula) {\n                data.formula = prop.formula;\n            }\n            else if (prop.value) {\n                if (typeof (prop.value) === 'string') {\n                    if (prop.value.indexOf('http://') === 0 || prop.value.indexOf('https://') === 0 ||\n                        prop.value.indexOf('ftp://') === 0 || prop.value.indexOf('www.') === 0) {\n                        data.hyperlink = prop.value;\n                    }\n                    else {\n                        data.value = prop.value;\n                    }\n                }\n                else {\n                    data.value = prop.value;\n                }\n            }\n        }\n        else {\n            if (checkIsFormula(prop)) {\n                data.formula = prop;\n            }\n            else {\n                if (typeof (prop) === 'string') {\n                    if (prop.indexOf('http://') === 0 || prop.indexOf('https://') === 0 ||\n                        prop.indexOf('ftp://') === 0 || prop.indexOf('www.') === 0) {\n                        data.hyperlink = prop;\n                    }\n                    else {\n                        data.value = prop;\n                    }\n                }\n                else {\n                    data.value = prop;\n                }\n            }\n        }\n        return data;\n    };\n    DataBind.prototype.checkDataForFormat = function (args) {\n        if (args.value !== '') {\n            var dateEventArgs = {\n                value: args.value,\n                rowIndex: args.rowIndex,\n                colIndex: args.colIndex,\n                isDate: false,\n                updatedVal: args.value,\n                isTime: false,\n                sheetIndex: args.sheetIndex\n            };\n            this.parent.notify(checkDateFormat, dateEventArgs);\n            if (dateEventArgs.isDate) {\n                if (args.cell) {\n                    args.cell.format = getFormatFromType('ShortDate');\n                    args.cell.value = dateEventArgs.updatedVal;\n                }\n                else {\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].format = getFormatFromType('ShortDate');\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].value = dateEventArgs.updatedVal;\n                }\n            }\n            else if (dateEventArgs.isTime) {\n                if (args.cell) {\n                    args.cell.format = getFormatFromType('Time');\n                    args.cell.value = dateEventArgs.updatedVal;\n                }\n                else {\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].format = getFormatFromType('Time');\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].value = dateEventArgs.updatedVal;\n                }\n            }\n        }\n    };\n    DataBind.prototype.getLoadedInfo = function (sRange, eRange, range) {\n        var isNotLoaded = true;\n        range.info.loadedRange.forEach(function (range) {\n            if (range[0] <= sRange && sRange <= range[1]) {\n                if (range[0] <= eRange && eRange <= range[1]) {\n                    isNotLoaded = false;\n                }\n                else {\n                    sRange = range[1] + 1;\n                }\n            }\n            else if (range[0] <= eRange && eRange <= range[1]) {\n                eRange = range[0] - 1;\n            }\n        });\n        return { isNotLoaded: isNotLoaded, unloadedRange: [sRange, eRange] };\n    };\n    DataBind.prototype.getMaxCount = function (range) {\n        if (range.query) {\n            var query = range.query.queries;\n            for (var i = 0; i < query.length; i++) {\n                if (query[i].fn === 'onTake') {\n                    return Math.min(query[i].e.nos, range.info.count || query[i].e.nos);\n                }\n            }\n        }\n        return range.info.count;\n    };\n    DataBind.prototype.initRangeInfo = function (range) {\n        if (!range.info) {\n            range.info = { loadedRange: [] };\n        }\n    };\n    /**\n     * Remove old data from sheet.\n     *\n     * @param {Object} args - Specify the args.\n     * @param {Workbook} args.oldProp - Specify the oldProp.\n     * @param {string} args.sheetIdx - Specify the sheetIdx.\n     * @param {string} args.rangeIdx - Specify the rangeIdx.\n     * @param {boolean} args.isLastRange - Specify the isLastRange.\n     * @returns {void} - Remove old data from sheet.\n     */\n    DataBind.prototype.dataSourceChangedHandler = function (args) {\n        var _this = this;\n        var row;\n        var sheet = this.parent.sheets[args.sheetIdx];\n        var range = sheet.ranges[args.rangeIdx];\n        if (range && (this.checkRangeHasChanges(sheet, args.rangeIdx) || !range.info)) {\n            var showFieldAsHeader_1 = range.showFieldAsHeader;\n            var indexes_1 = getCellIndexes(range.startCell);\n            if (range.info) {\n                range.info.loadedRange.forEach(function (loadedRange) {\n                    for (var i = loadedRange[0]; i <= loadedRange[1] && (i < range.info.count + (showFieldAsHeader_1 ? 1 : 0)); i++) {\n                        row = sheet.rows[i + indexes_1[0]];\n                        if (row) {\n                            for (var j = indexes_1[1]; j < indexes_1[1] + range.info.fldLen; j++) {\n                                if (row.cells && row.cells[j]) {\n                                    delete row.cells[j];\n                                }\n                            }\n                        }\n                    }\n                });\n                range.info = null;\n            }\n            var viewport = this.parent.viewport;\n            var refreshRange_1 = [viewport.topIndex, viewport.leftIndex, viewport.bottomIndex, viewport.rightIndex];\n            var eventArgs = {\n                sheet: sheet, indexes: refreshRange_1, dataSourceChange: true, promise: \n                // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                new Promise(function (resolve, reject) { resolve((function () { })()); })\n            };\n            this.updateSheetFromDataSourceHandler(eventArgs);\n            eventArgs.promise.then(function () {\n                _this.parent.notify('updateView', { indexes: refreshRange_1, checkWrap: true });\n                _this.parent.trigger('dataSourceChanged', { data: args.changedData, action: 'dataSourceChanged', rangeIndex: Number(args.rangeIdx), sheetIndex: Number(args.sheetIdx) });\n            });\n        }\n    };\n    DataBind.prototype.checkRangeHasChanges = function (sheet, rangeIdx) {\n        if (this.parent.isAngular) {\n            var changedRangeIdx = 'changedRangeIdx';\n            if (sheet[changedRangeIdx] === parseInt(rangeIdx, 10)) {\n                delete sheet[changedRangeIdx];\n                return true;\n            }\n            return false;\n        }\n        else {\n            return true;\n        }\n    };\n    /**\n     * Triggers dataSourceChange event when cell data changes\n     *\n     * @param {Object} args - Specify the args.\n     * @param {number} args.sheetIdx - Specify the sheetIdx.\n     * @param {number} args.activeSheetIndex - Specify the activeSheetIndex.\n     * @param {string} args.address - Specify the address.\n     * @param {number} args.startIndex - Specify the startIndex.\n     * @param {number} args.endIndex - Specify the endIndex.\n     * @param {string} args.modelType - Specify the modelType.\n     * @param {RowModel[]} args.deletedModel - Specify the deletedModel.\n     * @param {RowModel[]} args.model - Specify the model.\n     * @param {string} args.insertType - Specify the insertType.\n     * @param {number} args.index - Specify the index.\n     * @param {string} args.type - Specify the type.\n     * @param {string} args.pastedRange - Specify the pasted range.\n     * @param {string} args.range - Specify the range.\n     * @param {boolean}  args.isUndoRedo - Specify the boolean value.\n     * @param {string} args.requestType - Specify the requestType.\n     * @returns {void} - Triggers dataSourceChange event when cell data changes\n     */\n    DataBind.prototype.dataChangedHandler = function (args) {\n        var _this = this;\n        var changedData = [{}];\n        var action;\n        var cell;\n        var dataRange;\n        var startCell;\n        var inRange;\n        var inRangeCut;\n        var deleteRowDetails;\n        var sheetIdx = args.sheetIdx === undefined ? this.parent.activeSheetIndex : args.sheetIdx;\n        var sheet = this.parent.sheets[sheetIdx];\n        var cellIndices;\n        var cutIndices;\n        sheet.ranges.forEach(function (range, idx) {\n            if (range.dataSource) {\n                var isNewRow = void 0;\n                startCell = getCellIndexes(range.startCell);\n                dataRange = startCell.concat([startCell[0] + range.info.count + (range.showFieldAsHeader ? 0 : -1),\n                    startCell[1] + range.info.fldLen - 1]);\n                if (args.modelType === 'Row') {\n                    if (args.insertType) {\n                        inRange = ((!range.showFieldAsHeader && args.insertType === 'above') ? dataRange[0] <= args.index\n                            : dataRange[0] < args.index) && dataRange[2] >= args.index;\n                        cellIndices = [args.index];\n                        if (!inRange) {\n                            if ((dataRange[2] + 1 === args.index && args.insertType === 'below')) {\n                                isNewRow = true;\n                                range.info.count += args.model.length;\n                            }\n                            else if (dataRange[0] >= args.index) {\n                                range.startCell = getCellAddress(startCell[0] + args.model.length, startCell[1]);\n                            }\n                        }\n                        else {\n                            isNewRow = true;\n                            range.info.count += args.model.length;\n                        }\n                    }\n                    else {\n                        inRange = dataRange[0] <= args.startIndex && dataRange[2] >= args.startIndex;\n                        if (args.isDataRequest) {\n                            cellIndices = [args.startIndex, dataRange[1], args.startIndex, dataRange[1]];\n                        }\n                        else {\n                            action = 'delete';\n                        }\n                    }\n                }\n                else {\n                    cellIndices = getRangeIndexes(args.requestType === 'paste' ? args.pastedRange.split('!')[1] : args.sheetIdx > -1 ? args.address : (args.address || args.range).split('!')[1]);\n                    var dataRangeIndices = [range.showFieldAsHeader ? dataRange[0] + 1 : dataRange[0]].concat(dataRange.slice(1, 4));\n                    inRange = isInRange(dataRangeIndices, cellIndices, true);\n                    if (args.requestType === 'paste' && args.copiedInfo.isCut) {\n                        cutIndices = [].slice.call(args.copiedInfo.range);\n                        inRangeCut = isInRange(dataRangeIndices, cutIndices, true);\n                    }\n                }\n                if (inRange || isNewRow || inRangeCut) {\n                    if (args.modelType === 'Row' && !args.insertType && !args.isDataRequest) {\n                        args.deletedModel.forEach(function (row, rowIdx) {\n                            changedData[rowIdx] = {};\n                            range.info.flds.forEach(function (fld, idx) {\n                                if (row.cells) {\n                                    cell = row.cells[startCell[1] + idx];\n                                    changedData[rowIdx][fld] = _this.getFormattedValue(cell);\n                                }\n                                else {\n                                    changedData[rowIdx][fld] = null;\n                                }\n                            });\n                            range.info.count -= 1;\n                        });\n                        deleteRowDetails = { count: args.deletedModel.length, index: args.endIndex };\n                    }\n                    else {\n                        action = isNewRow ? 'add' : 'edit';\n                        var addedCutData_1 = 0;\n                        if (inRangeCut) {\n                            addedCutData_1 = cutIndices[2] - cutIndices[0] + 1;\n                            var _loop_2 = function (i) {\n                                changedData[i] = {};\n                                range.info.flds.forEach(function (fld, idx) {\n                                    cell = getCell(cutIndices[0] + i, startCell[1] + idx, sheet);\n                                    changedData[i][fld] = _this.getFormattedValue(cell);\n                                });\n                            };\n                            for (var i = 0; i < addedCutData_1; i++) {\n                                _loop_2(i);\n                            }\n                        }\n                        if (inRange || isNewRow) {\n                            var _loop_3 = function (i) {\n                                changedData[i + addedCutData_1] = {};\n                                range.info.flds.forEach(function (fld, idx) {\n                                    cell = getCell(cellIndices[0] + i, startCell[1] + idx, sheet);\n                                    changedData[i + addedCutData_1][fld] = _this.getFormattedValue(cell);\n                                });\n                            };\n                            for (var i = 0; i < (isNewRow ? args.model.length : (cellIndices[2] - cellIndices[0]) + 1 || 1); i++) {\n                                _loop_3(i);\n                            }\n                        }\n                    }\n                    if (args.isDataRequest) {\n                        args.data = changedData;\n                    }\n                    else {\n                        _this.parent.trigger('dataSourceChanged', { data: changedData, action: action, rangeIndex: idx, sheetIndex: sheetIdx });\n                    }\n                }\n                else if (deleteRowDetails && deleteRowDetails.count && dataRange[0] > deleteRowDetails.index) {\n                    range.startCell = getCellAddress(startCell[0] - deleteRowDetails.count, startCell[1]);\n                }\n            }\n        });\n    };\n    DataBind.prototype.getFormattedValue = function (cell) {\n        var value = this.parent.getDisplayText(cell);\n        if (value === '') {\n            return null;\n        }\n        else if (cell && !cell.format && typeof cell.value === 'number') {\n            return cell.value;\n        }\n        return value;\n    };\n    DataBind.prototype.triggerDataChangeHandler = function (args) {\n        var dataChangingActions = ['insert', 'delete', 'edit', 'cellDelete', 'cellSave', 'clipboard', 'clear'];\n        var triggerDataChange = true;\n        if ((args.action === 'delete' || args.action === 'insert') && ['Column', 'Sheet'].indexOf(args.eventArgs.modelType) > -1) {\n            triggerDataChange = false;\n        }\n        else if (args.action === 'clear' && ['Clear Formats', 'Clear Hyperlinks'].indexOf(args.eventArgs.type) > -1) {\n            triggerDataChange = false;\n        }\n        else if (args.action === 'clipboard' && args.eventArgs.requestType === 'Formats') {\n            triggerDataChange = false;\n        }\n        if (args.isUndo && (args.action === 'delete' || args.action === 'insert')) {\n            if (args.action === 'delete') {\n                args.eventArgs.index = args.eventArgs.startIndex;\n                args.eventArgs.model = args.eventArgs.deletedModel;\n                args.eventArgs.insertType = 'below';\n            }\n            else {\n                args.eventArgs.startIndex = args.eventArgs.index;\n                args.eventArgs.endIndex = args.eventArgs.index + args.eventArgs.model.length - 1;\n                args.eventArgs.deletedModel = args.eventArgs.model;\n                delete args.eventArgs.insertType;\n            }\n        }\n        if (triggerDataChange && dataChangingActions.indexOf(args.action) > -1) {\n            this.parent.notify(dataChanged, args.eventArgs);\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} - Get the module name.\n     * @private\n     */\n    DataBind.prototype.getModuleName = function () {\n        return 'dataBind';\n    };\n    /**\n     * Destroys the Data binding module.\n     *\n     * @returns {void} - Destroys the Data binding module.\n     */\n    DataBind.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.requestedInfo = [];\n    };\n    return DataBind;\n}());\nexport { DataBind };\n","/**\n * Specifies spreadsheet internal events\n */\n/** @hidden */\nexport var ribbon = 'ribbon';\n/** @hidden */\nexport var formulaBar = 'formulaBar';\n/** @hidden */\nexport var sheetTabs = 'sheetTabs';\n/** @hidden */\nexport var refreshSheetTabs = 'refreshSheetTabs';\n/** @hidden */\nexport var isFormulaBarEdit = 'isFormulaBarEdit';\n/** @hidden */\nexport var initialLoad = 'initialLoad';\n/** @hidden */\nexport var contentLoaded = 'contentLoaded';\n/** @hidden */\nexport var mouseDown = 'mouseDown';\n/** @hidden */\nexport var spreadsheetDestroyed = 'spreadsheetDestroyed';\n/** @hidden */\nexport var editOperation = 'editOperation';\n/** @hidden */\nexport var formulaOperation = 'formulaOperation';\n/** @hidden */\nexport var formulaBarOperation = 'formulaBarOperation';\n/** @hidden */\nexport var click = 'click';\n/** @hidden */\nexport var keyUp = 'keyUp';\n/** @hidden */\nexport var keyDown = 'keyDown';\n/** @hidden */\nexport var formulaKeyUp = 'formulaKeyUp';\n/** @hidden */\nexport var formulaBarUpdate = 'formulaBarUpdate';\n/** @hidden */\nexport var onVerticalScroll = 'verticalScroll';\n/** @hidden */\nexport var onHorizontalScroll = 'horizontalScroll';\n/** @hidden */\nexport var beforeContentLoaded = 'beforeContentLoaded';\n/** @hidden */\nexport var beforeVirtualContentLoaded = 'beforeVirtualContentLoaded';\n/** @hidden */\nexport var virtualContentLoaded = 'virtualContentLoaded';\n/** @hidden */\nexport var contextMenuOpen = 'contextMenuOpen';\n/** @hidden */\nexport var cellNavigate = 'cellNavigate';\n/** @hidden */\nexport var mouseUpAfterSelection = 'mouseUpAfterSelection';\n/** @hidden */\nexport var selectionComplete = 'selectionComplete';\n/** @hidden */\nexport var cMenuBeforeOpen = 'contextmenuBeforeOpen';\n/** @hidden */\nexport var insertSheetTab = 'insertSheetTab';\n/** @hidden */\nexport var removeSheetTab = 'removeSheetTab';\n/** @hidden */\nexport var renameSheetTab = 'renameSheetTab';\n/** @hidden */\nexport var ribbonClick = 'ribboClick';\n/** @hidden */\nexport var refreshRibbon = 'ribbonRefresh';\n/** @hidden */\nexport var enableToolbarItems = 'enableToolbarItems';\n/** @hidden */\nexport var tabSwitch = 'tabSwitch';\n/** @hidden */\nexport var selectRange = 'selectRange';\n/** @hidden */\nexport var cut = 'cut';\n/** @hidden */\nexport var copy = 'copy';\n/** @hidden */\nexport var paste = 'paste';\n/** @hidden */\nexport var clearCopy = 'clearCopy';\n/** @hidden */\nexport var dataBound = 'dataBound';\n/** @hidden */\nexport var beforeDataBound = 'beforeDataBound';\n/** @hidden */\nexport var addContextMenuItems = 'addContextMenuItems';\n/** @hidden */\nexport var removeContextMenuItems = 'removeContextMenuItems';\n/** @hidden */\nexport var enableContextMenuItems = 'enableContextMenuItems';\n/** @hidden */\nexport var enableFileMenuItems = 'enableFileMenuItems';\n/** @hidden */\nexport var hideFileMenuItems = 'hideFileMenuItems';\n/** @hidden */\nexport var addFileMenuItems = 'addFileMenuItems';\n/** @hidden */\nexport var hideRibbonTabs = 'hideRibbonTabs';\n/** @hidden */\nexport var enableRibbonTabs = 'enableRibbonTabs';\n/** @hidden */\nexport var addRibbonTabs = 'addRibbonTabs';\n/** @hidden */\nexport var addToolbarItems = 'addToolbarItems';\n/** @hidden */\nexport var hideToolbarItems = 'hideToolbarItems';\n/** @hidden */\nexport var beforeRibbonCreate = 'beforeRibbonCreate';\n/** @hidden */\nexport var rowHeightChanged = 'rowHeightChanged';\n/** @hidden */\nexport var colWidthChanged = 'colWidthChanged';\n/** @hidden */\nexport var onContentScroll = 'onContentScroll';\n/** @hidden */\nexport var deInitProperties = 'deInitProperties';\n/** @hidden */\nexport var activeSheetChanged = 'activeSheetChanged';\n/** @hidden */\nexport var renameSheet = 'renameSheet';\n/** @hidden */\nexport var initiateCustomSort = 'initiateCustomSort';\n/** @hidden */\nexport var applySort = 'applySort';\n/** @hidden */\nexport var collaborativeUpdate = 'collaborativeUpdate';\n/** @hidden */\nexport var hideShow = 'hideShow';\n/** @hidden */\nexport var autoFit = 'autoFitRowsColumns';\n/** @hidden */\nexport var updateToggleItem = 'updateToggleItem';\n/** @hidden */\nexport var initiateHyperlink = 'initiateHyperlink';\n/** @hidden */\nexport var editHyperlink = 'editHyperlink';\n/** @hidden */\nexport var openHyperlink = 'openHyperlink';\n/** @hidden */\nexport var removeHyperlink = 'removeHyperlink';\n/** @hidden */\nexport var createHyperlinkElement = 'createHyperlinkElement';\n/** @hidden */\nexport var sheetNameUpdate = 'sheetNameUpdate';\n/** @hidden */\nexport var hideSheet = 'hideSheet';\n/** @hidden */\nexport var performUndoRedo = 'performUndoRedo';\n/** @hidden */\nexport var updateUndoRedoCollection = 'updateUndoRedoCollection';\n/** @hidden */\nexport var setActionData = 'setActionData';\n/** @hidden */\nexport var getBeforeActionData = 'getBeforeActionData';\n/** @hidden */\nexport var clearUndoRedoCollection = 'clearUndoRedoCollection';\n/** @hidden */\nexport var initiateFilterUI = 'initiateFilterUI';\n/** @hidden */\nexport var renderFilterCell = 'renderFilterCell';\n/** @hidden */\nexport var reapplyFilter = 'reapplyFilter';\n/** @hidden */\nexport var filterByCellValue = 'filterByCellValue';\n/** @hidden */\nexport var clearFilter = 'clearFilter';\n/** @hidden */\nexport var getFilteredColumn = 'getFilteredColumn';\n/** @hidden */\nexport var completeAction = 'actionComplete';\n/** @hidden */\nexport var beginAction = 'actionBegin';\n/** @hidden */\nexport var filterCellKeyDown = 'filterCellKeyDown';\n/** @hidden */\nexport var getFilterRange = 'getFilterRange';\n/** @hidden */\nexport var setAutoFit = 'setAutoFit';\n/** @hidden */\nexport var refreshFormulaDatasource = 'refreshFormulaDatasource';\n/** @hidden */\nexport var setScrollEvent = 'setScrollEvent';\n/** @hidden */\nexport var initiateDataValidation = 'initiatedatavalidation';\n/** @hidden */\nexport var validationError = 'validationError';\n/** @hidden */\nexport var startEdit = 'startEdit';\n/** @hidden */\nexport var invalidData = 'invalidData';\n/** @hidden */\nexport var clearInvalid = 'clearInvalid';\n/** @hidden */\nexport var protectSheet = 'protectSheet';\n/** @hidden */\nexport var applyProtect = 'applyProtect';\n/** @hidden */\nexport var unprotectSheet = 'unprotectSheet';\n/** @hidden */\nexport var protectCellFormat = 'protectCellFormat';\n/** @hidden */\nexport var gotoDlg = 'renderGotoDlgt';\n/** @hidden */\nexport var findDlg = 'renderFindDlg';\n/** @hidden */\nexport var findHandler = 'findHandler';\n/** @hidden */\nexport var replace = 'replaceHandler';\n/** @hidden */\nexport var created = 'created';\n/** @hidden */\nexport var editAlert = 'editAlert';\n/** @hidden */\nexport var setUndoRedo = 'setUndoRedo';\n/** @hidden */\nexport var enableFormulaInput = 'enableFormulaInput';\n/** @hidden */\nexport var protectSelection = 'protectSelection';\n/** @hidden */\nexport var hiddenMerge = 'hiddenMerge';\n/** @hidden */\nexport var checkPrevMerge = 'checkPrevMerge';\n/** @hidden */\nexport var checkMerge = 'checkMerge';\n/** @hidden */\nexport var removeDataValidation = 'removeDataValidation';\n/** @hidden */\nexport var showAggregate = 'showAggregate';\n/** @hidden */\nexport var initiateConditionalFormat = 'initiateConditionalFormat';\n/** @hidden */\nexport var checkConditionalFormat = 'checkConditionalFormat';\n/** @hidden */\nexport var setCF = 'setCF';\n/** @hidden */\nexport var clearViewer = 'clearViewer';\n/** @hidden */\nexport var initiateFormulaReference = 'initiateFormulaReference';\n/** @hidden */\nexport var initiateCur = 'initiateCur';\n/** @hidden */\nexport var clearCellRef = 'clearCellRef';\n/** @hidden */\nexport var editValue = 'editValue';\n/** @hidden */\nexport var addressHandle = 'addressHandle';\n/** @hidden */\nexport var initiateEdit = 'initiateEdit';\n/** @hidden */\nexport var forRefSelRender = 'forRefSelRender';\nexport var blankWorkbook = 'blankWorkbook';\n/** @hidden */\nexport var insertImage = 'insertImage';\n/** @hidden */\nexport var refreshImgElem = 'refreshImgElem';\n/** @hidden */\nexport var refreshImgCellObj = 'refreshImgCellObj';\n/** @hidden */\nexport var getRowIdxFromClientY = 'getRowIdxFromClientY';\n/** @hidden */\nexport var getColIdxFromClientX = 'getColIdxFromClientX';\n/** @hidden */\nexport var createImageElement = 'createImageElement';\n/** @hidden */\nexport var deleteImage = 'deleteImage';\n/** @hidden */\nexport var deleteChart = 'deleteChart';\n/** @hidden */\nexport var refreshChartCellObj = 'refreshChartCellObj';\n/** @hidden */\nexport var refreshImagePosition = 'refreshImagePosition';\n/** @hidden */\nexport var updateTableWidth = 'updateTableWidth';\n/** @hidden */\nexport var focusBorder = 'focusBorder';\n/** @hidden */\nexport var clearChartBorder = 'clearChartBorder';\n/** @hidden */\nexport var insertChart = 'insertChart';\n/** @hidden */\nexport var chartRangeSelection = 'chartRangeSelection';\n/** @hidden */\nexport var insertDesignChart = 'insertDesignChart';\n/** @hidden */\nexport var removeDesignChart = 'removeDesignChart';\n/** @hidden */\nexport var chartDesignTab = 'chartDesignTab';\n/** @hidden */\nexport var addChartEle = 'addChartEle';\n/** @hidden */\nexport var isReact = 'isReact';\n/** @hidden */\nexport var renderReactTemplates = 'renderReactTemplates';\n/** @hidden */\nexport var clearTemplate = 'clearTemplate';\n/** @hidden */\nexport var protectWorkbook = 'protectWorkbook';\n/** @hidden */\nexport var unProtectWorkbook = 'unProtectWorkbook';\n/** @hidden */\nexport var getPassWord = 'getPassWord';\n/** @hidden */\nexport var importProtectWorkbook = 'importProtectWorkbook';\n/** @hidden */\nexport var selectionStatus = 'selectionStatus';\n/** @hidden */\nexport var freeze = 'freeze';\n/** @hidden */\nexport var overlayEleSize = 'overlayEleSize';\n/** @hidden */\nexport var updateScroll = 'updateScroll';\n","/**\n * Open properties.\n */\nimport { isUndefined } from '@syncfusion/ej2-base';\nimport { workbookOpen, openSuccess, openFailure, sheetsDestroyed, workbookFormulaOperation, getRangeIndexes } from '../common/index';\nimport { sheetCreated, protectSheetWorkBook, getRangeAddress, updateFilter } from '../common/index';\nimport { initSheet } from '../base/index';\nimport { beginAction } from '../../spreadsheet/common/event';\nvar WorkbookOpen = /** @class */ (function () {\n    function WorkbookOpen(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To open the excel file stream or excel url into the spreadsheet.\n     *\n     * @param {OpenOptions} options - Options to open a excel file.\n     * @returns {void} - To open the excel file stream or excel url into the spreadsheet.\n     */\n    WorkbookOpen.prototype.open = function (options) {\n        var _this = this;\n        if (!this.parent.allowOpen) {\n            return;\n        }\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (options.jsonObject) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            this.fetchSuccess(options.jsonObject, null);\n            return;\n        }\n        var formData = new FormData();\n        if (options.file) {\n            formData.append('file', options.file);\n        }\n        else {\n            this.parent.isOpen = false;\n            return;\n        }\n        var args = { passWord: '' };\n        if (options.password && options.password.length) {\n            args.passWord = options.password;\n        }\n        if (args.passWord && args.passWord.length) {\n            options.password = args.passWord;\n        }\n        if (options.password) {\n            formData.append('password', options.password);\n        }\n        var eventArgs = {\n            file: options.file || null,\n            cancel: false,\n            requestData: {\n                method: 'POST',\n                body: formData\n            },\n            password: args.passWord\n        };\n        this.parent.trigger('beforeOpen', eventArgs);\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'beforeOpen' });\n        if (eventArgs.cancel) {\n            return;\n        }\n        fetch(this.parent.openUrl, eventArgs.requestData)\n            .then(function (response) {\n            if (response.ok) {\n                return response.json();\n            }\n            else {\n                return Promise.reject({\n                    status: response.status,\n                    statusText: response.statusText,\n                    url: response.url\n                });\n            }\n        })\n            .then(function (data) { return _this.fetchSuccess(data, eventArgs); })\n            .catch(function (error) { return _this.fetchFailure(error); });\n    };\n    WorkbookOpen.prototype.fetchFailure = function (error) {\n        if (isUndefined(error.status) && isUndefined(error.statusText)) {\n            error.statusText = 'Improper response';\n        }\n        this.parent.notify(openFailure, error);\n        this.parent.isOpen = false;\n    };\n    WorkbookOpen.prototype.fetchSuccess = function (data, eventArgs) {\n        var openError = ['UnsupportedFile', 'InvalidUrl', 'NeedPassword', 'InCorrectPassword'];\n        var workbookData = data;\n        workbookData = (typeof data === 'string') ? JSON.parse(data) : data;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var impData = workbookData.Workbook;\n        if (openError.indexOf(impData) > -1) {\n            this.parent.notify(openSuccess, {\n                context: this, data: impData, eventArgs: eventArgs\n            });\n            return;\n        }\n        this.updateModel(impData);\n        this.parent.notify(openSuccess, {\n            context: this, data: impData\n        });\n        this.parent.isOpen = false;\n        if (eventArgs && eventArgs.password && eventArgs.password.length > 0) {\n            if (this.parent.showSheetTabs) {\n                this.parent.element.querySelector('.e-add-sheet-tab').removeAttribute('disabled');\n                this.parent.element.querySelector('.e-add-sheet-tab').classList.remove('e-disabled');\n            }\n            this.parent.password = '';\n        }\n    };\n    WorkbookOpen.prototype.updateModel = function (workbookModel) {\n        this.parent.notify(workbookFormulaOperation, { action: 'unRegisterSheet' });\n        this.parent.sheetNameCount = 1;\n        this.parent.sheets = [];\n        this.parent.notify(sheetsDestroyed, {});\n        workbookModel.activeSheetIndex = workbookModel.activeSheetIndex || 0;\n        this.setSelectAllRange(workbookModel.sheets);\n        this.parent.setProperties({\n            'sheets': workbookModel.sheets,\n            'activeSheetIndex': workbookModel.activeSheetIndex,\n            'definedNames': workbookModel.definedNames || [],\n            'filterCollection': workbookModel.filterCollection || [],\n            'sortCollection': workbookModel.sortCollection || []\n        }, true);\n        initSheet(this.parent);\n        this.parent.notify(sheetCreated, null);\n        this.parent.notify(workbookFormulaOperation, { action: 'registerSheet', isImport: true });\n        this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        this.parent.notify(protectSheetWorkBook, null);\n        this.parent.notify(updateFilter, { isOpen: true });\n    };\n    WorkbookOpen.prototype.setSelectAllRange = function (sheets) {\n        sheets.forEach(function (sheet) {\n            if (sheet.selectedRange) {\n                var selectedIndex = getRangeIndexes(sheet.selectedRange);\n                var rowCount = (isUndefined(sheet.rowCount) ? 100 : sheet.rowCount) - 1;\n                var colCount = (isUndefined(sheet.colCount) ? 100 : sheet.colCount) - 1;\n                if (selectedIndex[2] === 65535) {\n                    selectedIndex[2] = rowCount;\n                }\n                if (selectedIndex[3] === 255) {\n                    selectedIndex[3] = colCount;\n                }\n                if (selectedIndex[0] === 65535) {\n                    selectedIndex[0] = rowCount;\n                }\n                if (selectedIndex[1] === 255) {\n                    selectedIndex[1] = colCount;\n                }\n                sheet.selectedRange = getRangeAddress(selectedIndex);\n            }\n        });\n    };\n    /**\n     * Adding event listener for workbook open.\n     *\n     * @returns {void} - Adding event listener for workbook open.\n     */\n    WorkbookOpen.prototype.addEventListener = function () {\n        this.parent.on(workbookOpen, this.open.bind(this));\n    };\n    /**\n     * Removing event listener workbook open.\n     *\n     * @returns {void} - removing event listener workbook open.\n     */\n    WorkbookOpen.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookOpen, this.open.bind(this));\n        }\n    };\n    /**\n     * To Remove the event listeners\n     *\n     * @returns {void} - To Remove the event listeners\n     */\n    WorkbookOpen.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook open module name.\n     *\n     * @returns {string} - Get the module name.\n     */\n    WorkbookOpen.prototype.getModuleName = function () {\n        return 'workbookOpen';\n    };\n    return WorkbookOpen;\n}());\nexport { WorkbookOpen };\n","/**\n * @hidden\n * The `SaveWorker` module is used to perform save functionality with Web Worker.\n */\nvar SaveWorker = /** @class */ (function () {\n    /**\n     * Constructor for SaveWorker module in Workbook library.\n     *\n     * @private\n     * @param {Workbook} parent - Specifies the workbook.\n     */\n    function SaveWorker(parent) {\n        this.parent = parent;\n    }\n    /**\n     * Process sheet.\n     *\n     * @param {string} sheet - specify the sheet\n     * @param {number} sheetIndex - specify the sheetIndex\n     * @returns {Object} - Process sheet.\n     * @hidden\n     */\n    SaveWorker.prototype.processSheet = function (sheet, sheetIndex) {\n        var parsedSheet = JSON.parse(sheet, function (key, value) {\n            //Remove empty properties\n            if ((Array.isArray(value) || typeof value === 'string') && !value.length) {\n                return undefined;\n            }\n            return value;\n        });\n        return [sheetIndex, parsedSheet];\n    };\n    /**\n     * Process save action.\n     *\n     * @param {Object} saveJSON - specify the object\n     * @param {SaveOptions | Object} saveSettings - specify the saveSettings\n     * @param {Object} customParams - specify the customParams\n     * @returns {void} - Process save action.\n     * @hidden\n     */\n    SaveWorker.prototype.processSave = function (saveJSON, saveSettings, customParams) {\n        var formData = new FormData();\n        var i;\n        var keys = Object.keys(saveSettings);\n        formData.append('JSONData', JSON.stringify(saveJSON));\n        for (i = 0; i < keys.length; i++) {\n            formData.append(keys[i], saveSettings[keys[i]]);\n        }\n        keys = Object.keys(customParams);\n        for (i = 0; i < keys.length; i++) {\n            formData.append(keys[i], customParams[keys[i]]);\n        }\n        fetch(saveSettings.url, { method: 'POST', body: formData })\n            .then(function (response) {\n            if (response.ok) {\n                return response.blob();\n            }\n            else {\n                return Promise.reject({\n                    message: response.statusText\n                });\n            }\n        })\n            .then(function (data) {\n            new Promise(function (resolve) {\n                var reader = new FileReader();\n                reader.onload = function () {\n                    var result = reader.result.toString();\n                    if (result.indexOf('data:text/plain;base64,') > -1 || result.indexOf('data:text/html;base64,') > -1 ||\n                        result.indexOf('data:application/json;base64,') > -1) {\n                        var str = void 0;\n                        result = result.replace('data:text/plain;base64,', '');\n                        result = result.replace('data:text/html;base64,', '');\n                        if (result.indexOf('data:application/json;base64,') > -1) {\n                            result = result.replace('data:application/json;base64,', '');\n                            str = atob(result).split('.');\n                        }\n                        else {\n                            str = atob(result).split(/(\\r\\n|\\n|\\r)/gm);\n                        }\n                        if (str.length) {\n                            var text = str[0].length > 1 && str[0][0] === '\"' ? str[0].split('\"')[1] + '.' : str[0];\n                            postMessage({ dialog: text });\n                        }\n                    }\n                    else {\n                        postMessage(data);\n                    }\n                    resolve(reader.result);\n                };\n                reader.readAsDataURL(data);\n            });\n        })\n            .catch(function (error) {\n            postMessage({ error: error.message });\n        });\n        // try {\n        //     let httpRequest: XMLHttpRequest = new XMLHttpRequest();\n        //     let formData: FormData = new FormData();\n        //     let i: number;\n        //     let keys: string[] = Object.keys(saveSettings);\n        //     httpRequest.onreadystatechange = (event: Event) => {\n        //         if (httpRequest.readyState === 4 && httpRequest.status === 200) {\n        //             (postMessage as Function)(httpRequest.response);\n        //         }\n        //     };\n        //     httpRequest.onerror = (event: Event) => {\n        //         (postMessage as Function)(event);\n        //     };\n        //     formData.append('JSONData', JSON.stringify(saveJSON));\n        //     for (i = 0; i < keys.length; i++) {\n        //         formData.append(keys[i], (<{ [key: string]: string }>saveSettings)[keys[i]]);\n        //     }\n        //     httpRequest.open('POST', saveSettings.saveUrl, false);\n        //     httpRequest.send(formData);\n        // } catch (e) {\n        //     (postMessage as Function)({ error: e.message });\n        // }\n    };\n    return SaveWorker;\n}());\nexport { SaveWorker };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { executeTaskAsync } from '../common/worker';\nimport * as events from '../common/event';\nimport { SaveWorker } from '../workers/save-worker';\nimport { detach } from '@syncfusion/ej2-base';\n/**\n * @hidden\n * The `WorkbookSave` module is used to handle the save action in Workbook library.\n */\nvar WorkbookSave = /** @class */ (function (_super) {\n    __extends(WorkbookSave, _super);\n    /**\n     * Constructor for WorkbookSave module in Workbook library.\n     *\n     * @private\n     * @param {Workbook} parent - Specifies the workbook.\n     */\n    function WorkbookSave(parent) {\n        var _this = _super.call(this, parent) || this;\n        _this.isProcessCompleted = false;\n        _this.saveJSON = {};\n        _this.isFullPost = false;\n        _this.needBlobData = false;\n        _this.customParams = null;\n        _this.addEventListener();\n        return _this;\n    }\n    /**\n     * Get the module name.\n     *\n     * @returns {string} - To Get the module name.\n     * @private\n     */\n    WorkbookSave.prototype.getModuleName = function () {\n        return 'workbookSave';\n    };\n    /**\n     * To destroy the WorkbookSave module.\n     *\n     * @returns {void} - To destroy the WorkbookSave module.\n     * @hidden\n     */\n    WorkbookSave.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * @hidden\n     * @returns {void} - add Event Listener\n     */\n    WorkbookSave.prototype.addEventListener = function () {\n        this.parent.on(events.beginSave, this.initiateSave, this);\n    };\n    /**\n     * @hidden\n     * @returns {void} - remove Event Listener.\n     */\n    WorkbookSave.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(events.beginSave, this.initiateSave);\n        }\n    };\n    /**\n     * Initiate save process.\n     *\n     * @hidden\n     * @param {Object} args - Specify the args.\n     * @returns {void} - Initiate save process.\n     */\n    WorkbookSave.prototype.initiateSave = function (args) {\n        var saveSettings = args.saveSettings;\n        this.parent.notify(events.getFilteredCollection, null);\n        this.saveSettings = {\n            saveType: saveSettings.saveType,\n            url: saveSettings.url,\n            fileName: saveSettings.fileName || 'Sample'\n            //passWord: saveSettings.passWord\n        };\n        this.isFullPost = args.isFullPost;\n        this.needBlobData = args.needBlobData;\n        if (this.needBlobData) {\n            this.isFullPost = false;\n        }\n        this.customParams = args.customParams;\n        this.updateBasicSettings();\n        this.processSheets();\n    };\n    /**\n     * Update save JSON with basic settings.\n     *\n     * @hidden\n     * @returns {void} - Update save JSON with basic settings.\n     */\n    WorkbookSave.prototype.updateBasicSettings = function () {\n        var jsonStr = this.getStringifyObject(this.parent, ['sheets', '_isScalar', 'observers', 'closed', 'isStopped', 'hasError',\n            '__isAsync', 'beforeCellFormat', 'beforeCellRender', 'beforeDataBound', 'beforeOpen', 'beforeSave', 'beforeSelect',\n            'beforeSort', 'cellEdit', 'cellEditing', 'cellSave', 'beforeCellSave', 'contextMenuItemSelect', 'contextMenuBeforeClose',\n            'contextMenuBeforeOpen', 'created', 'dataBound', 'fileMenuItemSelect', 'fileMenuBeforeClose', 'fileMenuBeforeOpen',\n            'saveComplete', 'sortComplete', 'select', 'actionBegin', 'actionComplete', 'afterHyperlinkClick', 'afterHyperlinkCreate',\n            'beforeHyperlinkClick', 'beforeHyperlinkCreate', 'openComplete', 'openFailure', 'queryCellInfo', 'dialogBeforeOpen',\n            'dataSourceChanged', 'beforeConditionalFormat']);\n        var basicSettings = JSON.parse(jsonStr);\n        var sheetCount = this.parent.sheets.length;\n        if (sheetCount) {\n            basicSettings.sheets = [];\n        }\n        this.saveJSON = basicSettings;\n    };\n    /**\n     * Process sheets properties.\n     *\n     * @hidden\n     * @returns {void} - Process sheets properties.\n     */\n    WorkbookSave.prototype.processSheets = function () {\n        var i = 0;\n        var sheetCount = this.parent.sheets.length;\n        var skipProps = ['dataSource', 'startCell', 'query', 'showFieldAsHeader'];\n        while (i < sheetCount) {\n            executeTaskAsync(this, this.processSheet, this.updateSheet, [this.getStringifyObject(this.parent.sheets[i], skipProps), i]);\n            i++;\n        }\n    };\n    /**\n     * Update processed sheet data.\n     *\n     * @hidden\n     * @param {Object[]} data - Specifies the data.\n     * @returns {void} - Update processed sheet data.\n     */\n    WorkbookSave.prototype.updateSheet = function (data) {\n        this.saveJSON.sheets[data[0]] = data[1];\n        this.isProcessCompleted = this.getSheetLength(this.saveJSON.sheets) === this.parent.sheets.length;\n        if (this.isProcessCompleted) {\n            this.save(this.saveSettings);\n        }\n    };\n    WorkbookSave.prototype.getSheetLength = function (sheets) {\n        var len = 0;\n        sheets.forEach(function (sheet) {\n            if (sheet) {\n                len++;\n            }\n        });\n        return len;\n    };\n    /**\n     * Save process.\n     *\n     * @hidden\n     * @param {SaveOptions} saveSettings - Specifies the save settings props.\n     * @returns {void} - Save process.\n     */\n    WorkbookSave.prototype.save = function (saveSettings) {\n        var args = { cancel: false, jsonObject: this.saveJSON };\n        this.parent.notify(events.onSave, args);\n        if (!args.cancel) {\n            if (this.isFullPost) {\n                this.initiateFullPostSave();\n            }\n            else {\n                executeTaskAsync(this, { 'workerTask': this.processSave }, this.updateSaveResult, [this.saveJSON, saveSettings, this.customParams], true);\n            }\n        }\n        this.saveJSON = {};\n    };\n    /**\n     * Update final save data.\n     *\n     * @hidden\n     * @param {Object | Blob} result - specify the sve result.\n     * @returns {void} - Update final save data.\n     */\n    WorkbookSave.prototype.updateSaveResult = function (result) {\n        var args = {\n            status: 'Success',\n            message: '',\n            url: this.saveSettings.url,\n            fileName: this.saveSettings.fileName,\n            saveType: this.saveSettings.saveType,\n            blobData: null\n        };\n        if (typeof (result) === 'object' && result.error) {\n            args.status = 'Failure';\n            args.message = result.error.toString();\n        }\n        else if (typeof (result) === 'object' && result.dialog) {\n            this.parent.notify(events.saveError, { content: result.dialog });\n        }\n        else {\n            if (this.needBlobData) {\n                args.blobData = result;\n            }\n            else {\n                this.ClientFileDownload(result);\n            }\n        }\n        this.parent.trigger('saveComplete', args);\n        this.parent.notify(events.saveCompleted, args);\n    };\n    WorkbookSave.prototype.ClientFileDownload = function (blobData) {\n        var anchor = this.parent.createElement('a', { attrs: { download: this.getFileNameWithExtension() } });\n        var url = URL.createObjectURL(blobData);\n        anchor.href = url;\n        document.body.appendChild(anchor);\n        anchor.click();\n        URL.revokeObjectURL(url);\n        document.body.removeChild(anchor);\n    };\n    WorkbookSave.prototype.initiateFullPostSave = function () {\n        var keys = Object.keys(this.saveSettings);\n        var i;\n        var formElem = this.parent.createElement('form', { attrs: { method: 'POST', action: this.saveSettings.url } });\n        var inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: 'JSONData' } });\n        inputElem.value = JSON.stringify(this.saveJSON);\n        formElem.appendChild(inputElem);\n        for (i = 0; i < keys.length; i++) {\n            inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: keys[i] } });\n            inputElem.value = this.saveSettings[keys[i]];\n            formElem.appendChild(inputElem);\n        }\n        keys = Object.keys(this.customParams);\n        for (i = 0; i < keys.length; i++) {\n            inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: keys[i] } });\n            inputElem.value = this.customParams[keys[i]];\n            formElem.appendChild(inputElem);\n        }\n        document.body.appendChild(formElem);\n        formElem.submit();\n        detach(formElem);\n        this.parent.notify(events.saveCompleted, {});\n    };\n    /**\n     * Get stringified workbook object.\n     *\n     * @hidden\n     * @param {object} value - Specifies the value.\n     * @param {string[]} skipProp - specifies the skipprop.\n     * @returns {string} - Get stringified workbook object.\n     */\n    WorkbookSave.prototype.getStringifyObject = function (value, skipProp) {\n        if (skipProp === void 0) { skipProp = []; }\n        return JSON.stringify(value, function (key, value) {\n            if (skipProp.indexOf(key) > -1) {\n                return undefined;\n            }\n            else {\n                // eslint-disable-next-line no-prototype-builtins\n                if (value && typeof value === 'object' && value.hasOwnProperty('properties')) {\n                    return value.properties;\n                }\n                else if (value !== null) {\n                    return value;\n                }\n                else {\n                    return undefined;\n                }\n            }\n        });\n    };\n    WorkbookSave.prototype.getFileNameWithExtension = function (filename) {\n        if (!filename) {\n            filename = this.saveSettings.fileName;\n        }\n        var fileExt = this.getFileExtension();\n        var idx = filename.lastIndexOf('.');\n        if (idx > -1) {\n            filename = filename.substr(0, idx);\n        }\n        return (filename + fileExt);\n    };\n    WorkbookSave.prototype.getFileExtension = function () {\n        return ('.' + this.saveSettings.saveType.toLowerCase());\n    };\n    return WorkbookSave;\n}(SaveWorker));\nexport { WorkbookSave };\n","/* eslint-disable camelcase */\n/*eslint camelcase: [\"error\", {properties: \"never\"}]*/\n/**\n * @hidden\n */\nexport var CommonErrors;\n(function (CommonErrors) {\n    CommonErrors[CommonErrors[\"na\"] = 0] = \"na\";\n    CommonErrors[CommonErrors[\"value\"] = 1] = \"value\";\n    CommonErrors[CommonErrors[\"ref\"] = 2] = \"ref\";\n    CommonErrors[CommonErrors[\"divzero\"] = 3] = \"divzero\";\n    CommonErrors[CommonErrors[\"num\"] = 4] = \"num\";\n    CommonErrors[CommonErrors[\"name\"] = 5] = \"name\";\n    CommonErrors[CommonErrors[\"null\"] = 6] = \"null\";\n})(CommonErrors || (CommonErrors = {}));\n/**\n * @hidden\n */\nexport var FormulasErrorsStrings;\n(function (FormulasErrorsStrings) {\n    FormulasErrorsStrings[FormulasErrorsStrings[\"operators_cannot_start_with_expression\"] = 0] = \"operators_cannot_start_with_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_And\"] = 1] = \"reservedWord_And\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Xor\"] = 2] = \"reservedWord_Xor\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_If\"] = 3] = \"reservedWord_If\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"number_contains_2_decimal_points\"] = 4] = \"number_contains_2_decimal_points\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Else\"] = 5] = \"reservedWord_Else\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Not\"] = 6] = \"reservedWord_Not\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_char_in_number\"] = 7] = \"invalid_char_in_number\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_characters_following_with_operator\"] = 6] = \"invalid_characters_following_with_operator\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"mismatched_parentheses\"] = 8] = \"mismatched_parentheses\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"unknown_formula_name\"] = 9] = \"unknown_formula_name\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_a_single_argument\"] = 10] = \"requires_a_single_argument\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_3_args\"] = 11] = \"requires_3_args\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_Math_argument\"] = 12] = \"invalid_Math_argument\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_2_args\"] = 13] = \"requires_2_args\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"bad_index\"] = 14] = \"bad_index\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"too_complex\"] = 15] = \"too_complex\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"circular_reference\"] = 16] = \"circular_reference\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"missing_formula\"] = 17] = \"missing_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"improper_formula\"] = 18] = \"improper_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_expression\"] = 19] = \"invalid_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"cell_empty\"] = 20] = \"cell_empty\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"bad_formula\"] = 21] = \"bad_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"empty_expression\"] = 22] = \"empty_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"virtual_mode_required\"] = 23] = \"virtual_mode_required\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"mismatched_tics\"] = 24] = \"mismatched_tics\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"wrong_number_arguments\"] = 25] = \"wrong_number_arguments\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_arguments\"] = 26] = \"invalid_arguments\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"iterations_do_not_converge\"] = 27] = \"iterations_do_not_converge\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"calculation_overflow\"] = 29] = \"calculation_overflow\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"already_registered\"] = 28] = \"already_registered\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"missing_sheet\"] = 30] = \"missing_sheet\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"cannot_parse\"] = 31] = \"cannot_parse\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"expression_cannot_end_with_an_operator\"] = 32] = \"expression_cannot_end_with_an_operator\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"spill\"] = 33] = \"spill\";\n})(FormulasErrorsStrings || (FormulasErrorsStrings = {}));\n","import { FormulasErrorsStrings, CommonErrors, getSkeletonVal } from '../common/index';\nimport { getAlphalabel } from '../base/index';\nimport { isNullOrUndefined, getValue, Internationalization } from '@syncfusion/ej2-base';\nimport { DataUtil } from '@syncfusion/ej2-data';\n/**\n * Represents the basic formulas module.\n */\nvar BasicFormulas = /** @class */ (function () {\n    function BasicFormulas(parent) {\n        this.formulas = [\n            { formulaName: 'SUM', category: 'Math & Trig', description: 'Sums individual values, cell references or ranges.' },\n            {\n                formulaName: 'SUMIFS', category: 'Math & Trig',\n                description: 'Sums the cells specified by a given set of conditionsor criteria.'\n            },\n            {\n                formulaName: 'SUMPRODUCT', category: 'Math & Trig',\n                description: 'Returns sum of the product of given ranges of arrays.'\n            },\n            { formulaName: 'ABS', category: 'Math & Trig', description: 'Returns the absolute value of a number.' },\n            { formulaName: 'RAND', category: 'Math & Trig', description: 'Return a random number between 0 and 1.' },\n            { formulaName: 'FLOOR', category: 'Math & Trig', description: 'Returns the round a number down to the nearest integer.' },\n            { formulaName: 'CEILING', category: 'Math & Trig', description: 'Returns a number rounded up to a multiple of another number.' },\n            {\n                formulaName: 'SUMIF', category: 'Math & Trig',\n                description: 'It will sum up cells that meet the given criteria.'\n            },\n            {\n                formulaName: 'PRODUCT', category: 'Math & Trig',\n                description: 'Multiplies all the numbers given as arguments and returns the product.'\n            },\n            {\n                formulaName: 'AVERAGE', category: 'Statistical',\n                description: 'The sum of the numbers divided by how many numbers are being averaged.'\n            },\n            {\n                formulaName: 'AVERAGEIF', category: 'Statistical',\n                description: 'Computes the average of the numbers in a range that meet the supplied criteria.'\n            },\n            {\n                formulaName: 'COUNT', category: 'Statistical',\n                description: 'Counts the numbers in the list of arguments, exclude text entries.'\n            },\n            { formulaName: 'COUNTA', category: 'Statistical', description: 'Counts the non-empty values in the list of arguments.' },\n            {\n                formulaName: 'COUNTIF', category: 'Statistical',\n                description: 'Counts the number of cells in a range that meet a specified condition.'\n            },\n            {\n                formulaName: 'COUNTIFS', category: 'Statistical',\n                description: 'Counts the number of times each cells in all the ranges that meet the specific conditions.'\n            },\n            {\n                formulaName: 'AVERAGEA', category: 'Statistical',\n                description: 'Calculates the average of values in the list of arguments.Arguments can be numbers, names, arrays or references.'\n            },\n            {\n                formulaName: 'AVERAGEIFS', category: 'Statistical',\n                description: 'Conditionally returns the average of the contents of cells for the set of ranges.'\n            },\n            {\n                formulaName: 'MIN', category: 'Statistical',\n                description: 'Returns the smaller number in set of arguments.'\n            },\n            { formulaName: 'MAX', category: 'Statistical', description: 'Returns the largest number in set of arguments.' },\n            { formulaName: 'DATE', category: 'Date', description: 'Returns the date, given the year, month and day of the month.' },\n            { formulaName: 'DAY', category: 'Date', description: 'Returns the day of a given date.' },\n            { formulaName: 'TODAY', category: 'Date', description: 'Returns the current date as date value.' },\n            { formulaName: 'DAYS', category: 'Date', description: 'Returns the number of days between two dates.' },\n            {\n                formulaName: 'IF', category: 'Logical',\n                description: 'Returns one value if a logical expression is TRUE and another if it is FALSE'\n            },\n            {\n                formulaName: 'AND', category: 'Logical',\n                description: 'Returns TRUE if all the arguments are considered TRUE, and FALSE otherwise.'\n            },\n            {\n                formulaName: 'IFS', category: 'Logical',\n                description: 'Checks multiple conditions and returns a value corresponding to the first TRUE result.'\n            },\n            {\n                formulaName: 'IFERROR', category: 'Logical',\n                description: 'Returns a value you specify if a formula evaluates to an error; otherwise, it returns the result of the formula.'\n            },\n            {\n                formulaName: 'UNIQUE', category: 'Lookup & Reference',\n                description: 'Returns a unique values from a range or array.'\n            },\n            {\n                formulaName: 'CHOOSE', category: 'Lookup & Reference',\n                description: 'Returns a value from a list, given an index number.'\n            },\n            {\n                formulaName: 'INDEX', category: 'Lookup & Reference',\n                description: 'Returns a value from a table, given a row and column number.'\n            },\n            { formulaName: 'FIND', category: 'Text', description: 'Returns the position of a string of text within another string.' },\n            { formulaName: 'CONCATENATE', category: 'Text', description: ' Used to join two or more strings together.' },\n            { formulaName: 'CONCAT', category: 'Text', description: 'Concatenates a list or range of text strings.' },\n            { formulaName: 'SUBTOTAL', category: 'Lookup & Reference', description: 'Returns a subtotal in a list or database.' },\n            { formulaName: 'RADIANS', category: 'Math & Trig', description: 'Converts degrees to radians.' },\n            {\n                formulaName: 'OR', category: 'Logical',\n                description: 'Returns TRUE if any arguments considered TRUE, and all the arguments are FALSE it will return FALSE.'\n            },\n            {\n                formulaName: 'MATCH', category: 'Lookup & Reference',\n                description: 'Returns the relative position of an checked item in range that matches a specified value in a specified order'\n            },\n            {\n                formulaName: 'RANDBETWEEN', category: 'Math & Trig', description: 'Returns an integer random number in a specified range.'\n            },\n            {\n                formulaName: 'SLOPE', category: 'Statistical',\n                description: 'Returns the slope of the line from linear regression of the data points.'\n            },\n            {\n                formulaName: 'INTERCEPT', category: 'Statistical',\n                description: 'Calculates the point of the Y-intercept line via linear regression.'\n            },\n            {\n                formulaName: 'ROUNDUP', category: 'Math & Trig', description: 'Rounds a number away from zero.'\n            },\n            {\n                formulaName: 'INT', category: 'Math & Trig', description: 'Returns a number to the nearest integer.'\n            },\n            {\n                formulaName: 'LN', category: 'Math & Trig', description: 'Returns the natural logarithm of a number.'\n            },\n            {\n                formulaName: 'ISNUMBER', category: 'Information', description: 'Returns TRUE, if the argument is number and FALSE otherwise.'\n            },\n            {\n                formulaName: 'ROUND', category: 'Math & Trig', description: 'Rounds a number to a specified number of digits.'\n            },\n            {\n                formulaName: 'LOG', category: 'Math & Trig', description: 'Returns the logarithm of a number to the base that you specify.'\n            },\n            {\n                formulaName: 'POWER', category: 'Math & Trig', description: 'Returns the result of a number raised to power.'\n            },\n            {\n                formulaName: 'TRUNC', category: 'Math & Trig',\n                description: 'Returns the truncated value of a number to a specified number of decimal places.'\n            },\n            {\n                formulaName: 'EXP', category: 'Math & Trig', description: 'Returns e raised to the power of the given number.'\n            },\n            {\n                formulaName: 'GEOMEAN', category: 'Statistical',\n                description: 'Returns the geometric mean of an array or range of positive data.'\n            },\n            { formulaName: 'TEXT', category: 'Lookup & Reference', description: 'Converts a value to text in specified number format.' },\n            { formulaName: 'SORT', category: 'Lookup & Reference', description: 'Sorts a range of an array.' },\n            { formulaName: 'T', category: 'Text', description: 'Checks whether a value is text and returns the text if it is, or returns empty string if it is not.' }\n        ];\n        this.isConcat = false;\n        this.parent = parent;\n        this.init();\n    }\n    BasicFormulas.prototype.init = function () {\n        var fn;\n        for (var i = 0; i < this.formulas.length; i++) {\n            fn = getValue('Compute' + this.formulas[i].formulaName, this).bind(this);\n            this.addFormulaCollection(this.formulas[i].formulaName.toUpperCase(), fn, this.formulas[i].category, this.formulas[i].description);\n        }\n    };\n    BasicFormulas.prototype.addFormulaCollection = function (formulaName, functionName, formulaCategory, description) {\n        this.parent.libraryFormulas = {\n            fName: formulaName, handler: functionName, category: formulaCategory,\n            description: description\n        };\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args\n     * @returns {string | number} - Comput sum value\n     */\n    BasicFormulas.prototype.ComputeSUM = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var sum = 0;\n        var val;\n        var orgValue;\n        if (!isNullOrUndefined(args)) {\n            var argArr = args;\n            for (var i = 0; i < argArr.length; i++) {\n                var argValue = argArr[i].toString();\n                if (argValue.indexOf(':') > -1 && this.parent.isCellReference(argValue)) {\n                    var cellCollection = this.parent.getCellCollection(argValue.split(this.parent.tic).join(''));\n                    for (var j = 0; j < cellCollection.length; j++) {\n                        val = this.parent.getValueFromArg(cellCollection[j]);\n                        if (this.parent.getErrorStrings().indexOf(val) > -1) {\n                            return val;\n                        }\n                        if (isNullOrUndefined(val[0]) || isNaN(this.parent.parseFloat(val))) {\n                            continue;\n                        }\n                        sum = sum + this.parent.parseFloat(val);\n                    }\n                }\n                else {\n                    if (argArr[i].split(this.parent.tic).join('') === this.parent.trueValue) {\n                        argArr[i] = '1';\n                    }\n                    if (argArr[i].split(this.parent.tic).join('') === this.parent.falseValue) {\n                        argArr[i] = '0';\n                    }\n                    orgValue = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    if (isNullOrUndefined(orgValue) || isNaN(this.parent.parseFloat(orgValue))) {\n                        continue;\n                    }\n                    if (orgValue.length > 0) {\n                        sum = sum + this.parent.parseFloat(orgValue + '');\n                    }\n                }\n            }\n        }\n        return sum;\n    };\n    /**\n     * @hidden\n     * @param {string} args - specify the args.\n     * @returns {string} - Compute the text or null value.\n     */\n    BasicFormulas.prototype.ComputeT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var result = '';\n        if (isNullOrUndefined(args) || args.length !== 1 || args[0] === '') {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var value = args[0];\n        value = value.indexOf(':') > -1 ? value.split(':')[0] : value;\n        value = this.parent.getValueFromArg(value);\n        var letters = /^[0-9.]+$/;\n        if (value.match(letters) === null && value.toUpperCase() !== 'TRUE' && value.toUpperCase() !== 'FALSE') {\n            result = value;\n        }\n        return result;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {string | number} - Compute the Integer.\n     */\n    BasicFormulas.prototype.ComputeINT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        var num;\n        var index;\n        if (!isNullOrUndefined(args) && args.length !== 1 || args[0] === '') {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (args[0] !== '' && args.length === 1) {\n            str = args[0];\n            index = str.indexOf('\"');\n            str = str.indexOf('\"') > -1 ? str.replace('\"', '') : str;\n            str = str.indexOf('\"') > -1 ? str.replace('\"', '') : str;\n            str = this.parent.getValueFromArg(str);\n            str = str.toUpperCase() === 'TRUE' ? '1' : (str === 'FALSE' ? '0' : str);\n            num = this.parent.parseFloat(str);\n            num = Math.floor(num);\n        }\n        if (isNaN(num)) {\n            str = index > -1 ? this.parent.getErrorStrings()[CommonErrors.value] : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return num ? num : str;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {Date | string} - Compute the Today.\n     */\n    BasicFormulas.prototype.ComputeTODAY = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        if (args && args[0] !== '') {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        else {\n            var dt = new Date(Date.now());\n            str = dt.getFullYear() + '/' + this.parent.calculateDate((dt.getMonth() + 1).toString()) + '/'\n                + this.parent.calculateDate(dt.getDate().toString());\n        }\n        return str;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {string | number} - Compute the Sum product.\n     */\n    BasicFormulas.prototype.ComputeSUMPRODUCT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum = 0;\n        var count = 0;\n        var index;\n        var mulValues = null;\n        var ranges = args;\n        for (var k = 0; k < ranges.length; ++k) {\n            var range = ranges[k];\n            if (!range.startsWith(this.parent.tic) && this.parent.isCellReference(range)) {\n                var i = range.indexOf(':');\n                var startRow = this.parent.rowIndex(range.substr(0, i));\n                var endRow = this.parent.rowIndex(range.substr(i + 1));\n                if (!(startRow !== -1 || endRow === -1) === (startRow === -1 || endRow !== -1)) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                var col1 = this.parent.colIndex(range.substr(0, i));\n                var col2 = this.parent.colIndex(range.substr(i + 1));\n                if (mulValues === null) {\n                    count = (endRow - startRow + 1) * (col2 - col1 + 1);\n                    mulValues = [];\n                    for (i = 0; i < count; ++i) {\n                        mulValues[i] = 1; //To create required index.\n                    }\n                }\n                i = 0;\n                for (var row = startRow; row <= endRow; ++row) {\n                    for (var col = col1; col <= col2; ++col) {\n                        var cellRef = this.getSheetReference(range) + this.parent.convertAlpha(col) + (row);\n                        var result = this.parent.getValueFromArg(cellRef);\n                        if (!isNaN(parseFloat(result))) {\n                            //To return #VALUE! error when array dimensions are mismatched.\n                            if (isNaN(mulValues[i])) {\n                                return this.parent.getErrorStrings()[CommonErrors.name];\n                            }\n                            mulValues[i] = mulValues[i] * parseFloat(result);\n                        }\n                        else {\n                            mulValues[i] = 0;\n                        }\n                        i++;\n                    }\n                }\n            }\n            else {\n                var s1 = this.parent.getValueFromArg(range);\n                index = s1.indexOf('\"');\n                if (this.parent.getErrorStrings().indexOf(s1) > -1) {\n                    return s1;\n                }\n                else if (index > -1) {\n                    return 0;\n                }\n                else {\n                    return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n                }\n            }\n        }\n        for (var i = 0; i < count; ++i) {\n            sum += mulValues[i];\n        }\n        return sum;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {string | number} - Compute the Roundup.\n     */\n    BasicFormulas.prototype.ComputeROUNDUP = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        var num;\n        var arg1;\n        var arg2;\n        var index;\n        var len = args.length;\n        if (!isNullOrUndefined(args) && len > 2) {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (len === 1 && args[0] !== '') {\n            index = args[0].indexOf('\"');\n            arg1 = args[0].indexOf('\"') > -1 ? args[0].replace('\"', '') : args[0];\n            arg1 = arg1.indexOf('\"') > -1 ? arg1.replace('\"', '') : arg1;\n            arg1 = arg1.toUpperCase() === 'TRUE' ? '1' : (arg1 === 'FALSE' ? '0' : arg1);\n            arg1 = this.parent.getValueFromArg(arg1);\n            num = this.parent.parseFloat(arg1);\n            if (num > 0) {\n                num += .4999999999; // To round the number, we using this value.\n            }\n            else if (num < 0) {\n                num -= .4999999999;\n            }\n            num = this.parent.parseFloat(num.toFixed(0));\n            str = num.toString();\n        }\n        else if (len === 2 && args[0] !== '' && args[1] !== '') {\n            index = args[0].indexOf('\"') > -1 ? args[0].indexOf('\"') : (args[1].indexOf('\"') > -1 ? args[1].indexOf('\"') : -1);\n            arg1 = args[0].indexOf('\"') > -1 ? args[0].replace('\"', '') : args[0];\n            arg1 = arg1.indexOf('\"') > -1 ? arg1.replace('\"', '') : arg1;\n            arg2 = args[1].indexOf('\"') > -1 ? args[1].replace('\"', '') : args[1];\n            arg2 = arg2.indexOf('\"') > -1 ? arg2.replace('\"', '') : arg2;\n            arg1 = arg1.toUpperCase() === 'TRUE' ? '1' : (arg1 === 'FALSE' ? '0' : arg1);\n            arg2 = arg2.toUpperCase() === 'TRUE' ? '1' : (arg2 === 'FALSE' ? '0' : arg2);\n            arg1 = this.parent.getValueFromArg(arg1);\n            arg2 = this.parent.getValueFromArg(arg2);\n            var digits = Math.ceil(this.parent.parseFloat(arg2));\n            num = this.parent.parseFloat(arg1);\n            if (digits > 0) {\n                if (num > 0) {\n                    num += .4999999999 / Math.pow(10, digits);\n                }\n                else if (num < 0) {\n                    num -= .4999999999 / Math.pow(10, digits);\n                }\n                num = this.parent.parseFloat(num.toFixed(digits));\n                str = num.toFixed(digits);\n                if (isNaN(num)) {\n                    if (digits.toString().indexOf('\"') > -1) {\n                        str = this.parent.getErrorStrings()[CommonErrors.value];\n                    }\n                    else {\n                        str = this.parent.getErrorStrings()[CommonErrors.name];\n                    }\n                }\n            }\n            else {\n                if (num > 0) {\n                    num = (num / Math.pow(10, -digits)) + .49999;\n                }\n                else if (num < 0) {\n                    num = (num / Math.pow(10, -digits)) - .49999;\n                }\n                num = this.parent.parseFloat(num.toFixed(0)) * Math.pow(10, -digits);\n                str = num.toString();\n                if (isNaN(num)) {\n                    str = (digits.toString().indexOf('\"') > -1) ? this.parent.getErrorStrings()[CommonErrors.value] :\n                        str = this.parent.getErrorStrings()[CommonErrors.name];\n                }\n            }\n        }\n        else {\n            str = index > -1 ? this.parent.getErrorStrings()[CommonErrors.value] :\n                this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        return str;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {number | string} - Compute the count.\n     */\n    BasicFormulas.prototype.ComputeCOUNT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        var argVal;\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        for (var i = 0; i < argArr.length; i++) {\n            argVal = argArr[i];\n            if (argVal.indexOf(':') > -1 && this.parent.isCellReference(argVal)) {\n                cellColl = this.parent.getCellCollection(argVal.split(this.parent.tic).join(''));\n                for (var j = 0; j < cellColl.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellColl[j]);\n                    if (!isNaN(this.parent.parseFloat(cellValue))) {\n                        if (argVal.length > 0 && argVal !== '' && argVal !== ' ') {\n                            result++;\n                        }\n                    }\n                }\n            }\n            else {\n                argVal = argVal.split(this.parent.tic).join('');\n                if (!isNaN(this.parent.parseFloat(this.parent.getValueFromArg(argVal)))) {\n                    if (argVal.length > 0 && argVal !== '' && argVal !== ' ') {\n                        result++;\n                    }\n                }\n            }\n        }\n        return result;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {Date | string} - Compute the Date.\n     */\n    BasicFormulas.prototype.ComputeDATE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        if (argArr.length !== 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var i = 0; i < argArr.length; ++i) {\n            argArr[i] = this.parent.getValueFromArg(argArr[i]);\n        }\n        argArr[0] = (argArr[0].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[0].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[0];\n        argArr[1] = (argArr[1].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[1].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[1];\n        argArr[2] = (argArr[2].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[2].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[2];\n        /* eslint-enable */\n        var year = this.parent.parseFloat(argArr[0].split(this.parent.tic).join(''));\n        var month = this.parent.parseFloat(argArr[1].split(this.parent.tic).join(''));\n        var day = this.parent.parseFloat(argArr[2].split(this.parent.tic).join(''));\n        var days = 0;\n        if (!isNaN(year) && !isNaN(month) && !isNaN(day)) {\n            if (year < 0) {\n                return this.parent.getErrorStrings()[CommonErrors.num].toString();\n            }\n            while (month > 12) {\n                month -= 12;\n                year++;\n            }\n            days = this.parent.getSerialDateFromDate(year, month, day);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value].toString();\n        }\n        if (days === 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num].toString();\n        }\n        var date = this.parent.fromOADate(days);\n        if (date.toString() !== 'Invalid Date') {\n            return date.getFullYear() + '/' + this.parent.calculateDate((date.getMonth() + 1).toString()) + '/' + this.parent.calculateDate(date.getDate().toString());\n        }\n        return days.toString();\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {number | string} - Compute the ceiling.\n     */\n    BasicFormulas.prototype.ComputeFLOOR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var argCount = argArr.length;\n        var splitArg = argArr[1].split(this.parent.tic).join('');\n        var argValue = [];\n        var fnum;\n        var significance;\n        if (argCount !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        argValue.push(fnum = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''))));\n        argArr[1] = (splitArg === this.parent.trueValue) ? '1' : (splitArg === this.parent.falseValue) ? '0' : argArr[1];\n        argValue.push(significance = this.parent.parseFloat(this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''))));\n        if (fnum > 0 && significance < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (fnum > 0 && significance === 0) {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (isNaN(fnum)) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return Math.floor(fnum / significance) * significance;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {number | string} - Compute the ceiling.\n     */\n    BasicFormulas.prototype.ComputeCEILING = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var orgValue = [];\n        var argCount = argArr.length;\n        var splitArg = argArr[1].split(this.parent.tic).join('');\n        var cnum;\n        var significance;\n        if (argCount !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgValue.push(cnum = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''))));\n        argArr[1] = (splitArg === this.parent.trueValue) ? '1' : (splitArg === this.parent.falseValue) ? '0' : argArr[1];\n        orgValue.push(significance = this.parent.parseFloat(this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''))));\n        if (cnum > 0 && significance < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (isNaN(cnum)) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        if (significance === 0) {\n            return 0;\n        }\n        return Math.ceil(cnum / significance) * significance;\n    };\n    /**\n     * @hidden\n     * @param {string[]} serialNumber - specify the serialNumber.\n     * @returns {number | string} - Compute the DAY.\n     */\n    BasicFormulas.prototype.ComputeDAY = function () {\n        var serialNumber = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            serialNumber[_i] = arguments[_i];\n        }\n        var date = serialNumber;\n        var result;\n        if (isNullOrUndefined(date) || (date.length === 1 && date[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (date.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var dateVal = this.parent.getValueFromArg(date[0].split(this.parent.tic).join(''));\n        if (!isNaN(this.parent.parseFloat(dateVal))) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        // else {\n        //     dateVal = dateVal;\n        // }\n        result = this.parent.parseDate(dateVal);\n        if (Object.prototype.toString.call(result) === '[object Date]') {\n            /* eslint-disable-next-line */\n            result = result.getDate();\n        }\n        return result;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {string | number} - Compute the IF value.\n     */\n    BasicFormulas.prototype.ComputeIF = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (this.parent.getErrorStrings().indexOf(args[0]) > 0) {\n            return args[0];\n        }\n        var argArr = args;\n        var skipTick;\n        if (argArr.length === 4 && argArr[3] === 'nestedFormulaTrue') {\n            skipTick = true;\n            argArr.pop();\n        }\n        var condition;\n        var result;\n        if (argArr.length > 3 || argArr.length === 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        else if (argArr.length <= 3) {\n            condition = this.parent.getValueFromArg(argArr[0]);\n            if (this.parent.getErrorStrings().indexOf(condition) > -1) {\n                return condition;\n            }\n            if (condition === this.parent.trueValue || this.parent.parseFloat(condition) > 0 || this.parent.parseFloat(condition) < 0) {\n                result = this.parent.getValueFromArg(argArr[1]);\n            }\n            else if (condition === this.parent.falseValue || this.parent.parseFloat(condition) === 0) {\n                if (isNullOrUndefined(argArr[2])) {\n                    return this.parent.falseValue;\n                }\n                result = this.parent.getValueFromArg(argArr[2]);\n            }\n            else {\n                return this.parent.formulaErrorStrings[FormulasErrorsStrings.requires_3_args];\n            }\n        }\n        if (!skipTick && result.indexOf(this.parent.tic) > -1) {\n            return result.split(this.parent.tic).join('');\n        }\n        else {\n            return result;\n        }\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {number | string} - Compute the IFERROR value.\n     */\n    BasicFormulas.prototype.ComputeIFERROR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var condition;\n        if (argArr.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        condition = this.parent.getValueFromArg(argArr[0]);\n        if (condition === this.parent.trueValue || condition === this.parent.falseValue) {\n            return condition;\n        }\n        if (condition[0] === this.parent.arithMarker) {\n            condition = condition.replace(this.parent.arithMarker, ' ');\n        }\n        condition = this.parent.getValueFromArg(condition).toUpperCase().split(this.parent.tic).join('');\n        if (condition[0] === '#' || condition.indexOf('Infinity') > -1 || this.parent.getErrorStrings().indexOf(condition) > -1) {\n            return this.parent.getValueFromArg(argArr[1]).split(this.parent.tic).join('');\n        }\n        else {\n            return condition;\n        }\n    };\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range.\n     * @returns {string | number} - Compute the PRODUCT value.\n     */\n    BasicFormulas.prototype.ComputePRODUCT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(range) || (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var product = 1;\n        var val;\n        var orgValue;\n        var argsHit = true;\n        var parseVal;\n        if (!isNullOrUndefined(range)) {\n            var argArr = range;\n            for (var i = 0; i < argArr.length; i++) {\n                var rangevalue = argArr[i];\n                if (rangevalue.indexOf(':') > -1 && this.parent.isCellReference(rangevalue)) {\n                    var cellCollection = this.parent.getCellCollection(rangevalue);\n                    for (var j = 0; j < cellCollection.length; j++) {\n                        val = this.parent.getValueFromArg(cellCollection[j].split(this.parent.tic).join(''));\n                        if (this.parent.getErrorStrings().indexOf(val) > -1) {\n                            return val;\n                        }\n                        val = (val.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                            (val.split(this.parent.tic).join('') === 'FALSE') ? '0' : val;\n                        parseVal = this.parent.parseFloat(val);\n                        if (!isNaN(parseVal)) {\n                            if (val.length > 0) {\n                                product = product * parseVal;\n                                argsHit = false;\n                            }\n                        }\n                    }\n                }\n                else {\n                    orgValue = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    orgValue = (orgValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (orgValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgValue;\n                    parseVal = this.parent.parseFloat(orgValue);\n                    if (!isNaN(parseVal)) {\n                        if (orgValue.length > 0) {\n                            product = product * parseVal;\n                            argsHit = false;\n                        }\n                    }\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                }\n            }\n        }\n        return argsHit ? '0' : product.toString();\n    };\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range.\n     * @returns {string | number} - Compute the Choose value.\n     */\n    BasicFormulas.prototype.ComputeDAYS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var result;\n        if (isNullOrUndefined(range) && (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (range.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsArr = range;\n        if (argsArr[0].split(this.parent.tic).join('') === this.parent.trueValue) {\n            argsArr[0] = '1';\n        }\n        if (argsArr[0].split(this.parent.tic).join('') === this.parent.falseValue) {\n            argsArr[0] = '0';\n        }\n        var endDate = this.parent.getValueFromArg(argsArr[0].split(this.parent.tic).join(''));\n        var startDate = this.parent.getValueFromArg(argsArr[1].split(this.parent.tic).join(''));\n        startDate = (startDate === '' || startDate == null) ? new Date(Date.parse('1899-12-31')).toDateString() : startDate;\n        endDate = (endDate === '' || endDate == null) ? new Date(Date.parse('1899-12-31')).toDateString() : endDate;\n        if (endDate[0] === '#') {\n            return endDate;\n        }\n        if (startDate[0] === '#') {\n            return startDate;\n        }\n        var d1 = this.parent.intToDate(endDate);\n        var d2 = this.parent.intToDate(startDate);\n        if (d1.toString()[0] === '#') {\n            return d1.toString();\n        }\n        if (d2.toString()[0] === '#') {\n            return d2.toString();\n        }\n        if (Object.prototype.toString.call(d1) === '[object Date]' && Object.prototype.toString.call(d2) === '[object Date]') {\n            /* eslint-disable-next-line */\n            result = Math.ceil(d1.getTime() - d2.getTime()) / (1000 * 3600 * 24);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return Math.round(result);\n    };\n    /**\n         * @hidden\n         * @param {string[]} args - specify the range.\n         * @returns {number | string} - Compute the unique.\n         */\n    BasicFormulas.prototype.ComputeUNIQUE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        var result;\n        if (isNullOrUndefined(args) || args[0] === '' || argArr.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var byCol = argArr[1] ? argArr[1].toUpperCase() : 'FALSE';\n        var exactlyOne = argArr[2] ? argArr[2].toUpperCase() : 'FALSE';\n        var uniqueCollection = [];\n        if (argArr[0].indexOf(':') > -1) {\n            var rangeSplit = argArr[0].split(':');\n            if (this.parent.isCellReference(rangeSplit[0]) && this.parent.isCellReference(rangeSplit[1])) {\n                if (this.parent.dependencyCollection.indexOf(argArr[0]) === -1) {\n                    this.parent.dependencyCollection.push(argArr[0]);\n                }\n                else {\n                    this.clearDependency(argArr[0]);\n                }\n                var j = argArr[0].indexOf(':');\n                var swap = void 0;\n                var rowIdx = this.parent.rowIndex(this.parent.substring(argArr[0], 0, j));\n                var colIdx = this.parent.colIndex(this.parent.substring(argArr[0], 0, j));\n                var endRowIdx = this.parent.rowIndex(this.parent.substring(argArr[0], j + 1, j + argArr[0].length - j - 1));\n                var endColIdx = this.parent.colIndex(this.parent.substring(argArr[0], j + 1, j + argArr[0].length - j - 1));\n                if (rowIdx > endRowIdx) {\n                    swap = endRowIdx;\n                    endRowIdx = rowIdx;\n                    rowIdx = swap;\n                }\n                if (colIdx > endColIdx) {\n                    swap = endColIdx;\n                    endColIdx = colIdx;\n                    colIdx = swap;\n                }\n                var sheetIndex = '';\n                if (argArr[0].indexOf('!') === 0) {\n                    sheetIndex = argArr[0];\n                    sheetIndex = sheetIndex.replace('!', '');\n                    sheetIndex = sheetIndex.indexOf('!');\n                    sheetIndex = argArr[0].substring(0, sheetIndex + 2);\n                }\n                argArr[0] = sheetIndex + getAlphalabel(colIdx) + rowIdx + ':' + getAlphalabel(endColIdx) + endRowIdx;\n                var cellRange = this.parent.getCellCollection(argArr[0]);\n                var colDiff = endColIdx - colIdx;\n                var cellValues = [];\n                for (var i = 0; i < cellRange.length; i++) {\n                    cellValues.push(cellRange[i]);\n                }\n                if (byCol === 'FALSE') {\n                    if (colDiff === 0) {\n                        for (var i = 0; i < cellValues.length; i++) {\n                            uniqueCollection.push(this.parent.getValueFromArg(cellValues[i]));\n                        }\n                    }\n                    else {\n                        var temp = '';\n                        var diff = colDiff;\n                        for (var i = 0; i < cellValues.length; i++) {\n                            if (i === cellValues.length - 1) {\n                                temp = temp + this.parent.getValueFromArg(cellValues[i]) + '+';\n                                uniqueCollection.push(temp.substring(0, temp.length - 1));\n                            }\n                            if (i <= diff) {\n                                temp = temp + this.parent.getValueFromArg(cellValues[i]) + '+';\n                            }\n                            else {\n                                uniqueCollection.push(temp.substring(0, temp.length - 1));\n                                diff = colDiff + i;\n                                temp = this.parent.getValueFromArg(cellValues[i]) + '+';\n                            }\n                        }\n                    }\n                }\n                else {\n                    var temp = '';\n                    var diff = colDiff + 1;\n                    var rowDiff = endRowIdx - rowIdx;\n                    for (var i = 0; i < diff; i++) {\n                        for (var j_1 = 0; j_1 <= rowDiff; j_1++) {\n                            temp = temp + this.parent.getValueFromArg(cellValues[j_1 * diff + i]) + '+';\n                        }\n                        uniqueCollection.push(temp.substring(0, temp.length - 1));\n                        temp = '';\n                    }\n                }\n                var tmp = [];\n                var tmp2 = [];\n                for (var i = 0; i < uniqueCollection.length; i++) {\n                    if (tmp.indexOf(uniqueCollection[i]) === -1) {\n                        tmp.push(uniqueCollection[i]);\n                    }\n                    else {\n                        tmp2.push(uniqueCollection[i]);\n                    }\n                }\n                if (exactlyOne === 'TRUE') {\n                    var exactOne = [];\n                    for (var i = 0; i < tmp.length; i++) {\n                        if (tmp2.indexOf(tmp[i]) === -1) {\n                            exactOne.push(tmp[i]);\n                        }\n                    }\n                    tmp = exactOne;\n                }\n                var actCell = this.parent.actCell;\n                var actRowIdx = this.parent.rowIndex(actCell);\n                var actColIdx = this.parent.colIndex(actCell);\n                if (this.parent.dependencyLevel === 0) {\n                    if (byCol === 'FALSE') {\n                        for (var i = actRowIdx, diff = tmp.length + actRowIdx; i < diff; i++) {\n                            var splitValue = tmp[0].split('+');\n                            for (var j_2 = actColIdx, diff2 = splitValue.length + actColIdx; j_2 < diff2; j_2++) {\n                                if (i === diff - 1 && j_2 === diff2 - 1 &&\n                                    this.parent.uniqueRange.indexOf(this.parent.actCell + ':' + getAlphalabel(j_2) + i) === -1) {\n                                    this.parent.uniqueRange.push(this.parent.actCell + ':' + getAlphalabel(j_2) + i);\n                                }\n                            }\n                        }\n                        for (var i = actRowIdx, diff = tmp.length + actRowIdx; i < diff; i++) {\n                            var splitValue = tmp[0].split('+');\n                            for (var j_3 = actColIdx, diff2 = splitValue.length + actColIdx; j_3 < diff2; j_3++) {\n                                var value = this.parent.getValueFromArg(getAlphalabel(j_3) + i, true);\n                                if (value !== '' && value.indexOf('UNIQUE') !== 1) {\n                                    return this.parent.formulaErrorStrings[FormulasErrorsStrings.spill];\n                                }\n                            }\n                        }\n                    }\n                    else {\n                        for (var i = actColIdx, diff = tmp.length + actColIdx; i < diff; i++) {\n                            var splitValue = tmp[0].split('+');\n                            for (var j_4 = actRowIdx, diff2 = splitValue.length + actRowIdx; j_4 < diff2; j_4++) {\n                                if (i === diff - 1 && j_4 === diff2 - 1 &&\n                                    this.parent.uniqueRange.indexOf(this.parent.actCell + ':' + getAlphalabel(i) + j_4) === -1) {\n                                    this.parent.uniqueRange.push(this.parent.actCell + ':' + getAlphalabel(i) + j_4);\n                                }\n                            }\n                        }\n                        for (var i = actColIdx, diff = tmp.length + actColIdx; i < diff; i++) {\n                            var splitValue = tmp[0].split('+');\n                            for (var j_5 = actRowIdx, diff2 = splitValue.length + actRowIdx; j_5 < diff2; j_5++) {\n                                var value = this.parent.getValueFromArg(getAlphalabel(i) + j_5, true);\n                                if (value !== '' && value.indexOf('UNIQUE') !== 1) {\n                                    return this.parent.formulaErrorStrings[FormulasErrorsStrings.spill];\n                                }\n                            }\n                        }\n                    }\n                }\n                else if (this.parent.dependencyLevel > 0 &&\n                    this.parent.getValueFromArg(getAlphalabel(actColIdx) + actRowIdx, true).indexOf('#SPILL!') > -1) {\n                    return this.parent.formulaErrorStrings[FormulasErrorsStrings.spill];\n                }\n                if (byCol === 'FALSE') {\n                    for (var i = 0; i < tmp.length; i++) {\n                        var splitValue = tmp[i].split('+');\n                        if (i > 0) {\n                            actRowIdx++;\n                            actColIdx = this.parent.colIndex(actCell);\n                        }\n                        for (var i_1 = 0; i_1 < splitValue.length; i_1++) {\n                            this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid) + 1, splitValue[i_1], actRowIdx, actColIdx);\n                            if (splitValue[i_1 + 1]) {\n                                actColIdx++;\n                            }\n                        }\n                    }\n                    result = tmp[0].split('+')[0];\n                }\n                else {\n                    for (var i = 0; i < tmp.length; i++) {\n                        var splitValue = tmp[i].split('+');\n                        for (var i_2 = 0; i_2 < splitValue.length; i_2++) {\n                            this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid) + 1, splitValue[i_2], actRowIdx, actColIdx);\n                            if (splitValue[i_2 + 1]) {\n                                actRowIdx++;\n                            }\n                            else {\n                                actColIdx++;\n                                actRowIdx = this.parent.rowIndex(actCell);\n                            }\n                        }\n                    }\n                    result = tmp[0].split('+')[0];\n                }\n            }\n        }\n        else if (this.parent.isCellReference(argArr[0])) {\n            if (this.parent.dependencyCollection.indexOf(argArr[0]) === -1) {\n                this.parent.dependencyCollection.push(argArr[0]);\n            }\n            else {\n                this.clearDependency(argArr[0]);\n            }\n            result = this.parent.getValueFromArg(argArr[0]);\n        }\n        return result;\n    };\n    BasicFormulas.prototype.clearDependency = function (value) {\n        var actCell = this.parent.actCell;\n        var actRowIdx = this.parent.rowIndex(actCell);\n        var actColIdx = this.parent.colIndex(actCell);\n        var j = value.indexOf(':');\n        var rowIndex = this.parent.rowIndex(this.parent.substring(value, 0, j));\n        var colIndex = this.parent.colIndex(this.parent.substring(value, 0, j));\n        var eRowIdx = this.parent.rowIndex(this.parent.substring(value, j + 1, j + value.length - j - 1));\n        var eColIdx = this.parent.colIndex(this.parent.substring(value, j + 1, j + value.length - j - 1));\n        var rowDiff = eRowIdx - rowIndex + actRowIdx;\n        var colDiff = eColIdx - colIndex + actColIdx;\n        var formulaText = this.parent.getFormulaInfoTable().get('!' + this.parent.getSheetID(this.parent.grid) + '!' + actCell) ?\n            this.parent.getFormulaInfoTable().get('!' + this.parent.getSheetID(this.parent.grid) + '!' + actCell).getFormulaText() : '';\n        for (var i = actRowIdx; i <= rowDiff; i++) {\n            for (var j_6 = actColIdx; j_6 <= colDiff; j_6++) {\n                if (this.parent.dependencyLevel > 0 || formulaText.indexOf('UNIQUE') > -1) {\n                    if (this.parent.getValueFromArg('!' + this.parent.getSheetID(this.parent.grid) + '!' +\n                        getAlphalabel(actColIdx) + actRowIdx, true).indexOf('#SPILL!') > -1) {\n                        return;\n                    }\n                    this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid) + 1, null, i, j_6);\n                }\n            }\n        }\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {string | number} - Compute the Choose value.\n     */\n    BasicFormulas.prototype.ComputeCHOOSE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (args.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsArr = args;\n        if (argsArr[0].indexOf(':') > -1 && this.parent.isCellReference(argsArr[0])) {\n            var cellCollection = this.parent.getCellCollection(argsArr[0]);\n            if (cellCollection.length === 1) {\n                argsArr[0] = cellCollection[0];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var cond = this.parent.getValueFromArg(argsArr[0]);\n        if (this.parent.getErrorStrings().indexOf(cond) > -1) {\n            return cond;\n        }\n        var indexNum = this.parent.parseFloat(this.parent.getValueFromArg(argsArr[0].split(this.parent.tic).join('')));\n        if (indexNum < 1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        indexNum = Math.floor(indexNum);\n        var result;\n        if (isNullOrUndefined(argsArr[indexNum])) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        result = argsArr[indexNum];\n        if (result === '') {\n            result = '0';\n        }\n        if (result.indexOf(':') > -1 && this.parent.isCellReference(result)) {\n            var cellCollection = this.parent.getCellCollection(argsArr[0].split(this.parent.tic).join(''));\n            if (cellCollection.length === 1) {\n                argsArr[0] = cellCollection[0];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        return this.parent.getValueFromArg(result).split(this.parent.tic).join('');\n    };\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range.\n     * @returns {string | number} - Compute the SUMIF value.\n     */\n    BasicFormulas.prototype.ComputeSUMIF = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr[0].indexOf(':') < 0 && !this.parent.isCellReference(argArr[0]) ||\n            (argArr[2] && argArr[2].indexOf(':') < 0 && !this.parent.isCellReference(argArr[2]))) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n        }\n        if (argArr.length > 3 || argArr.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var result = this.parent.computeSumIfAndAvgIf(range);\n        if (typeof result === 'string' && (this.parent.formulaErrorStrings.indexOf(result)\n            || this.parent.getErrorStrings().indexOf(result))) {\n            return result;\n        }\n        return result[0];\n    };\n    /**\n     * @hidden\n     * @param {string[]} absValue - specify the absValue.\n     * @returns {string | number} - Compute the AVERAGE value.\n     */\n    BasicFormulas.prototype.ComputeABS = function () {\n        var absValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            absValue[_i] = arguments[_i];\n        }\n        var argArr = absValue;\n        var cellvalue = '';\n        var absVal;\n        if (absValue.length === 0 || absValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argArr[0].toString().split(this.parent.tic).join('').trim() === '' || argArr[0].indexOf(this.parent.tic) > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        if (this.parent.isCellReference(argArr[0])) {\n            cellvalue = this.parent.getValueFromArg(argArr[0]);\n            if (cellvalue === '') {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n            absVal = this.parent.parseFloat(cellvalue);\n            if (isNaN(absVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        else {\n            absVal = this.parent.parseFloat(argArr[0]);\n            if (isNaN(absVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n        }\n        return Math.abs(absVal);\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the range.\n     * @returns {string} - Compute the AVERAGE value.\n     */\n    BasicFormulas.prototype.ComputeAVERAGE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1) {\n                if (argArr[i].indexOf(this.parent.tic) > -1) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n        }\n        return this.parent.calculateAvg(argArr);\n    };\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range.\n     * @returns {string | number} - Compute the AVERAGEIF value.\n     */\n    BasicFormulas.prototype.ComputeAVERAGEIF = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argList = range;\n        if (argList[0].indexOf(':') < 0 && !this.parent.isCellReference(argList[0])) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n        }\n        var resultVal = this.parent.computeSumIfAndAvgIf(range);\n        if (typeof resultVal === 'string' && (this.parent.formulaErrorStrings.indexOf(resultVal)\n            || this.parent.getErrorStrings().indexOf(resultVal))) {\n            return resultVal;\n        }\n        return this.parent.parseFloat(resultVal[0]) / this.parent.parseFloat(resultVal[1]);\n    };\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range.\n     * @returns {string} - Compute the CONCATENATE value.\n     */\n    BasicFormulas.prototype.ComputeCONCATENATE = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(range) || (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argsList = range;\n        var result = '';\n        var tempStr = '';\n        for (var i = 0; i < argsList.length; i++) {\n            if (argsList[i].indexOf(':') > -1 && this.parent.isCellReference(argsList[i])) {\n                if (this.isConcat) {\n                    var cells = this.parent.getCellCollection(argsList[i]);\n                    for (var i_3 = 0; i_3 < cells.length; i_3++) {\n                        tempStr = this.parent.getValueFromArg(cells[i_3]);\n                        result = result + tempStr;\n                    }\n                }\n                else {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n            else {\n                if (argsList.length === 1 && argsList[0].indexOf(this.parent.tic) < 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                else {\n                    tempStr = this.parent.getValueFromArg(argsList[i]);\n                    result = result + tempStr;\n                }\n            }\n            if (this.parent.getErrorStrings().indexOf(tempStr) > -1) {\n                return tempStr;\n            }\n        }\n        return result.split(this.parent.tic).join('');\n    };\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range.\n     * @returns {string} - Compute the CONCAT value.\n     */\n    BasicFormulas.prototype.ComputeCONCAT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        this.isConcat = true;\n        return this.ComputeCONCATENATE.apply(this, range);\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {string | number} - Compute the MAX value.\n     */\n    BasicFormulas.prototype.ComputeMAX = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeMinMax(args, 'max');\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {string} - Compute the MIN value.\n     */\n    BasicFormulas.prototype.ComputeMIN = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeMinMax(args, 'min');\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {string} - Compute the RAND value.\n     */\n    BasicFormulas.prototype.ComputeRAND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (args.length === 1 && args[0] === '') {\n            args.length = 0;\n        }\n        if (args.length > 0) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        return Math.random().toString();\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {string} - Compute the AND value.\n     */\n    BasicFormulas.prototype.ComputeAND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeAndOr(args, 'and');\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the args.\n     * @returns {string} - Compute the OR value.\n     */\n    BasicFormulas.prototype.ComputeOR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeAndOr(args, 'or');\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the range.\n     * @returns {string | number} - Compute the find value.\n     */\n    BasicFormulas.prototype.ComputeFIND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsList = args;\n        if (argsList.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var findText = this.parent.removeTics(this.parent.getValueFromArg(argsList[0]));\n        var withinText = this.parent.removeTics(this.parent.getValueFromArg(argsList[1]));\n        if (this.parent.getErrorStrings().indexOf(findText) > -1 || this.parent.getErrorStrings().indexOf(withinText) > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var startNum = 1;\n        if (argsList.length === 3) {\n            startNum = this.parent.removeTics(this.parent.getValueFromArg(argsList[2]));\n            if (this.parent.getErrorStrings().indexOf(startNum) > -1) {\n                return startNum;\n            }\n            startNum = this.parent.parseFloat(startNum);\n            if (isNaN(startNum)) {\n                startNum = 1;\n            }\n        }\n        if (startNum <= 0 || startNum > withinText.length) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var loc = withinText.indexOf(findText, startNum - 1);\n        if (loc < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return (Number(loc) + Number(1)).toString();\n    };\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range.\n     * @returns {string | number} - Compute the index.\n     */\n    BasicFormulas.prototype.ComputeINDEX = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (isNullOrUndefined(range) || (argArr.length === 1 && argArr[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argCount > 3) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        var rangeValue = '';\n        var rangeArr = [];\n        if (argCount > 2) {\n            for (var i_4 = 0; i_4 < argCount; i_4++) {\n                if (this.parent.isCellReference(argArr[i_4]) && argArr[i_4].indexOf(':') < 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.ref];\n                }\n                if (this.parent.isCellReference(argArr[i_4])) {\n                    rangeArr[i_4] = argArr[i_4];\n                }\n            }\n        }\n        rangeValue = argArr[0];\n        argArr[1] = argArr[1] === '' ? '1' : argArr[1];\n        argArr[1] = this.parent.getValueFromArg(argArr[1]);\n        if (this.parent.getErrorStrings().indexOf(argArr[1]) > -1) {\n            return argArr[1];\n        }\n        if (!isNullOrUndefined(argArr[2])) {\n            argArr[2] = argArr[2] === '' ? '1' : argArr[2];\n            argArr[2] = this.parent.getValueFromArg(argArr[2]);\n            if (this.parent.getErrorStrings().indexOf(argArr[2]) > -1) {\n                return argArr[2];\n            }\n            if (argArr[2] === '0') {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var row = parseFloat(argArr[1]);\n        row = !isNaN(row) ? row : -1;\n        var col = parseFloat(argArr[2] ? argArr[2] : '1');\n        col = !isNaN(col) ? col : -1;\n        if (row === -1 || col === -1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var i = argArr[0].indexOf(':');\n        var startRow = this.parent.rowIndex(rangeValue.substring(0, i));\n        var endRow = this.parent.rowIndex(rangeValue.substring(i + 1));\n        var startCol = this.parent.colIndex(rangeValue.substring(0, i));\n        var endCol = this.parent.colIndex(rangeValue.substring(i + 1));\n        if (row > endRow - startRow + 1 || col > endCol - startCol + 1) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        row = startRow + row - 1;\n        col = startCol + col - 1;\n        var cellRef = this.getSheetReference(rangeValue) + this.parent.convertAlpha(col) + row;\n        var result = this.parent.getValueFromArg(cellRef);\n        if (result === '') {\n            return 0;\n        }\n        return result;\n    };\n    BasicFormulas.prototype.getSheetReference = function (range) {\n        return range.indexOf(this.parent.sheetToken) === 0 && range.lastIndexOf(this.parent.sheetToken) > range.indexOf(this.parent.sheetToken) ? range.substring(0, range.lastIndexOf(this.parent.sheetToken) + 1) : '';\n    };\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range.\n     * @returns {string | number} - Compute the if.\n     */\n    BasicFormulas.prototype.ComputeIFS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (isNullOrUndefined(range) || (argArr.length === 1 && argArr[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var condition = '';\n        var result = '';\n        for (var i = 0; i < argArr.length; i++) {\n            condition = this.parent.getValueFromArg(argArr[i]);\n            if (condition !== this.parent.trueValue && condition !== this.parent.falseValue) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n            if (condition === this.parent.trueValue) {\n                if (argArr[i + 1].indexOf(this.parent.arithMarker) > -1) {\n                    return this.parent.trueValue;\n                }\n                if (this.parent.isCellReference(argArr[i + 1].split(this.parent.tic).join(''))) {\n                    result = this.parent.getValueFromArg(argArr[i + 1]);\n                }\n                else {\n                    result = (argArr[i + 1].indexOf(this.parent.tic) > -1) ? argArr[i + 1].split(this.parent.tic).join('') :\n                        this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                i = i + 1;\n                return result;\n            }\n            else if (condition === this.parent.falseValue) {\n                i = i + 1;\n            }\n        }\n        return this.parent.getErrorStrings()[CommonErrors.na];\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the range.\n     * @returns {number | string} - Compute the count.\n     */\n    BasicFormulas.prototype.ComputeCOUNTA = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.parent.isCellReference(argArr[i])) {\n                cellColl = this.parent.getCellCollection(argArr[i].split(this.parent.tic).join(''));\n                for (var j = 0; j < cellColl.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellColl[j]);\n                    if (cellValue.length > 0) {\n                        result++;\n                    }\n                }\n            }\n            else {\n                var cellValue_1 = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                if (cellValue_1.length > 0) {\n                    result++;\n                }\n            }\n        }\n        return result;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the range.\n     * @returns {number | string} - Compute the average.\n     */\n    BasicFormulas.prototype.ComputeAVERAGEA = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArrs = args;\n        var cellCol;\n        var result = 0;\n        var cellValue;\n        var length = 0;\n        var parseValue;\n        for (var k = 0; k < argArrs.length; k++) {\n            if (argArrs[k].indexOf(':') > -1 && this.parent.isCellReference(argArrs[k])) {\n                cellCol = this.parent.getCellCollection(argArrs[k].split(this.parent.tic).join(''));\n                for (var j = 0; j < cellCol.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellCol[j]);\n                    if (cellValue.toUpperCase() === this.parent.trueValue) {\n                        cellValue = '1';\n                    }\n                    else if (cellValue.toUpperCase() === this.parent.falseValue || cellValue === '') {\n                        cellValue = '0';\n                    }\n                    else if (this.parent.getErrorStrings().indexOf(cellValue) > -1) {\n                        return cellValue;\n                    }\n                    else if (cellValue.length > 0) {\n                        parseValue = parseFloat(cellValue);\n                        cellValue = !isNaN(parseValue) ? parseValue : 0;\n                        result = result + cellValue;\n                        length = length + 1;\n                    }\n                }\n                length = cellCol.length;\n            }\n            else {\n                if (argArrs[k] === this.parent.trueValue) {\n                    argArrs[k] = '1';\n                }\n                if (argArrs[k] === this.parent.falseValue || argArrs[k] === '') {\n                    argArrs[k] = '0';\n                }\n                cellValue = this.parent.getValueFromArg(argArrs[k].split(this.parent.tic).join(''));\n                if (this.parent.getErrorStrings().indexOf(cellValue) > -1) {\n                    return cellValue;\n                }\n                if (cellValue.length > 0) {\n                    parseValue = parseFloat(cellValue);\n                    cellValue = !isNaN(parseValue) ? parseValue : 0;\n                    result = result + cellValue;\n                    length = length + 1;\n                }\n            }\n            if (length === 0) {\n                return this.parent.getErrorStrings()[CommonErrors.divzero];\n            }\n        }\n        return result / length;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the range.\n     * @returns {number | string} - Compute the count if.\n     */\n    BasicFormulas.prototype.ComputeSORT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        var result;\n        if (isNullOrUndefined(args) || args[0] === '' || argArr.length > 4) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        argArr[1] = argArr[1] ? argArr[1] : '1';\n        argArr[2] = argArr[2] ? argArr[2] : '1'; // 1 = Ascending, -1 = Descending. Default is ascending order.\n        var order = argArr[2] === '1' ? 'Ascending' : 'Descending';\n        argArr[3] = argArr[3] ? argArr[3].toUpperCase() : 'FALSE'; // Default is FALSE = sort by column or row\n        argArr[0] = argArr[0].split('$').join('');\n        var cellCollection;\n        var valueCollection = [];\n        if (argArr[0].indexOf(':') > -1) {\n            var rangeSplit = argArr[0].split(':');\n            if (this.parent.isCellReference(rangeSplit[0]) && this.parent.isCellReference(rangeSplit[1])) {\n                var j = argArr[0].indexOf(':');\n                var swap = void 0;\n                var rowIdx = this.parent.rowIndex(this.parent.substring(argArr[0], 0, j));\n                var colIdx = this.parent.colIndex(this.parent.substring(argArr[0], 0, j));\n                var eRowIdx = this.parent.rowIndex(this.parent.substring(argArr[0], j + 1, j + argArr[0].length - j - 1));\n                var eColIdx = this.parent.colIndex(this.parent.substring(argArr[0], j + 1, j + argArr[0].length - j - 1));\n                if (rowIdx > eRowIdx) {\n                    swap = eRowIdx;\n                    eRowIdx = rowIdx;\n                    rowIdx = swap;\n                }\n                if (colIdx > eColIdx) {\n                    swap = eColIdx;\n                    eColIdx = colIdx;\n                    colIdx = swap;\n                }\n                argArr[2] = this.parent.getValueFromArg(argArr[2]);\n                if (argArr[2] !== '1') {\n                    if (argArr[2] !== '-1') {\n                        return this.parent.getErrorStrings()[CommonErrors.value];\n                    }\n                }\n                if (!isNaN(this.parseDouble(argArr[1])) && this.parseDouble(argArr[1]) < 1) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n                if (argArr[3].toUpperCase() !== this.parent.trueValue) {\n                    if (argArr[3].toUpperCase() !== this.parent.falseValue) {\n                        return this.parent.getErrorStrings()[CommonErrors.value];\n                    }\n                }\n                var sheetIdx = '';\n                if (argArr[0].indexOf('!') === 0) {\n                    sheetIdx = argArr[0];\n                    sheetIdx = sheetIdx.replace('!', '');\n                    sheetIdx = sheetIdx.indexOf('!');\n                    sheetIdx = argArr[0].substring(0, sheetIdx + 2);\n                }\n                argArr[0] = sheetIdx + getAlphalabel(colIdx) + rowIdx + ':' + getAlphalabel(eColIdx) + eRowIdx;\n                cellCollection = this.parent.getCellCollection(argArr[0]);\n                for (var i = 0; i < cellCollection.length; i++) {\n                    valueCollection.push(this.parent.getValueFromArg(cellCollection[i]));\n                }\n                var colSort = [];\n                var totalColumn = eColIdx - colIdx + 1;\n                if (argArr[3] === 'TRUE') {\n                    for (var i = 0; i < totalColumn; i++) {\n                        if (valueCollection[i + ((this.parseDouble(argArr[1]) - 1) * totalColumn)]) {\n                            colSort.push(isNaN(this.parseDouble(valueCollection[i + ((this.parseDouble(argArr[1]) - 1) * totalColumn)])) ?\n                                valueCollection[i + ((this.parseDouble(argArr[1]) - 1) * totalColumn)] :\n                                this.parseDouble(valueCollection[i + ((this.parseDouble(argArr[1]) - 1) * totalColumn)]));\n                        }\n                    }\n                }\n                if (argArr[3] === 'FALSE') {\n                    for (var i = 0; i < valueCollection.length; i++) {\n                        if (valueCollection[i * totalColumn + this.parseDouble(argArr[1]) - 1]) {\n                            colSort.push(isNaN(this.parseDouble(valueCollection[i * totalColumn + this.parseDouble(argArr[1]) - 1])) ?\n                                valueCollection[i * totalColumn + this.parseDouble(argArr[1]) - 1] :\n                                this.parseDouble(valueCollection[i * totalColumn + this.parseDouble(argArr[1]) - 1]));\n                        }\n                    }\n                }\n                var sortedVal = DataUtil.sort(colSort, null, DataUtil.fnSort(order));\n                var id = [];\n                for (var a = 0; a < sortedVal.length; a++) {\n                    for (var b = 0; b < colSort.length; b++) {\n                        if (JSON.stringify(sortedVal[a]) === JSON.stringify(colSort[b])) {\n                            if (id.indexOf(b) === -1) {\n                                id.push(b);\n                            }\n                        }\n                    }\n                }\n                if (argArr[3] === 'TRUE') {\n                    for (var startRow = rowIdx, rowInc = 0; startRow <= eRowIdx; startRow++, rowInc++) {\n                        for (var a = 0, colInc = 0; a < id.length; a++, colInc++) {\n                            var cellValue = this.parent.getValueFromArg(sheetIdx + getAlphalabel(id[a] + colIdx) + startRow);\n                            var activeCell = this.parent.actCell;\n                            var actRowIdx = this.parent.rowIndex(activeCell);\n                            var actColIdx = this.parent.colIndex(activeCell);\n                            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                            this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid) + 1, cellValue, actRowIdx + rowInc, actColIdx + colInc);\n                        }\n                    }\n                    result = this.parent.getValueFromArg(sheetIdx + getAlphalabel(id[0] + colIdx) + rowIdx);\n                }\n                if (argArr[3] === 'FALSE') {\n                    for (var a = 0, rowInc = 0; a < id.length; a++, rowInc++) {\n                        for (var startCol = colIdx, colInc = 0; startCol <= eColIdx; startCol++, colInc++) {\n                            var value = this.parent.getValueFromArg(sheetIdx + getAlphalabel(startCol) + (id[a] + rowIdx));\n                            var activeCell = this.parent.actCell;\n                            var actRowIdx = this.parent.rowIndex(activeCell);\n                            var actColIdx = this.parent.colIndex(activeCell);\n                            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                            this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid) + 1, value, actRowIdx + rowInc, actColIdx + colInc);\n                        }\n                    }\n                    result = this.parent.getValueFromArg(sheetIdx + getAlphalabel(colIdx) + (id[0] + rowIdx));\n                }\n            }\n        }\n        return result;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the range.\n     * @returns {number | string} - Compute the count if.\n     */\n    BasicFormulas.prototype.ComputeCOUNTIF = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        if (isNullOrUndefined(args) || args[0] === '' || argArr.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        var stack = [];\n        var op = 'equal';\n        var condition = argArr[1].split(this.parent.tic).join('');\n        if (condition.startsWith('<=')) {\n            op = 'lessEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('>=')) {\n            op = 'greaterEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('<>')) {\n            op = 'notEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('<')) {\n            op = 'less';\n            condition = condition.substring(1);\n        }\n        else if (condition.startsWith('>')) {\n            op = 'greater';\n            condition = condition.substring(1);\n        }\n        else if (condition.startsWith('=')) {\n            op = 'equal';\n            condition = condition.substring(1);\n        }\n        if (argArr[0].indexOf(':') > -1 && this.parent.isCellReference(argArr[0])) {\n            cellColl = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n            for (var j = 0; j < cellColl.length; j++) {\n                cellValue = this.parent.getValueFromArg(cellColl[j]);\n                if (condition.indexOf('*') > -1 || condition.indexOf('?') > -1) {\n                    cellValue = this.parent.findWildCardValue(condition, cellValue);\n                }\n                stack.push(cellValue);\n                stack.push(condition);\n                if (this.parent.processLogical(stack, op) === this.parent.trueValue) {\n                    result++;\n                }\n            }\n        }\n        return result;\n    };\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range.\n     * @returns {string | number} - Compute the sum if.\n     */\n    BasicFormulas.prototype.ComputeSUMIFS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var sum = this.parent.computeIfsFormulas(range, this.parent.falseValue);\n        return sum;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the range.\n     * @returns {string | number} - Compute the Text.\n     */\n    BasicFormulas.prototype.ComputeTEXT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var checkArgs;\n        var argsLength = args.length;\n        for (var i = 0; i < argsLength; i++) {\n            if (isNullOrUndefined(checkArgs)) {\n                checkArgs = args[i];\n            }\n            else {\n                checkArgs = checkArgs + ',' + args[i];\n            }\n        }\n        var splitIndex = checkArgs.indexOf(',');\n        var frtArg = checkArgs.slice(0, splitIndex);\n        var scndArg = checkArgs.slice(checkArgs.indexOf('\"') + 1, checkArgs.length);\n        var checkScndArg = scndArg.indexOf('\"');\n        if (splitIndex > -1 && checkScndArg !== scndArg.length - 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var s1 = frtArg;\n        var s2 = scndArg.slice(0, scndArg.length - 1);\n        var dTime = new Date(1900, 0, 1, 0, 0, 0);\n        var checkString = s1 + ',' + s2;\n        var intl = new Internationalization();\n        if (this.parent.getErrorStrings().indexOf(checkString) > -1) {\n            return checkString;\n        }\n        s1 = this.parent.getValueFromArg(s1);\n        s2 = s2.split(this.parent.tic).join('');\n        if (s2 === '') {\n            return '';\n        }\n        if (s1 === '' && (s2.length > 0 && (s2.toUpperCase().indexOf('M') > -1 || s2.toUpperCase().indexOf('D') > -1\n            || s2.toUpperCase().indexOf('Y') > -1 || s2.toUpperCase().indexOf('S') > -1 || s2.toUpperCase().indexOf('T') > -1)\n            || s2.toUpperCase().indexOf('H') > -1)) {\n            s1 = dTime.toString();\n        }\n        var d = this.parseDouble(s1);\n        if (isNaN(d) && this.parent.isDate(new Date(s1)) !== null) {\n            d = this.parent.toOADate(new Date(s1));\n        }\n        dTime = Date.parse(s1.split(this.parent.tic).join(''));\n        if (!isNaN(d) || !isNaN(dTime)) {\n            if (s2[0] === '[') {\n                return this.parent.tic + s1 + this.parent.tic;\n            }\n            if (s2.length > 0 && (s2.toUpperCase().indexOf('M') > -1 || s2.toUpperCase().indexOf('D') > -1\n                || s2.toUpperCase().indexOf('Y') > -1 || s2.toUpperCase().indexOf('S') > -1 || s2.toUpperCase().indexOf('T') > -1)\n                || s2.toUpperCase().indexOf('H') > -1) {\n                s2 = s2.split('Y').join('y').split('D').join('d').split('H').join('h');\n                s2 = s2.split('S').join('s').split('m').join('M').split('AM/PM').join('tt');\n                var formatChar = s2.split('');\n                var isH = false;\n                var isMFound = false;\n                var i = 0;\n                // let mcount: number = 0;\n                var lastCharIndex = 0;\n                var totalCharforM = 0;\n                for (i = 0; i < formatChar.length;) {\n                    var c = formatChar[i];\n                    if (c === 's' && formatChar[lastCharIndex] === 'M') {\n                        formatChar[lastCharIndex] = 'm';\n                        if (formatChar[lastCharIndex - 1] === 'M') {\n                            formatChar[lastCharIndex - 1] = 'm';\n                        }\n                    }\n                    if (this.parent.isChar(c)) {\n                        lastCharIndex = i;\n                        if (c === 'M') {\n                            // mcount++;\n                            totalCharforM++;\n                        }\n                    }\n                    else if (totalCharforM > 1) {\n                        totalCharforM++;\n                    }\n                    if (c === 'M' && isH) {\n                        formatChar[i] = 'm';\n                        isMFound = true;\n                    }\n                    if (c === 'h') {\n                        isH = true;\n                    }\n                    else if (this.parent.isChar(c) && c !== 'M' && c !== 'h' && !isMFound) {\n                        isH = false;\n                        isMFound = false;\n                    }\n                    i++;\n                }\n                s2 = String(formatChar);\n                s2 = s2.split(',').join('').split('\\n').join(' ');\n                var dt = this.parent.fromOADate(d);\n                if (d === 0) {\n                    dt = dTime;\n                }\n                var getSkeleton = getSkeletonVal(s2);\n                if (getSkeleton === '') {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                var dFormatter = intl.getDateFormat({ skeleton: getSkeleton, type: 'date' });\n                var formattedString = dFormatter(new Date(dt.toString()));\n                s1 = formattedString;\n            }\n            else {\n                s1 = intl.formatNumber(d, { format: s2 });\n            }\n        }\n        return s1;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the range.\n     * @returns {number | string} - Compute the count if.\n     */\n    BasicFormulas.prototype.ComputeCOUNTIFS = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum = this.parent.computeIfsFormulas(args, this.parent.trueValue);\n        return sum;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the range.\n     * @returns {number | string} - Compute the Average if.\n     */\n    BasicFormulas.prototype.ComputeAVERAGEIFS = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum = this.parent.computeIfsFormulas(args, this.parent.falseValue, this.parent.trueValue);\n        return sum;\n    };\n    /**\n     * @hidden\n     * @param {string[]} args - specify the range.\n     * @returns {string | number} - Compute the Match.\n     */\n    BasicFormulas.prototype.ComputeMATCH = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 2 || argArr.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellColl;\n        var cellValue = [];\n        var lookupVal = argArr[0].split(this.parent.tic).join('');\n        if (this.parent.isCellReference(lookupVal)) {\n            lookupVal = this.parent.getValueFromArg(lookupVal);\n        }\n        if (!lookupVal.toString().length) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        argArr[2] = isNullOrUndefined(argArr[2]) ? '1' : argArr[2].split(this.parent.tic).join('');\n        if (argArr[2].split(this.parent.tic).join('') === this.parent.trueValue) {\n            argArr[2] = '1';\n        }\n        if (argArr[2].split(this.parent.tic).join('') === this.parent.falseValue) {\n            argArr[2] = '0';\n        }\n        var matchType = parseFloat(argArr[2]);\n        if (matchType !== -1 && matchType !== 0 && matchType !== 1) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        var index = 0;\n        var indexVal = '';\n        if (argArr[1].indexOf(':') > -1 || this.parent.isCellReference(argArr[1])) {\n            cellColl = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n            for (var j = 0; j < cellColl.length; j++) {\n                cellValue[j] = this.parent.getValueFromArg(cellColl[j]).split(this.parent.tic).join('');\n            }\n            for (var i = 0; i < cellValue.length; i++) {\n                if (!cellValue[i].toString().length) {\n                    continue;\n                }\n                if (matchType === 1) {\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    else if (lookupVal > cellValue[i]) {\n                        if (!indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                        else if (cellValue[i] > indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                    }\n                }\n                else if (matchType === 0) {\n                    if (lookupVal.indexOf('*') > -1 || lookupVal.indexOf('?') > -1) {\n                        cellValue[i] = this.parent.findWildCardValue(lookupVal, cellValue[i]);\n                    }\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    if (this.parent.parseFloat(lookupVal) === this.parent.parseFloat(cellValue[i])) {\n                        return i + 1;\n                    }\n                }\n                else if (matchType === -1) {\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    else if (lookupVal < cellValue[i]) {\n                        if (!indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                        else if (cellValue[i] < indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                    }\n                }\n            }\n        }\n        return index ? index : this.parent.getErrorStrings()[CommonErrors.na];\n    };\n    // /**\n    //  * @hidden\n    //  * @param {string[]} range - specify the range.\n    //  * @returns {string | number} - Compute the lookup value.\n    //  */\n    // public ComputeLOOKUP(...range: string[]): string | number {\n    //     const argArr: string[] = range;\n    //     let result: string = '';\n    //     if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 2 || argArr.length > 3) {\n    //         return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n    //     }\n    //     result = this.parent.computeLookup(argArr);\n    //     return result;\n    // }\n    // /**\n    //  * @hidden\n    //  * @param {string[]} range - specify the range.\n    //  * @returns {string | number} - Compute the vlookup value.\n    //  */\n    // public ComputeVLOOKUP(...range: string[]): string | number {\n    //     const argArr: string[] = range;\n    //     let result: string = '';\n    //     if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 3 || argArr.length > 4) {\n    //         return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n    //     }\n    //     result = this.parent.computeVLookup(argArr);\n    //     return result;\n    // }\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range.\n     * @returns {string | number} - Compute the sub total value.\n     */\n    BasicFormulas.prototype.ComputeSUBTOTAL = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (argArr.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var formula = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join('')));\n        // if (isNaN(formula)) {\n        //     this.parent.getErrorStrings()[CommonErrors.value];\n        // }\n        // if ((formula < 1 || formula > 11) && (formula < 101 || formula > 111)) {\n        //     this.parent.getErrorStrings()[CommonErrors.value];\n        // }\n        var cellRef = argArr.slice(1, argArr.length);\n        switch (formula) {\n            case 1:\n            case 101:\n                result = this.ComputeAVERAGE.apply(this, cellRef);\n                break;\n            case 2:\n            case 102:\n                result = this.ComputeCOUNT.apply(this, cellRef);\n                break;\n            case 3:\n            case 103:\n                result = this.ComputeCOUNTA.apply(this, cellRef);\n                break;\n            case 4:\n            case 104:\n                result = this.ComputeMAX.apply(this, cellRef);\n                break;\n            case 5:\n            case 105:\n                result = this.ComputeMIN.apply(this, cellRef);\n                break;\n            case 6:\n            case 106:\n                result = this.ComputePRODUCT.apply(this, cellRef);\n                break;\n            case 7:\n            case 107:\n                result = this.ComputeDAY.apply(this, cellRef);\n                break;\n            case 8:\n            case 108:\n                result = this.ComputeCONCAT.apply(this, cellRef);\n                break;\n            case 9:\n            case 109:\n                result = this.ComputeSUM.apply(this, cellRef);\n                break;\n            case 10:\n            case 110:\n                result = this.ComputeAVERAGEA.apply(this, cellRef);\n                break;\n            case 11:\n            case 111:\n                result = this.ComputeABS.apply(this, cellRef);\n                break;\n            default:\n                result = this.parent.getErrorStrings()[CommonErrors.value];\n                break;\n        }\n        return result;\n    };\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range.\n     * @returns {string | number} - Compute the Radians value.\n     */\n    BasicFormulas.prototype.ComputeRADIANS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result;\n        if (argArr[0] === '' || argArr.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argArr[0].indexOf(':') > -1 || argArr[0].split(this.parent.tic).join('') === '') {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var val = argArr[0].split(this.parent.tic).join('');\n        argArr[0] = isNaN(this.parent.parseFloat(val)) ? argArr[0] : val;\n        var cellvalue = this.parent.getValueFromArg(argArr[0]);\n        var radVal = this.parent.parseFloat(cellvalue);\n        if (!isNaN(radVal)) {\n            result = Math.PI * (radVal) / 180;\n        }\n        else {\n            if (cellvalue.indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n        }\n        return result;\n    };\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range.\n     * @returns {string | number} - Compute the random between value.\n     */\n    BasicFormulas.prototype.ComputeRANDBETWEEN = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argsLength = range.length;\n        var min;\n        var max;\n        var argVal;\n        if (argsLength !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var i = 0; i < argsLength; i++) {\n            if (range[i] === '') {\n                return this.parent.getErrorStrings()[CommonErrors.na];\n            }\n            if (range[i].indexOf(this.parent.tic) > -1) {\n                if (isNaN(parseFloat(range[i].split(this.parent.tic).join('')))) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n                else {\n                    range[i] = range[i].split(this.parent.tic).join('');\n                }\n            }\n            argVal = parseFloat(this.parent.getValueFromArg(range[i]));\n            if (!this.parent.isCellReference(range[i])) {\n                if (isNaN(argVal)) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                if (i === 0) {\n                    min = argVal;\n                }\n                else {\n                    max = argVal;\n                }\n            }\n            else {\n                argVal = this.parent.getValueFromArg(range[i]) === '' ? 0 : argVal;\n                if (i === 0) {\n                    min = argVal;\n                }\n                else {\n                    max = argVal;\n                }\n                if (min === 0 && max === 0) {\n                    return '0';\n                }\n                if (isNaN(argVal)) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n        }\n        if (max < min) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (min === 0) {\n            return Math.floor(Math.random() * (max - (min - 1))) + min;\n        }\n        else {\n            return max - min === 1 ? Math.round((Math.random() * (max - min)) + min) : Math.floor(Math.random() * (max - (min - 1))) + min;\n        }\n    };\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range.\n     * @returns {string | number} - Compute the slope value.\n     */\n    BasicFormulas.prototype.ComputeSLOPE = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr.length !== 2 || argArr[0] === '') {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var xPointsRange = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n        var yPointsRange = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n        if (yPointsRange.length !== xPointsRange.length) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        var yPoints = this.getDataCollection(yPointsRange);\n        var xPoints = this.getDataCollection(xPointsRange);\n        if (xPoints.indexOf('#NAME?') > -1 || yPoints.indexOf('#NAME?') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var sumXY = 0;\n        var sumX2 = 0;\n        var sumX = 0;\n        var sumY = 0;\n        for (var i = 0, len = xPoints.length; i < len; ++i) {\n            if (Number(xPoints[i]).toString() !== 'NaN' && Number(yPoints[i]).toString() !== 'NaN') {\n                sumXY += Number(xPoints[i]) * Number(yPoints[i]);\n                sumX += Number(xPoints[i]);\n                sumY += Number(yPoints[i]);\n                sumX2 += Number(xPoints[i]) * Number(xPoints[i]);\n            }\n        }\n        // if ((sumXY - sumX * sumY) === 0 || (sumX2 - sumX * sumX) === 0) {\n        //     this.parent.getErrorStrings()[CommonErrors.divzero];\n        // }\n        var result = ((sumXY - sumX * sumY / xPoints.length) / (sumX2 - sumX * sumX / xPoints.length)).toString();\n        if (result === 'NaN') {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        return result;\n    };\n    /**\n     * @hidden\n     * @param {string[]} range - specify the range.\n     * @returns {string | number} - Compute the intercept.\n     */\n    BasicFormulas.prototype.ComputeINTERCEPT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr[0] === '' || argArr.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var yValuesRange = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n        var xValuesRange = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n        if (yValuesRange.length !== xValuesRange.length) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        var xValues = this.getDataCollection(xValuesRange);\n        var yValues = this.getDataCollection(yValuesRange);\n        if (xValues.indexOf('#NAME?') > -1 || yValues.indexOf('#NAME?') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var sumX = 0;\n        var sumY = 0;\n        for (var i = 0, len = xValues.length; i < len; ++i) {\n            sumX += Number(xValues[i]);\n            sumY += Number(yValues[i]);\n        }\n        sumX = sumX / xValues.length;\n        sumY = sumY / xValues.length;\n        var sumXY = 0;\n        var sumX2 = 0;\n        var diff;\n        for (var i = 0, len = xValues.length; i < len; ++i) {\n            diff = Number(xValues[i]) - sumX;\n            sumXY += diff * (Number(yValues[i]) - sumY);\n            sumX2 += diff * diff;\n        }\n        var result = (sumY - sumXY / sumX2 * sumX).toString();\n        // if ((sumY - sumXY) === 0 || (sumX2 * sumX) === 0) {\n        //     this.parent.getErrorStrings()[CommonErrors.divzero];\n        // }\n        if (result === 'NaN') {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        return result;\n    };\n    /**\n     * @hidden\n     * @param {string[]} logValue - specify the log value.\n     * @returns {string | number} - Compute the value.\n     */\n    BasicFormulas.prototype.ComputeLN = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var cellvalue = '';\n        var logVal;\n        var orgValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (this.parent.isCellReference(argArr[0])) {\n            cellvalue = this.parent.getValueFromArg(argArr[0]);\n            logVal = this.parent.parseFloat(cellvalue);\n            if (logVal <= 0 || cellvalue === '') {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            if (isNaN(logVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        else {\n            orgValue = this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''));\n            logVal = this.parent.parseFloat(orgValue);\n            if (logVal <= 0 || logVal.toString() === '') {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            if (isNaN(logVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        return Math.log(logVal);\n    };\n    /**\n     * @hidden\n     * @param {string[]} logValue - specify the log value.\n     * @returns {boolean | string} - Compute the Isnumber value.\n     */\n    BasicFormulas.prototype.ComputeISNUMBER = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var orgValue = (this.parent.isCellReference(argArr[0])) ? this.parent.getValueFromArg(argArr[0]) :\n            this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''));\n        if (orgValue.toString() === '') {\n            return false;\n        }\n        var logVal = this.parent.parseFloat(orgValue);\n        return !isNaN(logVal) ? true : false;\n    };\n    /**\n     * @hidden\n     * @param {string[]} logValue - specify the log value.\n     * @returns {number | string} - Compute the round value.\n     */\n    BasicFormulas.prototype.ComputeROUND = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgValue;\n        var x = 0;\n        var digits = 0;\n        var round;\n        var numStr;\n        var digStr;\n        var mult;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (logValue.length === 1) {\n            orgValue = (argArr[0].split(this.parent.tic).join('') === 'TRUE')\n                ? '1'\n                : (argArr[0].split(this.parent.tic).join('') === 'FALSE')\n                    ? '0'\n                    : argArr[0];\n            return Math.round(this.parent.parseFloat(orgValue)).toString();\n        }\n        numStr = this.parent.getValueFromArg(argArr[0]);\n        digStr = (argArr[1].split(this.parent.tic).join('')) === '' ? '0' :\n            this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''));\n        numStr = (numStr.split(this.parent.tic).join('') === 'TRUE')\n            ? '1'\n            : (numStr.split(this.parent.tic).join('') === 'FALSE')\n                ? '0' : numStr;\n        digStr = (digStr.split(this.parent.tic).join('') === 'TRUE') ? '1'\n            : (digStr.split(this.parent.tic).join('') === 'FALSE')\n                ? '0' : digStr;\n        if (numStr !== '' && digStr !== '') {\n            x = this.parent.parseFloat(numStr);\n            digits = this.parent.parseFloat(digStr);\n            if (!isNaN(digits) && !isNaN(x) && digits > 0) {\n                round = x.toFixed(digits);\n            }\n            else {\n                mult = Math.pow(10, -digits);\n                round = Math.round(x / mult) * mult;\n            }\n        }\n        return round.toString();\n    };\n    /**\n     * @hidden\n     * @param {string[]} logValue - specify the log value.\n     * @returns {boolean | string} - Compute the power value.\n     */\n    BasicFormulas.prototype.ComputePOWER = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var power;\n        var orgNumValue;\n        var orgPowValue;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgPowValue = this.parent.getValueFromArg(argArr[1]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        orgPowValue = (orgPowValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgPowValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgPowValue;\n        var logNumValue = this.parent.parseFloat(orgNumValue);\n        var logPowValue = this.parent.parseFloat(orgPowValue);\n        if (!isNaN(logNumValue) && !isNaN(logPowValue)) {\n            if (logNumValue === 0 && logPowValue < 0) {\n                return this.parent.getErrorStrings()[CommonErrors.divzero];\n            }\n            if (logNumValue === 0 && logPowValue === 0) {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            power = Math.pow(logNumValue, logPowValue);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return power.toString();\n    };\n    /**\n     * @hidden\n     * @param {string[]} logValue - specify the log value.\n     * @returns {number | string} - Compute the log value.\n     */\n    BasicFormulas.prototype.ComputeLOG = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        var orgBaseValue;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgBaseValue = (logValue.length === 2) ? this.parent.getValueFromArg(argArr[1]) : '10';\n        if ((orgNumValue === '' || orgNumValue === null) || (orgBaseValue === '' || orgBaseValue === null)) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        orgBaseValue = (orgBaseValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgBaseValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgBaseValue;\n        var logNumValue = this.parent.parseFloat(orgNumValue);\n        var logBaseValue = this.parent.parseFloat(orgBaseValue);\n        if (logNumValue <= 0 || logBaseValue <= 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (logBaseValue === 1) {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        if (!isNaN(logNumValue) && !isNaN(logBaseValue)) {\n            return ((Math.log(logNumValue) / Math.LN10) / (Math.log(logBaseValue) / Math.LN10)).toString();\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n    };\n    /**\n     * @hidden\n     * @param {string[]} logValue - specify the log value.\n     * @returns {boolean | string} - Compute the trunc value.\n     */\n    BasicFormulas.prototype.ComputeTRUNC = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        var orgDigitValue = 0;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (logValue.length === 2) {\n            orgDigitValue = this.parent.getValueFromArg(argArr[1]);\n            orgDigitValue = (orgDigitValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                (orgDigitValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgDigitValue;\n            orgDigitValue = this.parent.parseFloat(orgDigitValue);\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        var logNumValue = this.parent.parseFloat(orgNumValue.split(this.parent.tic).join(''));\n        if (isNaN(logNumValue) || isNaN(orgDigitValue)) {\n            return (argArr[0] === this.parent.tic || this.parent.isCellReference(argArr[0]) || (argArr[1] === this.parent.tic\n                || this.parent.isCellReference(argArr[1]))) ? this.parent.getErrorStrings()[CommonErrors.value]\n                : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var normalizer = Math.pow(10, orgDigitValue);\n        var logDigitValue = (logNumValue < 0) ? -1 : 1;\n        return (logDigitValue * Math.floor(normalizer * Math.abs(logNumValue)) / normalizer).toString();\n    };\n    /**\n     * @hidden\n     * @param {string[]} logValue - specify the log value.\n     * @returns {boolean | string} - Compute the expression.\n     */\n    BasicFormulas.prototype.ComputeEXP = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        if (orgNumValue === '') {\n            orgNumValue = '0';\n        }\n        var logNumValue = this.parent.parseFloat(orgNumValue);\n        if (logNumValue > 709) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (isNaN(logNumValue)) {\n            return (argArr[0] === this.parent.tic || this.parent.isCellReference(argArr[0])) ?\n                this.parent.getErrorStrings()[CommonErrors.value]\n                : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return Math.exp(logNumValue).toString();\n    };\n    /**\n     * @hidden\n     * @param {string[]} logValue - specify the log value\n     * @returns {boolean | string} - compute the value.\n     */\n    BasicFormulas.prototype.ComputeGEOMEAN = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var sum = 1;\n        var count = 0;\n        var cellVal = 0;\n        var dev;\n        var r;\n        var s;\n        var cell;\n        if (logValue.length === 0) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (r = 0; r < argArr.length; r++) {\n            if (argArr[r].indexOf(':') > -1) {\n                if (argArr[0] === this.parent.tic) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n                cell = this.parent.getCellCollection(argArr[r].split(this.parent.tic).join(''));\n                for (s = 0; s < cell.length; s++) {\n                    cellVal = this.parent.getValueFromArg(cell[s]);\n                    cellVal = (cellVal.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (cellVal.split(this.parent.tic).join('') === 'FALSE') ? '0' : cellVal;\n                    dev = this.parent.parseFloat(cellVal);\n                    if (dev <= 0) {\n                        return this.parent.getErrorStrings()[CommonErrors.num];\n                    }\n                    else if (!isNaN(dev)) {\n                        count++;\n                        sum = sum * dev;\n                    }\n                }\n            }\n            else {\n                cellVal = this.parent.getValueFromArg(argArr[r]);\n                if (cellVal.length > 0) {\n                    cellVal = (cellVal.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (cellVal.split(this.parent.tic).join('') === 'FALSE') ? '0' : cellVal;\n                    if (!this.parent.isCellReference(argArr[r])) {\n                        if (isNaN(this.parent.parseFloat(cellVal))) {\n                            return this.parent.getErrorStrings()[CommonErrors.name];\n                        }\n                    }\n                    dev = this.parent.parseFloat(cellVal);\n                    if (dev <= 0) {\n                        return this.parent.getErrorStrings()[CommonErrors.num];\n                    }\n                    else if (!isNaN(dev)) {\n                        count++;\n                        sum = sum * dev;\n                    }\n                }\n            }\n        }\n        if (count > 0) {\n            sum = Math.pow(sum, 1 / count);\n        }\n        return sum.toString();\n    };\n    BasicFormulas.prototype.getDataCollection = function (cells) {\n        var cellsData = [];\n        for (var i = 0, len = cells.length; i < len; i++) {\n            cellsData.push(this.parent.getValueFromArg(cells[i]));\n        }\n        return cellsData;\n    };\n    /**\n     * @hidden\n     * @param {string} value - specify the value\n     * @returns {number} - Returns parse double value.\n     */\n    BasicFormulas.prototype.parseDouble = function (value) {\n        var val = this.parent.parseFloat(value.toString());\n        return !isNaN(val) ? val : NaN;\n    };\n    BasicFormulas.prototype.getModuleName = function () {\n        return 'basic-formulas';\n    };\n    return BasicFormulas;\n}());\nexport { BasicFormulas };\n","import { FormulaError } from './index';\nimport { CommonErrors, FormulasErrorsStrings } from '../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nvar Parser = /** @class */ (function () {\n    function Parser(parent) {\n        this.emptyStr = '';\n        this.storedStringText = this.emptyStr;\n        this.sheetToken = '!';\n        /** @hidden */\n        this.tokenAdd = 'a';\n        /** @hidden */\n        this.tokenSubtract = 's';\n        /** @hidden */\n        this.tokenMultiply = 'm';\n        /** @hidden */\n        this.tokenDivide = 'd';\n        /** @hidden */\n        this.tokenLess = 'l';\n        this.charEm = 'r';\n        this.charEp = 'x';\n        /** @hidden */\n        this.tokenGreater = 'g';\n        /** @hidden */\n        this.tokenEqual = 'e';\n        /** @hidden */\n        this.tokenLessEq = 'k';\n        /** @hidden */\n        this.tokenGreaterEq = 'j';\n        /** @hidden */\n        this.tokenNotEqual = 'o';\n        /** @hidden */\n        this.tokenAnd = 'c';\n        this.tokenEm = 'v';\n        this.tokenEp = 't';\n        /** @hidden */\n        this.tokenOr = String.fromCharCode(126);\n        this.charAnd = 'i';\n        this.charLess = '<';\n        this.charGreater = '>';\n        this.charEqual = '=';\n        this.charLessEq = 'f';\n        this.charGreaterEq = 'h';\n        this.charNoEqual = 'z';\n        this.stringGreaterEq = '>=';\n        this.stringLessEq = '<=';\n        this.stringNoEqual = '<>';\n        this.stringAnd = '&';\n        this.stringOr = '^';\n        this.charOr = 'w';\n        this.charAdd = '+';\n        this.charSubtract = '-';\n        this.charMultiply = '*';\n        this.charDivide = '/';\n        this.fixedReference = '$';\n        this.spaceString = ' ';\n        this.ignoreBracet = false;\n        /** @hidden */\n        this.isError = false;\n        /** @hidden */\n        this.isFormulaParsed = false;\n        this.findNamedRange = false;\n        this.stringsColl = new Map();\n        this.tokens = [\n            this.tokenAdd, this.tokenSubtract, this.tokenMultiply, this.tokenDivide, this.tokenLess,\n            this.tokenGreater, this.tokenEqual, this.tokenLessEq, this.tokenGreaterEq, this.tokenNotEqual, this.tokenAnd, this.tokenOr\n        ];\n        this.charNOTop = String.fromCharCode(167);\n        this.specialSym = ['~', '@', '#', '?'];\n        this.isFailureTriggered = false;\n        this.parent = parent;\n    }\n    /**\n     * @hidden\n     * @param {string} text - specify the text\n     * @param {string} fkey - specify the formula key\n     * @returns {string} - returns parse.\n     */\n    Parser.prototype.parse = function (text, fkey) {\n        if (this.parent.isTextEmpty(text)) {\n            return text;\n        }\n        if (this.parent.getFormulaCharacter() !== String.fromCharCode(0) && this.parent.getFormulaCharacter() === text[0]) {\n            text = text.substring(1);\n        }\n        if (this.parent.namedRanges.size > 0 || this.parent.storedData.size > 0) {\n            text = this.checkForNamedRangeAndKeyValue(text);\n            this.findNamedRange = false;\n        }\n        text = text.split('-+').join('-');\n        text = text.split('--').join('+');\n        text = text.split('+-').join('-');\n        text = text.split('-' + '(' + '-').join('(');\n        var formulaString = this.storeStrings(text);\n        text = this.storedStringText;\n        var i = 0;\n        if (isNullOrUndefined(formulaString)) {\n            text = text.split(' ').join('');\n        }\n        text = text.split('=>').join('>=');\n        text = text.split('=<').join('<=');\n        if (text[text.length - 1] !== this.parent.arithMarker || this.indexOfAny(text, this.tokens) !== (text.length - 2)) {\n            text = text.toUpperCase();\n        }\n        if (text.indexOf(this.sheetToken) > -1) {\n            var family = this.parent.getSheetFamilyItem(this.parent.grid);\n            if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.size > 0) {\n                if (text[0] !== this.sheetToken.toString()) {\n                    text = this.parent.setTokensForSheets(text);\n                }\n                var sheetToken = this.parent.getSheetToken(text.split(this.parent.tic).join(this.emptyStr));\n                var scopedRange = this.checkScopedRange(text.split('\"').join(this.emptyStr).split(this.sheetToken).join(''));\n                if (isNullOrUndefined(sheetToken) && sheetToken !== '' && this.parent.namedRanges.size > 0 && scopedRange !== '') {\n                    text = scopedRange;\n                }\n            }\n        }\n        text = this.markLibraryFormulas(text);\n        try {\n            text = this.formulaAutoCorrection(text);\n        }\n        catch (ex) {\n            var args = {\n                message: ex.message, exception: ex, isForceCalculable: ex.formulaCorrection,\n                computeForceCalculate: false\n            };\n            if (!args.isForceCalculable) {\n                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression];\n            }\n            if (!this.isFailureTriggered) {\n                this.parent.trigger('onFailure', args);\n                this.isFailureTriggered = true;\n            }\n            if (args.isForceCalculable && args.computeForceCalculate) {\n                text = this.formulaAutoCorrection(text, args);\n                this.parent.storedData.get(fkey).formulaText = '=' + text;\n            }\n            else {\n                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression];\n            }\n        }\n        if (!this.ignoreBracet) {\n            i = text.indexOf(')');\n            while (i > -1) {\n                var k = text.substring(0, i).lastIndexOf('(');\n                if (k === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n                }\n                if (k === i - 1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.empty_expression]);\n                }\n                var s = this.emptyStr;\n                if (this.ignoreBracet) {\n                    s = this.parent.substring(text, k, i - k + 1);\n                }\n                else {\n                    s = this.parent.substring(text, k + 1, i - k - 1);\n                }\n                try {\n                    text = text.substring(0, k) + this.parseSimple(s) + text.substring(i + 1);\n                }\n                catch (ex) {\n                    var args = this.exceptionArgs(ex);\n                    if (!this.isFailureTriggered) {\n                        this.parent.trigger('onFailure', args);\n                        this.isFailureTriggered = true;\n                    }\n                    var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n                    return (this.parent.getErrorLine(ex) ? '' : '#' + this.parent.getErrorLine(ex) + ': ') + errorMessage;\n                }\n                i = text.indexOf(')');\n            }\n        }\n        if (!this.ignoreBracet && text.indexOf('(') > -1) {\n            throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n        }\n        text = this.parseSimple(text);\n        if (formulaString !== null && formulaString.size > 0) {\n            text = this.setStrings(text, formulaString);\n        }\n        return text;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Parser.prototype.exceptionArgs = function (ex) {\n        return {\n            message: ex.message, exception: ex, isForceCalculable: ex.formulaCorrection,\n            computeForceCalculate: false\n        };\n    };\n    Parser.prototype.formulaAutoCorrection = function (formula, args) {\n        var arithemeticArr = ['*', '+', '-', '/', '^', '&'];\n        var logicalSym = ['>', '=', '<'];\n        var i = 0;\n        var form = '';\n        var op = '';\n        var firstOp = '';\n        var secondprevOp = '';\n        var secondnextOp = '';\n        var firstDigit = '';\n        var secondDigit = '';\n        var countDigit = 0;\n        if (this.parent.formulaErrorStrings.indexOf(formula) > -1) {\n            return formula;\n        }\n        else {\n            if (this.indexOfAny(formula, this.specialSym) > -1) {\n                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression], false);\n            }\n            while (i < formula.length) {\n                formula = formula.split('-*').join('-').split('/*').join('/').split('*/').join('*').split('-/').join('-').\n                    split('*+').join('*').split('+*').join('+');\n                if (formula.indexOf('*-') > -1 || formula.indexOf('/-') > -1) {\n                    formula = '-' + formula.split('*-').join('*').split('/-').join('/');\n                }\n                if ((this.parent.isDigit(formula[i]) && ((formula.length > i + 1)\n                    && (this.indexOfAny(formula[i + 1], arithemeticArr) > -1)) && ((formula.length > i + 2)\n                    && (!isNullOrUndefined(formula[i + 2]) && this.indexOfAny(formula[i + 2], arithemeticArr) > -1)))) {\n                    if (isNullOrUndefined(args)) {\n                        throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression], true);\n                    }\n                    if (args.computeForceCalculate) {\n                        if (this.parent.isDigit(formula[i])) {\n                            if (countDigit < 1) {\n                                firstDigit = formula[i];\n                                firstOp = formula[i + 1];\n                                if (isNullOrUndefined(firstOp)) {\n                                    firstOp = this.emptyStr;\n                                }\n                                firstOp = firstOp === '&' ? '' : firstOp;\n                                countDigit = countDigit + 1;\n                                form = form + firstDigit + firstOp;\n                            }\n                            else if (countDigit < 2) {\n                                secondDigit = formula[i];\n                                secondprevOp = formula[i - 1];\n                                secondnextOp = formula[i + 1];\n                                countDigit = 0;\n                                if (secondprevOp === '-') {\n                                    secondnextOp = isNullOrUndefined(secondnextOp) ? this.emptyStr : secondnextOp;\n                                    secondnextOp = secondnextOp === '&' ? '' : secondnextOp;\n                                    form = form + secondprevOp + secondDigit + secondnextOp;\n                                }\n                                else {\n                                    secondnextOp = isNullOrUndefined(secondnextOp) ? this.emptyStr : secondnextOp;\n                                    form = form + secondDigit + secondnextOp;\n                                }\n                            }\n                            i = i + 2;\n                        }\n                        else {\n                            form = (formula[i] === '-') ? form + formula[i] : form;\n                            i = i + 1;\n                        }\n                    }\n                    else {\n                        throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                    }\n                    /* eslint-disable-next-line */\n                }\n                else if ((this.parent.isDigit(formula[i]) || formula[i] === this.parent.rightBracket || this.parent.storedData.has(formula[i].toUpperCase())) && (isNullOrUndefined(formula[i + 1]) || this.indexOfAny(formula[i + 1], arithemeticArr)) > -1) {\n                    op = isNullOrUndefined(formula[i + 1]) ? this.emptyStr : formula[i + 1];\n                    op = op === '&' ? '' : op;\n                    form = formula[i - 1] === '-' ? form + formula[i - 1] + formula[i] + op : form + formula[i] + op;\n                    i = i + 2;\n                    /* eslint-disable-next-line */\n                }\n                else if (this.indexOfAny(formula[i], logicalSym) > -1 && !isNullOrUndefined(formula[i - 1]) && !isNullOrUndefined(formula[i + 1])) {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (formula[i] === 'q') {\n                    while (formula[i] !== this.parent.leftBracket) {\n                        form = form + formula[i];\n                        i = i + 1;\n                    }\n                }\n                else if (formula[i] === this.parent.leftBracket || formula[i] === this.parent.rightBracket || formula[i] === '{' || formula[i] === '}' || formula[i] === '(' || formula[i] === ')') {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (this.parent.isUpperChar(formula[i]) || formula[i].indexOf(':') > -1 || formula[i] === this.parent.getParseArgumentSeparator() || ((formula[i] === '%') && (this.parent.isDigit(formula[i - 1])))) {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (formula[i] === this.parent.tic || formula[i] === ' ' || formula[i] === '.' || formula[i] === this.sheetToken ||\n                    formula[i] === '$') {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else {\n                    if (this.parent.isDigit(formula[i])) {\n                        form = formula[i - 1] === '-' ? form + formula[i - 1] + formula[i] : form + formula[i];\n                    }\n                    if (formula[i] === '-' || formula[i] === '+') {\n                        form = form + formula[i];\n                        form = form.split('++').join('+').split('+-').join('-').split('-+').join('-');\n                    }\n                    if (formula[i] === '/' || formula[i] === '*') {\n                        form = form + formula[i];\n                    }\n                    i = i + 1;\n                }\n            }\n        }\n        form = form === this.emptyStr ? formula : form;\n        if (this.indexOfAny(form[form.length - 1], arithemeticArr) > -1) {\n            form = form.substring(0, form.length - 1);\n        }\n        form = form.split('--').join('-').split('-+').join('-').split('+-').join('-');\n        return form;\n    };\n    Parser.prototype.checkScopedRange = function (text) {\n        var _this = this;\n        var scopedRange = this.emptyStr;\n        var b = 'NaN';\n        var id = this.parent.getSheetID(this.parent.grid);\n        var sheet = this.parent.getSheetFamilyItem(this.parent.grid);\n        if (text[0] === this.sheetToken.toString()) {\n            var i = text.indexOf(this.sheetToken, 1);\n            var v = parseInt(text.substr(1, i - 1), 10);\n            if (i > 1 && !this.parent.isNaN(v)) {\n                text = text.substring(i + 1);\n                id = v;\n            }\n        }\n        var token = '!' + id.toString() + '!';\n        if (sheet === null || sheet.sheetNameToToken == null) {\n            return b;\n        }\n        sheet.sheetNameToToken.forEach(function (value, key) {\n            if (sheet.sheetNameToToken.get(key).toString() === token) {\n                var s_1 = _this.emptyStr;\n                _this.parent.namedRanges.forEach(function (value, key) {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    if (!isNullOrUndefined(_this.parent.parentObject)) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        s_1 = (_this.parent.parentObject.getActiveSheet().name + _this.sheetToken + text).toUpperCase();\n                    }\n                    else {\n                        s_1 = sheet.sheetNameToToken.get(key).toUpperCase();\n                    }\n                    if (_this.parent.getNamedRanges().has(s_1)) {\n                        scopedRange = (_this.parent.getNamedRanges().get(s_1)).toUpperCase();\n                        b = scopedRange;\n                    }\n                });\n            }\n        });\n        return b;\n    };\n    Parser.prototype.storeStrings = function (tempString) {\n        var i = 0;\n        var j = 0;\n        var id = 0;\n        var key = '';\n        var storedString = null;\n        var condition;\n        var ticLoc = tempString.indexOf(this.parent.tic);\n        if (ticLoc > -1) {\n            i = tempString.indexOf(this.parent.tic);\n            while (i > -1 && tempString.length > 0) {\n                if (storedString === null) {\n                    storedString = this.stringsColl;\n                }\n                j = i + 1 < tempString.length ? tempString.indexOf(this.parent.tic, i + 1) : -1;\n                if (j === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_tics]);\n                }\n                condition = this.parent.substring(tempString, i, j - i + 1);\n                key = this.parent.tic + this.spaceString + id.toString() + this.parent.tic;\n                storedString = storedString.set(key, condition);\n                tempString = tempString.substring(0, i) + key + tempString.substring(j + 1);\n                i = i + key.length;\n                if (i <= tempString.length) {\n                    i = tempString.indexOf(this.parent.tic, i);\n                }\n                id++;\n            }\n        }\n        this.storedStringText = tempString;\n        return storedString;\n    };\n    Parser.prototype.setStrings = function (text, formulaString) {\n        for (var i = 0; i < formulaString.size; i++) {\n            formulaString.forEach(function (value, key) {\n                text = text.split(key).join(value);\n            });\n        }\n        return text;\n    };\n    /**\n     * @hidden\n     * @param {string} formulaText - specify the formula text\n     * @returns {string} - parse simple.\n     */\n    Parser.prototype.parseSimple = function (formulaText) {\n        var needToContinue = true;\n        var text = formulaText;\n        if (text.length > 0 && text[0] === '+') {\n            text = text.substring(1);\n        }\n        if (text === '#DIV/0!') {\n            return '#DIV/0!';\n        }\n        if (text === '#NAME?') {\n            return '#NAME?';\n        }\n        if (text === '') {\n            return text;\n        }\n        if (this.parent.formulaErrorStrings.indexOf(text) > -1) {\n            return text;\n        }\n        text = text.split(this.stringLessEq).join(this.charLessEq);\n        text = text.split(this.stringGreaterEq).join(this.charGreaterEq);\n        text = text.split(this.stringNoEqual).join(this.charNoEqual);\n        text = text.split(this.stringAnd).join(this.charAnd);\n        text = text.split(this.stringOr).join(this.charOr);\n        text = text.split(this.fixedReference).join(this.emptyStr);\n        needToContinue = true;\n        var expTokenArray = [this.tokenEp, this.tokenEm];\n        var mulTokenArray = [this.tokenMultiply, this.tokenDivide];\n        var addTokenArray = [this.tokenAdd, this.tokenSubtract];\n        var mulCharArray = [this.charMultiply, this.charDivide];\n        var addCharArray = [this.charAdd, this.charSubtract];\n        var compareTokenArray = [this.tokenLess, this.tokenGreater, this.tokenEqual, this.tokenLessEq,\n            this.tokenGreaterEq, this.tokenNotEqual];\n        var compareCharArray = [this.charLess, this.charGreater, this.charEqual, this.charLessEq,\n            this.charGreaterEq, this.charNoEqual];\n        var expCharArray = [this.charEp, this.charEm];\n        var andTokenArray = [this.tokenAnd];\n        var andCharArray = [this.charAnd];\n        var orCharArray = [this.charOr];\n        var orTokenArray = [this.tokenOr];\n        text = this.parseSimpleOperators(text, expTokenArray, expCharArray);\n        text = this.parseSimpleOperators(text, orTokenArray, orCharArray);\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, mulTokenArray, mulCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, addTokenArray, addCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, compareTokenArray, compareCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, andTokenArray, andCharArray);\n        }\n        return text;\n    };\n    /**\n     * @hidden\n     * @param {string} formulaText - specify the formula text\n     * @param {string[]} markers -  specify the markers\n     * @param {string[]} operators - specify the operators\n     * @returns {string} - parse Simple Operators\n     */\n    Parser.prototype.parseSimpleOperators = function (formulaText, markers, operators) {\n        if (this.parent.getErrorStrings().indexOf(formulaText) > -1) {\n            return formulaText;\n        }\n        var text = formulaText;\n        var i = 0;\n        var op = '';\n        for (var c = 0; c < operators.length; c++) {\n            op = op + operators[c];\n        }\n        /* eslint-disable */\n        text = text.split(\"---\").join(\"-\").split(\"--\").join(\"+\").split(this.parent.getParseArgumentSeparator() + \"-\").join(this.parent.getParseArgumentSeparator() + \"u\").split(this.parent.leftBracket + \"-\").join(this.parent.leftBracket + \"u\").split(\"=-\").join(\"=u\");\n        text = text.split(',+').join(',').split(this.parent.leftBracket + '+').join(this.parent.leftBracket).split('=+').join('=').split('>+').join('>').split('<+').join('<').split('/+').join('/').split('*+').join('*').split('++').join('+').split(\"*-\").join(\"*u\").toString();\n        ;\n        /* eslint-enable */\n        if (text.length > 0 && text[0] === '-') {\n            text = text.substring(1).split('-').join(this.tokenOr);\n            text = '0-' + text;\n            text = this.parseSimpleOperators(text, [this.tokenSubtract], [this.charSubtract]);\n            text = text.split(this.tokenOr).join('-');\n        }\n        else if (text.length > 0 && text[0] === '+') {\n            text = text.substring(1);\n        }\n        else if (text.length > 0 && text[text.length - 1] === '+') {\n            text = text.substring(0, text.length - 1);\n        }\n        try {\n            if (this.indexOfAny(text, operators) > -1) {\n                i = this.indexOfAny(text, operators);\n                while (i > -1) {\n                    var left = '';\n                    var right = '';\n                    var leftIndex = 0;\n                    var rightIndex = 0;\n                    var isNotOperator = text[i] === this.charNOTop;\n                    var j = 0;\n                    if (!isNotOperator) {\n                        j = i - 1;\n                        if (text[j] === this.parent.arithMarker) {\n                            var k = this.findLeftMarker(text.substring(0, j - 1));\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, k + 1, j - k - 1);\n                            leftIndex = k + 1;\n                        }\n                        else if (text[j] === this.parent.rightBracket) {\n                            var bracketCount = 0;\n                            var k = j - 1;\n                            while (k > 0 && (text[k] !== 'q' || bracketCount !== 0)) {\n                                if (text[k] === 'q') {\n                                    bracketCount--;\n                                }\n                                else if (text[k] === this.parent.rightBracket) {\n                                    bracketCount++;\n                                }\n                                k--;\n                            }\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, k, j - k + 1);\n                            leftIndex = k;\n                        }\n                        else if (text[j] === this.parent.tic[0]) {\n                            var l = text.substring(0, j - 1).lastIndexOf(this.parent.tic);\n                            if (l < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, l, j - l + 1);\n                            leftIndex = l;\n                        }\n                        else {\n                            var period = false;\n                            while (j > -1 && (this.parent.isDigit(text[j]) ||\n                                (!period && text[j] === this.parent.getParseDecimalSeparator()))) {\n                                if (text[j] === this.parent.getParseDecimalSeparator()) {\n                                    period = true;\n                                }\n                                j = j - 1;\n                            }\n                            if (j > -1 && period && text[j] === this.parent.getParseDecimalSeparator()) {\n                                /* eslint-disable-next-line */\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.number_contains_2_decimal_points]);\n                            }\n                            j = j + 1;\n                            if (j === 0 || (j > 0 && !this.parent.isUpperChar(text[j - 1]))) {\n                                left = 'n' + this.parent.substring(text, j, i - j);\n                                leftIndex = j;\n                            }\n                            else {\n                                j = j - 1;\n                                while (j > -1 && (this.parent.isUpperChar(text[j]) || this.parent.isDigit(text[j]))) {\n                                    j = j - 1;\n                                }\n                                if (j > -1 && text[j] === this.sheetToken) {\n                                    j = j - 1;\n                                    while (j > -1 && text[j] !== this.sheetToken) {\n                                        j = j - 1;\n                                    }\n                                    if (j > -1 && text[j] === this.sheetToken) {\n                                        j = j - 1;\n                                    }\n                                }\n                                if (j > -1 && text[j] === ':') {\n                                    //// handle range operands\n                                    j = j - 1;\n                                    while (j > -1 && this.parent.isDigit(text[j])) {\n                                        j = j - 1;\n                                    }\n                                    while (j > -1 && this.parent.isUpperChar(text[j])) {\n                                        j = j - 1;\n                                    }\n                                    if (j > -1 && text[j] === this.sheetToken) {\n                                        j--;\n                                        while (j > -1 && text[j] !== this.sheetToken) {\n                                            j--;\n                                        }\n                                        if (j > -1 && text[j] === this.sheetToken) {\n                                            j--;\n                                        }\n                                    }\n                                    j = j + 1;\n                                    left = this.parent.substring(text, j, i - j);\n                                    left = this.parent.getCellFrom(left);\n                                }\n                                else {\n                                    j = j + 1;\n                                    left = this.parent.substring(text, j, i - j);\n                                }\n                                this.parent.updateDependentCell(left);\n                                leftIndex = j;\n                            }\n                            if ((this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(left.toUpperCase())) ||\n                                (this.parent.storedData.has(left.toUpperCase()))) {\n                                left = 'n' + this.checkForNamedRangeAndKeyValue(left);\n                            }\n                        }\n                    }\n                    else {\n                        leftIndex = i;\n                    }\n                    if (i === text.length - 1) {\n                        /* eslint-disable-next-line */\n                        throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.expression_cannot_end_with_an_operator]);\n                    }\n                    else {\n                        j = i + 1;\n                        var uFound = text[j] === 'u'; // for 3*-2\n                        if (uFound) {\n                            j = j + 1;\n                        }\n                        if (text[j] === this.parent.tic[0]) {\n                            var k = text.substring(j + 1).indexOf(this.parent.tic);\n                            if (k < 0) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse];\n                            }\n                            right = this.parent.substring(text, j, k + 2);\n                            rightIndex = k + j + 2;\n                        }\n                        else if (text[j] === this.parent.arithMarker) {\n                            var k = this.findRightMarker(text.substring(j + 1));\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            right = this.parent.substring(text, j + 1, k);\n                            rightIndex = k + j + 2;\n                        }\n                        else if (text[j] === 'q') {\n                            var bracketCount = 0;\n                            var k = j + 1;\n                            while (k < text.length && (text[k] !== this.parent.rightBracket || bracketCount !== 0)) {\n                                if (text[k] === this.parent.rightBracket) {\n                                    bracketCount++;\n                                }\n                                else if (text[k] === 'q') {\n                                    bracketCount--;\n                                }\n                                k++;\n                            }\n                            if (k === text.length) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse];\n                            }\n                            right = this.parent.substring(text, j, k - j + 1);\n                            if (uFound) {\n                                right = 'u' + right;\n                            }\n                            rightIndex = k + 1;\n                        }\n                        else if (this.parent.isDigit(text[j]) || text[j] === this.parent.getParseDecimalSeparator()) {\n                            var period = (text[j] === this.parent.getParseDecimalSeparator());\n                            j = j + 1;\n                            /* eslint-disable-next-line */\n                            while (j < text.length && (this.parent.isDigit(text[j]) || (!period && text[j] === this.parent.getParseDecimalSeparator()))) {\n                                if (text[j] === this.parent.getParseDecimalSeparator()) {\n                                    period = true;\n                                }\n                                j = j + 1;\n                            }\n                            if (j < text.length && text[j] === '%') {\n                                j += 1;\n                            }\n                            if (period && j < text.length && text[j] === this.parent.getParseDecimalSeparator()) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.number_contains_2_decimal_points];\n                            }\n                            right = 'n' + this.parent.substring(text, i + 1, j - i - 1);\n                            rightIndex = j;\n                        }\n                        else if (this.parent.isUpperChar(text[j]) || text[j] === this.sheetToken || text[j] === 'u') {\n                            if (text[j] === this.sheetToken) {\n                                j = j + 1;\n                                while (j < text.length && text[j] !== this.sheetToken) {\n                                    j = j + 1;\n                                }\n                            }\n                            j = j + 1;\n                            var jTemp = 0;\n                            var inbracket = false;\n                            while (j < text.length && (this.parent.isUpperChar(text[j]) || text[j] === '_'\n                                || text[j] === '.' || text[j] === '[' || text[j] === ']' || text[j] === '#' || text[j] === ' '\n                                || text[j] === '%' || text[j] === this.parent.getParseDecimalSeparator() && inbracket)) {\n                                if (j !== text.length - 1 && text[j] === '[' && text[j + 1] === '[') {\n                                    inbracket = true;\n                                }\n                                if (j !== text.length - 1 && text[j] === ']' && text[j + 1] === ']') {\n                                    inbracket = false;\n                                }\n                                j++;\n                                jTemp++;\n                            }\n                            var noCellReference = (j === text.length) || !this.parent.isDigit(text[j]);\n                            if (jTemp > 1) {\n                                while (j < text.length && (this.parent.isUpperChar(text[j]) || this.parent.isDigit(text[j])\n                                    || text[j] === ' ' || text[j] === '_')) {\n                                    j++;\n                                }\n                                noCellReference = true;\n                            }\n                            while (j < text.length && this.parent.isDigit(text[j])) {\n                                j = j + 1;\n                            }\n                            if (j < text.length && text[j] === ':') {\n                                j = j + 1;\n                                if (j < text.length && text[j] === this.sheetToken) {\n                                    j++;\n                                    while (j < text.length && text[j] !== this.sheetToken) {\n                                        j = j + 1;\n                                    }\n                                    if (j < text.length && text[j] === this.sheetToken) {\n                                        j++;\n                                    }\n                                }\n                                while (j < text.length && this.parent.isUpperChar(text[j])) {\n                                    j = j + 1;\n                                }\n                                while (j < text.length && this.parent.isDigit(text[j])) {\n                                    j = j + 1;\n                                }\n                                j = j - 1;\n                                right = this.parent.substring(text, i + 1, j - i);\n                                right = this.parent.getCellFrom(right);\n                            }\n                            else {\n                                j = j - 1;\n                                right = this.parent.substring(text, i + 1, j - i);\n                                uFound = text[j] === 'u';\n                                if (uFound) {\n                                    right = 'u' + right;\n                                }\n                            }\n                            if (noCellReference && right.startsWith(this.sheetToken)) {\n                                noCellReference = !this.parent.isCellReference(right);\n                            }\n                            if (!noCellReference) {\n                                this.parent.updateDependentCell(right);\n                            }\n                            if ((this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(right.toUpperCase()))\n                                || (this.parent.storedData.has(right.toUpperCase()))) {\n                                right = 'n' + this.checkForNamedRangeAndKeyValue(right);\n                            }\n                            rightIndex = j + 1;\n                        }\n                    }\n                    var p = op.indexOf(text[i]);\n                    var s = this.parent.arithMarker + left + right + markers[p] + this.parent.arithMarker;\n                    if (leftIndex > 0) {\n                        s = text.substring(0, leftIndex) + s;\n                    }\n                    if (rightIndex < text.length) {\n                        s = s + text.substring(rightIndex);\n                    }\n                    s = s.split(this.parent.arithMarker2).join(this.parent.arithMarker.toString());\n                    text = s;\n                    i = this.indexOfAny(text, operators);\n                }\n            }\n            else {\n                if (text.length > 0 && (this.parent.isUpperChar(text[0]) || text[0] === this.sheetToken)) {\n                    var isCharacter = true;\n                    var checkLetter = true;\n                    var oneTokenFound = false;\n                    var textLen = text.length;\n                    for (var k = 0; k < textLen; ++k) {\n                        if (text[k] === this.sheetToken) {\n                            if (k > 0 && !oneTokenFound) {\n                                throw this.parent.getErrorStrings()[CommonErrors.ref];\n                            }\n                            oneTokenFound = true;\n                            k++;\n                            while (k < textLen && this.parent.isDigit(text[k])) {\n                                k++;\n                            }\n                            if (k === textLen || text[k] !== this.sheetToken) {\n                                isCharacter = false;\n                                break;\n                            }\n                        }\n                        else {\n                            if (!checkLetter && this.parent.isChar(text[k])) {\n                                isCharacter = false;\n                                break;\n                            }\n                            if (this.parent.isChar(text[k]) || this.parent.isDigit(text[k]) || text[k] === this.sheetToken) {\n                                checkLetter = this.parent.isUpperChar(text[k]);\n                            }\n                            else {\n                                isCharacter = false;\n                                break;\n                            }\n                        }\n                    }\n                    if (isCharacter) {\n                        this.parent.updateDependentCell(text);\n                    }\n                }\n            }\n            return text;\n        }\n        catch (ex) {\n            return ex;\n        }\n    };\n    /**\n     * @hidden\n     * @param {string} text - specify the text\n     * @param {string[]} operators - specify the operators\n     * @returns {number} - returns index.\n     */\n    Parser.prototype.indexOfAny = function (text, operators) {\n        for (var i = 0; i < text.length; i++) {\n            if (operators.indexOf(text[i]) > -1) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /**\n     * @hidden\n     * @param {string} text - specify the text\n     * @returns {number} - find Left Marker.\n     */\n    Parser.prototype.findLeftMarker = function (text) {\n        var ret = -1;\n        if (text.indexOf(this.parent.arithMarker) > -1) {\n            var bracketLevel = 0;\n            for (var i = text.length - 1; i >= 0; --i) {\n                if (text[i] === this.parent.rightBracket) {\n                    bracketLevel--;\n                }\n                else if (text[i] === this.parent.leftBracket) {\n                    bracketLevel++;\n                }\n                else if (text[i] === this.parent.arithMarker && bracketLevel === 0) {\n                    ret = i;\n                    break;\n                }\n            }\n        }\n        return ret;\n    };\n    /**\n     * @hidden\n     * @param {string} text - specify the text.\n     * @returns {number} - find Right Marker.\n     */\n    Parser.prototype.findRightMarker = function (text) {\n        var ret = -1;\n        if (text.indexOf(this.parent.arithMarker) > -1) {\n            var bracketLevel = 0;\n            for (var j = 0; j < text.length; ++j) {\n                if (text[j] === this.parent.rightBracket) {\n                    bracketLevel--;\n                }\n                else if (text[j] === this.parent.leftBracket) {\n                    bracketLevel++;\n                }\n                else if (text[j] === this.parent.arithMarker && bracketLevel === 0) {\n                    ret = j;\n                    break;\n                }\n            }\n        }\n        return ret;\n    };\n    /**\n     * @hidden\n     * @param {string} formula - specify the formula\n     * @param {string} fKey - specify the formula key.\n     * @returns {string} - parse formula.\n     */\n    Parser.prototype.parseFormula = function (formula, fKey) {\n        if (formula.length > 0 && formula[0] === this.parent.getFormulaCharacter()) {\n            formula = formula.substring(1);\n        }\n        if (formula.indexOf('#REF!') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        if (formula.length > 0 && formula[0] === '+') {\n            formula = formula.substring(1);\n        }\n        try {\n            this.isFailureTriggered = false;\n            this.isError = false;\n            formula = this.parse(formula.trim(), fKey);\n            this.isFormulaParsed = true;\n        }\n        catch (ex) {\n            var args = this.exceptionArgs(ex);\n            if (!this.isFailureTriggered) {\n                this.parent.trigger('onFailure', args);\n                this.isFailureTriggered = true;\n            }\n            var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n            formula = (isNullOrUndefined(this.parent.getErrorLine(ex)) ? '' : '#' + this.parent.getErrorLine(ex) + ': ') + errorMessage;\n            this.isError = true;\n        }\n        return formula;\n    };\n    /**\n     * @hidden\n     * @param {string} formula - specify the formula\n     * @returns {string} - mark library formulas.\n     */\n    Parser.prototype.markLibraryFormulas = function (formula) {\n        var bracCount = 0;\n        var rightParens = formula.indexOf(')');\n        if (rightParens === -1) {\n            formula = this.markNamedRanges(formula);\n        }\n        else {\n            while (rightParens > -1) {\n                var parenCount = 0;\n                var leftParens = rightParens - 1;\n                while (leftParens > -1 && (formula[leftParens] !== '(' || parenCount !== 0)) {\n                    if (formula[leftParens] === ')') {\n                        parenCount++;\n                    }\n                    // else if (formula[leftParens] === ')') {\n                    //     parenCount--;\n                    // }\n                    leftParens--;\n                }\n                if (leftParens === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n                }\n                var i = leftParens - 1;\n                while (i > -1 && (this.parent.isChar(formula[i]))) {\n                    i--;\n                }\n                var len = leftParens - i - 1;\n                var libFormula = this.parent.substring(formula, i + 1, len);\n                if (len > 0 && !isNullOrUndefined(this.parent.getFunction(libFormula))) {\n                    if (this.parent.substring(formula, i + 1, len) === 'AREAS') {\n                        this.ignoreBracet = true;\n                    }\n                    else {\n                        this.ignoreBracet = false;\n                    }\n                    var substr = this.parent.substring(formula, leftParens, rightParens - leftParens + 1);\n                    try {\n                        var args = void 0;\n                        substr = substr.split('(').join('').split(')').join('');\n                        substr = '(' + this.formulaAutoCorrection(substr, args) + ')';\n                    }\n                    catch (ex) {\n                        var args = {\n                            message: ex.message, exception: ex,\n                            isForceCalculable: ex.formulaCorrection, computeForceCalculate: false\n                        };\n                        if (!args.isForceCalculable) {\n                            throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                        }\n                        if (!this.isFailureTriggered) {\n                            this.parent.trigger('onFailure', args);\n                            this.isFailureTriggered = true;\n                            bracCount = bracCount + 1;\n                        }\n                        args.computeForceCalculate = bracCount > 0 ? true : args.computeForceCalculate;\n                        if (args.isForceCalculable) {\n                            if (args.computeForceCalculate) {\n                                substr = substr.split('(').join('').split(')').join('');\n                                substr = '(' + this.formulaAutoCorrection(substr, args) + ')';\n                            }\n                            else {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                            }\n                        }\n                        else {\n                            throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                        }\n                    }\n                    substr = this.markNamedRanges(substr);\n                    substr = this.swapInnerParens(substr);\n                    substr = this.addParensToArgs(substr);\n                    var id = substr.lastIndexOf(this.parent.getParseArgumentSeparator());\n                    if (id === -1) {\n                        if (substr.length > 2 && substr[0] === '(' && substr[substr.length - 1] === ')') {\n                            if (substr[1] !== '{' && substr[1] !== '(') {\n                                substr = substr.substring(0, substr.length - 1) + '}' + substr.substring(substr.length - 1);\n                                substr = substr[0] + '{' + substr.substring(1);\n                            }\n                        }\n                    }\n                    formula = formula.substring(0, i + 1) + 'q' + this.parent.substring(formula, i + 1, len) +\n                        (substr.split('(').join(this.parent.leftBracket))\n                            .split(')').join(this.parent.rightBracket) + formula.substring(rightParens + 1);\n                }\n                else if (len > 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                else {\n                    var s = this.emptyStr;\n                    if (leftParens > 0) {\n                        s = formula.substring(0, leftParens);\n                    }\n                    s = s + '{' + this.parent.substring(formula, leftParens + 1, rightParens - leftParens - 1) + '}';\n                    if (rightParens < formula.length) {\n                        s = s + formula.substring(rightParens + 1);\n                    }\n                    s = this.markNamedRanges(s);\n                    formula = s;\n                }\n                rightParens = formula.indexOf(')');\n            }\n        }\n        formula = (formula.split('{').join('(')).split('}').join(')');\n        return formula;\n    };\n    /**\n     * @hidden\n     * @param {string} fSubstr - specify the string\n     * @returns {string} - swap inner parens.\n     */\n    Parser.prototype.swapInnerParens = function (fSubstr) {\n        if (fSubstr.length > 2) {\n            fSubstr = fSubstr[0] + fSubstr.substr(1, fSubstr.length - 2).split('(').join('{').split(')').join('}') + fSubstr[fSubstr.length - 1];\n        }\n        return fSubstr;\n    };\n    /**\n     * @hidden\n     * @param {string} fSubstr - specify the string\n     * @returns {string} - add parens to args.\n     */\n    Parser.prototype.addParensToArgs = function (fSubstr) {\n        if (fSubstr.length === 0) {\n            return this.emptyStr;\n        }\n        var rightSides = [];\n        rightSides.push(this.parent.getParseArgumentSeparator());\n        rightSides.push(this.parent.rightBracket);\n        var id = fSubstr.lastIndexOf(this.parent.getParseArgumentSeparator());\n        var k = 0;\n        if (id === -1) {\n            if (fSubstr.length > 2 && fSubstr[0] === '(' && fSubstr[fSubstr.length - 1] === ')') {\n                if (fSubstr[1] !== '{' && fSubstr[1] !== '(') {\n                    fSubstr = fSubstr.substring(0, fSubstr.length - 1) + '}' + fSubstr.substring(fSubstr.length - 1);\n                    fSubstr = fSubstr[0] + '{' + fSubstr.substring(1);\n                }\n                else {\n                    var marker = ['+', '-', '*', '/'];\n                    id = this.lastIndexOfAny(fSubstr, marker);\n                    if (k === 0 && fSubstr[fSubstr.length - 1] === ')') {\n                        k = fSubstr.length - 1;\n                    }\n                    if (k > 0) {\n                        if (fSubstr[id + 1] !== '{' && fSubstr[id - 1] === '}') {\n                            fSubstr = fSubstr.substr(0, k) + '}' + fSubstr.substr(k);\n                            fSubstr = fSubstr.substr(0, id + 1) + '{' + fSubstr.substr(id + 1);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            var oneTimeOnly = true;\n            while (id > -1) {\n                var j = this.indexOfAny(fSubstr.substring(id + 1, fSubstr.length), rightSides);\n                if (j >= 0) {\n                    j = id + j + 1;\n                }\n                else if (j === -1 && fSubstr[fSubstr.length - 1] === ')') {\n                    j = fSubstr.length - 1;\n                }\n                if (j > 0) {\n                    if (fSubstr[id + 1] !== '{' && fSubstr[j - 1] !== '}') {\n                        fSubstr = fSubstr.substr(0, j) + '}' + fSubstr.substr(j);\n                        fSubstr = fSubstr.substr(0, id + 1) + '{' + fSubstr.substr(id + 1);\n                    }\n                }\n                id = fSubstr.substr(0, id).lastIndexOf(this.parent.getParseArgumentSeparator());\n                if (oneTimeOnly && id === -1 && fSubstr[0] === '(') {\n                    id = 0;\n                    oneTimeOnly = false;\n                }\n            }\n        }\n        fSubstr = fSubstr.split('{}').join(this.emptyStr);\n        return fSubstr;\n    };\n    /**\n     * @hidden\n     * @param {string} text - specify the text\n     * @param {string[]} operators - specify the operators\n     * @returns {number} - returns last Index Of Any.\n     */\n    Parser.prototype.lastIndexOfAny = function (text, operators) {\n        for (var i = text.length - 1; i > -1; i--) {\n            if (operators.indexOf(text[i]) > -1) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /**\n     * @hidden\n     * @param {string} formula - specify the formula\n     * @returns {string} - mark Named Ranges.\n     */\n    Parser.prototype.markNamedRanges = function (formula) {\n        var markers = [')', this.parent.getParseArgumentSeparator(), '}', '+', '-', '*', '/', '<', '>', '=', '&'];\n        var i = (formula.length > 0 && (formula[0] === '(' || formula[0] === '{')) ? 1 : 0;\n        if (formula.indexOf('#N/A') > -1) {\n            formula = formula.split('#N/A').join('#N~A');\n        }\n        if (formula.indexOf('#DIV/0!') > -1) {\n            formula = formula.split('#DIV/0!').join('#DIV~0!');\n        }\n        var end = this.indexOfAny(formula.substring(i), markers);\n        while (end > -1 && end + i < formula.length) {\n            var scopedRange = this.emptyStr;\n            var s = null;\n            if ((this.parent.substring(formula, i, end)).indexOf('[') > -1) {\n                s = this.getTableRange(this.parent.substring(formula, i, end));\n            }\n            else if (this.parent.storedData.has(this.parent.substring(formula, i, end))) {\n                s = this.checkForNamedRangeAndKeyValue(this.parent.substring(formula, i, end));\n            }\n            else if (this.parent.namedRanges.has(this.parent.substring(formula, i, end))) {\n                s = this.checkForNamedRangeAndKeyValue(this.parent.substring(formula, i, end));\n            }\n            if (isNullOrUndefined(s)) {\n                scopedRange = this.checkScopedRange(this.parent.substring(formula, i, end));\n                if (scopedRange !== 'NaN') {\n                    this.findNamedRange = true;\n                    s = scopedRange;\n                }\n                else if (this.parent.substring(formula, i, end).startsWith(this.sheetToken.toString())) {\n                    //let formulaStr: number = this.parent.substring(formula, i, end).indexOf(this.sheetToken, 1);\n                    // if (formulaStr > 1) {\n                    //     s = this.parent.namedRanges.get(this.parent.substring\n                    // (formula.substring(i), formulaStr + 1, end - formulaStr - 1));\n                    // }\n                }\n                if (!isNullOrUndefined(s) && this.findNamedRange) {\n                    if (s.indexOf(this.fixedReference) > -1) {\n                        s = s.split(this.fixedReference).join(this.emptyStr);\n                    }\n                }\n            }\n            if (!isNullOrUndefined(s)) {\n                s = s.toUpperCase();\n                s = this.parent.setTokensForSheets(s);\n                s = this.markLibraryFormulas(s);\n            }\n            if (!isNullOrUndefined(s) && s !== this.emptyStr) {\n                formula = formula.substring(0, i) + s + formula.substring(i + end);\n                i += s.length + 1;\n            }\n            else {\n                i += end + 1;\n                while (i < formula.length && !this.parent.isUpperChar(formula[i]) && formula[i] !== this.sheetToken) {\n                    i++;\n                }\n            }\n            end = i;\n            if (i < formula.length - 1 && formula[i] === '{') {\n                i = i + 1;\n            }\n            end = this.indexOfAny(formula.substring(i), markers);\n            while (end === 0 && i < formula.length - 1) {\n                i++;\n                end = this.indexOfAny(formula.substring(i), markers);\n            }\n            if ((end === -1 || formula.substring(i).indexOf('[') > -1) && i < formula.length) {\n                if (formula.substring(i).indexOf('[') > -1) {\n                    s = this.getTableRange(formula.substring(i));\n                }\n                else {\n                    if (this.parent.storedData.has(formula.substring(i))) {\n                        s = this.parent.storedData.size > 0 ? this.checkForNamedRangeAndKeyValue(formula.substring(i)) : s;\n                    }\n                    else {\n                        s = this.parent.namedRanges.size > 0 ? this.checkForNamedRangeAndKeyValue(formula.substring(i)) : s;\n                    }\n                }\n                if (isNullOrUndefined(s)) {\n                    scopedRange = this.checkScopedRange(formula.substring(i));\n                    if (scopedRange !== 'NaN') {\n                        s = scopedRange;\n                    }\n                }\n                if (!isNullOrUndefined(s) && s !== this.emptyStr) {\n                    s = s.toUpperCase();\n                    s = this.parent.setTokensForSheets(s);\n                    s = this.markLibraryFormulas(s);\n                    if (s != null) {\n                        var val = formula.substring(i);\n                        if (val[val.length - 1] === ')') {\n                            formula = formula.substring(0, i) + s + ')';\n                        }\n                        else {\n                            formula = formula.substring(0, i) + s;\n                        }\n                        i += s.toString().length + 1;\n                    }\n                }\n                end = (i < formula.length) ? this.indexOfAny(formula.substring(i), markers) : -1;\n            }\n        }\n        if (formula.indexOf('#N~A') > -1) {\n            formula = formula.split('#N~A').join('#N/A');\n        }\n        if (formula.indexOf('#DIV~0!') > -1) {\n            formula = formula.split('#DIV~0!').join('#DIV/0!');\n        }\n        return formula;\n    };\n    /**\n     * @hidden\n     * @param {string} text - specify the text.\n     * @returns {string} - check For Named Range And Key Value\n     */\n    Parser.prototype.checkForNamedRangeAndKeyValue = function (text) {\n        var scopedRange = this.emptyStr;\n        if (text.indexOf('[') > -1) {\n            var namerangeValue = this.getTableRange(text);\n            if (!isNullOrUndefined(namerangeValue)) {\n                this.findNamedRange = true;\n                text = namerangeValue;\n            }\n        }\n        scopedRange = this.checkScopedRange(text);\n        if (scopedRange !== 'NaN') {\n            this.findNamedRange = true;\n            text = scopedRange;\n        }\n        else {\n            if (text.indexOf(this.sheetToken) > -1) {\n                var sheet = this.parent.getSheetFamilyItem(this.parent.grid);\n                var value = text.split('\"').join(this.emptyStr);\n                value = value.substr(0, value.indexOf(this.sheetToken));\n                if (sheet.sheetNameToToken.has(value.toUpperCase())) {\n                    /* eslint-disable */\n                    var sheetIndex = parseInt(sheet.sheetNameToToken.get(value.toUpperCase()).split(this.sheetToken).join(this.emptyStr));\n                    // if (!ej.isNullOrUndefined(this.parentObject) && this.parentObject.pluginName == \"ejSpreadsheet\") {\n                    //     var name = text.replace(value, this.parentObject.model.sheets[(sheetIndex + 1)].sheetInfo.text.toUpperCase()).split(\"'\").join(this._string_empty);\n                    //     if (this.getNamedRanges().length > 0 && this.getNamedRanges().contains(name.toUpperCase())) {\n                    //         text = name;\n                    //     }\n                    // }\n                    /* tslint-enable */\n                }\n            }\n            if (this.parent.storedData.size > 0 && this.parent.storedData.has(text)) {\n                text = 'A' + this.parent.colIndex(text);\n            }\n            if (this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(text.toUpperCase())) {\n                if (!isNullOrUndefined(this.parent.parentObject)) {\n                    text = this.parse(this.parent.namedRanges.get(text.toUpperCase()));\n                }\n                else {\n                    text = this.parse(this.parent.namedRanges.get(text.toUpperCase()));\n                    text = this.parent.setTokensForSheets(text);\n                    if (text.indexOf(this.fixedReference) > -1) {\n                        text.split(this.fixedReference).join(this.emptyStr);\n                    }\n                    this.findNamedRange = true;\n                }\n            }\n            if (this.findNamedRange) {\n                if (text[0] !== '!' && text[0] !== 'q' && text[0] !== 'bq') {\n                    text = this.parent.setTokensForSheets(text);\n                    if (text.indexOf(this.fixedReference) > -1) {\n                        text = text.split(this.fixedReference).join(this.emptyStr);\n                    }\n                }\n            }\n        }\n        return text;\n    };\n    Parser.prototype.getTableRange = function (text) {\n        text = text.replace(' ', this.emptyStr).toUpperCase();\n        var name = text.replace(']', this.emptyStr).replace('#DATA', this.emptyStr);\n        var tableName = name;\n        if (name.indexOf(this.parent.getParseArgumentSeparator()) > -1) {\n            tableName = name.substring(0, name.indexOf(this.parent.getParseArgumentSeparator())).replace('[', this.emptyStr);\n            name = name.replace('[', this.emptyStr).replace(this.parent.getParseArgumentSeparator(), '_');\n        }\n        var range = this.emptyStr;\n        return name.toUpperCase();\n    };\n    Parser.prototype.findNextEndIndex = function (formula, loc) {\n        var count = 0;\n        var l = loc;\n        var found = false;\n        while (!found && loc < formula.length) {\n            if (formula[l] === '[') {\n                count++;\n            }\n            else if (formula[l] === ']') {\n                count--;\n                if (count === 0) {\n                    found = true;\n                }\n            }\n            loc++;\n        }\n        loc = loc - l;\n        return loc;\n    };\n    ;\n    return Parser;\n}());\nexport { Parser };\n","import { getSheetName, getSheetIndex, getSheet, getSheetIndexByName, getCell } from '../base/index';\nimport { getSingleSelectedRange } from '../base/index';\nimport { workbookFormulaOperation, getColumnHeaderText, aggregateComputation, getRangeIndexes, getUniqueRange, removeUniquecol } from '../common/index';\nimport { Calculate, ValueChangedArgs, CommonErrors, getAlphalabel } from '../../calculate/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getCellAddress, getFormattedCellObject, isNumber, checkIsFormula } from '../common/index';\nimport { workbookEditOperation, getRangeAddress, getRangeFromAddress, isCellReference } from '../common/index';\n/**\n * @hidden\n * The `WorkbookFormula` module is used to handle the formula operation in Workbook.\n */\nvar WorkbookFormula = /** @class */ (function () {\n    /**\n     * Constructor for formula module in Workbook.\n     *\n     * @param {Workbook} workbook - Specifies the workbook.\n     * @private\n     */\n    function WorkbookFormula(workbook) {\n        this.uniqueOBracket = String.fromCharCode(129);\n        this.uniqueCBracket = String.fromCharCode(130);\n        this.uniqueCSeparator = String.fromCharCode(131);\n        this.uniqueCOperator = String.fromCharCode(132);\n        this.uniquePOperator = String.fromCharCode(133);\n        this.uniqueSOperator = String.fromCharCode(134);\n        this.uniqueMOperator = String.fromCharCode(135);\n        this.uniqueDOperator = String.fromCharCode(136);\n        this.uniqueModOperator = String.fromCharCode(137);\n        this.uniqueConcateOperator = String.fromCharCode(138);\n        this.uniqueEqualOperator = String.fromCharCode(139);\n        this.uniqueExpOperator = String.fromCharCode(140);\n        this.uniqueGTOperator = String.fromCharCode(141);\n        this.uniqueLTOperator = String.fromCharCode(142);\n        this.sheetInfo = [];\n        this.parent = workbook;\n        this.init();\n    }\n    WorkbookFormula.prototype.init = function () {\n        this.addEventListener();\n        this.initCalculate();\n        this.registerSheet();\n    };\n    /**\n     * To destroy the formula module.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    WorkbookFormula.prototype.destroy = function () {\n        this.removeEventListener();\n        this.calculateInstance.dispose();\n        this.calculateInstance = null;\n        this.parent = null;\n    };\n    WorkbookFormula.prototype.addEventListener = function () {\n        this.parent.on(workbookFormulaOperation, this.performFormulaOperation, this);\n        this.parent.on(aggregateComputation, this.aggregateComputation, this);\n        this.parent.on(getUniqueRange, this.getUniqueRange, this);\n        this.parent.on(removeUniquecol, this.removeUniquecol, this);\n    };\n    WorkbookFormula.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookFormulaOperation, this.performFormulaOperation);\n            this.parent.off(aggregateComputation, this.aggregateComputation);\n            this.parent.off(getUniqueRange, this.getUniqueRange);\n            this.parent.off(removeUniquecol, this.removeUniquecol);\n        }\n    };\n    /**\n     * Get the module name.\n     *\n     * @returns {string} - Get the module name.\n     * @private\n     */\n    WorkbookFormula.prototype.getModuleName = function () {\n        return 'workbookFormula';\n    };\n    WorkbookFormula.prototype.initCalculate = function () {\n        this.calculateInstance = new Calculate(this.parent);\n        this.calcID = this.calculateInstance.createSheetFamilyID();\n        this.calculateInstance.setTreatEmptyStringAsZero(true);\n        this.calculateInstance.grid = this.parent.getActiveSheet().id.toString();\n    };\n    WorkbookFormula.prototype.performFormulaOperation = function (args) {\n        var action = args.action;\n        var formulas = this.calculateInstance.getLibraryFormulas();\n        var formulaInfo = (Array.from(formulas.values()));\n        var collection;\n        var length;\n        switch (action) {\n            case 'getLibraryFormulas':\n                args.formulaCollection = Array.from(formulas.keys());\n                break;\n            case 'getFormulaCategory':\n                collection = ['All'];\n                for (var i = 1; i < Array.from(formulas.values()).length; i++) {\n                    if (collection.indexOf(formulaInfo[i].category) < 0) {\n                        collection.push(formulaInfo[i].category);\n                    }\n                }\n                args.categoryCollection = collection;\n                break;\n            case 'dropDownSelectFormulas':\n                for (var i = 0; i < Array.from(formulas.values()).length; i++) {\n                    if (args.selectCategory === formulaInfo[i].category) {\n                        args.formulaCollection[i] = Array.from(formulas.keys())[i];\n                    }\n                }\n                break;\n            case 'getFormulaDescription':\n                for (var i = 0; i < Array.from(formulas.values()).length; i++) {\n                    if (args.selectedList === Array.from(formulas.keys())[i]) {\n                        args.description = formulaInfo[i].description;\n                    }\n                }\n                break;\n            case 'registerSheet':\n                this.registerSheet(args.sheetIndex, args.sheetCount);\n                if (args.isImport) {\n                    this.updateSheetInfo();\n                }\n                break;\n            case 'unRegisterSheet':\n                this.unRegisterSheet(args.sheetIndex, args.sheetCount, args.propertyChange);\n                break;\n            case 'refreshCalculate':\n                if (args.isFormula) {\n                    args.value = this.autoCorrectFormula(args.value, args.rowIndex, args.colIndex, args.sheetIndex);\n                }\n                this.refreshCalculate(args.rowIndex, args.colIndex, args.value, args.isFormula, args.sheetIndex, args.isRefreshing);\n                args.value = args.value ? args.value.toString().split('-*').join('-').split('/*').join('/').split('*/').\n                    join('*').split('-/').join('-').split('*+').join('*').split('+*').join('+') : args.value;\n                break;\n            case 'getArgumentSeparator':\n                args.argumentSeparator = this.calculateInstance.getParseArgumentSeparator();\n                break;\n            case 'addDefinedName':\n                args.isAdded = this.addDefinedName(args.definedName);\n                break;\n            case 'removeDefinedName':\n                args.isRemoved = this.removeDefinedName(args.definedName, args.scope);\n                break;\n            case 'initiateDefinedNames':\n                this.initiateDefinedNames();\n                break;\n            case 'renameUpdation':\n                this.renameUpdation(args.value, args.sheetId);\n                break;\n            case 'addSheet':\n                this.sheetInfo.push({ visibleName: args.visibleName, sheet: args.sheetName, index: args.index });\n                break;\n            case 'getSheetInfo':\n                args.sheetInfo = this.sheetInfo;\n                break;\n            case 'deleteSheetTab':\n                length = this.sheetInfo.length;\n                for (var i = 0; i < length; i++) {\n                    if (this.sheetInfo[i].index === args.index) {\n                        args.sheetName = this.sheetInfo[i].sheet;\n                        this.sheetInfo.splice(i, 1);\n                        break;\n                    }\n                }\n                this.calculateInstance.unregisterGridAsSheet((args.index - 1).toString(), args.index);\n                this.calculateInstance.tokenCount = this.calculateInstance.tokenCount - 1;\n                this.sheetDeletion(args.sheetName, args.index, args.index);\n                break;\n            case 'getReferenceError':\n                args.refError = this.referenceError();\n                break;\n            case 'getAlpha':\n                args.col = getAlphalabel(args.col);\n                break;\n            case 'addCustomFunction':\n                this.addCustomFunction(args.functionHandler, args.functionName);\n                break;\n            case 'computeExpression':\n                args.calcValue = this.calculateInstance.computeExpression(args.formula);\n                break;\n            case 'registerGridInCalc':\n                this.calculateInstance.grid = args.sheetID;\n                break;\n            case 'refreshInsDelFormula':\n                this.refreshInsDelFormula(args.insertArgs);\n                break;\n            case 'refreshNamedRange':\n                this.refreshNamedRange(args.insertArgs);\n                break;\n        }\n    };\n    WorkbookFormula.prototype.referenceError = function () {\n        return this.calculateInstance.getErrorStrings()[CommonErrors.ref];\n    };\n    WorkbookFormula.prototype.getSheetInfo = function () {\n        return this.sheetInfo;\n    };\n    WorkbookFormula.prototype.addCustomFunction = function (functionHandler, functionName) {\n        this.calculateInstance.defineFunction(functionName, functionHandler);\n    };\n    WorkbookFormula.prototype.updateSheetInfo = function () {\n        var _this = this;\n        this.sheetInfo = [];\n        this.parent.sheets.forEach(function (sheet, idx) {\n            _this.sheetInfo.push({ visibleName: sheet.name, sheet: 'Sheet' + sheet.id, index: idx });\n        });\n    };\n    WorkbookFormula.prototype.getUniqueRange = function (args) {\n        args.range = this.calculateInstance.uniqueRange;\n    };\n    WorkbookFormula.prototype.removeUniquecol = function () {\n        var cellAddr = this.parent.getActiveSheet().activeCell;\n        for (var i = 0; i < this.calculateInstance.uniqueRange.length; i++) {\n            if (this.calculateInstance.uniqueRange[i].split(':')[0] === cellAddr) {\n                var range = getRangeIndexes(this.calculateInstance.uniqueRange[i]);\n                this.calculateInstance.uniqueRange.splice(i, 1);\n                for (var j = range[0]; j <= range[2]; j++) {\n                    for (var k = range[1]; k <= range[3]; k++) {\n                        var cell = getCell(j, k, this.parent.getActiveSheet());\n                        cell.formula = '';\n                        this.parent.updateCell({ value: '', formula: '' }, getRangeAddress([j, k]));\n                    }\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.sheetDeletion = function (delSheetName, sheetId, index) {\n        var dependentCell = this.calculateInstance.getDependentCells();\n        var cellRef = [];\n        var fInfo = null;\n        var formulaVal = '';\n        var rowId;\n        var colId;\n        dependentCell.forEach(function (value, key) {\n            cellRef.push(key);\n        });\n        this.removeSheetTokenIndex(formulaVal, index);\n        for (var i = 0; i < cellRef.length; i++) {\n            var dependentCellRef = this.calculateInstance.getDependentCells().get(cellRef[i]);\n            for (var j = 0; j < dependentCellRef.length; j++) {\n                fInfo = this.calculateInstance.getFormulaInfoTable().get(dependentCellRef[j]);\n                sheetId = parseInt(dependentCellRef[j].split('!')[1], 10) + 1;\n                if (!isNullOrUndefined(fInfo) && sheetId > -1) {\n                    formulaVal = fInfo.formulaText;\n                    if (formulaVal.toUpperCase().indexOf(delSheetName.toUpperCase()) > -1) {\n                        formulaVal = formulaVal.toUpperCase().split(delSheetName.toUpperCase() +\n                            this.calculateInstance.sheetToken).join(this.referenceError());\n                        rowId = this.calculateInstance.rowIndex(dependentCellRef[j]);\n                        colId = this.calculateInstance.colIndex(dependentCellRef[j]);\n                        this.updateDataContainer([rowId - 1, colId - 1], { value: formulaVal, sheetId: sheetId, visible: false });\n                        this.calculateInstance.refresh(fInfo.getParsedFormula());\n                    }\n                }\n                if (delSheetName.split('Sheet')[1] === cellRef[i].split('!')[1]) {\n                    this.calculateInstance.getFormulaInfoTable().delete(cellRef[i]);\n                    this.calculateInstance.clearFormulaDependentCells(cellRef[i]);\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.removeSheetTokenIndex = function (value, index) {\n        var family = this.calculateInstance.getSheetFamilyItem(this.calculateInstance.grid);\n        family.sheetNameToToken.delete(index.toString());\n        family.sheetNameToParentObject.delete(index.toString());\n        family.parentObjectToToken.delete(index.toString());\n        family.tokenToParentObject.delete('!' + (index - 1).toString() + '!');\n        return value;\n    };\n    WorkbookFormula.prototype.renameUpdation = function (name, sheetIdx) {\n        var dependentCellRef = this.calculateInstance.getDependentCells();\n        var cellRef = [];\n        var fInfo;\n        var formulaVal = '';\n        var savedTokens = [];\n        var isSheetRenamed = false;\n        var rowIndex;\n        var colIndex;\n        var sheetIndex;\n        dependentCellRef.forEach(function (value, key) {\n            cellRef.push(key);\n        });\n        for (var i = 0; i < this.sheetInfo.length; i++) {\n            if (this.sheetInfo[i].index === sheetIdx) {\n                this.sheetInfo[i].visibleName = name;\n                break;\n            }\n        }\n        var sheetNames = this.sheetInfo;\n        for (var i = 0; i < cellRef.length; i++) {\n            var dependentCells = this.calculateInstance.getDependentCells().get(cellRef[i]);\n            for (var j = 0; j < dependentCells.length; j++) {\n                fInfo = this.calculateInstance.getFormulaInfoTable().get(dependentCells[j]);\n                formulaVal = fInfo.formulaText;\n                for (var s = 0; s < sheetNames.length; s++) {\n                    if (sheetNames[s].visibleName !== sheetNames[s].sheet) {\n                        var name_1 = sheetNames[s].sheet.toUpperCase();\n                        if (formulaVal.toUpperCase().indexOf(name_1) > -1) {\n                            formulaVal = formulaVal.toUpperCase().split(name_1).join(s + '/');\n                            savedTokens.push(s);\n                            isSheetRenamed = true;\n                        }\n                    }\n                }\n                if (isSheetRenamed) {\n                    for (var k = 0; k < savedTokens.length; k++) {\n                        formulaVal = formulaVal.split(savedTokens[k].toString() + '/').join(sheetNames[savedTokens[k]].visibleName);\n                    }\n                    rowIndex = this.calculateInstance.rowIndex(dependentCells[j]);\n                    colIndex = this.calculateInstance.colIndex(dependentCells[j]);\n                    sheetIndex = getSheetIndexByName(this.parent, ('Sheet') + (parseInt(dependentCells[j].split('!')[1], 10) + 1), this.sheetInfo);\n                    this.updateDataContainer([rowIndex - 1, colIndex - 1], { value: formulaVal, sheetId: sheetIndex, visible: true });\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.updateDataContainer = function (indexes, data) {\n        var rowIndex = indexes[0];\n        var colIndex = indexes[1];\n        var sheetData;\n        var rowData;\n        var colObj;\n        var len = this.parent.sheets.length;\n        for (var i = 0; i < len; i++) {\n            if (this.parent.sheets[i].id === data.sheetId) {\n                sheetData = this.parent.sheets[i].rows;\n                break;\n            }\n        }\n        if (!isNullOrUndefined(data)) {\n            if (rowIndex in sheetData) {\n                rowData = sheetData[rowIndex];\n                if (colIndex in rowData.cells) {\n                    colObj = rowData.cells[colIndex];\n                    colObj.formula = data.value;\n                    colObj.value = data.visible ? colObj.value : this.referenceError();\n                }\n                else {\n                    rowData.cells[colIndex] = colObj = {};\n                }\n            }\n            else {\n                rowData = sheetData[rowIndex] = {};\n                rowData[colIndex] = colObj = {};\n            }\n        }\n    };\n    WorkbookFormula.prototype.parseSheetRef = function (value) {\n        var regx;\n        // eslint-disable-next-line no-useless-escape\n        var escapeRegx = new RegExp('[!@#$%^&()+=\\';,.{}|\\\":<>~_-]', 'g');\n        var i = 0;\n        var sheetCount = this.parent.sheets.length;\n        var temp = [];\n        temp.length = 0;\n        var regxTemp;\n        var searchIdx;\n        var idx;\n        var valSearchIdx;\n        var regxVisible;\n        var sheetInfo = this.getSheetInfo();\n        var exp = '(?=[\\'!])(?=[^\"]*(?:\"[^\"]*\"[^\"]*)*$)';\n        for (i = 0; i < sheetCount; i++) {\n            if (sheetInfo[i].sheet !== sheetInfo[i].visibleName) {\n                regx = new RegExp(sheetInfo[i].visibleName.replace(escapeRegx, '\\\\$&') + exp, 'gi');\n                idx = i;\n                if (value.match(regx)) {\n                    for (var j = i + 1; j < sheetCount; j++) {\n                        regxTemp = new RegExp(sheetInfo[j].visibleName.replace(escapeRegx, '\\\\$&') + exp, 'gi');\n                        searchIdx = value.search(regxTemp);\n                        valSearchIdx = value.search(regx);\n                        if (searchIdx > -1 && (searchIdx < valSearchIdx || (searchIdx === valSearchIdx && sheetInfo[j].visibleName.length >\n                            sheetInfo[i].visibleName.length))) {\n                            regxVisible = new RegExp('Sheet', 'gi');\n                            if (sheetInfo[j].visibleName.search(regxVisible) !== 0) {\n                                regx = regxTemp;\n                                idx = j;\n                            }\n                        }\n                    }\n                    value = value.replace(regx, idx + '/');\n                    temp.push(idx);\n                }\n            }\n        }\n        i = 0;\n        while (i < temp.length) {\n            regx = new RegExp(temp[i] + '/' + exp, 'gi');\n            value = value.replace(regx, sheetInfo[temp[i]].sheet);\n            i++;\n        }\n        return value;\n    };\n    WorkbookFormula.prototype.registerSheet = function (sheetIndex, sheetCount) {\n        if (sheetIndex === void 0) { sheetIndex = 0; }\n        if (sheetCount === void 0) { sheetCount = this.parent.sheets.length; }\n        var id;\n        while (sheetIndex < sheetCount) {\n            id = getSheet(this.parent, sheetIndex).id + '';\n            this.calculateInstance.registerGridAsSheet(id, id, this.calcID);\n            sheetIndex++;\n        }\n    };\n    WorkbookFormula.prototype.unRegisterSheet = function (sheetIndex, sheetCount, propertyChange) {\n        if (sheetIndex === void 0) { sheetIndex = 0; }\n        if (sheetCount === void 0) { sheetCount = this.parent.sheets.length; }\n        var id;\n        this.calculateInstance.tokenCount = 0;\n        if (propertyChange) {\n            this.calculateInstance.unregisterGridAsSheet(id, id, propertyChange);\n        }\n        else {\n            while (sheetIndex < sheetCount) {\n                id = getSheet(this.parent, sheetIndex).id + '';\n                this.calculateInstance.unregisterGridAsSheet(id, id);\n                sheetIndex++;\n            }\n        }\n    };\n    WorkbookFormula.prototype.refreshCalculate = function (rowIdx, colIdx, value, isFormula, sheetIdx, isRefreshing) {\n        var sheet = isNullOrUndefined(sheetIdx) ? this.parent.getActiveSheet() : getSheet(this.parent, sheetIdx);\n        var sheetName = sheet.id + '';\n        if (isFormula) {\n            value = this.parseSheetRef(value);\n            var cellArgs = new ValueChangedArgs(rowIdx + 1, colIdx + 1, value);\n            var usedRange = [sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n            this.calculateInstance.valueChanged(sheetName, cellArgs, true, usedRange, isRefreshing);\n            var referenceCollection = this.calculateInstance.randCollection;\n            if (this.calculateInstance.isRandomVal === true) {\n                var rowId = void 0;\n                var colId = void 0;\n                var refValue = '';\n                if (this.calculateInstance.randomValues.size > 1 && this.calculateInstance.randomValues.size ===\n                    referenceCollection.length) {\n                    for (var i = 0; i < this.calculateInstance.randomValues.size; i++) {\n                        rowId = this.calculateInstance.rowIndex(referenceCollection[i]);\n                        colId = this.calculateInstance.colIndex(referenceCollection[i]);\n                        refValue = this.calculateInstance.randomValues.get(referenceCollection[i]);\n                        sheetName = (parseFloat(this.calculateInstance.getSheetToken(referenceCollection[i]).split(this.calculateInstance.sheetToken).join('')) + 1).toString();\n                        var tempArgs = new ValueChangedArgs(rowId, colId, refValue);\n                        this.calculateInstance.valueChanged(sheetName, tempArgs, true);\n                    }\n                }\n            }\n        }\n        else {\n            var family = this.calculateInstance.getSheetFamilyItem(sheetName);\n            var cellRef = getColumnHeaderText(colIdx + 1) + (rowIdx + 1);\n            if (family.isSheetMember && !isNullOrUndefined(family.parentObjectToToken)) {\n                cellRef = family.parentObjectToToken.get(sheetName) + cellRef;\n            }\n            if (this.calculateInstance.getFormulaInfoTable().has(cellRef)) {\n                this.calculateInstance.getFormulaInfoTable().delete(cellRef);\n                if (this.calculateInstance.getDependentCells().has(cellRef)) {\n                    this.calculateInstance.clearFormulaDependentCells(cellRef);\n                }\n            }\n            this.calculateInstance.getComputedValue().clear();\n            this.calculateInstance.refresh(cellRef);\n            this.calculateInstance.refreshRandValues(cellRef);\n        }\n        this.calculateInstance.cell = '';\n        var updatedCell = getCell(rowIdx, colIdx, this.parent.getActiveSheet());\n        if (updatedCell && value && value.toString().toUpperCase().indexOf('=SUM(') === 0) {\n            var errorStrings = ['#N/A', '#VALUE!', '#REF!', '#DIV/0!', '#NUM!', '#NAME?', '#NULL!', 'invalid arguments'];\n            var val = value.toString().toUpperCase().replace('=SUM', '').replace('(', '').replace(')', '').split(':')[0];\n            if (isCellReference(val)) {\n                var index = getRangeIndexes(val);\n                var fCell = getCell(index[0], index[1], this.parent.getActiveSheet());\n                if (fCell && fCell.value && fCell.format &&\n                    errorStrings.indexOf(updatedCell.value) < 0 && errorStrings.indexOf(fCell.value) < 0) {\n                    updatedCell.format = fCell.format;\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.autoCorrectFormula = function (formula, rowIdx, colIdx, sheetIdx) {\n        if (!isNullOrUndefined(formula)) {\n            formula = formula.toString();\n            if (formula.split('(').length === 2 && formula.indexOf(')') < 0) {\n                formula += ')';\n            }\n            var isEqual = void 0;\n            if (formula.indexOf('=') === 0) {\n                formula = formula.slice(1);\n                isEqual = true;\n            }\n            var lessEq = formula.match(/</g);\n            var greaterEq = formula.match(/>/g);\n            var equal = formula.match(/=/g);\n            if (lessEq) {\n                var lessOp = '';\n                for (var i = 0; i < lessEq.length; i++) {\n                    lessOp = lessOp + lessEq[i];\n                }\n                formula = formula.replace(lessOp, '<');\n            }\n            if (greaterEq) {\n                var greaterOp = '';\n                for (var j = 0; j < greaterEq.length; j++) {\n                    greaterOp = greaterOp + greaterEq[j];\n                }\n                formula = formula.replace(greaterOp, '>');\n            }\n            if (equal) {\n                var equalOp = '';\n                for (var c = 0; c < equal.length; c++) {\n                    equalOp = equalOp + equal[c];\n                }\n                formula = formula.split(equalOp).join('=');\n            }\n            formula = isEqual ? '=' + formula : formula;\n            if (lessEq || greaterEq || equal) {\n                getCell(rowIdx, colIdx, isNullOrUndefined(sheetIdx) ? this.parent.getActiveSheet() : getSheet(this.parent, sheetIdx)).formula = formula;\n            }\n        }\n        return formula;\n    };\n    WorkbookFormula.prototype.initiateDefinedNames = function () {\n        var definedNames = this.parent.definedNames;\n        var i = 0;\n        while (i < definedNames.length) {\n            var definedname = definedNames[i];\n            var refersTo = this.parseSheetRef(definedname.refersTo);\n            var range = getRangeFromAddress(refersTo);\n            var cellRef = false;\n            var isLink = refersTo.indexOf('http:') > -1 ? true : (refersTo.indexOf('https:') > -1 ? true : false);\n            range = range.split('$').join('');\n            range = range.split('=').join('');\n            if (range.indexOf(':') > -1) {\n                var rangeSplit = range.split(':');\n                if (isCellReference(rangeSplit[0]) && isCellReference(rangeSplit[1])) {\n                    cellRef = true;\n                }\n            }\n            else if (range.indexOf(':') < 0) {\n                if (isCellReference(range)) {\n                    cellRef = true;\n                }\n            }\n            if (isLink) {\n                cellRef = false;\n            }\n            if (cellRef) {\n                this.addDefinedName(definedname, true);\n            }\n            else {\n                this.removeDefinedName(definedname.name, definedname.scope);\n                i--;\n            }\n            i++;\n        }\n    };\n    /**\n     * @hidden\n     * Used to add defined name to workbook.\n     *\n     * @param {DefineNameModel} definedName - Define named range.\n     * @param {boolean} isValidate - Specify the boolean value.\n     * @returns {boolean} - Used to add defined name to workbook.\n     */\n    WorkbookFormula.prototype.addDefinedName = function (definedName, isValidate) {\n        var isAdded = true;\n        var sheetIdx;\n        var name = definedName.name;\n        if (definedName.refersTo.indexOf('!') < 0) {\n            var sheetName = getSheetName(this.parent);\n            sheetName = sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName;\n            definedName.refersTo = sheetName + '!' + ((definedName.refersTo.indexOf('=') < 0) ?\n                definedName.refersTo : definedName.refersTo.split('=')[1]);\n        }\n        var visibleRefersTo = definedName.refersTo;\n        var refersTo = this.parseSheetRef(definedName.refersTo);\n        if (definedName.scope) {\n            sheetIdx = getSheetIndex(this.parent, definedName.scope);\n            if (sheetIdx > -1) {\n                name = getSheetName(this.parent, sheetIdx) + '!' + name;\n            }\n        }\n        else {\n            definedName.scope = '';\n        }\n        if (!definedName.comment) {\n            definedName.comment = '';\n        }\n        //need to extend once internal sheet value changes done.\n        if (!isValidate && this.checkIsNameExist(definedName.name, definedName.scope)) {\n            isAdded = false;\n        }\n        else {\n            this.calculateInstance.addNamedRange(name, refersTo[0] === '=' ? refersTo.substr(1) : refersTo);\n            if (refersTo[0] !== '=') {\n                definedName.refersTo = '=' + visibleRefersTo;\n            }\n            if (this.parent.definedNames.indexOf(definedName) < 0) {\n                this.parent.definedNames.push(definedName);\n            }\n        }\n        return isAdded;\n    };\n    /**\n     * @hidden\n     * Used to remove defined name from workbook.\n     *\n     * @param {string} name - Specifies the defined name.\n     * @param {string} scope - Specifies the scope of the define name.\n     * @returns {boolean} - To Return the bool value.\n     */\n    WorkbookFormula.prototype.removeDefinedName = function (name, scope) {\n        var isRemoved = false;\n        var index = this.getIndexFromNameColl(name, scope);\n        if (index > -1) {\n            var calcName = name;\n            if (scope) {\n                var sheetIdx = getSheetIndex(this.parent, scope);\n                if (sheetIdx) {\n                    calcName = getSheetName(this.parent, sheetIdx) + '!' + name;\n                }\n            }\n            this.calculateInstance.removeNamedRange(calcName);\n            this.parent.definedNames.splice(index, 1);\n            isRemoved = true;\n        }\n        return isRemoved;\n    };\n    WorkbookFormula.prototype.checkIsNameExist = function (name, sheetName) {\n        var isExist = this.parent.definedNames.some(function (key) {\n            return key.name === name && (sheetName ? key.scope === sheetName : key.scope === '');\n        });\n        return isExist;\n    };\n    WorkbookFormula.prototype.getIndexFromNameColl = function (definedName, scope) {\n        if (scope === void 0) { scope = ''; }\n        var index = -1;\n        this.parent.definedNames.filter(function (name, idx) {\n            if (name.name === definedName && name.scope === scope) {\n                index = idx;\n            }\n        });\n        return index;\n    };\n    WorkbookFormula.prototype.toFixed = function (value) {\n        var num = Number(value);\n        if (Math.round(num) !== num) {\n            value = num.toFixed(2);\n        }\n        return value;\n    };\n    WorkbookFormula.prototype.aggregateComputation = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSingleSelectedRange(sheet);\n        var indexes = getRangeIndexes(range.split(':')[1]);\n        var i;\n        var calcValue;\n        var formulaVal = ['SUM', 'AVERAGE', 'MIN', 'MAX'];\n        var formatedValues = [];\n        if (indexes[0] + 1 === sheet.rowCount && indexes[1] + 1 === sheet.colCount) {\n            range = \"A1:\" + getCellAddress(sheet.usedRange.rowIndex, sheet.usedRange.colIndex);\n        }\n        var actCell = getRangeIndexes(sheet.activeCell);\n        var actCellModel = sheet.rows[actCell[0]] ? sheet.rows[actCell[0]].cells ?\n            sheet.rows[actCell[0]].cells[actCell[1]] : {} : {};\n        var actCellfrmt = (actCellModel) ? actCellModel.format : '';\n        var cellValue;\n        var cellCol = this.calculateInstance.getCellCollection(range);\n        for (i = 0; i < cellCol.length; i++) {\n            cellValue = this.calculateInstance.getValueFromArg(cellCol[i]);\n            if (isNumber(cellValue)) {\n                args.countOnly = false;\n                break;\n            }\n        }\n        args.Count = this.calculateInstance.getFunction('COUNTA')(range);\n        if (!args.Count || args.countOnly) {\n            return;\n        }\n        for (i = 0; i < 4; i++) {\n            calcValue = this.toFixed(this.calculateInstance.getFunction(formulaVal[i])(range));\n            var eventArgs = {\n                formattedText: calcValue,\n                value: calcValue,\n                format: actCellfrmt,\n                onLoad: true\n            };\n            if (actCellfrmt) {\n                this.parent.notify(getFormattedCellObject, eventArgs);\n                calcValue = eventArgs.formattedText;\n            }\n            formatedValues.push(calcValue);\n        }\n        args.Sum = formatedValues[0];\n        args.Avg = formatedValues[1];\n        args.Min = formatedValues[2];\n        args.Max = formatedValues[3];\n    };\n    WorkbookFormula.prototype.clearFormula = function (args) {\n        if (this.parent.activeSheetIndex === args.sheetIdx) {\n            args.rowIdx = (args.type === 'Row') ? (args.status === 'insert') ? (args.rowIdx >= args.startIdx)\n                ? args.rowIdx - args.count : args.rowIdx : args.rowIdx + args.count : args.rowIdx;\n            args.colIdx = (args.type === 'Column') ? (args.status === 'insert') ? (args.colIdx >= args.startIdx) ?\n                args.colIdx - args.count : args.colIdx : args.colIdx + args.count : args.colIdx;\n        }\n        var cellRef = '!' + args.sheetIdx + '!' + getAlphalabel((args.colIdx === -1 ?\n            (args.colIdx + 2) : (args.colIdx + 1))) + (args.rowIdx === -1 ? (args.rowIdx + 2) : (args.rowIdx + 1));\n        this.calculateInstance.getFormulaInfoTable().delete(cellRef);\n        this.calculateInstance.clearFormulaDependentCells(cellRef);\n    };\n    WorkbookFormula.prototype.refreshFormula = function (formulaValue, count, status, type, startIdx, sheetIdx) {\n        var diff;\n        var diff1;\n        var val = formulaValue;\n        var nAlpha;\n        var range = [];\n        var actSheet = this.parent.getActiveSheet();\n        var deleteIdxs = [];\n        var i;\n        var splitFormula = [];\n        var fArg;\n        var ridx;\n        var pVal;\n        if (checkIsFormula(val)) {\n            if (status === 'delete') {\n                for (i = 1; i <= count; i++) {\n                    deleteIdxs.push(startIdx + i);\n                }\n            }\n            splitFormula = this.parseFormula(val);\n            for (i = 0; i < splitFormula.length; i++) {\n                fArg = splitFormula[i].trim();\n                if (this.calculateInstance.isCellReference(fArg)) {\n                    pVal = i && splitFormula[i - 1].trim();\n                    if (pVal && pVal[pVal.length - 1] === '!') {\n                        pVal = pVal.replace(/['!]/g, '');\n                        if (pVal !== actSheet.name) {\n                            continue;\n                        }\n                    }\n                    else if (parseInt(pVal, 10) === 0 && pVal[pVal.length - 1] === undefined) {\n                        if ((actSheet.id - 1) !== sheetIdx) {\n                            continue;\n                        }\n                    }\n                    range = getRangeIndexes(fArg);\n                    diff = (type === 'Column') ? (status === 'insert') ? range[3] + count : range[3] - count :\n                        (status === 'insert') ? range[2] + count : range[2] - count;\n                    diff1 = (type === 'Column') ? (status === 'insert') ? range[1] + count : range[1] - count :\n                        (status === 'insert') ? range[0] + count : range[0] - count;\n                    diff1 = (type === 'Column') ? (startIdx > range[1]) ? range[1] : diff1 : (startIdx > range[0]) ? range[0] : diff1;\n                    diff = (type === 'Column') ? (startIdx > range[3]) ? range[3] : diff : (startIdx > range[2]) ? range[2] : diff;\n                    if (diff1 > -1) {\n                        nAlpha = (type === 'Column') ? getRangeAddress([range[0], diff1, range[2], diff]).split(':')[0] :\n                            getRangeAddress([diff1, range[1], diff, range[3]]).split(':')[0];\n                    }\n                    else {\n                        nAlpha = '#REF!';\n                    }\n                    if (status === 'delete') {\n                        ridx = parseInt(type === 'Row' ? fArg.replace(/[A-Z]/g, '') : (fArg.replace(/[0-9]/g, '')), 10);\n                        if (deleteIdxs.indexOf(ridx) > -1) {\n                            nAlpha = '#REF!';\n                        }\n                    }\n                    splitFormula[i] = nAlpha;\n                }\n            }\n            val = '=' + splitFormula.join('');\n        }\n        return val;\n    };\n    WorkbookFormula.prototype.refreshInsDelFormula = function (args) {\n        var count;\n        var sheet;\n        var sheets = this.parent.sheets;\n        var sheetLen = sheets.length;\n        if (isNullOrUndefined(args.activeSheetIndex)) {\n            args.activeSheetIndex = this.parent.activeSheetIndex;\n        }\n        var sheetName = this.parent.sheets[args.activeSheetIndex].name;\n        var address;\n        var cell;\n        var s;\n        var updatedFormulaVal;\n        for (s = 0; s < sheetLen; s++) {\n            count = args.model.length;\n            sheet = this.parent.sheets[s];\n            address = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n            for (var i = address[2]; i >= address[0]; i--) {\n                for (var j = address[1]; j <= address[3]; j++) {\n                    cell = getCell(i, j, sheet);\n                    if (cell && cell.formula && checkIsFormula(cell.formula)) {\n                        if (args.activeSheetIndex !== s && !cell.formula.includes(sheetName)) {\n                            continue;\n                        }\n                        this.clearFormula({\n                            rowIdx: i, colIdx: j, sheetIdx: s, count: count, status: args.name,\n                            type: args.modelType, startIdx: args.startIndex\n                        });\n                        updatedFormulaVal = this.refreshFormula(cell.formula, count, args.name, args.modelType, args.startIndex, s);\n                        this.parent.notify(workbookEditOperation, {\n                            action: 'updateCellValue', address: [i, j, i,\n                                j], value: updatedFormulaVal, sheetIndex: s\n                        });\n                    }\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.parseFormula = function (formula) {\n        var temp;\n        var str;\n        var i = 0;\n        var arr = [];\n        var formulaVal = [];\n        formulaVal = this.markSpecialChar(formula.replace('=', ''));\n        formulaVal = formulaVal.split(/\\(|\\)|=|\\^|>|<|,|:|\\+|-|\\*|\\/|%|&/g);\n        var len = formulaVal.length;\n        while (i < len) {\n            temp = formulaVal[i];\n            if (!temp) {\n                i++;\n                continue;\n            }\n            if (temp.length === 1) {\n                arr.push(this.isUniqueChar(temp) ? this.getUniqueCharVal(temp) : temp);\n            }\n            else {\n                str = temp[0];\n                if (temp.indexOf('!') > 0) {\n                    if (this.isUniqueChar(str)) {\n                        arr.push(this.getUniqueCharVal(str));\n                        temp = temp.substr(1);\n                    }\n                    str = temp.indexOf('!') + 1;\n                    arr.push(temp.substr(0, str));\n                    arr.push(temp.substr(str));\n                }\n                else if (this.isUniqueChar(str)) {\n                    arr.push(this.getUniqueCharVal(str));\n                    arr.push(temp.substr(1));\n                }\n                else {\n                    arr.push(temp);\n                }\n            }\n            i++;\n        }\n        return arr;\n    };\n    WorkbookFormula.prototype.getUniqueCharVal = function (formula) {\n        switch (formula) {\n            case this.uniqueOBracket:\n                return '(';\n            case this.uniqueCBracket:\n                return ')';\n            case this.uniqueCSeparator:\n                return ',';\n            case this.uniqueCOperator:\n                return ':';\n            case this.uniquePOperator:\n                return '+';\n            case this.uniqueSOperator:\n                return '-';\n            case this.uniqueMOperator:\n                return '*';\n            case this.uniqueDOperator:\n                return '/';\n            case this.uniqueModOperator:\n                return '%';\n            case this.uniqueConcateOperator:\n                return '&';\n            case this.uniqueEqualOperator:\n                return '=';\n            case this.uniqueExpOperator:\n                return '^';\n            case this.uniqueGTOperator:\n                return '>';\n            case this.uniqueLTOperator:\n                return '<';\n        }\n        return '';\n    };\n    WorkbookFormula.prototype.isUniqueChar = function (formula) {\n        var code = formula.charCodeAt(formula);\n        return code >= 129 && code <= 142;\n    };\n    WorkbookFormula.prototype.markSpecialChar = function (formula) {\n        formula = formula.replace(/\\(/g, '(' + this.uniqueOBracket).replace(/\\)/g, ')' + this.uniqueCBracket);\n        formula = formula.replace(/,/g, ',' + this.uniqueCSeparator).replace(/:/g, ':' + this.uniqueCOperator);\n        formula = formula.replace(/\\+/g, '+' + this.uniquePOperator).replace(/-/g, '-' + this.uniqueSOperator);\n        formula = formula.replace(/\\*/g, '*' + this.uniqueMOperator).replace(/\\//g, '/' + this.uniqueDOperator);\n        formula = formula.replace(/&/g, '&' + this.uniqueConcateOperator);\n        formula = formula.replace(/=/g, '=' + this.uniqueEqualOperator);\n        formula = formula.replace(/\\^/g, '^' + this.uniqueExpOperator);\n        formula = formula.replace(/>/g, '>' + this.uniqueGTOperator).replace(/</g, '<' + this.uniqueLTOperator);\n        return formula.replace(/%/g, '%' + this.uniqueModOperator);\n    };\n    WorkbookFormula.prototype.refreshNamedRange = function (args) {\n        var isChanged = false;\n        var modelDefinedNames = this.parent.definedNames;\n        var definedNames = Object.assign({}, modelDefinedNames);\n        var definedName;\n        var definedNameCnt = modelDefinedNames.length;\n        var range;\n        var rangeIndex;\n        var count;\n        var startIndex;\n        var endIndex;\n        var newIndex;\n        var newRange;\n        var sheetName;\n        var sheetIndex;\n        for (var idx = 0; idx < definedNameCnt; idx++) {\n            definedName = definedNames[idx];\n            range = definedNames[idx].refersTo.split('!')[1];\n            rangeIndex = getRangeIndexes(range);\n            sheetName = definedName.refersTo.split('!')[0].split('=')[1];\n            sheetIndex = getSheetIndex(this.parent, sheetName.replace(/'/g, ''));\n            if (sheetIndex === this.parent.activeSheetIndex) {\n                if (args.name === 'insert') {\n                    count = args.model.length;\n                    startIndex = args.index;\n                    endIndex = args.index + count;\n                    if (args.modelType === 'Row') { // for above the named range index\n                        if ((rangeIndex[0] >= endIndex) || (rangeIndex[0] >= startIndex && rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0] + count, rangeIndex[1], rangeIndex[2] + count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[0] <= startIndex && rangeIndex[2] >= startIndex) || (rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2] + count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                    }\n                    else if (args.modelType === 'Column') {\n                        if ((rangeIndex[1] >= endIndex) || (rangeIndex[1] >= startIndex && rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1] + count, rangeIndex[2], rangeIndex[3] + count];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[1] <= startIndex && rangeIndex[3] >= startIndex) || (rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2], rangeIndex[3] + count];\n                            isChanged = true;\n                        }\n                    }\n                }\n                else {\n                    count = args.deletedModel.length;\n                    startIndex = args.startIndex;\n                    endIndex = args.endIndex;\n                    if (args.modelType === 'Row') { // for above the named range index\n                        if ((rangeIndex[0] >= endIndex) || (rangeIndex[0] >= startIndex && rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0] - count, rangeIndex[1], rangeIndex[2] - count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[0] <= startIndex && rangeIndex[2] >= startIndex) || (rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2] - count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                    }\n                    else if (args.modelType === 'Column') {\n                        if ((rangeIndex[1] >= endIndex) || (rangeIndex[1] >= startIndex && rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1] - count, rangeIndex[2], rangeIndex[3] - count];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[1] <= startIndex && rangeIndex[3] >= startIndex) || (rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2], rangeIndex[3] - count];\n                            isChanged = true;\n                        }\n                    }\n                }\n                if (isChanged) {\n                    newRange = getRangeAddress(newIndex);\n                    definedName.refersTo = sheetName + '!' + newRange;\n                    this.parent.removeDefinedName(definedName.name, definedName.scope);\n                    var eventArgs = {\n                        action: 'addDefinedName', definedName: definedName, isAdded: false\n                    };\n                    this.parent.notify(workbookFormulaOperation, eventArgs);\n                }\n            }\n            modelDefinedNames = definedNames;\n        }\n    };\n    return WorkbookFormula;\n}());\nexport { WorkbookFormula };\n","import { getCell, setCell, getData } from '../base/index';\nimport { DataManager, Query, DataUtil, Deferred } from '@syncfusion/ej2-data';\nimport { getCellIndexes, getIndexesFromAddress, getColumnHeaderText, getRangeAddress, workbookLocale, isNumber, getUpdatedFormula, getDataRange } from '../common/index';\nimport { getSwapRange } from '../common/index';\nimport { parseIntValue } from '../common/index';\nimport { initiateSort } from '../common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookSort` module is used to handle sort action in Spreadsheet.\n */\nvar WorkbookSort = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     *\n     * @param {Workbook} parent - Specifies the workbook.\n     */\n    function WorkbookSort(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     *\n     * @returns {void} - To destroy the sort module.\n     */\n    WorkbookSort.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookSort.prototype.addEventListener = function () {\n        this.parent.on(initiateSort, this.initiateSortHandler, this);\n    };\n    WorkbookSort.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateSort, this.initiateSortHandler);\n        }\n    };\n    /**\n     * Sorts range of cells in the sheet.\n     *\n     * @param {{ args: BeforeSortEventArgs, promise: Promise<SortEventArgs> }} eventArgs - Specify the arguments.\n     * @param {BeforeSortEventArgs} eventArgs.args - arguments for sorting.\n     * @param {Promise<SortEventArgs>} eventArgs.promise - Specify the promise.\n     * @returns {void} - Sorts range of cells in the sheet.\n     */\n    WorkbookSort.prototype.initiateSortHandler = function (eventArgs) {\n        var _this = this;\n        var args = eventArgs.args;\n        var deferred = new Deferred();\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(args.range));\n        var sortOptions = args.sortOptions || { sortDescriptors: {}, containsHeader: true };\n        var isSingleCell = false;\n        eventArgs.promise = deferred.promise;\n        if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n            deferred.reject(this.parent.serviceLocator.getService(workbookLocale).getConstant('SortOutOfRangeError'));\n            return;\n        }\n        var containsHeader = sortOptions.containsHeader;\n        if (range[0] === range[2]) { //if selected range is a single cell\n            range = getDataRange(range[0], range[1], sheet);\n            isSingleCell = true;\n            if (isNullOrUndefined(sortOptions.containsHeader)) {\n                if (typeof getCell(range[0], range[1], sheet, null, true).value ===\n                    typeof getCell(range[0] + 1, range[1], sheet, null, true).value) {\n                    containsHeader = this.isSameStyle(getCell(range[0], range[1], sheet, null, true).style, getCell(range[0] + 1, range[1], sheet, null, true).style) ? false : true;\n                }\n                else {\n                    containsHeader = true;\n                }\n            }\n        }\n        if ((isNullOrUndefined(args.sortOptions) || isNullOrUndefined(args.sortOptions.containsHeader)) && !isSingleCell) {\n            if (!isNullOrUndefined(getCell(range[0], range[1], sheet)) && !isNullOrUndefined(getCell(range[0] + 1, range[1], sheet))) {\n                if (typeof getCell(range[0], range[1], sheet).value === typeof getCell(range[0] + 1, range[1], sheet).value) {\n                    containsHeader = false;\n                }\n                else {\n                    containsHeader = true;\n                }\n            }\n        }\n        var sRIdx = range[0] = containsHeader ? range[0] + 1 : range[0];\n        var sCIdx;\n        var eCIdx;\n        var cell = getCellIndexes(sheet.activeCell);\n        var header = getColumnHeaderText(cell[1] + 1);\n        var sortDescriptors = sortOptions.sortDescriptors;\n        var address = getRangeAddress(range);\n        getData(this.parent, sheet.name + \"!\" + address, true).then(function (jsonData) {\n            var dataManager = new DataManager(jsonData);\n            var query = new Query();\n            if (Array.isArray(sortDescriptors)) { //multi-column sorting.\n                if (!sortDescriptors || sortDescriptors.length === 0) {\n                    sortDescriptors = [{ field: header }];\n                }\n                for (var length_1 = sortDescriptors.length, i = length_1 - 1; i > -1; i--) {\n                    if (!sortDescriptors[length_1 - 1].field) {\n                        sortDescriptors[length_1 - 1].field = header;\n                    }\n                    if (!sortDescriptors[i].field) {\n                        continue;\n                    }\n                    var comparerFn = sortDescriptors[i].sortComparer\n                        || _this.sortComparer.bind(_this, sortDescriptors[i], sortOptions.caseSensitive);\n                    query.sortBy(sortDescriptors[i].field, comparerFn);\n                }\n            }\n            else { //single column sorting.\n                if (!sortDescriptors) {\n                    sortDescriptors = { field: header };\n                }\n                if (!sortDescriptors.field) {\n                    sortDescriptors.field = header;\n                }\n                var comparerFn = sortDescriptors.sortComparer\n                    || _this.sortComparer.bind(_this, sortDescriptors, sortOptions.caseSensitive);\n                query.sortBy(sortDescriptors.field, comparerFn);\n            }\n            dataManager.executeQuery(query).then(function (e) {\n                var colName;\n                var cell = {};\n                var rowKey = '__rowIndex';\n                Array.prototype.forEach.call(e.result, function (data, index) {\n                    if (!data) {\n                        return;\n                    }\n                    sCIdx = range[1];\n                    eCIdx = range[3];\n                    sRIdx = parseInt(jsonData[index][rowKey], 10) - 1;\n                    for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n                        colName = getColumnHeaderText(sCIdx + 1);\n                        cell = data[colName];\n                        if (cell && cell.formula) {\n                            cell.formula =\n                                getUpdatedFormula([sRIdx, sCIdx], [parseInt(data[rowKey], 10) - 1, sCIdx], sheet, cell);\n                        }\n                        setCell(sRIdx, sCIdx, sheet, cell);\n                    }\n                });\n                var eventArgs = { range: sheet.name + \"!\" + address, sortOptions: args.sortOptions };\n                deferred.resolve(eventArgs);\n            });\n        });\n    };\n    WorkbookSort.prototype.isSameStyle = function (firstCellStyle, secondCellStyle) {\n        if (firstCellStyle === void 0) { firstCellStyle = {}; }\n        if (secondCellStyle === void 0) { secondCellStyle = {}; }\n        var sameStyle = true;\n        var keys = Object.keys(firstCellStyle);\n        for (var i = 0; i < keys.length; i++) {\n            if (firstCellStyle[keys[i]] === secondCellStyle[keys[i]] || this.parent.cellStyle[keys[i]] === firstCellStyle[keys[i]]) {\n                sameStyle = true;\n            }\n            else {\n                sameStyle = false;\n                break;\n            }\n        }\n        return sameStyle;\n    };\n    /**\n     * Compares the two cells for sorting.\n     *\n     * @param {SortDescriptor} sortDescriptor - protocol for sorting.\n     * @param {boolean} caseSensitive - value for case sensitive.\n     * @param {CellModel} x - first cell\n     * @param {CellModel} y - second cell\n     * @returns {number} - Compares the two cells for sorting.\n     */\n    WorkbookSort.prototype.sortComparer = function (sortDescriptor, caseSensitive, x, y) {\n        var direction = sortDescriptor.order || '';\n        var comparer = DataUtil.fnSort(direction);\n        var caseOptions = { sensitivity: caseSensitive ? 'case' : 'base' };\n        if (x && y && (typeof x.value === 'string' || typeof y.value === 'string')) {\n            if (isNumber(x.value)) { // Imported number values are of string type, need to handle this case in server side\n                x.value = parseIntValue(x.value);\n            }\n            if (isNumber(y.value)) {\n                y.value = parseIntValue(y.value);\n            }\n            var collator = new Intl.Collator(this.parent.locale, caseOptions);\n            if (!direction || direction.toLowerCase() === 'ascending') {\n                return collator.compare(x.value, y.value);\n            }\n            else {\n                return collator.compare(x.value, y.value) * -1;\n            }\n        }\n        if ((x === null || isNullOrUndefined(x.value)) && (y === null || isNullOrUndefined(y.value))) {\n            return -1;\n        }\n        if (x === null || isNullOrUndefined(x.value)) {\n            return 1;\n        }\n        if (y === null || isNullOrUndefined(y.value)) {\n            return -1;\n        }\n        return comparer(x ? x.value : x, y ? y.value : y);\n    };\n    /**\n     * Gets the module name.\n     *\n     * @returns {string} - Get the module name.\n     */\n    WorkbookSort.prototype.getModuleName = function () {\n        return 'workbookSort';\n    };\n    return WorkbookSort;\n}());\nexport { WorkbookSort };\n","import { getData } from '../base/index';\nimport { DataManager, Query, Deferred, Predicate } from '@syncfusion/ej2-data';\nimport { getCellIndexes, getIndexesFromAddress, getSwapRange, getRangeAddress } from '../common/index';\nimport { initiateFilter, clearAllFilter, dataRefresh } from '../common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookFilter` module is used to handle filter action in Spreadsheet.\n */\nvar WorkbookFilter = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookFilter module.\n     *\n     * @param {Workbook} parent - Constructor for WorkbookFilter module.\n     */\n    function WorkbookFilter(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the filter module.\n     *\n     * @returns {void} - To destroy the filter module.\n     */\n    WorkbookFilter.prototype.destroy = function () {\n        this.removeEventListener();\n        this.filterRange = null;\n        this.parent = null;\n    };\n    WorkbookFilter.prototype.addEventListener = function () {\n        this.parent.on(initiateFilter, this.initiateFilterHandler, this);\n        this.parent.on(clearAllFilter, this.clearAllFilterHandler, this);\n    };\n    WorkbookFilter.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateFilter, this.initiateFilterHandler);\n            this.parent.off(clearAllFilter, this.clearAllFilterHandler);\n        }\n    };\n    /**\n     * Filters a range of cells in the sheet.\n     *\n     * @param { {args: BeforeFilterEventArgs, promise: Promise<FilterEventArgs>}} eventArgs - Specify the event args.\n     * @param {BeforeFilterEventArgs} eventArgs.args - arguments for filtering..\n     * @param {Promise<FilterEventArgs>} eventArgs.promise - Specify the promise.\n     * @returns {void} - Filters a range of cells in the sheet.\n     */\n    WorkbookFilter.prototype.initiateFilterHandler = function (eventArgs) {\n        var _this = this;\n        var args = eventArgs.args;\n        var deferred = new Deferred();\n        var sheet = this.parent.getActiveSheet();\n        var filterOptions = args.filterOptions || {};\n        eventArgs.promise = deferred.promise;\n        this.filterRange = args.range;\n        if (filterOptions.datasource) {\n            this.setFilter(filterOptions.datasource, filterOptions.predicates);\n            var filterEventArgs = { range: args.range, filterOptions: filterOptions };\n            deferred.resolve(filterEventArgs);\n        }\n        else {\n            var range = getSwapRange(getIndexesFromAddress(args.range));\n            if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n                deferred.reject('Select a cell or range inside the used range and try again.');\n                return;\n            }\n            if (range[0] === range[2] && (range[2] - range[0]) === 0) { //if selected range is a single cell\n                range[0] = 0;\n                range[1] = 0;\n                range[3] = sheet.usedRange.colIndex;\n            }\n            range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n            range[0] = range[0] + 1; //ignore first row\n            var address_1 = getRangeAddress(range);\n            getData(this.parent, sheet.name + \"!\" + address_1, true, true, null, null, null, null, false).then(function (jsonData) {\n                var dataManager = new DataManager(jsonData);\n                _this.setFilter(dataManager, filterOptions.predicates);\n                var filterEventArgs = { range: address_1, filterOptions: filterOptions };\n                deferred.resolve(filterEventArgs);\n            });\n        }\n    };\n    /**\n     * Hides or unhides the rows based on the filter predicates.\n     *\n     * @param {DataManager} dataManager - Specify the dataManager.\n     * @param {Predicate[]} predicates - Specify the predicates.\n     * @returns {void} - Hides or unhides the rows based on the filter predicates.\n     */\n    WorkbookFilter.prototype.setFilter = function (dataManager, predicates) {\n        var _this = this;\n        if (dataManager && predicates) {\n            var jsonData = dataManager.dataSource.json;\n            var query = new Query();\n            if (predicates.length) {\n                query.where(Predicate.and(predicates));\n            }\n            var result_1 = dataManager.executeLocal(query);\n            var rowKey_1 = '__rowIndex';\n            jsonData.forEach(function (data) {\n                if (!data) {\n                    return;\n                }\n                var rowIdx = parseInt(data[rowKey_1], 10);\n                _this.parent.hideRow(rowIdx - 1, undefined, result_1.indexOf(data) < 0);\n                if (isNullOrUndefined(_this.parent.filteredRows)) {\n                    _this.parent.filteredRows = {};\n                    _this.parent.filteredRows.rowIdxColl = [];\n                    _this.parent.filteredRows.sheetIdxColl = [];\n                }\n                var filterRows = _this.parent.filteredRows.rowIdxColl;\n                var filterSheet = _this.parent.filteredRows.sheetIdxColl;\n                if (result_1.indexOf(data) < 0) {\n                    if (filterRows && filterSheet) {\n                        for (var i = 0, len = filterSheet.length; i < len; i++) {\n                            if (_this.parent.activeSheetIndex === filterSheet[i] && filterRows[i] === rowIdx - 1) {\n                                filterRows.splice(i, 1);\n                                filterSheet.splice(i, 1);\n                            }\n                        }\n                    }\n                    filterRows.push(rowIdx - 1);\n                    filterSheet.push(_this.parent.activeSheetIndex);\n                }\n                else {\n                    if (filterRows && filterSheet) {\n                        for (var i = 0, length_1 = filterSheet.length; i < length_1; i++) {\n                            if (_this.parent.activeSheetIndex === filterSheet[i] && filterRows[i] === rowIdx - 1) {\n                                filterRows.splice(i, 1);\n                                filterSheet.splice(i, 1);\n                            }\n                        }\n                    }\n                }\n            });\n            var sheet = this.parent.getActiveSheet();\n            if (sheet.frozenColumns || sheet.frozenRows) {\n                this.parent.notify(dataRefresh, null);\n            }\n        }\n    };\n    /**\n     * Clears all the filters in the sheet.\n     *\n     * @returns {void} - Clears all the filters in the sheet.\n     */\n    WorkbookFilter.prototype.clearAllFilterHandler = function () {\n        if (this.filterRange) {\n            var range = getCellIndexes(this.filterRange);\n            var sheet = this.parent.getActiveSheet();\n            this.parent.hideRow(range[0], sheet.usedRange.rowIndex, false);\n        }\n    };\n    /**\n     * Gets the module name.\n     *\n     * @returns {string} - Get the module name.\n     */\n    WorkbookFilter.prototype.getModuleName = function () {\n        return 'workbookFilter';\n    };\n    return WorkbookFilter;\n}());\nexport { WorkbookFilter };\n","import { getRangeIndexes } from '../common/index';\nimport { getCell, setCell, getSheetIndex } from '../base/index';\nimport { setImage } from '../common/event';\n/**\n * Specifies image.\n */\nvar WorkbookImage = /** @class */ (function () {\n    function WorkbookImage(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookImage.prototype.setImage = function (args) {\n        var imgRange = args.range ? (args.range.indexOf('!') > 0) ? args.range.split('!')[1] : args.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIdx = (args.range && args.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, args.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var indexes = getRangeIndexes(imgRange);\n        var sheet = sheetIdx ? this.parent.sheets[sheetIdx] : this.parent.getActiveSheet();\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var oldImgData;\n        var imgData = args.options;\n        if (cell && cell.image) {\n            oldImgData = cell.image;\n            for (var i = 0; i < imgData.length; i++) {\n                oldImgData.push(imgData[i]);\n            }\n        }\n        setCell(indexes[0], indexes[1], sheet, { image: (cell && cell.image) ? oldImgData : imgData }, true);\n    };\n    /**\n     * Adding event listener for number format.\n     *\n     * @returns {void} - Adding event listener for number format.\n     */\n    WorkbookImage.prototype.addEventListener = function () {\n        this.parent.on(setImage, this.setImage, this);\n    };\n    /**\n     * Removing event listener for number format.\n     *\n     * @returns {void}\n     */\n    WorkbookImage.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setImage, this.setImage);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     *\n     * @returns {void} - To Remove the event listeners.\n     */\n    WorkbookImage.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook number format module name.\n     *\n     * @returns {string} - Get the module name.\n     */\n    WorkbookImage.prototype.getModuleName = function () {\n        return 'workbookImage';\n    };\n    return WorkbookImage;\n}());\nexport { WorkbookImage };\n","import { getRangeIndexes, inRange } from '../common/index';\nimport { setCell, getSheetIndex, getCell, getSheetNameFromAddress } from '../base/index';\nimport { setChart, initiateChart, refreshChart, updateChart, deleteChartColl, refreshChartSize, focusChartBorder } from '../common/event';\nimport { closest, isNullOrUndefined, getComponent } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookChart` module is used to handle chart action in Spreadsheet.\n */\nvar WorkbookChart = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookChart module.\n     *\n     * @param {Workbook} parent - Constructor for WorkbookChart module.\n     */\n    function WorkbookChart(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookChart.prototype.addEventListener = function () {\n        this.parent.on(setChart, this.setChartHandler, this);\n        this.parent.on(refreshChart, this.refreshChartData, this);\n        this.parent.on(deleteChartColl, this.deleteChartColl, this);\n        this.parent.on(refreshChartSize, this.refreshChartSize, this);\n        this.parent.on(focusChartBorder, this.focusChartBorder, this);\n    };\n    WorkbookChart.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setChart, this.setChartHandler);\n            this.parent.off(refreshChart, this.refreshChartData);\n            this.parent.off(deleteChartColl, this.deleteChartColl);\n            this.parent.off(refreshChartSize, this.refreshChartSize);\n            this.parent.off(focusChartBorder, this.focusChartBorder);\n        }\n    };\n    WorkbookChart.prototype.setChartHandler = function (args) {\n        var i = 0;\n        args.isInitCell = isNullOrUndefined(args.isInitCell) ? false : args.isInitCell;\n        args.isUndoRedo = isNullOrUndefined(args.isUndoRedo) ? true : args.isUndoRedo;\n        args.isPaste = isNullOrUndefined(args.isPaste) ? false : args.isPaste;\n        var chart = args.chart;\n        if (chart.length > 0) {\n            while (i < chart.length) {\n                if (args.isCut === false) {\n                    if (document.getElementById(args.chart[i].id)) {\n                        chart[i] = {\n                            range: chart[i].range, id: 'e_spreadsheet_chart_' + this.parent.chartCount,\n                            isSeriesInRows: chart[i].isSeriesInRows, theme: chart[i].theme, type: chart[i].type\n                        };\n                        chart[i].id = 'e_spreadsheet_chart_' + this.parent.chartCount;\n                        args.isIdAvailabe = false;\n                    }\n                }\n                if (document.getElementById(args.chart[i].id)) {\n                    return;\n                }\n                var idAvailable = isNullOrUndefined(args.isIdAvailabe) ? true : args.isIdAvailabe;\n                chart[i].theme = chart[i].theme || 'Material';\n                chart[i].type = chart[i].type || 'Line';\n                chart[i].isSeriesInRows = chart[i].isSeriesInRows || false;\n                chart[i].range = chart[i].range || this.parent.getActiveSheet().selectedRange;\n                if (chart[i].range.indexOf('!') < 0) {\n                    chart[i].range = this.parent.getActiveSheet().name + '!' + chart[i].range;\n                }\n                if (isNullOrUndefined(chart[i].id)) {\n                    chart[i].id = 'e_spreadsheet_chart_' + this.parent.chartCount;\n                    idAvailable = false;\n                }\n                chart[i].height = chart[i].height || 290;\n                chart[i].width = chart[i].width || 480;\n                this.parent.notify(initiateChart, {\n                    option: chart[i], chartCount: this.parent.chartCount, isInitCell: args.isInitCell, isUndoRedo: args.isUndoRedo,\n                    dataSheetIdx: args.dataSheetIdx, range: args.range, isPaste: args.isPaste\n                });\n                this.parent.chartColl.push(chart[i]);\n                if (!idAvailable) {\n                    this.parent.chartCount++;\n                }\n                if (!args.isInitCell || args.isPaste) {\n                    var sheetIdx = (chart[i].range && chart[i].range.indexOf('!') > 0) ?\n                        getSheetIndex(this.parent, chart[i].range.split('!')[0]) : this.parent.activeSheetIndex;\n                    var indexes = args.isPaste ? getRangeIndexes(args.range) : getRangeIndexes(chart[i].range);\n                    var sheet = sheetIdx ? this.parent.sheets[sheetIdx] : this.parent.getActiveSheet();\n                    var cell = getCell(indexes[0], indexes[1], sheet);\n                    if (cell && cell.chart) {\n                        cell.chart.push(chart[i]);\n                    }\n                    else {\n                        setCell(indexes[0], indexes[1], sheet, { chart: [chart[i]] }, true);\n                    }\n                }\n                i++;\n            }\n        }\n    };\n    WorkbookChart.prototype.refreshChartData = function (args) {\n        var i;\n        var j = 1;\n        var cnt = this.parent.sheets.length + 1;\n        while (j < cnt) {\n            var charts = this.parent.chartColl;\n            i = charts ? charts.length : 0;\n            if (i) {\n                while (i--) {\n                    var chart = this.parent.chartColl[i];\n                    var isRange = isNullOrUndefined(args.showHide) ? inRange(getRangeIndexes(chart.range), args.rIdx, args.cIdx)\n                        : this.inRowColumnRange(getRangeIndexes(chart.range), args.rIdx, args.showHide);\n                    var rangeSheetIdx = chart.range.indexOf('!') > -1 ?\n                        getSheetIndex(this.parent, getSheetNameFromAddress(chart.range)) : this.parent.activeSheetIndex;\n                    if (isRange && rangeSheetIdx === this.parent.activeSheetIndex) {\n                        this.parent.notify(updateChart, { chart: chart });\n                    }\n                }\n            }\n            j++;\n        }\n    };\n    WorkbookChart.prototype.inRowColumnRange = function (range, index, showHide) {\n        return showHide === 'rows' ? index >= range[0] && index <= range[2] : index >= range[1] && index <= range[3];\n    };\n    WorkbookChart.prototype.refreshChartSize = function (args) {\n        var chartCnt;\n        var j = 1;\n        var sheetCnt = this.parent.sheets.length + 1;\n        while (j < sheetCnt) {\n            var charts = this.parent.chartColl;\n            chartCnt = charts ? charts.length : 0;\n            if (chartCnt) {\n                while (chartCnt--) {\n                    var chart = this.parent.chartColl[chartCnt];\n                    if (!isNullOrUndefined(args.overlayEle.querySelector('#' + chart.id))) {\n                        var chartObj = this.parent.element.querySelector('.' + chart.id);\n                        var excelFilter = getComponent(chartObj, 'chart');\n                        if (excelFilter) {\n                            excelFilter.height = args.height;\n                            excelFilter.width = args.width;\n                        }\n                    }\n                }\n            }\n            j++;\n        }\n    };\n    WorkbookChart.prototype.focusChartBorder = function (args) {\n        for (var idx = 0; idx < this.parent.chartColl.length; idx++) {\n            var overlayEle = document.getElementById(args.id);\n            var chartEle = document.getElementById(this.parent.chartColl[idx].id);\n            if (overlayEle && chartEle && closest(chartEle, '.' + overlayEle.classList[1]) === overlayEle) {\n                this.parent.notify(initiateChart, {\n                    option: this.parent.chartColl[idx], chartCount: this.parent.chartCount, isRefresh: true\n                });\n            }\n        }\n    };\n    WorkbookChart.prototype.deleteChartColl = function (args) {\n        for (var idx = 0; idx < this.parent.chartColl.length; idx++) {\n            var chartElement = document.getElementById(this.parent.chartColl[idx].id);\n            var overlayElement = document.getElementById(args.id);\n            if (overlayElement && chartElement && closest(chartElement, '.' + overlayElement.classList[1]) === overlayElement) {\n                this.parent.chartColl.splice(idx, 1);\n            }\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     *\n     * @returns {void} - To Remove the event listeners.\n     */\n    WorkbookChart.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook chart module name.\n     *\n     * @returns {string} - Get the workbook chart module name.\n     */\n    WorkbookChart.prototype.getModuleName = function () {\n        return 'workbookChart';\n    };\n    return WorkbookChart;\n}());\nexport { WorkbookChart };\n","import { getRangeIndexes, setCellFormat, applyCellFormat, activeCellChanged } from '../common/index';\nimport { getSwapRange, textDecorationUpdate } from '../common/index';\nimport { clear, getIndexesFromAddress, activeCellMergedRange, deleteHyperlink } from '../common/index';\nimport { getSheetIndex, isHiddenRow, getSheet, getCell, setCell } from '../base/index';\n/**\n * Workbook Cell format.\n */\nvar WorkbookCellFormat = /** @class */ (function () {\n    function WorkbookCellFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookCellFormat.prototype.format = function (args) {\n        var sheet;\n        var rng = args.range;\n        if (rng && typeof rng === 'string' && rng.indexOf('!') > -1) {\n            rng = rng.split('!')[1];\n            sheet = this.parent.sheets[getSheetIndex(this.parent, args.range.split('!')[0])];\n        }\n        else {\n            sheet = this.parent.getActiveSheet();\n        }\n        if (rng === undefined) {\n            rng = sheet.selectedRange;\n        }\n        var triggerEvent = typeof (rng) !== 'object' && args.onActionUpdate;\n        var eventArgs = {\n            range: rng, style: Object.assign({}, args.style), requestType: 'CellFormat'\n        };\n        if (args.borderType) {\n            eventArgs.borderType = args.borderType;\n        }\n        var style = {};\n        Object.assign(style, eventArgs.style, null, true);\n        if (triggerEvent) {\n            this.parent.trigger('beforeCellFormat', eventArgs);\n            this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'format' });\n            if (eventArgs.cancel) {\n                args.cancel = true;\n                return;\n            }\n        }\n        var indexes = typeof (eventArgs.range) === 'object' ? eventArgs.range :\n            getSwapRange(getRangeIndexes(eventArgs.range));\n        if (args.borderType) {\n            this.setTypedBorder(sheet, args.style.border, indexes, args.borderType, args.onActionUpdate);\n            delete args.style.border;\n        }\n        if (eventArgs.style.borderTop !== undefined) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderBottom', indexes[0] - 1, i);\n                this.checkFullBorder(sheet, 'borderBottom', indexes[0] - 1, i);\n                this.checkFullBorder(sheet, 'borderTop', indexes[0], i);\n                this.setCellBorder(sheet, { borderTop: eventArgs.style.borderTop }, indexes[0], i, args.onActionUpdate, i === indexes[3]);\n            }\n            delete eventArgs.style.borderTop;\n        }\n        if (eventArgs.style.borderBottom !== undefined) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderTop', indexes[2] + 1, i);\n                this.checkFullBorder(sheet, 'borderTop', indexes[2] + 1, i);\n                this.checkFullBorder(sheet, 'borderBottom', indexes[2], i);\n                this.setCellBorder(sheet, { borderBottom: eventArgs.style.borderBottom }, indexes[2], i, args.onActionUpdate, i === indexes[3]);\n                this.setBottomBorderPriority(sheet, indexes[2], i);\n            }\n            delete eventArgs.style.borderBottom;\n        }\n        if (eventArgs.style.borderLeft !== undefined) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderRight', i, indexes[1] - 1);\n                this.checkFullBorder(sheet, 'borderRight', i, indexes[1] - 1);\n                this.checkFullBorder(sheet, 'borderLeft', i, indexes[1]);\n                this.setCellBorder(sheet, { borderLeft: eventArgs.style.borderLeft }, i, indexes[1], args.onActionUpdate);\n            }\n            delete eventArgs.style.borderLeft;\n        }\n        if (eventArgs.style.borderRight !== undefined) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderLeft', i, indexes[3] - 1);\n                this.checkFullBorder(sheet, 'borderLeft', i, indexes[3] - 1);\n                this.checkFullBorder(sheet, 'borderRight', i, indexes[3]);\n                this.setCellBorder(sheet, { borderRight: eventArgs.style.borderRight }, i, indexes[3], args.onActionUpdate);\n            }\n            delete eventArgs.style.borderRight;\n        }\n        var border;\n        var isFullBorder;\n        if (Object.keys(args.style).length) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                for (var j = indexes[1]; j <= indexes[3]; j++) {\n                    if (isFullBorder === undefined) {\n                        if (eventArgs.style.border !== undefined) {\n                            border = eventArgs.style.border;\n                            eventArgs.style.border = undefined;\n                            isFullBorder = true;\n                        }\n                        else {\n                            isFullBorder = false;\n                        }\n                    }\n                    if (isFullBorder) {\n                        this.setFullBorder(sheet, border, indexes, i, j, args.onActionUpdate);\n                    }\n                    this.setCellStyle(sheet, i, j, eventArgs.style);\n                    if (this.parent.getActiveSheet().id === sheet.id) {\n                        this.parent.notify(applyCellFormat, { style: eventArgs.style, rowIdx: i, colIdx: j,\n                            lastCell: j === indexes[3], isHeightCheckNeeded: true, manualUpdate: true, onActionUpdate: args.onActionUpdate\n                        });\n                    }\n                }\n            }\n        }\n        if (isFullBorder) {\n            eventArgs.style.border = border;\n        }\n        this.parent.setUsedRange(indexes[2], indexes[3]);\n        if (args.refreshRibbon) {\n            this.parent.notify(activeCellChanged, null);\n        }\n        if (triggerEvent) {\n            eventArgs.style = style;\n            eventArgs.range = sheet.name + \"!\" + rng;\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'format' });\n        }\n    };\n    WorkbookCellFormat.prototype.setBottomBorderPriority = function (sheet, rowIdx, colIdx) {\n        if (isHiddenRow(sheet, rowIdx + 1)) {\n            var pIdx = this.skipHiddenRows(sheet, rowIdx + 1);\n            var pCellStyle = this.parent.getCellStyleValue(['borderTop'], [pIdx, colIdx]).borderTop;\n            if (pCellStyle !== '') {\n                sheet.rows[rowIdx].cells[colIdx].style.bottomPriority = true;\n            }\n        }\n    };\n    WorkbookCellFormat.prototype.setFullBorder = function (sheet, border, indexes, i, j, actionUpdate) {\n        var style = {};\n        if (i === indexes[0]) {\n            this.checkAdjustantBorder(sheet, 'borderBottom', i - 1, j);\n            this.checkFullBorder(sheet, 'borderBottom', i - 1, j);\n        }\n        if (j === indexes[1]) {\n            this.checkAdjustantBorder(sheet, 'borderRight', i, j - 1);\n            this.checkFullBorder(sheet, 'borderRight', i, j - 1);\n        }\n        if (j === indexes[3]) {\n            this.checkAdjustantBorder(sheet, 'borderLeft', i, j + 1);\n            this.checkFullBorder(sheet, 'borderLeft', i, j + 1);\n        }\n        else {\n            this.checkAdjustantBorder(sheet, 'border', i, j + 1);\n        }\n        style.borderRight = border;\n        style.borderTop = border;\n        style.borderLeft = border;\n        style.borderBottom = border;\n        this.setCellBorder(sheet, style, i, j, actionUpdate, j === indexes[3]);\n        if (i === indexes[2]) {\n            this.checkAdjustantBorder(sheet, 'borderTop', i + 1, j);\n            this.checkFullBorder(sheet, 'borderTop', i + 1, j);\n            this.setBottomBorderPriority(sheet, i, j);\n        }\n        else {\n            this.checkAdjustantBorder(sheet, 'border', i + 1, j);\n        }\n    };\n    WorkbookCellFormat.prototype.checkAdjustantBorder = function (sheet, prop, rowIdx, colIdx) {\n        var style = {};\n        if (this.parent.getCellStyleValue([prop], [rowIdx, colIdx])[prop] !== '') {\n            style[prop] = undefined;\n            this.setCellStyle(sheet, rowIdx, colIdx, style);\n        }\n    };\n    WorkbookCellFormat.prototype.checkFullBorder = function (sheet, prop, rowIdx, colIdx) {\n        var border = this.parent.getCellStyleValue(['border'], [rowIdx, colIdx]).border;\n        if (border !== '') {\n            var style_1 = { border: undefined };\n            ['borderBottom', 'borderTop', 'borderLeft', 'borderRight'].forEach(function (value) {\n                if (value !== prop) {\n                    style_1[value] = border;\n                }\n            });\n            this.setCellStyle(sheet, rowIdx, colIdx, style_1);\n        }\n    };\n    WorkbookCellFormat.prototype.textDecorationActionUpdate = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var eventArgs = { range: sheet.selectedRange, style: args.style, requestType: 'CellFormat' };\n        this.parent.trigger('beforeCellFormat', eventArgs);\n        this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'format' });\n        if (eventArgs.cancel) {\n            args.cancel = true;\n            return;\n        }\n        var indexes = getSwapRange(getRangeIndexes(sheet.selectedRange));\n        var value = args.style.textDecoration;\n        var changedValue = value;\n        var activeCellIndexes = getRangeIndexes(sheet.activeCell);\n        var cellValue = this.parent.getCellStyleValue(['textDecoration'], activeCellIndexes).textDecoration;\n        var changedStyle;\n        var removeProp = false;\n        if (cellValue === 'underline') {\n            changedValue = value === 'underline' ? 'none' : 'underline line-through';\n        }\n        else if (cellValue === 'line-through') {\n            changedValue = value === 'line-through' ? 'none' : 'underline line-through';\n        }\n        else if (cellValue === 'underline line-through') {\n            changedValue = value === 'underline' ? 'line-through' : 'underline';\n            removeProp = true;\n        }\n        if (changedValue === 'none') {\n            removeProp = true;\n        }\n        this.format({\n            style: { textDecoration: changedValue }, range: activeCellIndexes, refreshRibbon: args.refreshRibbon,\n            onActionUpdate: true\n        });\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (i === activeCellIndexes[0] && j === activeCellIndexes[1]) {\n                    continue;\n                }\n                changedStyle = {};\n                cellValue = this.parent.getCellStyleValue(['textDecoration'], [i, j]).textDecoration;\n                if (cellValue === 'none') {\n                    if (removeProp) {\n                        continue;\n                    }\n                    changedStyle.textDecoration = value;\n                }\n                else if (cellValue === 'underline' || cellValue === 'line-through') {\n                    if (removeProp) {\n                        if (value === cellValue) {\n                            changedStyle.textDecoration = 'none';\n                        }\n                        else {\n                            continue;\n                        }\n                    }\n                    else {\n                        changedStyle.textDecoration = value !== cellValue ? 'underline line-through' : value;\n                    }\n                }\n                else if (cellValue === 'underline line-through') {\n                    if (removeProp) {\n                        changedStyle.textDecoration = value === 'underline' ? 'line-through' : 'underline';\n                    }\n                    else {\n                        continue;\n                    }\n                }\n                this.format({\n                    style: changedStyle, range: [i, j, i, j], refreshRibbon: args.refreshRibbon,\n                    onActionUpdate: true\n                });\n            }\n        }\n        eventArgs.range = sheet.name + '!' + eventArgs.range;\n        this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'format' });\n    };\n    WorkbookCellFormat.prototype.setTypedBorder = function (sheet, border, range, type, actionUpdate) {\n        var prevBorder;\n        if (type === 'Outer') {\n            for (var colIdx = range[1]; colIdx <= range[3]; colIdx++) {\n                this.checkAdjustantBorder(sheet, 'borderBottom', range[0] - 1, colIdx);\n                this.checkFullBorder(sheet, 'borderBottom', range[0] - 1, colIdx);\n                this.setCellBorder(sheet, { borderTop: border }, range[0], colIdx, actionUpdate, colIdx === range[3]);\n                this.checkAdjustantBorder(sheet, 'borderTop', range[2] + 1, colIdx);\n                this.checkFullBorder(sheet, 'borderTop', range[2] + 1, colIdx);\n                this.setCellBorder(sheet, { borderBottom: border }, range[2], colIdx, actionUpdate, colIdx === range[3], type);\n                this.setBottomBorderPriority(sheet, range[2], colIdx);\n            }\n            for (var rowIdx = range[0]; rowIdx <= range[2]; rowIdx++) {\n                this.checkAdjustantBorder(sheet, 'borderRight', rowIdx, range[1] - 1);\n                this.checkFullBorder(sheet, 'borderRight', rowIdx, range[1] - 1);\n                this.setCellBorder(sheet, { borderLeft: border }, rowIdx, range[1], actionUpdate);\n                this.checkAdjustantBorder(sheet, 'borderLeft', rowIdx, range[3] + 1);\n                this.checkFullBorder(sheet, 'borderLeft', rowIdx, range[3] + 1);\n                this.setCellBorder(sheet, { borderRight: border }, rowIdx, range[3], actionUpdate, null, type);\n            }\n        }\n        else if (type === 'Inner') {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = {};\n                    prevBorder = this.parent.getCellStyleValue(['border'], [i, j]).border;\n                    if (prevBorder !== '') {\n                        style.border = undefined;\n                        if (j === range[3] || j === range[1] || i === range[0] || i === range[2]) {\n                            if (i === range[0]) {\n                                style.borderTop = prevBorder;\n                            }\n                            if (i === range[2]) {\n                                style.borderBottom = prevBorder;\n                            }\n                            if (j === range[3]) {\n                                style.borderRight = prevBorder;\n                            }\n                            if (j === range[1]) {\n                                style.borderLeft = prevBorder;\n                            }\n                        }\n                    }\n                    if (j !== range[3]) {\n                        style.borderRight = border;\n                    }\n                    if (i !== range[0]) {\n                        style.borderTop = border;\n                    }\n                    if (i !== range[2]) {\n                        style.borderBottom = border;\n                    }\n                    if (j !== range[1]) {\n                        style.borderLeft = border;\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate, j === range[3]);\n                }\n            }\n        }\n        else if (type === 'Vertical') {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = { borderRight: border, borderLeft: border };\n                    if (j === range[1]) {\n                        this.checkAdjustantBorder(sheet, 'borderRight', i, j - 1);\n                        this.checkFullBorder(sheet, 'borderRight', i, j - 1);\n                    }\n                    if (j === range[3]) {\n                        this.checkAdjustantBorder(sheet, 'borderLeft', i, j + 1);\n                        this.checkFullBorder(sheet, 'borderLeft', i, j + 1);\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate);\n                }\n            }\n        }\n        else {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = { borderTop: border, borderBottom: border };\n                    if (i === range[0]) {\n                        this.checkAdjustantBorder(sheet, 'borderBottom', i - 1, j);\n                        this.checkFullBorder(sheet, 'borderBottom', i - 1, j);\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate, j === range[3]);\n                    if (i === range[2]) {\n                        this.checkAdjustantBorder(sheet, 'borderTop', i + 1, j);\n                        this.checkFullBorder(sheet, 'borderTop', i + 1, j);\n                        this.setBottomBorderPriority(sheet, i, j);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookCellFormat.prototype.setCellBorder = function (sheet, style, rowIdx, colIdx, actionUpdate, lastCell, type) {\n        this.setCellStyle(sheet, rowIdx, colIdx, style);\n        if (this.parent.getActiveSheet().id === sheet.id) {\n            if (type === 'Outer' && (style.borderBottom || style.borderRight)) {\n                var mergeArgs = { range: [rowIdx, colIdx, rowIdx, colIdx] };\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                rowIdx = mergeArgs.range[0];\n                colIdx = mergeArgs.range[1];\n            }\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rowIdx, colIdx: colIdx, onActionUpdate: actionUpdate, first: '', lastCell: lastCell,\n                isHeightCheckNeeded: true, manualUpdate: true\n            });\n        }\n    };\n    WorkbookCellFormat.prototype.setCellStyle = function (sheet, rowIdx, colIdx, style) {\n        if (!sheet.rows[rowIdx]) {\n            sheet.rows[rowIdx] = { cells: [] };\n        }\n        else if (!sheet.rows[rowIdx].cells) {\n            sheet.rows[rowIdx].cells = [];\n        }\n        if (!sheet.rows[rowIdx].cells[colIdx]) {\n            sheet.rows[rowIdx].cells[colIdx] = {};\n        }\n        if (!sheet.rows[rowIdx].cells[colIdx].style) {\n            sheet.rows[rowIdx].cells[colIdx].style = {};\n        }\n        Object.assign(sheet.rows[rowIdx].cells[colIdx].style, style, null, true);\n    };\n    WorkbookCellFormat.prototype.skipHiddenRows = function (sheet, startIdx) {\n        startIdx++;\n        if (isHiddenRow(sheet, startIdx)) {\n            startIdx = this.skipHiddenRows(sheet, startIdx);\n        }\n        return startIdx;\n    };\n    WorkbookCellFormat.prototype.addEventListener = function () {\n        this.parent.on(setCellFormat, this.format, this);\n        this.parent.on(textDecorationUpdate, this.textDecorationActionUpdate, this);\n        this.parent.on(clear, this.clearCellObj, this);\n    };\n    WorkbookCellFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setCellFormat, this.format);\n            this.parent.off(textDecorationUpdate, this.textDecorationActionUpdate);\n            this.parent.off(clear, this.clearCellObj);\n        }\n    };\n    WorkbookCellFormat.prototype.clearCellObj = function (options) {\n        var clrRange = options.range ? (options.range.indexOf('!') > 0) ? options.range.split('!')[1] : options.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIdx = (options.range && options.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, options.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var sheet = getSheet(this.parent, sheetIdx);\n        var range = getIndexesFromAddress(clrRange);\n        var sRowIdx = range[0];\n        var eRowIdx = range[2];\n        var sColIdx;\n        var eColIdx;\n        for (sRowIdx; sRowIdx <= eRowIdx; sRowIdx++) {\n            sColIdx = range[1];\n            eColIdx = range[3];\n            for (sColIdx; sColIdx <= eColIdx; sColIdx++) {\n                var cell = getCell(sRowIdx, sColIdx, sheet);\n                if (cell) {\n                    switch (options.type) {\n                        case 'Clear Formats':\n                            delete cell.format;\n                            delete cell.rowSpan;\n                            delete cell.style;\n                            delete cell.wrap;\n                            delete cell.colSpan;\n                            break;\n                        case 'Clear Contents':\n                            if (cell.hyperlink) {\n                                this.parent.notify(deleteHyperlink, { sheet: sheet, rowIdx: sRowIdx, colIdx: sColIdx, preventRefresh: true });\n                            }\n                            delete cell.value;\n                            delete cell.formula;\n                            break;\n                        case 'Clear Hyperlinks':\n                            delete cell.hyperlink;\n                            break;\n                        case 'Clear All':\n                            setCell(sRowIdx, sColIdx, sheet, {}, false);\n                            break;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * To destroy workbook cell format.\n     *\n     * @returns {void} - To destroy workbook cell format.\n     */\n    WorkbookCellFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook cell format module name.\n     *\n     *  @returns {void}\n     */\n    WorkbookCellFormat.prototype.getModuleName = function () {\n        return 'workbookcellformat';\n    };\n    return WorkbookCellFormat;\n}());\nexport { WorkbookCellFormat };\n","import { getCell, getSheet } from '../base/index';\nimport { workbookEditOperation, checkDateFormat, workbookFormulaOperation, refreshChart } from '../common/event';\nimport { getRangeIndexes, parseIntValue } from '../common/index';\nimport { isNullOrUndefined, getNumericObject } from '@syncfusion/ej2-base';\nimport { checkIsFormula } from '../../workbook/common/index';\nimport { getTypeFromFormat } from '../integrations/index';\nimport { checkConditionalFormat } from '../../spreadsheet/common/event';\n/**\n * The `WorkbookEdit` module is used to handle the editing functionalities in Workbook.\n */\nvar WorkbookEdit = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Workbook.\n     *\n     * @private\n     * @param {Workbook} workbook - Specifies the workbook.\n     */\n    function WorkbookEdit(workbook) {\n        this.parent = workbook;\n        this.localeObj = getNumericObject(this.parent.locale);\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        this.decimalSep = this.localeObj.decimal;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the edit module.\n     *\n     * @returns {void} - destroy the edit module\n     * @hidden\n     */\n    WorkbookEdit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookEdit.prototype.addEventListener = function () {\n        this.parent.on(workbookEditOperation, this.performEditOperation, this);\n    };\n    WorkbookEdit.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookEditOperation, this.performEditOperation);\n        }\n    };\n    /**\n     * Get the module name.\n     *\n     * @returns {string} - string\n     * @private\n     */\n    WorkbookEdit.prototype.getModuleName = function () {\n        return 'workbookEdit';\n    };\n    WorkbookEdit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'updateCellValue':\n                this.updateCellValue(args.address, args.value, args.sheetIndex, args.isValueOnly);\n                break;\n        }\n    };\n    WorkbookEdit.prototype.checkDecimalPoint = function (value) {\n        if (Number(value)) {\n            var decIndex = value.toString().indexOf(this.decimalSep) + 1;\n            var checkDec = value.toString().substr(decIndex).length <= 6;\n            value = checkDec ? decIndex < 7 ? value : (parseFloat(value)).toFixed(0) : decIndex > 7 ? (parseFloat(value)).toFixed(0) :\n                (parseFloat(value)).toFixed(6 - decIndex + 2);\n        }\n        return value;\n    };\n    WorkbookEdit.prototype.updateCellValue = function (address, value, sheetIdx, isValueOnly) {\n        if (isValueOnly === void 0) { isValueOnly = false; }\n        if (sheetIdx === undefined) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var range;\n        if (typeof address === 'string') {\n            range = getRangeIndexes(address);\n        }\n        else {\n            range = address;\n        }\n        var sheet = getSheet(this.parent, sheetIdx);\n        var cell = getCell(range[0], range[1], sheet, true);\n        if (!cell) {\n            cell = sheet.rows[range[0]].cells[range[1]] = {};\n        }\n        if (!isValueOnly) {\n            var isFormula = checkIsFormula(value);\n            isFormula = value === '#SPILL!' ? true : isFormula;\n            var skipFormula = false; // for unique formula\n            if (cell.formula && cell.formula.indexOf('UNIQUE') > -1 && value === '') {\n                skipFormula = true;\n            }\n            if (!isFormula && !skipFormula) {\n                cell.formula = '';\n                cell.value = parseIntValue(value);\n            }\n            var eventArgs = {\n                action: 'refreshCalculate',\n                value: value,\n                rowIndex: range[0],\n                colIndex: range[1],\n                sheetIndex: sheetIdx,\n                isFormula: isFormula\n            };\n            if (getTypeFromFormat(cell.format) !== 'Text') {\n                var dateEventArgs = {\n                    value: value,\n                    rowIndex: range[0],\n                    colIndex: range[1],\n                    sheetIndex: sheetIdx,\n                    updatedVal: ''\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (!isNullOrUndefined(dateEventArgs.updatedVal) && dateEventArgs.updatedVal.length > 0) {\n                    cell.value = dateEventArgs.updatedVal;\n                }\n            }\n            if (value === '#SPILL!') {\n                cell.value = value;\n            }\n            else {\n                if (!skipFormula && value !== '') {\n                    this.parent.notify(workbookFormulaOperation, eventArgs);\n                }\n                else {\n                    value = cell.value;\n                }\n                if (isFormula) {\n                    cell.formula = eventArgs.value;\n                    value = cell.value;\n                }\n            }\n        }\n        else {\n            if (value && value.toString().indexOf(this.decimalSep) > -1) {\n                value = this.checkDecimalPoint(value);\n            }\n            cell.value = value;\n        }\n        this.parent.setUsedRange(range[0], range[1], sheet);\n        if (this.parent.allowChart) {\n            this.parent.notify(refreshChart, { cell: cell, rIdx: range[0], cIdx: range[1], sheetIdx: sheetIdx });\n        }\n        if (this.parent.allowConditionalFormat) {\n            this.parent.notify(checkConditionalFormat, { rowIdx: range[0], colIdx: range[1], cell: cell, isAction: true });\n        }\n    };\n    return WorkbookEdit;\n}());\nexport { WorkbookEdit };\n","import { setLinkModel } from '../common/event';\nimport { getRangeIndexes } from '../common/address';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookHyperlink` module is used to handle Hyperlink action in Spreadsheet.\n */\nvar WorkbookHyperlink = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     *\n     * @param {Workbook} parent - Specifies the workbook.\n     */\n    function WorkbookHyperlink(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     *\n     * @returns {void} - To destroy the sort module.\n     */\n    WorkbookHyperlink.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookHyperlink.prototype.addEventListener = function () {\n        this.parent.on(setLinkModel, this.setLinkHandler, this);\n    };\n    WorkbookHyperlink.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setLinkModel, this.setLinkHandler);\n        }\n    };\n    WorkbookHyperlink.prototype.setLinkHandler = function (args) {\n        var hyperlink = args.hyperlink;\n        var cellAddr = args.cell;\n        var range;\n        var sheetIdx;\n        var sheet = this.parent.getActiveSheet();\n        var address;\n        if (cellAddr && cellAddr.indexOf('!') !== -1) {\n            range = cellAddr.split('!');\n            var sheets = this.parent.sheets;\n            for (var idx = 0; idx < sheets.length; idx++) {\n                if (sheets[idx].name === range[0]) {\n                    sheetIdx = idx;\n                }\n            }\n            sheet = this.parent.sheets[sheetIdx];\n            cellAddr = range[1];\n        }\n        cellAddr = cellAddr ? cellAddr : this.parent.getActiveSheet().activeCell;\n        var cellIdx = getRangeIndexes(cellAddr);\n        var rowIdx = cellIdx[0];\n        var colIdx = cellIdx[1];\n        if (!sheet) {\n            return;\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx])) {\n            sheet.rows[rowIdx] = {};\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx].cells)) {\n            sheet.rows[rowIdx].cells = [];\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx].cells[colIdx])) {\n            sheet.rows[rowIdx].cells[colIdx] = {};\n        }\n        if (sheet.rows[rowIdx].cells[colIdx].style) {\n            sheet.rows[rowIdx].cells[colIdx].style.textDecoration = 'underline';\n            sheet.rows[rowIdx].cells[colIdx].style.color = '#00e';\n        }\n        else {\n            sheet.rows[rowIdx].cells[colIdx].style = { textDecoration: 'underline', color: '#00e' };\n        }\n        if (typeof (hyperlink) === 'string') {\n            if (hyperlink.indexOf('http://') !== 0 && hyperlink.indexOf('https://') !== 0 && hyperlink.indexOf('ftp://') !== 0) {\n                hyperlink = hyperlink.toLowerCase().indexOf('www.') === 0 ? 'http://' + hyperlink : hyperlink;\n                address = hyperlink;\n            }\n            sheet.rows[rowIdx].cells[colIdx].hyperlink = hyperlink;\n        }\n        else {\n            address = hyperlink.address;\n            if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                address = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n            }\n            sheet.rows[rowIdx].cells[colIdx].hyperlink = {\n                address: address\n            };\n        }\n    };\n    /**\n     * Gets the module name.\n     *\n     *@returns {string} - returns the module name.\n     */\n    WorkbookHyperlink.prototype.getModuleName = function () {\n        return 'workbookHyperlink';\n    };\n    return WorkbookHyperlink;\n}());\nexport { WorkbookHyperlink };\n","import { insert, insertModel, workbookFormulaOperation } from '../../workbook/common/index';\nimport { insertMerge, refreshClipboard } from '../../workbook/common/index';\n/**\n * The `WorkbookInsert` module is used to insert cells, rows, columns and sheets in to workbook.\n */\nvar WorkbookInsert = /** @class */ (function () {\n    /**\n     * Constructor for the workbook insert module.\n     *\n     * @param {Workbook} parent - Specifies the workbook.\n     * @private\n     */\n    function WorkbookInsert(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    // tslint:disable-next-line\n    WorkbookInsert.prototype.insertModel = function (args) {\n        var _this = this;\n        var _a, _b, _c;\n        if (!args.model) {\n            return;\n        }\n        var index;\n        var model = [];\n        var mergeCollection;\n        var isModel;\n        if (typeof (args.start) === 'number') {\n            index = args.start;\n            args.end = args.end || index;\n            if (index > args.end) {\n                index = args.end;\n                args.end = args.start;\n            }\n            for (var i = index; i <= args.end; i++) {\n                model.push({});\n            }\n        }\n        else {\n            if (args.start) {\n                index = args.start[0].index || 0;\n                model = args.start;\n                isModel = true;\n            }\n            else {\n                index = 0;\n                model.push({});\n            }\n        }\n        var freezePane;\n        if (args.modelType === 'Row') {\n            args.model = args.model;\n            if (!args.model.rows) {\n                args.model.rows = [];\n            }\n            if (isModel && args.model.usedRange.rowIndex > -1 && index > args.model.usedRange.rowIndex) {\n                for (var i = args.model.usedRange.rowIndex; i < index - 1; i++) {\n                    model.splice(0, 0, {});\n                }\n            }\n            var frozenRow = this.parent.frozenRowCount(args.model);\n            if (index < frozenRow) {\n                this.parent.setSheetPropertyOnMute(args.model, 'frozenRows', args.model.frozenRows + model.length);\n                freezePane = true;\n            }\n            (_a = args.model.rows).splice.apply(_a, [index, 0].concat(model));\n            //this.setInsertInfo(args.model, index, model.length, 'count');\n            if (index > args.model.usedRange.rowIndex) {\n                this.parent.setUsedRange(index + (model.length - 1), args.model.usedRange.colIndex, args.model);\n            }\n            else {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex + model.length, args.model.usedRange.colIndex, args.model);\n            }\n            var curIdx = index + model.length;\n            for (var i = 0; i <= args.model.usedRange.colIndex; i++) {\n                if (args.model.rows[curIdx] && args.model.rows[curIdx].cells && args.model.rows[curIdx].cells[i] &&\n                    args.model.rows[curIdx].cells[i].rowSpan !== undefined && args.model.rows[curIdx].cells[i].rowSpan < 0 &&\n                    args.model.rows[curIdx].cells[i].colSpan === undefined) {\n                    this.parent.notify(insertMerge, {\n                        range: [curIdx, i, curIdx, i], insertCount: model.length,\n                        insertModel: 'Row'\n                    });\n                }\n            }\n        }\n        else if (args.modelType === 'Column') {\n            args.model = args.model;\n            if (!args.model.columns) {\n                args.model.columns = [];\n            }\n            (_b = args.model.columns).splice.apply(_b, [index, 0].concat(model));\n            var frozenCol = this.parent.frozenColCount(args.model);\n            if (index < frozenCol) {\n                this.parent.setSheetPropertyOnMute(args.model, 'frozenColumns', args.model.frozenColumns + model.length);\n                freezePane = true;\n            }\n            //this.setInsertInfo(args.model, index, model.length, 'fldLen', 'Column');\n            if (index > args.model.usedRange.colIndex) {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex, index + (model.length - 1), args.model);\n            }\n            else {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex, args.model.usedRange.colIndex + model.length, args.model);\n            }\n            if (!args.model.rows) {\n                args.model.rows = [];\n            }\n            var cellModel = [];\n            if (!args.columnCellsModel) {\n                args.columnCellsModel = [];\n            }\n            for (var i = 0; i < model.length; i++) {\n                cellModel.push(null);\n            }\n            mergeCollection = [];\n            for (var i = 0; i <= args.model.usedRange.rowIndex; i++) {\n                if (!args.model.rows[i]) {\n                    args.model.rows[i] = { cells: [] };\n                }\n                else if (!args.model.rows[i].cells) {\n                    args.model.rows[i].cells = [];\n                }\n                if (index && !args.model.rows[i].cells[index - 1]) {\n                    args.model.rows[i].cells[index - 1] = {};\n                }\n                (_c = args.model.rows[i].cells).splice.apply(_c, [index, 0].concat((args.columnCellsModel[i] && args.columnCellsModel[i].cells ?\n                    args.columnCellsModel[i].cells : cellModel)));\n                var curIdx = index + model.length;\n                if (args.model.rows[i].cells[curIdx] && args.model.rows[i].cells[curIdx].colSpan !== undefined &&\n                    args.model.rows[i].cells[curIdx].colSpan < 0 && args.model.rows[i].cells[curIdx].rowSpan === undefined) {\n                    mergeCollection.push({\n                        range: [i, curIdx, i, curIdx], insertCount: cellModel.length,\n                        insertModel: 'Column'\n                    });\n                }\n            }\n            mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(insertMerge, mergeArgs); });\n        }\n        else {\n            if (args.checkCount !== undefined && args.checkCount === this.parent.sheets.length) {\n                return;\n            }\n            var sheetModel = model;\n            for (var i = 0; i < sheetModel.length; i++) {\n                if (sheetModel[i].name) {\n                    for (var j = 0; j < this.parent.sheets.length; j++) {\n                        if (sheetModel[i].name === this.parent.sheets[j].name) {\n                            sheetModel.splice(i, 1);\n                            i--;\n                            break;\n                        }\n                    }\n                }\n            }\n            if (!sheetModel.length) {\n                return;\n            }\n            delete model[0].index;\n            this.parent.createSheet(index, model);\n            var id_1;\n            if (args.activeSheetIndex) {\n                this.parent.setProperties({ activeSheetIndex: args.activeSheetIndex }, true);\n            }\n            else if (!args.isAction && args.start < this.parent.activeSheetIndex) {\n                this.parent.setProperties({ activeSheetIndex: this.parent.skipHiddenSheets(this.parent.activeSheetIndex) }, true);\n            }\n            model.forEach(function (sheet) {\n                if (isModel) {\n                    _this.updateRangeModel(sheet.ranges);\n                }\n                id_1 = sheet.id;\n                _this.parent.notify(workbookFormulaOperation, {\n                    action: 'addSheet', visibleName: sheet.name, sheetName: 'Sheet' + id_1, index: id_1\n                });\n            });\n        }\n        var insertArgs = {\n            action: 'refreshNamedRange', insertArgs: {\n                model: model, index: index, modelType: args.modelType, isAction: args.isAction, activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length, name: 'insert'\n            }\n        };\n        var eventArgs = {\n            action: 'refreshInsDelFormula', insertArgs: {\n                model: model, startIndex: args.start, endIndex: args.end, modelType: args.modelType, name: 'insert', activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length\n            }\n        };\n        if (args.modelType !== 'Sheet') {\n            this.parent.notify(workbookFormulaOperation, insertArgs);\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            this.parent.notify(refreshClipboard, { start: index, end: index + model.length - 1, modelType: args.modelType, model: args.model, isInsert: true });\n            if (args.model !== this.parent.getActiveSheet()) {\n                return;\n            }\n        }\n        this.parent.notify(insert, {\n            model: model, index: index, modelType: args.modelType, isAction: args.isAction, activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length, insertType: args.insertType, freezePane: freezePane\n        });\n    };\n    WorkbookInsert.prototype.updateRangeModel = function (ranges) {\n        ranges.forEach(function (range) {\n            if (range.dataSource) {\n                range.startCell = range.startCell || 'A1';\n                range.showFieldAsHeader = range.showFieldAsHeader === undefined || range.showFieldAsHeader;\n                range.template = range.template || '';\n                range.address = range.address || 'A1';\n            }\n        });\n    };\n    WorkbookInsert.prototype.setInsertInfo = function (sheet, startIndex, count, totalKey, modelType) {\n        if (modelType === void 0) { modelType = 'Row'; }\n        var endIndex = count = startIndex + (count - 1);\n        sheet.ranges.forEach(function (range) {\n            if (range.info && startIndex < range.info[totalKey]) {\n                if (!range.info[\"insert\" + modelType + \"Range\"]) {\n                    range.info[\"insert\" + modelType + \"Range\"] = [[startIndex, endIndex]];\n                }\n                else {\n                    range.info[\"insert\" + modelType + \"Range\"].push([startIndex, endIndex]);\n                }\n                range.info[totalKey] += ((endIndex - startIndex) + 1);\n            }\n        });\n    };\n    WorkbookInsert.prototype.addEventListener = function () {\n        this.parent.on(insertModel, this.insertModel, this);\n    };\n    /**\n     * Destroy workbook insert module.\n     *\n     * @returns {void} - destroy the workbook insert module.\n     */\n    WorkbookInsert.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookInsert.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insertModel, this.insertModel);\n        }\n    };\n    /**\n     * Get the workbook insert module name.\n     *\n     * @returns {string} - Return the string.\n     */\n    WorkbookInsert.prototype.getModuleName = function () {\n        return 'workbookinsert';\n    };\n    return WorkbookInsert;\n}());\nexport { WorkbookInsert };\n","import { getCell, setCell } from '../base/index';\nimport { deleteAction, refreshClipboard, beforeDelete } from '../../workbook/common/index';\nimport { activeCellMergedRange, setMerge, workbookFormulaOperation, deleteModel } from '../../workbook/common/index';\n/**\n * The `WorkbookDelete` module is used to delete cells, rows, columns and sheets from workbook.\n */\nvar WorkbookDelete = /** @class */ (function () {\n    /**\n     * Constructor for the workbook delete module.\n     *\n     * @param {Workbook} parent - Specify the workbook\n     * @private\n     */\n    function WorkbookDelete(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    // tslint:disable-next-line\n    WorkbookDelete.prototype.deleteModel = function (args) {\n        var _this = this;\n        var sheetLength = this.parent.sheets.length;\n        if (args.modelType === 'Sheet' && sheetLength === 1) {\n            return;\n        }\n        var modelName = args.modelType.toLowerCase() + \"s\";\n        args.start = args.start;\n        if (args.start > args.end) {\n            var temp = args.start;\n            args.start = args.end;\n            args.end = temp;\n        }\n        var deletedCells;\n        var mergeArgsCollection = [];\n        var count = (args.end - args.start) + 1;\n        var prevCell;\n        var freezePane;\n        if (args.modelType === 'Row') {\n            args.model = args.model;\n            if (args.start > args.model.usedRange.rowIndex) {\n                return;\n            }\n            if (args.end > args.model.usedRange.rowIndex) {\n                args.end -= (args.end - args.model.usedRange.rowIndex);\n            }\n            args.model.usedRange.rowIndex -= ((args.end - args.start) + 1);\n            if (args.model.usedRange.rowIndex < 0) {\n                args.model.usedRange.rowIndex = 0;\n            }\n            var frozenRow = this.parent.frozenRowCount(args.model);\n            if (args.start < frozenRow) {\n                frozenRow = args.end < frozenRow ? (args.end - args.start) + 1 : frozenRow - args.start;\n                frozenRow = args.model.frozenRows - frozenRow;\n                this.parent.setSheetPropertyOnMute(args.model, 'frozenRows', frozenRow);\n                freezePane = true;\n            }\n            var curIdx = args.end + 1;\n            var cell = void 0;\n            var mergeArgs = void 0;\n            if (args.model.rows[args.start] && args.model.rows[args.start].cells) {\n                for (var i = 0; i <= args.model.usedRange.colIndex; i++) {\n                    if (args.model.rows[args.start].cells[i] && args.model.rows[args.start].cells[i].rowSpan !== undefined &&\n                        args.model.rows[args.start].cells[i].rowSpan < 0 && args.model.rows[args.start].cells[i].colSpan === undefined) {\n                        mergeArgs = { range: [args.start, i, args.start, i] };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        mergeArgs.range = mergeArgs.range;\n                        if (mergeArgs.range[2] <= args.end) {\n                            prevCell = getCell(mergeArgs.range[0], i, args.model);\n                            if (prevCell && prevCell.rowSpan > 1) {\n                                if (prevCell.rowSpan - ((mergeArgs.range[2] - args.start) + 1) > 1) {\n                                    setCell(mergeArgs.range[0], i, args.model, { colSpan: prevCell.rowSpan - ((mergeArgs.range[2] - args.start) + 1) }, true);\n                                }\n                                else {\n                                    delete args.model.rows[mergeArgs.range[0]].cells[i].rowSpan;\n                                }\n                            }\n                            mergeArgs = null;\n                        }\n                    }\n                    if (args.model.rows[curIdx] && args.model.rows[curIdx].cells && args.model.rows[curIdx].cells[i] &&\n                        args.model.rows[curIdx].cells[i].rowSpan !== undefined &&\n                        args.model.rows[curIdx].cells[i].rowSpan < 0 && args.model.rows[curIdx].cells[i].colSpan === undefined) {\n                        if (!mergeArgs) {\n                            mergeArgs = { range: [curIdx, i, curIdx, i] };\n                            this.parent.notify(activeCellMergedRange, mergeArgs);\n                        }\n                        cell = new Object();\n                        mergeArgs.range = mergeArgs.range;\n                        Object.assign(cell, getCell(mergeArgs.range[0], mergeArgs.range[1], args.model));\n                        if (cell && cell.rowSpan && (cell.rowSpan > 1 || cell.colSpan > 1)) {\n                            var indexes = [];\n                            indexes[1] = i;\n                            indexes[3] = cell.colSpan > 1 ? i + (cell.colSpan - 1) : i;\n                            mergeArgs.range = mergeArgs.range;\n                            if (mergeArgs.range[0] < args.start) {\n                                indexes[0] = indexes[2] = mergeArgs.range[0];\n                                if (cell.rowSpan - count > 1) {\n                                    indexes[2] += (cell.rowSpan - count - 1);\n                                }\n                            }\n                            else {\n                                indexes[0] = indexes[2] = args.start;\n                                if (cell.rowSpan - ((args.end - mergeArgs.range[0]) + 1) > 1) {\n                                    indexes[2] += ((cell.rowSpan - ((args.end - mergeArgs.range[0]) + 1)) - 1);\n                                }\n                            }\n                            mergeArgsCollection.push({\n                                range: indexes, isAction: false, preventRefresh: true, merge: true,\n                                type: 'All', skipChecking: true\n                            });\n                        }\n                    }\n                    mergeArgs = null;\n                }\n            }\n        }\n        else if (args.modelType === 'Column') {\n            args.model = args.model;\n            if (args.start > args.model.usedRange.colIndex) {\n                return;\n            }\n            if (args.end > args.model.usedRange.colIndex) {\n                args.end -= (args.end - args.model.usedRange.colIndex);\n            }\n            args.model.usedRange.colIndex -= count;\n            if (args.model.usedRange.colIndex < 0) {\n                args.model.usedRange.colIndex = 0;\n            }\n            //this.setDeleteInfo(args.start, args.end, 'fldLen', 'Column');\n            var frozenCol = this.parent.frozenColCount(args.model);\n            if (args.start < frozenCol) {\n                frozenCol = args.end < frozenCol ? (args.end - args.start) + 1 : frozenCol - args.start;\n                frozenCol = args.model.frozenColumns - frozenCol;\n                this.parent.setSheetPropertyOnMute(args.model, 'frozenColumns', frozenCol);\n                freezePane = true;\n            }\n            deletedCells = [];\n            var curIdx = args.end + 1;\n            var cell = void 0;\n            var mergeArgs = void 0;\n            for (var i = 0; i <= args.model.usedRange.rowIndex; i++) {\n                deletedCells.push({});\n                if (args.model.rows[i] && args.model.rows[i].cells) {\n                    if (args.model.rows[i].cells[args.start] && args.model.rows[i].cells[args.start].colSpan !== undefined &&\n                        args.model.rows[i].cells[args.start].colSpan < 0 && args.model.rows[i].cells[args.start].rowSpan === undefined) {\n                        mergeArgs = { range: [i, args.start, i, args.start] };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        mergeArgs.range = mergeArgs.range;\n                        if (mergeArgs.range[3] <= args.end) {\n                            var prevCell_1 = getCell(i, mergeArgs.range[1], args.model);\n                            if (prevCell_1 && prevCell_1.colSpan > 1) {\n                                if (prevCell_1.colSpan - ((mergeArgs.range[3] - args.start) + 1) > 1) {\n                                    setCell(i, mergeArgs.range[1], args.model, { colSpan: prevCell_1.colSpan - ((mergeArgs.range[3] - args.start) + 1) }, true);\n                                }\n                                else {\n                                    delete args.model.rows[i].cells[mergeArgs.range[1]].colSpan;\n                                }\n                            }\n                            mergeArgs = null;\n                        }\n                    }\n                    if (args.model.rows[i].cells[curIdx] && args.model.rows[i].cells[curIdx].colSpan !== undefined &&\n                        args.model.rows[i].cells[curIdx].colSpan < 0 && args.model.rows[i].cells[curIdx].rowSpan === undefined) {\n                        if (!mergeArgs) {\n                            mergeArgs = { range: [i, curIdx, i, curIdx] };\n                            this.parent.notify(activeCellMergedRange, mergeArgs);\n                        }\n                        cell = new Object();\n                        mergeArgs.range = mergeArgs.range;\n                        Object.assign(cell, getCell(mergeArgs.range[0], mergeArgs.range[1], args.model));\n                        if (cell && cell.colSpan && (cell.colSpan > 1 || cell.rowSpan > 1)) {\n                            var indexes = [];\n                            indexes[0] = i;\n                            indexes[2] = cell.rowSpan > 1 ? i + (cell.rowSpan - 1) : i;\n                            mergeArgs.range = mergeArgs.range;\n                            if (mergeArgs.range[1] < args.start) {\n                                indexes[1] = indexes[3] = mergeArgs.range[1];\n                                if (cell.colSpan - count > 1) {\n                                    indexes[3] += (cell.colSpan - count - 1);\n                                }\n                            }\n                            else {\n                                indexes[1] = indexes[3] = args.start;\n                                if (cell.colSpan - ((args.end - mergeArgs.range[1]) + 1) > 1) {\n                                    indexes[3] += ((cell.colSpan - ((args.end - mergeArgs.range[1]) + 1)) - 1);\n                                }\n                            }\n                            mergeArgsCollection.push({\n                                range: indexes, isAction: false, preventRefresh: true, merge: true,\n                                type: 'All', skipChecking: true\n                            });\n                        }\n                    }\n                    deletedCells[i].cells = args.model.rows[i].cells.splice(args.start, count);\n                    mergeArgs = null;\n                }\n            }\n        }\n        else {\n            if (args.end - args.start === this.parent.sheets.length - 1) {\n                return;\n            }\n        }\n        var deletedModel = [];\n        for (var i = args.start; i <= args.end; i++) {\n            if (args.modelType === 'Sheet') {\n                this.parent.notify(workbookFormulaOperation, {\n                    action: 'deleteSheetTab', sheetName: '', index: i + 1\n                });\n            }\n            if (args.model[modelName][args.start]) {\n                deletedModel.push(args.model[modelName][args.start]);\n                args.model[modelName].splice(args.start, 1);\n            }\n            else {\n                deletedModel.push({});\n            }\n            if (i === args.start) {\n                deletedModel[0].index = args.start;\n            }\n        }\n        mergeArgsCollection.forEach(function (merge) { _this.parent.notify(setMerge, merge); });\n        var insertArgs = {\n            action: 'refreshNamedRange', insertArgs: {\n                startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n                isAction: args.isAction, deletedModel: deletedModel, deletedCellsModel: deletedCells,\n                activeSheetIndex: this.parent.activeSheetIndex, name: 'delete'\n            }\n        };\n        // const eventArgs: { [key: string]: Object } = {\n        //     action: 'refreshInsDelFormula', insertArgs: {\n        //         model: deletedModel, startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n        //         name: 'delete', activeSheetIndex:\n        //             args.activeSheetIndex, sheetCount: this.parent.sheets.length\n        //     }\n        // };\n        this.parent.notify(workbookFormulaOperation, insertArgs);\n        this.parent.notify(beforeDelete, args);\n        if (args.modelType !== 'Sheet') {\n            this.parent.notify(refreshClipboard, args);\n            if (args.model !== this.parent.getActiveSheet()) {\n                return;\n            }\n        }\n        this.parent.notify(deleteAction, {\n            startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n            isAction: args.isAction, deletedModel: deletedModel, deletedCellsModel: deletedCells,\n            activeSheetIndex: this.parent.activeSheetIndex, freezePane: freezePane\n        });\n    };\n    WorkbookDelete.prototype.setDeleteInfo = function (startIndex, endIndex, totalKey, modelType) {\n        if (modelType === void 0) { modelType = 'Row'; }\n        var total = (endIndex - startIndex) + 1;\n        var newRange = [];\n        this.parent.getActiveSheet().ranges.forEach(function (range) {\n            if (range.info && startIndex < range.info[totalKey]) {\n                if (range.info[\"delete\" + modelType + \"Range\"]) {\n                    range.info[\"delete\" + modelType + \"Range\"].push([startIndex, endIndex]);\n                }\n                else {\n                    range.info[\"delete\" + modelType + \"Range\"] = [[startIndex, endIndex]];\n                }\n                range.info[totalKey] -= total;\n                if (range.info[\"insert\" + modelType + \"Range\"]) {\n                    range.info[\"insert\" + modelType + \"Range\"] = newRange;\n                }\n            }\n        });\n    };\n    WorkbookDelete.prototype.addEventListener = function () {\n        this.parent.on(deleteModel, this.deleteModel, this);\n    };\n    /**\n     * Destroy workbook delete module.\n     *\n     * @returns {void}\n     */\n    WorkbookDelete.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookDelete.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(deleteModel, this.deleteModel);\n        }\n    };\n    /**\n     * Get the workbook delete module name.\n     *\n     * @returns {string} - returns the module name.\n     */\n    WorkbookDelete.prototype.getModuleName = function () {\n        return 'workbookdelete';\n    };\n    return WorkbookDelete;\n}());\nexport { WorkbookDelete };\n","import { setCell, setRow, getSheet, getColumn } from '../base/index';\nimport { setValidation, applyCellFormat, isValidation, removeValidation, addHighlight, getCellAddress, validationHighlight } from '../common/index';\nimport { removeHighlight } from '../common/index';\nimport { getRangeIndexes } from '../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookHyperlink` module is used to handle Hyperlink action in Spreadsheet.\n */\nvar WorkbookDataValidation = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     *\n     * @param {Workbook} parent - Specifies the parent element.\n     */\n    function WorkbookDataValidation(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     *\n     * @returns {void}\n     */\n    WorkbookDataValidation.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookDataValidation.prototype.addEventListener = function () {\n        this.parent.on(setValidation, this.addValidationHandler, this);\n        this.parent.on(removeValidation, this.removeValidationHandler, this);\n        this.parent.on(addHighlight, this.addHighlightHandler, this);\n        this.parent.on(removeHighlight, this.removeHighlightHandler, this);\n    };\n    WorkbookDataValidation.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setValidation, this.addValidationHandler);\n            this.parent.off(removeValidation, this.removeValidationHandler);\n            this.parent.off(addHighlight, this.addHighlightHandler);\n            this.parent.off(removeHighlight, this.removeHighlightHandler);\n        }\n    };\n    WorkbookDataValidation.prototype.addValidationHandler = function (args) {\n        this.ValidationHandler(args.rules, args.range, false);\n    };\n    WorkbookDataValidation.prototype.removeValidationHandler = function (args) {\n        this.ValidationHandler(args.rules, args.range, true);\n    };\n    WorkbookDataValidation.prototype.ValidationHandler = function (rules, range, isRemoveValidation) {\n        var cell;\n        var onlyRange = range;\n        var sheetName = '';\n        if (range.indexOf('!') > -1) {\n            onlyRange = range.split('!')[1];\n            sheetName = range.split('!')[0];\n        }\n        var sheet = getSheet(this.parent, this.parent.getAddressInfo(sheetName + 'A1:A1').sheetIndex);\n        var isfullCol = false;\n        var maxRowCount = sheet.rowCount;\n        var rangeArr = onlyRange.split(':');\n        if (onlyRange.match(/\\D/g) && !onlyRange.match(/[0-9]/g)) {\n            rangeArr[0] += 1;\n            rangeArr[1] += maxRowCount;\n            onlyRange = rangeArr[0] + ':' + rangeArr[1];\n            isfullCol = true;\n        }\n        else if (!onlyRange.match(/\\D/g) && onlyRange.match(/[0-9]/g)) {\n            rangeArr[0] = 'A' + rangeArr[0];\n            rangeArr[1] = getCellAddress(0, sheet.colCount - 1).replace(/[0-9]/g, '') + rangeArr[1];\n            onlyRange = rangeArr[0] + ':' + rangeArr[1];\n        }\n        if (!isNullOrUndefined(sheetName)) {\n            range = sheetName + onlyRange;\n        }\n        range = range || sheet.selectedRange;\n        var indexes = getRangeIndexes(range);\n        if (isfullCol) {\n            for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                var column = getColumn(sheet, colIdx);\n                if (isRemoveValidation && column && column.validation) {\n                    delete (sheet.columns[colIdx].validation);\n                }\n                else {\n                    if (isNullOrUndefined(column)) {\n                        sheet.columns[colIdx] = getColumn(sheet, colIdx);\n                    }\n                    sheet.columns[colIdx].validation = {\n                        operator: rules.operator,\n                        type: rules.type,\n                        value1: (rules.type === 'List' && rules.value1.length > 256) ?\n                            rules.value1.substring(0, 255) : rules.value1,\n                        value2: rules.value2,\n                        inCellDropDown: rules.inCellDropDown,\n                        ignoreBlank: rules.ignoreBlank\n                    };\n                }\n            }\n        }\n        else {\n            for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n                if (!sheet.rows[rowIdx]) {\n                    setRow(sheet, rowIdx, {});\n                }\n                for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                    if (!sheet.rows[rowIdx].cells || !sheet.rows[rowIdx].cells[colIdx]) {\n                        setCell(rowIdx, colIdx, sheet, {});\n                    }\n                    cell = sheet.rows[rowIdx].cells[colIdx];\n                    if (isRemoveValidation) {\n                        if (cell.validation) {\n                            delete (cell.validation);\n                            var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rowIdx, colIdx]);\n                            this.parent.notify(applyCellFormat, {\n                                style: style, rowIdx: rowIdx, colIdx: colIdx\n                            });\n                        }\n                    }\n                    else {\n                        cell.validation = {\n                            type: rules.type,\n                            operator: rules.operator,\n                            value1: (rules.type === 'List' && rules.value1.length > 256) ?\n                                rules.value1.substring(0, 255) : rules.value1,\n                            value2: rules.value2,\n                            ignoreBlank: rules.ignoreBlank,\n                            inCellDropDown: rules.inCellDropDown\n                        };\n                    }\n                }\n            }\n        }\n    };\n    WorkbookDataValidation.prototype.addHighlightHandler = function (args) {\n        this.InvalidDataHandler(args.range, false, args.td, args.isclearFormat);\n    };\n    WorkbookDataValidation.prototype.removeHighlightHandler = function (args) {\n        this.InvalidDataHandler(args.range, true);\n    };\n    WorkbookDataValidation.prototype.getRange = function (range) {\n        var indexes = getRangeIndexes(range);\n        var sheet = this.parent.getActiveSheet();\n        var maxColCount = sheet.colCount;\n        var maxRowCount = sheet.rowCount;\n        if (indexes[2] === maxRowCount - 1 && indexes[0] === 0) {\n            range = range.replace(/[0-9]/g, '');\n        }\n        else if (indexes[3] === maxColCount - 1 && indexes[2] === 0) {\n            range = range.replace(/\\D/g, '');\n        }\n        return range;\n    };\n    WorkbookDataValidation.prototype.InvalidDataHandler = function (range, isRemoveHighlightedData, td, isclearFormat) {\n        var isCell = false;\n        var cell;\n        var value;\n        var sheet = this.parent.getActiveSheet();\n        range = range || sheet.selectedRange;\n        var indexes = range ? getRangeIndexes(range) : [];\n        range = this.getRange(range);\n        var isfullCol = false;\n        if (range.match(/\\D/g) && !range.match(/[0-9]/g)) {\n            isfullCol = true;\n        }\n        var rowIdx = range ? indexes[0] : 0;\n        var lastRowIdx = range ? indexes[2] : sheet.rows.length;\n        for (rowIdx; rowIdx <= lastRowIdx; rowIdx++) {\n            if (sheet.rows[rowIdx]) {\n                var colIdx = range ? indexes[1] : 0;\n                var lastColIdx = range ? indexes[3] : sheet.rows[rowIdx].cells.length;\n                for (colIdx; colIdx <= lastColIdx; colIdx++) {\n                    var validation = void 0;\n                    if (sheet.rows[rowIdx].cells[colIdx]) {\n                        var column = getColumn(sheet, colIdx);\n                        cell = sheet.rows[rowIdx].cells[colIdx];\n                        if (cell && cell.validation) {\n                            validation = cell.validation;\n                            if (isclearFormat && !validation.isHighlighted) {\n                                return;\n                            }\n                            if (isRemoveHighlightedData) {\n                                if (validation.isHighlighted) {\n                                    cell.validation.isHighlighted = false;\n                                }\n                            }\n                            else {\n                                cell.validation.isHighlighted = true;\n                            }\n                        }\n                        else if (column && column.validation) {\n                            validation = column.validation;\n                            if (isclearFormat && !validation.isHighlighted) {\n                                return;\n                            }\n                            if (isRemoveHighlightedData && isfullCol) {\n                                if (validation.isHighlighted) {\n                                    column.validation.isHighlighted = false;\n                                }\n                            }\n                            else if (isfullCol) {\n                                column.validation.isHighlighted = true;\n                            }\n                        }\n                        value = cell.value ? cell.value : '';\n                        var range_1 = [rowIdx, colIdx];\n                        var sheetIdx = this.parent.activeSheetIndex;\n                        if (validation && this.parent.allowDataValidation) {\n                            this.parent.notify(isValidation, { value: value, range: range_1, sheetIdx: sheetIdx, isCell: isCell });\n                            var isValid = this.parent.allowDataValidation;\n                            this.parent.allowDataValidation = true;\n                            if (!isValid) {\n                                this.parent.notify(validationHighlight, {\n                                    isRemoveHighlightedData: isRemoveHighlightedData, rowIdx: rowIdx, colIdx: colIdx, td: td\n                                });\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Gets the module name.\n     *\n     * @returns {string} string\n     */\n    WorkbookDataValidation.prototype.getModuleName = function () {\n        return 'workbookDataValidation';\n    };\n    return WorkbookDataValidation;\n}());\nexport { WorkbookDataValidation };\n","import { getCellIndexes, getCellAddress, findNext, findPrevious, count } from '../common/index';\nimport { goto, replaceHandler, replaceAllHandler, showDialog, findUndoRedo, replaceAllDialog } from '../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { findAllValues, workBookeditAlert } from '../common/index';\n/**\n * `WorkbookFindAndReplace` module is used to handle the search action in Spreadsheet.\n */\nvar WorkbookFindAndReplace = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookFindAndReplace module.\n     *\n     * @param {Workbook} parent - Specifies the workbook.\n     */\n    function WorkbookFindAndReplace(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the FindAndReplace module.\n     *\n     * @returns {void} - To destroy the FindAndReplace module.\n     */\n    WorkbookFindAndReplace.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookFindAndReplace.prototype.addEventListener = function () {\n        this.parent.on(findNext, this.findNext, this);\n        this.parent.on(findPrevious, this.findPrevious, this);\n        this.parent.on(replaceHandler, this.replace, this);\n        this.parent.on(replaceAllHandler, this.replaceAll, this);\n        this.parent.on(count, this.totalCount, this);\n        this.parent.on(findAllValues, this.findAllValues, this);\n    };\n    WorkbookFindAndReplace.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(findNext, this.findNext);\n            this.parent.off(findPrevious, this.findPrevious);\n            this.parent.off(replaceHandler, this.replace);\n            this.parent.off(replaceAllHandler, this.replaceAll);\n            this.parent.off(count, this.totalCount);\n            this.parent.off(findAllValues, this.findAllValues);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNext = function (args) {\n        var sheets = this.parent.sheets;\n        var val;\n        var sheet = sheets[this.parent.activeSheetIndex];\n        var activecell = getCellIndexes(sheet.activeCell);\n        var usedRange = sheet.usedRange;\n        var endColumn = usedRange.colIndex;\n        var stringValue = args.value.toString();\n        var cidx;\n        var ridx;\n        var count = 0;\n        var endRow = usedRange.rowIndex;\n        var loopCount = 0;\n        var cellFormat;\n        var valueOfCell;\n        cidx = activecell[1];\n        ridx = activecell[0];\n        var startColumn = cidx;\n        var startRow = ridx;\n        if (sheet.rows[ridx]) {\n            if (sheet.rows[ridx].cells && sheet.rows[ridx].cells[cidx]) {\n                cellFormat = sheet.rows[ridx].cells[cidx].format;\n                if (cellFormat) {\n                    var dispTxt = this.parent.getDisplayText(sheet.rows[ridx].cells[cidx]);\n                    valueOfCell = dispTxt.toString();\n                }\n                else {\n                    if (sheet.rows[ridx].cells[cidx].value) {\n                        valueOfCell = sheet.rows[ridx].cells[cidx].value.toString();\n                    }\n                }\n            }\n        }\n        if (valueOfCell) {\n            var lcValueOfCell = valueOfCell.toLowerCase();\n            var ivalueOfCell = valueOfCell.indexOf(args.value) > -1;\n            var lowerCaseIndex = lcValueOfCell.indexOf(args.value.toString().toLowerCase()) > -1;\n            if ((stringValue === valueOfCell) || (stringValue === lcValueOfCell) || (ivalueOfCell) || (lowerCaseIndex)) {\n                if (args.searchBy === 'By Column') {\n                    ridx++;\n                }\n                else {\n                    cidx++;\n                }\n                count++;\n            }\n        }\n        if (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex) {\n            if (activecell[0] > sheet.usedRange.rowIndex && activecell[1] <= sheet.usedRange.colIndex) {\n                ridx = 0;\n                cidx = activecell[1];\n            }\n            else if (activecell[0] <= sheet.usedRange.rowIndex && activecell[1] > sheet.usedRange.colIndex) {\n                ridx = activecell[0];\n                cidx = 0;\n            }\n            else {\n                ridx = 0;\n                cidx = 0;\n            }\n        }\n        var findNextArgs = {\n            rowIndex: ridx, colIndex: cidx, usedRange: usedRange, endRow: endRow, endColumn: endColumn, startRow: startRow,\n            mode: args.mode, loopCount: loopCount, count: count, args: args, val: val, stringValue: stringValue,\n            sheetIndex: this.parent.activeSheetIndex, startColumn: startColumn, sheets: sheets\n        };\n        if (args.searchBy === 'By Row') {\n            this.findNxtRow(findNextArgs);\n        }\n        if (args.searchBy === 'By Column') {\n            this.findNxtCol(findNextArgs);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNxtRow = function (findNextArgs) {\n        var usedRange;\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        var sheetsLen = this.parent.sheets.length;\n        usedRange = sheet.usedRange;\n        var activecell = getCellIndexes(sheet.activeCell);\n        if (findNextArgs.colIndex >= findNextArgs.usedRange.colIndex + 1) {\n            findNextArgs.colIndex = 0;\n            findNextArgs.rowIndex++;\n        }\n        for (findNextArgs.rowIndex; findNextArgs.rowIndex <= findNextArgs.endRow + 1; findNextArgs.rowIndex++) {\n            if (findNextArgs.rowIndex > findNextArgs.endRow) {\n                if (findNextArgs.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findNextArgs.sheetIndex++;\n                    if (sheetsLen === findNextArgs.sheetIndex) {\n                        findNextArgs.sheetIndex = 0;\n                    }\n                    if (noCellfound === findNextArgs.sheetIndex) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n                    usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findNextArgs.rowIndex = 0;\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.endColumn = usedRange.colIndex;\n                    findNextArgs.endRow = usedRange.rowIndex;\n                }\n                if (findNextArgs.colIndex === 0 && findNextArgs.rowIndex > findNextArgs.endRow) {\n                    if ((activecell[0] === 0 && activecell[1] === 0)) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    else if ((activecell[0] !== 0 && activecell[1] !== 0) || (activecell[0] !== 0 || activecell[1] !== 0)) {\n                        findNextArgs.startColumn = 0;\n                        findNextArgs.startRow = 0;\n                        findNextArgs.endColumn = usedRange.colIndex;\n                        findNextArgs.endRow = activecell[0];\n                        findNextArgs.rowIndex = findNextArgs.startRow;\n                        findNextArgs.colIndex = findNextArgs.startColumn;\n                        findNextArgs.loopCount++;\n                    }\n                }\n            }\n            if (findNextArgs.count > 0) {\n                if (usedRange.rowIndex < findNextArgs.rowIndex) {\n                    findNextArgs.rowIndex = 0;\n                    if (findNextArgs.rowIndex === 0) {\n                        findNextArgs.colIndex = 0;\n                    }\n                }\n            }\n            if (sheet.rows[findNextArgs.rowIndex]) {\n                var row = sheet.rows[findNextArgs.rowIndex];\n                for (findNextArgs.colIndex; findNextArgs.colIndex <= findNextArgs.endColumn; findNextArgs.colIndex++) {\n                    if (row) {\n                        if (row.cells && row.cells[findNextArgs.colIndex]) {\n                            var checkTrue = this.nextCommon(findNextArgs);\n                            if (checkTrue) {\n                                return;\n                            }\n                        }\n                    }\n                }\n                if (findNextArgs.colIndex > findNextArgs.endColumn) {\n                    findNextArgs.colIndex = 0;\n                }\n                if (findNextArgs.loopCount > 0) {\n                    if (activecell[0] === findNextArgs.rowIndex) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n            }\n        }\n        if (findNextArgs.count === 0) {\n            this.parent.notify(showDialog, null);\n            return;\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNxtCol = function (findNextArgs) {\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        var noFound;\n        var activecell = getCellIndexes(sheet.activeCell);\n        var sheetsLen = this.parent.sheets.length;\n        if (findNextArgs.rowIndex >= findNextArgs.usedRange.rowIndex) {\n            findNextArgs.rowIndex = 0;\n            findNextArgs.colIndex++;\n        }\n        for (findNextArgs.colIndex; findNextArgs.colIndex <= findNextArgs.usedRange.colIndex + 1; findNextArgs.colIndex++) {\n            if (findNextArgs.colIndex >= findNextArgs.endColumn + 1) {\n                if (findNextArgs.mode === 'Workbook') {\n                    noFound = this.parent.activeSheetIndex;\n                    findNextArgs.sheetIndex++;\n                    if (sheetsLen === findNextArgs.sheetIndex) {\n                        findNextArgs.sheetIndex = 0;\n                    }\n                    if (noFound === findNextArgs.sheetIndex) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n                    findNextArgs.usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.rowIndex = 0;\n                    findNextArgs.endColumn = findNextArgs.usedRange.colIndex;\n                    findNextArgs.endRow = findNextArgs.usedRange.rowIndex;\n                }\n            }\n            if (findNextArgs.colIndex >= findNextArgs.endColumn + 1) {\n                findNextArgs.colIndex = 0;\n            }\n            if (findNextArgs.rowIndex > findNextArgs.endRow && findNextArgs.colIndex === 0) {\n                if ((activecell[0] === 0 && activecell[1] === 0) ||\n                    (activecell[1] > sheet.usedRange.rowIndex || activecell[0] > sheet.usedRange.colIndex)) {\n                    if (findNextArgs.count === 0) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n                else if ((activecell[1] !== 0 || activecell[0] !== 0) || (activecell[1] !== 0 && activecell[0] !== 0)) {\n                    findNextArgs.startRow = 0;\n                    findNextArgs.startColumn = 0;\n                    findNextArgs.endRow = activecell[0];\n                    findNextArgs.endColumn = findNextArgs.usedRange.colIndex;\n                    findNextArgs.colIndex = findNextArgs.startColumn;\n                    findNextArgs.rowIndex = findNextArgs.startRow;\n                    findNextArgs.loopCount++;\n                }\n            }\n            if (findNextArgs.count > 0) {\n                if (findNextArgs.usedRange.colIndex + 1 < findNextArgs.colIndex) {\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.rowIndex = 0;\n                }\n            }\n            if (findNextArgs.rowIndex >= findNextArgs.endRow) {\n                findNextArgs.rowIndex = 0;\n            }\n            if (findNextArgs.colIndex <= findNextArgs.usedRange.colIndex) {\n                for (findNextArgs.rowIndex; findNextArgs.rowIndex <= findNextArgs.usedRange.rowIndex; findNextArgs.rowIndex++) {\n                    if (sheet.rows[findNextArgs.rowIndex]) {\n                        if (sheet.rows[findNextArgs.rowIndex].cells && sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex]) {\n                            var checkTrue = this.nextCommon(findNextArgs);\n                            if (checkTrue) {\n                                return;\n                            }\n                        }\n                    }\n                }\n                if (findNextArgs.loopCount > 0) {\n                    if (activecell[1] === findNextArgs.colIndex) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n            }\n        }\n        if (findNextArgs.count === 0) {\n            this.parent.notify(showDialog, null);\n            return;\n        }\n    };\n    WorkbookFindAndReplace.prototype.nextCommon = function (findNextArgs) {\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        if (sheet.rows[findNextArgs.rowIndex]) {\n            var rowCol = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex];\n            if (rowCol && rowCol.value) {\n                var cellType = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex];\n                if (cellType) {\n                    var cellval = void 0;\n                    if (cellType.format) {\n                        var displayTxt = this.parent.getDisplayText(sheet.rows[findNextArgs.rowIndex].\n                            cells[findNextArgs.colIndex]);\n                        cellval = displayTxt;\n                    }\n                    else {\n                        cellval = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex].value.toString();\n                    }\n                    if (findNextArgs.args.isCSen && findNextArgs.args.isEMatch) {\n                        if (cellval === findNextArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (findNextArgs.args.isCSen && !findNextArgs.args.isEMatch) {\n                        var index = cellval.indexOf(findNextArgs.args.value) > -1;\n                        if ((cellval === findNextArgs.stringValue) || (index)) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findNextArgs.args.isCSen && findNextArgs.args.isEMatch) {\n                        findNextArgs.val = cellval.toString().toLowerCase();\n                        if (findNextArgs.val === findNextArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findNextArgs.args.isCSen && !findNextArgs.args.isEMatch) {\n                        findNextArgs.val = cellval.toString().toLowerCase();\n                        var index = findNextArgs.val.indexOf(findNextArgs.args.value.toString().toLowerCase()) > -1;\n                        var lowerCaseIndex = findNextArgs.val.indexOf(findNextArgs.args.value) > -1;\n                        if ((findNextArgs.val === findNextArgs.stringValue) || ((cellval === findNextArgs.stringValue) || (index)) ||\n                            (cellval === findNextArgs.stringValue) || (lowerCaseIndex)) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    WorkbookFindAndReplace.prototype.findPrevious = function (args) {\n        var sheets = this.parent.sheets;\n        var sheetIndex = args.sheetIndex;\n        var sheet = sheets[sheetIndex];\n        var valueOfCell;\n        var cellFormat;\n        var val;\n        var activecell = getCellIndexes(sheet.activeCell);\n        var loopCount = 0;\n        var count = 0;\n        var endRow = sheet.usedRange.rowIndex;\n        var endColumn = sheet.usedRange.colIndex;\n        var stringValue = args.value.toString();\n        var cidx = activecell[1];\n        var ridx = activecell[0];\n        var startColumn = cidx;\n        var startRow = ridx;\n        if (sheet.rows[ridx]) {\n            if (sheet.rows[ridx].cells[cidx]) {\n                cellFormat = sheet.rows[ridx].cells[cidx].format;\n                if (cellFormat) {\n                    var displayTxt = this.parent.getDisplayText(sheet.rows[ridx].cells[cidx]);\n                    valueOfCell = displayTxt.toString();\n                }\n                else {\n                    if (sheet.rows[ridx].cells[cidx].value) {\n                        valueOfCell = sheet.rows[ridx].cells[cidx].value.toString();\n                    }\n                }\n            }\n        }\n        if (valueOfCell) {\n            var lcValue = valueOfCell.toLowerCase();\n            var ivalue = valueOfCell.indexOf(args.value) > -1;\n            var lowerCaseIndex = lcValue.indexOf(args.value.toString().toLowerCase()) > -1;\n            if ((stringValue === valueOfCell) || (stringValue === lcValue) || (ivalue) || (lowerCaseIndex)) {\n                if (args.searchBy === 'By Row') {\n                    cidx--;\n                }\n                if (args.searchBy === 'By Column') {\n                    ridx--;\n                }\n                count++;\n            }\n        }\n        if (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex) {\n            if (activecell[0] > sheet.usedRange.rowIndex && activecell[1] <= sheet.usedRange.colIndex) {\n                ridx = sheet.usedRange.rowIndex;\n                cidx = activecell[1];\n            }\n            else if (activecell[0] <= sheet.usedRange.rowIndex && activecell[1] > sheet.usedRange.colIndex) {\n                ridx = activecell[0];\n                cidx = sheet.usedRange.colIndex;\n            }\n            else {\n                ridx = sheet.usedRange.rowIndex;\n                cidx = sheet.usedRange.colIndex;\n            }\n        }\n        var findPrevArgs = {\n            rowIndex: ridx, colIndex: cidx, endRow: endRow, endColumn: endColumn, startRow: startRow,\n            loopCount: loopCount, count: count, args: args, val: val, stringValue: stringValue,\n            sheets: sheets, sheetIndex: sheetIndex, startColumn: startColumn\n        };\n        if (args.searchBy === 'By Row') {\n            this.findPreRow(findPrevArgs);\n        }\n        if (args.searchBy === 'By Column') {\n            this.findPreCol(findPrevArgs);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findPreRow = function (findPrevArgs) {\n        var usedRan;\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var sheetsLength = this.parent.sheets.length;\n        var noValueBoolean = false;\n        var activecell = getCellIndexes(sheet.activeCell);\n        if (findPrevArgs.colIndex === -1) {\n            findPrevArgs.colIndex = findPrevArgs.endColumn;\n            findPrevArgs.rowIndex--;\n        }\n        for (findPrevArgs.rowIndex; findPrevArgs.rowIndex >= -1; findPrevArgs.rowIndex--) {\n            if (findPrevArgs.rowIndex < 0 && findPrevArgs.colIndex <= 0) {\n                if (findPrevArgs.args.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findPrevArgs.sheetIndex--;\n                    if (findPrevArgs.sheetIndex === -1) {\n                        findPrevArgs.sheetIndex = sheetsLength - 1;\n                    }\n                    if (noCellfound === findPrevArgs.sheetIndex) {\n                        if (findPrevArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n                    usedRan = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findPrevArgs.rowIndex = usedRan.rowIndex;\n                    findPrevArgs.colIndex = usedRan.colIndex;\n                    findPrevArgs.endColumn = 0;\n                    findPrevArgs.endRow = 0;\n                }\n                noValueBoolean = this.commonCondition(findPrevArgs, activecell);\n            }\n            if (!noValueBoolean) {\n                if (findPrevArgs.args.mode !== 'Workbook') {\n                    if (findPrevArgs.count > 0) {\n                        if (findPrevArgs.rowIndex === -1) {\n                            findPrevArgs.rowIndex = findPrevArgs.endRow;\n                        }\n                    }\n                }\n                if (findPrevArgs.rowIndex === -1) {\n                    findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                    findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                }\n                var row = sheet.rows[findPrevArgs.rowIndex];\n                if (row) {\n                    if (findPrevArgs.colIndex === -1) {\n                        findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                    }\n                    for (findPrevArgs.colIndex; findPrevArgs.colIndex >= 0; findPrevArgs.colIndex--) {\n                        if (row) {\n                            if (row.cells && row.cells[findPrevArgs.colIndex]) {\n                                var checkTrue = this.prevCommon(findPrevArgs);\n                                if (checkTrue) {\n                                    return;\n                                }\n                            }\n                        }\n                    }\n                    if (findPrevArgs.loopCount > 0) {\n                        if (activecell[0] === findPrevArgs.rowIndex) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n        if (!noValueBoolean) {\n            if (findPrevArgs.count === 0) {\n                this.parent.notify(showDialog, null);\n                return;\n            }\n        }\n    };\n    WorkbookFindAndReplace.prototype.findPreCol = function (findPrevArgs) {\n        var usedRange;\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var sheetsLen = this.parent.sheets.length;\n        var noValueBoolean = false;\n        var activecell = getCellIndexes(sheet.activeCell);\n        for (findPrevArgs.colIndex; findPrevArgs.colIndex >= -1; findPrevArgs.colIndex--) {\n            if (findPrevArgs.rowIndex < 0 && findPrevArgs.colIndex <= 0) {\n                if (findPrevArgs.args.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findPrevArgs.sheetIndex--;\n                    if (findPrevArgs.sheetIndex === -1) {\n                        findPrevArgs.sheetIndex = sheetsLen - 1;\n                    }\n                    if (noCellfound === findPrevArgs.sheetIndex) {\n                        if (findPrevArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n                    usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findPrevArgs.rowIndex = usedRange.rowIndex;\n                    findPrevArgs.colIndex = usedRange.colIndex;\n                    findPrevArgs.endColumn = 0;\n                    findPrevArgs.endRow = 0;\n                }\n                noValueBoolean = this.commonCondition(findPrevArgs, activecell);\n            }\n            if (!noValueBoolean) {\n                if (findPrevArgs.count > 0) {\n                    if (findPrevArgs.colIndex < 0) {\n                        findPrevArgs.colIndex = findPrevArgs.endColumn;\n                    }\n                }\n                if (findPrevArgs.rowIndex < 0) {\n                    findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                }\n                if (findPrevArgs.colIndex < -1) {\n                    findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                    findPrevArgs.rowIndex--;\n                }\n                var row = sheet.rows[findPrevArgs.rowIndex];\n                if (row) {\n                    if (sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex]) {\n                        if (findPrevArgs.rowIndex === -1) {\n                            findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                        }\n                    }\n                }\n                for (findPrevArgs.rowIndex; findPrevArgs.rowIndex >= 0; findPrevArgs.rowIndex--) {\n                    if (row) {\n                        if (row.cells && row.cells[findPrevArgs.colIndex]) {\n                            var check = this.prevCommon(findPrevArgs);\n                            if (check) {\n                                return;\n                            }\n                        }\n                    }\n                    if (findPrevArgs.loopCount > 0) {\n                        if (activecell[1] === findPrevArgs.colIndex) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n        if (!noValueBoolean) {\n            if (findPrevArgs.count === 0) {\n                this.parent.notify(showDialog, null);\n                return;\n            }\n        }\n    };\n    WorkbookFindAndReplace.prototype.commonCondition = function (findPrevArgs, activecell) {\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var isTrue;\n        if ((activecell[0] !== findPrevArgs.endRow && activecell[1] !== findPrevArgs.endColumn) ||\n            (activecell[0] !== findPrevArgs.endRow || activecell[1] !== findPrevArgs.endColumn)) {\n            findPrevArgs.startColumn = sheet.usedRange.colIndex;\n            findPrevArgs.startRow = sheet.usedRange.rowIndex;\n            findPrevArgs.endColumn = 0;\n            findPrevArgs.endRow = activecell[0];\n            findPrevArgs.rowIndex = findPrevArgs.startRow;\n            findPrevArgs.colIndex = findPrevArgs.startColumn;\n            findPrevArgs.loopCount++;\n            isTrue = false;\n        }\n        else if (((activecell[0] === sheet.usedRange.rowIndex && activecell[1] === sheet.usedRange.colIndex) ||\n            (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex)) &&\n            (activecell[0] !== 0 && activecell[1] !== 0)) {\n            this.parent.notify(showDialog, null);\n            isTrue = true;\n        }\n        return isTrue;\n    };\n    WorkbookFindAndReplace.prototype.prevCommon = function (findPrevArgs) {\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        if (sheet.rows[findPrevArgs.rowIndex]) {\n            var rowCol = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex];\n            if (rowCol && rowCol.value) {\n                var cellType = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex];\n                if (cellType) {\n                    var cellvalue = void 0;\n                    if (cellType.format) {\n                        var displayTxt = this.parent.getDisplayText(sheet.rows[findPrevArgs.rowIndex]\n                            .cells[findPrevArgs.colIndex]);\n                        cellvalue = displayTxt;\n                    }\n                    else {\n                        cellvalue = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex].value.toString();\n                    }\n                    if (findPrevArgs.args.isCSen && findPrevArgs.args.isEMatch) {\n                        if (cellvalue === findPrevArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (findPrevArgs.args.isCSen && !findPrevArgs.args.isEMatch) {\n                        var index = cellvalue.indexOf(findPrevArgs.args.value) > -1;\n                        if ((cellvalue === findPrevArgs.stringValue) || (index)) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findPrevArgs.args.isCSen && findPrevArgs.args.isEMatch) {\n                        findPrevArgs.val = cellvalue.toString().toLowerCase();\n                        if (findPrevArgs.val === findPrevArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findPrevArgs.args.isCSen && !findPrevArgs.args.isEMatch) {\n                        findPrevArgs.val = cellvalue.toString().toLowerCase();\n                        var index = findPrevArgs.val.indexOf(findPrevArgs.args.value.toString().toLowerCase()) > -1;\n                        var lowerCaseIndex = findPrevArgs.val.indexOf(findPrevArgs.args.value) > -1;\n                        if ((cellvalue === findPrevArgs.stringValue) || ((cellvalue === findPrevArgs.stringValue) ||\n                            (index)) || (findPrevArgs.val === findPrevArgs.stringValue) || (lowerCaseIndex)) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    WorkbookFindAndReplace.prototype.replace = function (args) {\n        if (this.parent.getActiveSheet().isProtected) {\n            this.parent.notify(workBookeditAlert, null);\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var activecell = getCellIndexes(sheet.activeCell);\n        var currentCell = sheet.rows[activecell[0]].cells[activecell[1]].value.toString();\n        var index = currentCell.indexOf(args.value) > -1;\n        var lowerCaseIndex = currentCell.toLowerCase().indexOf(args.value.toString().toLowerCase()) > -1;\n        var val = currentCell.toString().toLowerCase();\n        if ((currentCell !== args.value) && (!index) && (val !== args.value) && (!lowerCaseIndex)) {\n            args.findOpt = 'next';\n            this.findNext(args);\n        }\n        this.parent.getActiveSheet();\n        var activecel = getCellIndexes(sheet.activeCell);\n        var address = sheet.activeCell;\n        var cell = sheet.rows[activecel[0]].cells[activecel[1]];\n        var cellFormat = sheet.rows[activecel[0]].cells[activecel[1]].format;\n        var compareVal;\n        var replaceAddress = sheet.name + '!' + getCellAddress(activecel[0], activecel[1]);\n        if (cellFormat) {\n            var dispTxt = this.parent.getDisplayText(sheet.rows[activecel[0]].cells[activecel[1]]);\n            compareVal = dispTxt.toString();\n        }\n        else {\n            compareVal = sheet.rows[activecel[0]].cells[activecel[1]].value.toString();\n        }\n        var replaceAllCollection = { undoRedoOpt: 'before', address: replaceAddress, compareVal: compareVal };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        var lcValueOfCell = compareVal.toLowerCase();\n        var ivalueOfCell = compareVal.indexOf(args.value) > -1;\n        var caseInSensitive = lcValueOfCell.indexOf(args.value) > -1;\n        if ((args.value === compareVal) || (args.value === lcValueOfCell)) {\n            sheet.rows[activecel[0]].cells[activecel[1]].value = args.replaceValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_1 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_1);\n        }\n        else if (ivalueOfCell) {\n            var newValue = compareVal.replace(args.value, args.replaceValue);\n            sheet.rows[activecel[0]].cells[activecel[1]].value = newValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_2 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_2);\n        }\n        else if (caseInSensitive) {\n            var regx = new RegExp(args.value.toString().replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'ig');\n            var updateValue = compareVal.replace(regx, args.replaceValue);\n            sheet.rows[activecel[0]].cells[activecel[1]].value = updateValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_3 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_3);\n        }\n    };\n    WorkbookFindAndReplace.prototype.replaceAll = function (args) {\n        var startSheet = 0;\n        var sheet = this.parent.sheets[startSheet];\n        var endRow = sheet.usedRange.rowIndex;\n        var count = 0;\n        var undoRedoOpt = 'beforeReplaceAll';\n        var startRow = 0;\n        var endColumn = sheet.usedRange.colIndex;\n        var startColumn = 0;\n        var addressCollection = [];\n        var address;\n        for (startRow; startRow <= endRow; startRow++) {\n            if (startColumn > endColumn && startRow === endRow) {\n                if (args.mode === 'Workbook') {\n                    startSheet++;\n                    sheet = this.parent.sheets[startSheet];\n                    if (sheet) {\n                        startColumn = 0;\n                        startRow = 0;\n                        endColumn = sheet.usedRange.colIndex;\n                        endRow = sheet.usedRange.rowIndex;\n                    }\n                }\n            }\n            if (sheet) {\n                if (sheet.rows[startRow]) {\n                    var row = sheet.rows[startRow];\n                    if (startColumn === endColumn + 1) {\n                        startColumn = 0;\n                    }\n                    for (startColumn; startColumn <= endColumn; startColumn++) {\n                        var cell = sheet.rows[startRow].cells[startColumn];\n                        if (row) {\n                            if (row.cells && row.cells[startColumn] && row.cells[startColumn].value) {\n                                var cellType = sheet.rows[startRow].cells[startColumn];\n                                if (cellType) {\n                                    var cellTypeVal = cellType.format;\n                                    var cellval = void 0;\n                                    if (cellTypeVal) {\n                                        var displayTxt = this.parent.getDisplayText(sheet.rows[startRow].\n                                            cells[startColumn]);\n                                        cellval = displayTxt.toString();\n                                    }\n                                    else {\n                                        cellval = sheet.rows[startRow].cells[startColumn].value.toString();\n                                    }\n                                    if (args.isCSen && args.isEMatch) {\n                                        if (cellval === args.value) {\n                                            sheet.rows[startRow].cells[startColumn].value = args.replaceValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (args.isCSen && !args.isEMatch) {\n                                        var index = cellval.indexOf(args.value) > -1;\n                                        if ((cellval === args.value) || (index)) {\n                                            var newValue = cellval.replace(args.value, args.replaceValue);\n                                            sheet.rows[startRow].cells[startColumn].value = newValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!args.isCSen && args.isEMatch) {\n                                        var val = cellval.toString().toLowerCase();\n                                        if (val === args.value) {\n                                            sheet.rows[startRow].cells[startColumn].value = args.replaceValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!args.isCSen && !args.isEMatch) {\n                                        var val = cellval.toString().toLowerCase();\n                                        var index = val.indexOf(args.value.toString().toLowerCase()) > -1;\n                                        var lowerCaseValue = val.indexOf(args.value) > -1;\n                                        if (((cellval === args.value) || (index)) || (val === args.value) || (cellval === args.value) ||\n                                            (lowerCaseValue)) {\n                                            var regExepression = new RegExp(args.value.toString().replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'ig');\n                                            var newValue = cellval.replace(regExepression, args.replaceValue);\n                                            sheet.rows[startRow].cells[startColumn].value = newValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        var replaceAllCollection = {\n            undoRedoOpt: undoRedoOpt, Collection: addressCollection,\n            replaceValue: args.value\n        };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        replaceAllCollection = {\n            undoRedoOpt: 'afterReplaceAll', Collection: addressCollection,\n            replaceValue: args.replaceValue\n        };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        var countNumber = count;\n        this.parent.notify(replaceAllDialog, { count: countNumber, replaceValue: args.replaceValue });\n    };\n    WorkbookFindAndReplace.prototype.totalCount = function (args) {\n        var sheet = this.parent.sheets[args.sheetIndex];\n        var endRow = sheet.usedRange.rowIndex;\n        var count = 0;\n        var rowIndex = 0;\n        var endColumn = sheet.usedRange.colIndex;\n        var columnIndex = 0;\n        for (rowIndex; rowIndex <= endRow; rowIndex++) {\n            if (sheet.rows[rowIndex]) {\n                var row = sheet.rows[rowIndex];\n                if (columnIndex === endColumn + 1) {\n                    columnIndex = 0;\n                }\n                for (columnIndex; columnIndex <= endColumn; columnIndex++) {\n                    if (row) {\n                        if (row.cells && row.cells[columnIndex] && row.cells[columnIndex].value) {\n                            var cellType = sheet.rows[rowIndex].cells[columnIndex];\n                            if (cellType) {\n                                var cellFormat = cellType.format;\n                                var cellvalue = void 0;\n                                if (cellFormat) {\n                                    var displayTxt = this.parent.getDisplayText(sheet.rows[rowIndex].\n                                        cells[columnIndex]);\n                                    cellvalue = displayTxt.toString();\n                                }\n                                else {\n                                    cellvalue = cellType.value.toString();\n                                }\n                                if (args.isCSen && args.isEMatch) {\n                                    if (cellvalue === args.value) {\n                                        count++;\n                                    }\n                                }\n                                else if (args.isCSen && !args.isEMatch) {\n                                    var index = cellvalue.indexOf(args.value) > -1;\n                                    if ((cellvalue === args.value) || (index)) {\n                                        count++;\n                                    }\n                                }\n                                else if (!args.isCSen && args.isEMatch) {\n                                    var val = cellvalue.toString().toLowerCase();\n                                    if (val === args.value) {\n                                        count++;\n                                    }\n                                }\n                                else if (!args.isCSen && !args.isEMatch) {\n                                    var val = cellvalue.toString().toLowerCase();\n                                    var index = val.indexOf(args.value.toString().toLowerCase()) > -1;\n                                    var lowerCaseValue = val.indexOf(args.value) > -1;\n                                    if ((val === args.value) || ((cellvalue === args.value) || (index)) || (cellvalue === args.value) ||\n                                        (lowerCaseValue)) {\n                                        count++;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        var totalCount = count;\n        var requiredCount = this.requiredCount(args) - 1;\n        count = totalCount - requiredCount;\n        if (count > totalCount) {\n            count = totalCount;\n        }\n        if (count !== 0) {\n            var activecel = getCellIndexes(sheet.activeCell);\n            var val = sheet.rows[activecel[0]] ?\n                this.parent.getDisplayText(sheet.rows[activecel[0]].cells[activecel[1]]).toString().toLowerCase() : null;\n            if (val && val.indexOf(args.value.toString().toLowerCase()) === -1) {\n                count = count - 1;\n            }\n        }\n        args.findCount = count + ' ' + 'of' + ' ' + totalCount;\n        return;\n    };\n    WorkbookFindAndReplace.prototype.requiredCount = function (args) {\n        var sheetIndex = this.parent.activeSheetIndex;\n        var sheet = this.parent.sheets[sheetIndex];\n        var activecel = getCellIndexes(sheet.activeCell);\n        var endRow = sheet.usedRange.rowIndex;\n        var requiredCount = 0;\n        var startRow = activecel[0];\n        var endColumn = sheet.usedRange.colIndex;\n        var startColumn = activecel[1];\n        for (startRow; startRow <= endRow; startRow++) {\n            if (sheet.rows[startRow]) {\n                var row = sheet.rows[startRow];\n                if (startColumn === endColumn + 1) {\n                    startColumn = 0;\n                }\n                for (startColumn; startColumn <= endColumn; startColumn++) {\n                    if (row) {\n                        if (row.cells && row.cells[startColumn] && row.cells[startColumn].value) {\n                            if (sheet.rows[startRow].cells[startColumn]) {\n                                var cellval = void 0;\n                                if (sheet.rows[startRow].cells[startColumn].format) {\n                                    var displayTxt = this.parent.getDisplayText(sheet.rows[startRow].\n                                        cells[startColumn]);\n                                    cellval = displayTxt.toString();\n                                }\n                                else {\n                                    cellval = sheet.rows[startRow].cells[startColumn].value.toString();\n                                }\n                                if (args.isCSen && !args.isEMatch) {\n                                    var index = cellval.indexOf(args.value) > -1;\n                                    if ((cellval === args.value) || (index)) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (args.isCSen && args.isEMatch) {\n                                    if (cellval === args.value) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (!args.isCSen && args.isEMatch) {\n                                    var val = cellval.toString().toLowerCase();\n                                    if (val === args.value) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (!args.isCSen && !args.isEMatch) {\n                                    var val = cellval.toString().toLowerCase();\n                                    var argsVal = args.value.toString().toLowerCase();\n                                    var index = val.indexOf(argsVal) > -1;\n                                    var lowerCaseVal = val.indexOf(args.value) > -1;\n                                    if ((cellval === args.value) || ((val === argsVal) || (index)) || (val === args.value) ||\n                                        (lowerCaseVal)) {\n                                        requiredCount++;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return requiredCount;\n    };\n    WorkbookFindAndReplace.prototype.findAllValues = function (findAllArguments) {\n        var startSheet = findAllArguments.sheetIndex;\n        var sheet = this.parent.sheets[startSheet];\n        var endRow = sheet.usedRange.rowIndex;\n        var rowIndex = 0;\n        var count = 0;\n        var address;\n        var endColumn = sheet.usedRange.colIndex;\n        var columnIndex = 0;\n        var sheetLength = this.parent.sheets.length;\n        var initialSheet = findAllArguments.sheetIndex;\n        for (rowIndex; rowIndex <= endRow + 1; rowIndex++) {\n            if ((initialSheet !== 1) && (findAllArguments.sheetIndex === sheetLength)) {\n                startSheet = 1;\n            }\n            if (rowIndex > endRow && columnIndex > endColumn) {\n                if (findAllArguments.mode === 'Workbook') {\n                    startSheet++;\n                    if (initialSheet === startSheet) {\n                        if (count === 0) {\n                            return;\n                        }\n                        return;\n                    }\n                    if (startSheet > sheetLength - 1) {\n                        startSheet = 0;\n                    }\n                    sheet = this.parent.sheets[startSheet];\n                    if (sheet) {\n                        rowIndex = 0;\n                        columnIndex = 0;\n                        endColumn = sheet.usedRange.colIndex;\n                        endRow = sheet.usedRange.rowIndex;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(sheet)) {\n                if (sheet.rows[rowIndex]) {\n                    var row = sheet.rows[rowIndex];\n                    if (columnIndex === endColumn + 2) {\n                        columnIndex = 0;\n                    }\n                    for (columnIndex; columnIndex <= endColumn + 1; columnIndex++) {\n                        if (row) {\n                            if (row.cells && row.cells[columnIndex]) {\n                                var cell = sheet.rows[rowIndex].cells[columnIndex];\n                                if (cell) {\n                                    var cellFormat = cell.format;\n                                    var cellvalue = void 0;\n                                    if (cellFormat) {\n                                        var displayTxt = this.parent.getDisplayText(sheet.rows[rowIndex].\n                                            cells[columnIndex]);\n                                        cellvalue = displayTxt.toString();\n                                    }\n                                    else {\n                                        cellvalue = cell.value.toString();\n                                    }\n                                    if (findAllArguments.isCSen && findAllArguments.isEMatch) {\n                                        if (cellvalue === findAllArguments.value) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (findAllArguments.isCSen && !findAllArguments.isEMatch) {\n                                        var index = cellvalue.indexOf(findAllArguments.value) > -1;\n                                        if ((cellvalue === findAllArguments.value) || (index)) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!findAllArguments.isCSen && findAllArguments.isEMatch) {\n                                        var val = cellvalue.toString().toLowerCase();\n                                        if (val === findAllArguments.value) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!findAllArguments.isCSen && !findAllArguments.isEMatch) {\n                                        var val = cellvalue.toString().toLowerCase();\n                                        var index = val.indexOf(findAllArguments.value.toLowerCase()) > -1;\n                                        if ((val === findAllArguments.value) || ((cellvalue === findAllArguments.value) || (index)) ||\n                                            ((cellvalue === findAllArguments.value))) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (count === 0) {\n            return;\n        }\n        return;\n    };\n    /**\n     * Gets the module name.\n     *\n     * @returns {string} - Return the string\n     */\n    WorkbookFindAndReplace.prototype.getModuleName = function () {\n        return 'workbookfindAndReplace';\n    };\n    return WorkbookFindAndReplace;\n}());\nexport { WorkbookFindAndReplace };\n","import { setColumn } from '../base/index';\nimport { applyLockCells } from '../common/index';\nimport { protectsheetHandler, protectSheetWorkBook, updateToggle, setLockCells } from '../common/index';\nimport { unprotectsheetHandler } from '../common/index';\nimport { getRangeIndexes, getSwapRange } from '../common/index';\nimport { isUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookSpreadSheet` module is used to handle the Protecting functionalities in Workbook.\n */\nvar WorkbookProtectSheet = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Workbook.\n     *\n     * @param {Workbook} workbook - Specifies the workbook.\n     * @private\n     */\n    function WorkbookProtectSheet(workbook) {\n        this.parent = workbook;\n        this.addEventListener();\n    }\n    WorkbookProtectSheet.prototype.protectsheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        this.parent.setSheetPropertyOnMute(sheet, 'protectSettings', {\n            selectCells: args.selectCells, formatCells: args.formatCells,\n            formatColumns: args.formatColumns, formatRows: args.formatRows, insertLink: args.insertLink\n        });\n        this.parent.notify(protectSheetWorkBook, sheet.protectSettings);\n        this.parent.notify(updateToggle, { props: 'Protect' });\n        sheet.columns.forEach(function (column) {\n            if (column && isUndefined(column.isLocked)) {\n                column.isLocked = true;\n            }\n        });\n    };\n    WorkbookProtectSheet.prototype.unprotectsheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (args.sheet) {\n            sheet = this.parent.sheets[args.sheet];\n        }\n        sheet.protectSettings.formatCells = sheet.protectSettings.formatColumns = false;\n        sheet.protectSettings.formatRows = sheet.protectSettings.selectCells = false;\n        this.parent.setSheetPropertyOnMute(sheet, 'isProtected', false);\n        this.parent.notify(protectSheetWorkBook, sheet.protectSettings);\n        this.parent.notify(updateToggle, { props: 'Protect' });\n    };\n    /**\n     * To destroy the edit module.\n     *\n     * @returns {void} - To destroy the edit module.\n     * @hidden\n     */\n    WorkbookProtectSheet.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookProtectSheet.prototype.addEventListener = function () {\n        this.parent.on(protectsheetHandler, this.protectsheetHandler, this);\n        this.parent.on(unprotectsheetHandler, this.unprotectsheetHandler, this);\n        this.parent.on(setLockCells, this.lockCells, this);\n    };\n    WorkbookProtectSheet.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(protectsheetHandler, this.protectsheetHandler);\n            this.parent.off(setLockCells, this.lockCells);\n            this.parent.off(protectsheetHandler, this.unprotectsheetHandler);\n        }\n    };\n    WorkbookProtectSheet.prototype.lockCells = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var range;\n        if (args) {\n            range = args.range;\n        }\n        else {\n            range = sheet.selectedRange;\n        }\n        var indexes = typeof (range) === 'object' ? range :\n            getSwapRange(getRangeIndexes(range));\n        if (indexes[0] === 0 && indexes[2] === sheet.rowCount - 1) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                setColumn(sheet, i, { isLocked: args.isLocked });\n            }\n        }\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (this.parent.getActiveSheet().id === sheet.id) {\n                    this.parent.notify(applyLockCells, { rowIdx: i, colIdx: j, isLocked: args.isLocked\n                    });\n                }\n            }\n        }\n    };\n    /**\n     * Get the module name.\n     *\n     * @returns {string} - Return the string.\n     * @private\n     */\n    WorkbookProtectSheet.prototype.getModuleName = function () {\n        return 'workbookProtectSheet';\n    };\n    return WorkbookProtectSheet;\n}());\nexport { WorkbookProtectSheet };\n","import { getCell, setCell } from '../base/index';\nimport { setMerge, getSwapRange, getRangeIndexes, mergedRange, applyMerge, activeCellMergedRange } from './../common/index';\nimport { insertMerge, activeCellChanged, pasteMerge, getCellIndexes, checkIsFormula } from './../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookMerge` module is used to merge the range of cells.\n */\nvar WorkbookMerge = /** @class */ (function () {\n    /**\n     * Constructor for the workbook merge module.\n     *\n     * @param {Workbook} parent - Specifies the workbook.\n     * @private\n     */\n    function WorkbookMerge(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookMerge.prototype.merge = function (args) {\n        if (args.isAction) {\n            this.parent.notify('actionBegin', { eventArgs: args, action: 'merge' });\n            if (!args.model) {\n                args.model = [];\n            }\n        }\n        if (typeof (args.range) === 'string') {\n            args.range = getRangeIndexes(args.range);\n        }\n        args.range = getSwapRange(args.range);\n        if (!args.skipChecking) {\n            this.mergedRange(args);\n        }\n        if (!args.merge || args.type === 'All') {\n            this.mergeAll(args);\n            if (args.refreshRibbon) {\n                this.parent.notify(activeCellChanged, null);\n            }\n        }\n        else if (args.type === 'Horizontally') {\n            this.mergeHorizontally(args);\n        }\n        else if (args.type === 'Vertically') {\n            this.mergeVertically(args);\n        }\n        this.parent.setUsedRange(args.range[2], args.range[3]);\n        if (args.isAction) {\n            this.parent.notify('actionComplete', { eventArgs: args, action: 'merge' });\n        }\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        if (this.parent.sheets.indexOf(sheet) === this.parent.activeSheetIndex) {\n            this.parent.notify('selectRange', { address: sheet.selectedRange, skipChecking: true });\n        }\n    };\n    WorkbookMerge.prototype.mergeAll = function (args) {\n        var rowSpan = 0;\n        var cell;\n        args.range = args.range;\n        var colSpan;\n        var value;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var curCell;\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            colSpan = 0;\n            if (args.isAction) {\n                args.model.push({ cells: [] });\n            }\n            for (var j = args.range[1]; j <= args.range[3]; j++) {\n                cell = getCell(i, j, sheet);\n                if (cell && (cell.value || cell.formula) && !value) {\n                    value = cell.formula || cell.value;\n                }\n                if (args.isAction && args.merge) {\n                    args.model[i - args.range[0]].cells[j - args.range[1]] = {};\n                    Object.assign(args.model[i - args.range[0]].cells[j - args.range[1]], cell);\n                }\n                if (sheet.rows[i] && sheet.rows[i].cells && sheet.rows[i].cells[j]) {\n                    delete sheet.rows[i].cells[j].rowSpan;\n                    delete sheet.rows[i].cells[j].colSpan;\n                    if (!args.merge && !args.isAction && args.model && args.model[i - args.range[0]] && args.model[i - args.range[0]].\n                        cells[j - args.range[1]] && args.model[i - args.range[0]].cells[j - args.range[1]] !== {}) {\n                        setCell(i, j, sheet, args.model[i - args.range[0]].cells[j - args.range[1]]);\n                    }\n                }\n                if (args.merge) {\n                    cell = new Object();\n                    if (i === args.range[0] && j === args.range[1]) {\n                        if (args.range[3] - args.range[1] > 0) {\n                            cell.colSpan = (args.range[3] - args.range[1]) + 1;\n                        }\n                        if (args.range[2] - args.range[0] > 0) {\n                            cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n                        }\n                        setCell(args.range[0], args.range[1], sheet, cell, true);\n                        continue;\n                    }\n                    else {\n                        if (i !== args.range[0]) {\n                            cell.rowSpan = -rowSpan;\n                        }\n                        if (j !== args.range[1]) {\n                            colSpan++;\n                            cell.colSpan = -colSpan;\n                        }\n                        if (sheet.rows[i] && sheet.rows[i].cells && sheet.rows[i].cells[j]) {\n                            delete sheet.rows[i].cells[j].value;\n                            delete sheet.rows[i].cells[j].formula;\n                        }\n                        curCell = getCell(i, j, sheet) || {};\n                        setCell(i, j, sheet, Object.assign(cell, curCell));\n                    }\n                }\n                if (!args.preventRefresh) {\n                    this.parent.notify(applyMerge, { rowIdx: i, colIdx: j });\n                }\n            }\n            rowSpan++;\n        }\n        if (args.merge) {\n            cell = this.getCellValue(args.range[0], args.range[1], value, sheet);\n            setCell(args.range[0], args.range[1], sheet, cell, true);\n            if (!args.preventRefresh) {\n                this.parent.notify(applyMerge, { rowIdx: args.range[0], colIdx: args.range[1] });\n            }\n        }\n    };\n    WorkbookMerge.prototype.mergeHorizontally = function (args) {\n        var mergeCount;\n        args.range = args.range;\n        var cell;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var newValue;\n        var rowIdx;\n        var curCell;\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            mergeCount = 0;\n            if (args.isAction) {\n                args.model.push({ cells: [] });\n            }\n            for (var j = args.range[1]; j <= args.range[3]; j++) {\n                curCell = getCell(i, j, sheet);\n                cell = new Object();\n                if (args.isAction) {\n                    args.model[i - args.range[0]].cells[j - args.range[1]] = {};\n                    Object.assign(args.model[i - args.range[0]].cells[j - args.range[1]], curCell);\n                }\n                if (j === args.range[1]) {\n                    if (i === args.range[0]) {\n                        continue;\n                    }\n                    rowIdx = i - 1;\n                    if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[j]) {\n                        delete sheet.rows[rowIdx].cells[j].rowSpan;\n                    }\n                    cell = this.getCellValue(rowIdx, j, newValue, sheet);\n                    if (args.range[3] - args.range[1] > 0) {\n                        cell.colSpan = (args.range[3] - args.range[1]) + 1;\n                    }\n                    newValue = null;\n                    setCell(rowIdx, j, sheet, cell, true);\n                }\n                else {\n                    if (curCell && (curCell.value || curCell.formula) && !newValue) {\n                        newValue = curCell.formula || curCell.value;\n                    }\n                    rowIdx = i;\n                    if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[j]) {\n                        delete sheet.rows[rowIdx].cells[j].rowSpan;\n                        delete sheet.rows[rowIdx].cells[j].value;\n                        delete sheet.rows[rowIdx].cells[j].formula;\n                    }\n                    mergeCount++;\n                    cell.colSpan = -mergeCount;\n                    setCell(rowIdx, j, sheet, cell, true);\n                }\n                this.parent.notify(applyMerge, { rowIdx: rowIdx, colIdx: j });\n            }\n        }\n        if (sheet.rows[args.range[2]] && sheet.rows[args.range[2]].cells && sheet.rows[args.range[2]].cells[args.range[1]]) {\n            delete sheet.rows[args.range[2]].cells[args.range[1]].rowSpan;\n        }\n        cell = this.getCellValue(args.range[2], args.range[1], newValue, sheet);\n        if (args.range[3] - args.range[1] > 0) {\n            cell.colSpan = (args.range[3] - args.range[1]) + 1;\n        }\n        setCell(args.range[2], args.range[1], sheet, cell, true);\n        this.parent.notify(applyMerge, { rowIdx: args.range[2], colIdx: args.range[1] });\n    };\n    WorkbookMerge.prototype.getCellValue = function (rowIdx, colIdx, value, sheet) {\n        var cell = new Object();\n        var curCell = getCell(rowIdx, colIdx, sheet);\n        if (value && (!curCell || (!curCell.value && !curCell.formula))) {\n            if (checkIsFormula(value)) {\n                cell.formula = value;\n            }\n            else {\n                cell.value = value;\n            }\n        }\n        return cell;\n    };\n    WorkbookMerge.prototype.mergeVertically = function (args) {\n        var rowSpan = 0;\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell;\n        var newValue;\n        var colIdx;\n        var curCell;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            for (var j = args.range[0]; j <= args.range[2]; j++) {\n                curCell = getCell(j, i, sheet);\n                if (args.isAction) {\n                    if (args.model[j - args.range[0]] === undefined) {\n                        args.model[j - args.range[0]] = { cells: [] };\n                    }\n                    args.model[j - args.range[0]].cells[i - args.range[1]] = {};\n                    Object.assign(args.model[j - args.range[0]].cells[i - args.range[1]], curCell);\n                }\n                if (j === args.range[0]) {\n                    rowSpan = 0;\n                    if (i === args.range[1]) {\n                        continue;\n                    }\n                    colIdx = i - 1;\n                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[colIdx]) {\n                        delete sheet.rows[j].cells[colIdx].colSpan;\n                    }\n                    cell = this.getCellValue(j, colIdx, newValue, sheet);\n                    if (args.range[2] - args.range[0] > 0) {\n                        cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n                    }\n                    newValue = null;\n                    setCell(j, colIdx, sheet, cell, true);\n                }\n                else {\n                    cell = new Object();\n                    if (curCell && (curCell.value || curCell.formula) && !newValue) {\n                        newValue = curCell.formula || curCell.value;\n                    }\n                    rowSpan++;\n                    colIdx = i;\n                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[colIdx]) {\n                        delete sheet.rows[j].cells[colIdx].colSpan;\n                        delete sheet.rows[j].cells[colIdx].value;\n                        delete sheet.rows[j].cells[colIdx].formula;\n                    }\n                    cell.rowSpan = -rowSpan;\n                    setCell(j, colIdx, sheet, cell, true);\n                }\n                this.parent.notify(applyMerge, { rowIdx: j, colIdx: colIdx });\n            }\n        }\n        if (sheet.rows[args.range[0]] && sheet.rows[args.range[0]].cells && sheet.rows[args.range[0]].cells[args.range[3]]) {\n            delete sheet.rows[args.range[0]].cells[args.range[3]].colSpan;\n        }\n        cell = this.getCellValue(args.range[0], args.range[1], newValue, sheet);\n        if (args.range[2] - args.range[0] > 0) {\n            cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n        }\n        setCell(args.range[0], args.range[3], sheet, cell, true);\n        this.parent.notify(applyMerge, { rowIdx: args.range[0], colIdx: args.range[3] });\n    };\n    WorkbookMerge.prototype.activeCellRange = function (args) {\n        args.range = args.range;\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                args.range[0] += cell.rowSpan;\n                if (args.insertCount) {\n                    args.range[0] -= args.insertCount;\n                }\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                args.range[1] += cell.colSpan;\n                if (args.insertCount) {\n                    args.range[1] -= args.insertCount;\n                }\n            }\n            cell = getCell(args.range[0], args.range[1], sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && (args.range[0] + (cell.rowSpan - 1) >= args.range[2] || args.insertCount)) {\n                    args.range[2] = args.range[0] + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && (args.range[1] + (cell.colSpan - 1) >= args.range[3] || args.insertCount)) {\n                    args.range[3] = args.range[1] + (cell.colSpan - 1);\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.mergedRange = function (args) {\n        if (typeof (args.range) === 'string') {\n            args.range = getRangeIndexes(args.range);\n        }\n        if (args.range[0] <= args.range[2] && args.range[1] <= args.range[3]) {\n            this.forward(args);\n        }\n        else if (args.range[0] >= args.range[2] && args.range[1] >= args.range[3]) {\n            this.reverse(args);\n        }\n        else if (args.range[0] < args.range[2] && args.range[1] > args.range[3]) {\n            this.forwardReverse(args);\n        }\n        else if (args.range[0] > args.range[2] && args.range[1] < args.range[3]) {\n            this.reverseForward(args);\n        }\n    };\n    WorkbookMerge.prototype.forward = function (args) {\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var endRowIdx;\n        var endColIdx;\n        var rowIdx = endRowIdx = args.range[0];\n        var colIdx = endColIdx = args.range[1];\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIdx = endRowIdx = args.range[0] + cell.rowSpan;\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colIdx = endColIdx = args.range[1] + cell.colSpan;\n            }\n            cell = getCell(rowIdx, colIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1) {\n                    endRowIdx += (cell.rowSpan - 1);\n                    if (rowIdx + (cell.rowSpan - 1) >= args.range[2]) {\n                        args.range[2] = args.range[0];\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n                if (cell.colSpan > 1) {\n                    endColIdx += (cell.colSpan - 1);\n                    if (colIdx + (cell.colSpan - 1) >= args.range[3]) {\n                        args.range[3] = args.range[1];\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        args.range[0] = rowIdx;\n        args.range[1] = colIdx;\n        if (args.range[0] === rowIdx && args.range[1] === colIdx && args.range[2] === endRowIdx && args.range[3] === endColIdx) {\n            args.isActiveCell = true;\n        }\n        if (args.skipChecking) {\n            return;\n        }\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                rowIdx = args.range[2];\n                colIdx = i;\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[1]) {\n                        args.range[1] = colIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = colIdx;\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx;\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var startRowIdx;\n        var startColIdx;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                startColIdx = i;\n                startRowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    startColIdx += cell.colSpan;\n                    if (startColIdx < args.range[1]) {\n                        args.range[1] = startColIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIdx += cell.rowSpan;\n                    if (startRowIdx < args.range[0]) {\n                        args.range[0] = startRowIdx;\n                    }\n                }\n            }\n        }\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rowIdx = i;\n                colIdx = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[1]) {\n                        args.range[1] = colIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx;\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = colIdx;\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.forwardReverse = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        args.range = args.range;\n        var colIndex = args.range[1];\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var rowIndex = args.range[0];\n        if (cell) {\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colIndex += cell.colSpan;\n                if (args.range[3] >= colIndex) {\n                    args.range[3] = colIndex;\n                }\n            }\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIndex += cell.rowSpan;\n                if (rowIndex < args.range[0]) {\n                    args.range[0] = rowIndex;\n                }\n            }\n            cell = getCell(rowIndex, colIndex, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rowIndex + (cell.rowSpan - 1) >= args.range[2]) {\n                    args.range[2] = rowIndex + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && colIndex + (cell.colSpan - 1) >= args.range[1]) {\n                    args.range[1] = colIndex + (cell.colSpan - 1);\n                }\n            }\n        }\n        args.range[0] = rowIndex;\n        if (args.skipChecking) {\n            return;\n        }\n        var rowIdx;\n        var cellIdx;\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                cellIdx = i;\n                rowIdx = args.range[2];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIdx += cell.colSpan;\n                    if (cellIdx < args.range[3]) {\n                        args.range[3] = cellIdx;\n                    }\n                }\n                cell = getCell(rowIdx, cellIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        var startRowIndex;\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                cellIdx = i;\n                startRowIndex = args.range[0];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIndex += cell.rowSpan;\n                    if (startRowIndex < args.range[0]) {\n                        args.range[0] = startRowIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIdx += cell.colSpan;\n                }\n                cell = getCell(startRowIndex, cellIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && startRowIndex + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = startRowIndex + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIdx;\n                        args.range[1] = cellIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        var colIdx;\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                startRowIndex = i;\n                colIdx = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIndex += cell.rowSpan;\n                    if (startRowIndex < args.range[0]) {\n                        args.range[0] = startRowIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[3]) {\n                        args.range[3] = colIdx;\n                    }\n                }\n                cell = getCell(startRowIndex, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && startRowIndex + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = startRowIndex;\n                        args.range[2] = startRowIndex + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.reverse = function (args) {\n        args.range = args.range;\n        var colnIdx = args.range[1];\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var rowIdx = args.range[0];\n        if (cell) {\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colnIdx += cell.colSpan;\n            }\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIdx += cell.rowSpan;\n            }\n            if (args.range[2] >= rowIdx) {\n                args.range[2] = rowIdx;\n                args.isActiveCell = true;\n            }\n            if (args.range[3] >= colnIdx) {\n                args.range[3] = colnIdx;\n                if (args.range[2] === rowIdx) {\n                    args.isActiveCell = true;\n                }\n            }\n            else if (args.isActiveCell) {\n                args.isActiveCell = false;\n            }\n            cell = getCell(rowIdx, colnIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) >= args.range[0]) {\n                    args.range[0] = rowIdx;\n                    args.range[0] = rowIdx + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && colnIdx + (cell.colSpan - 1) >= args.range[1]) {\n                    args.range[1] = colnIdx;\n                    args.range[1] = colnIdx + (cell.colSpan - 1);\n                }\n            }\n        }\n        var colIdx = args.range[3];\n        if (args.skipChecking) {\n            return;\n        }\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                colIdx = i;\n                rowIdx = args.range[2];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[2]) {\n                        args.range[2] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[3]) {\n                        args.range[3] = colIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rowIdx;\n                        args.range[0] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        colIdx = args.range[3];\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                colIdx = i;\n                rowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rowIdx;\n                        args.range[0] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var cellIndex;\n        var rIdx;\n        for (var i = args.range[2]; i <= args.range[0]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rIdx = i;\n                cellIndex = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIdx += cell.rowSpan;\n                    if (rIdx < args.range[2]) {\n                        args.range[2] = rIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIndex += cell.colSpan;\n                    if (cellIndex < args.range[3]) {\n                        args.range[3] = cellIndex;\n                    }\n                }\n                cell = getCell(rIdx, cellIndex, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rIdx;\n                        args.range[0] = rIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIndex + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIndex;\n                        args.range[1] = cellIndex + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.reverseForward = function (args) {\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var rIdx = args.range[0];\n        var cIdx = args.range[1];\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rIdx += cell.rowSpan;\n                if (args.range[2] >= rIdx) {\n                    args.range[2] = rIdx;\n                }\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                cIdx += cell.colSpan;\n            }\n            cell = getCell(rIdx, cIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rIdx + (cell.rowSpan - 1) >= args.range[0]) {\n                    args.range[0] = rIdx;\n                    args.range[0] = rIdx + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && cIdx + (cell.colSpan - 1) >= args.range[3]) {\n                    args.range[3] = args.range[1];\n                    args.range[3] = cIdx + (cell.colSpan - 1);\n                }\n            }\n        }\n        if (args.skipChecking) {\n            return;\n        }\n        var cIndex = args.range[3];\n        var rIndex;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                rIndex = args.range[2];\n                cIndex = i;\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIndex += cell.rowSpan;\n                    if (rIndex < args.range[2]) {\n                        args.range[2] = rIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cIndex += cell.colSpan;\n                    if (cIndex < args.range[1]) {\n                        args.range[1] = cIndex;\n                    }\n                }\n                cell = getCell(rIndex, cIndex, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && cIndex + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = cIndex + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && (cell.rowSpan - 1) + rIndex > args.range[0]) {\n                        args.range[0] = (cell.rowSpan - 1) + rIndex;\n                    }\n                }\n            }\n        }\n        var sRowIdx;\n        var sColIdx;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                sColIdx = i;\n                sRowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    sColIdx += cell.colSpan;\n                    if (sColIdx < args.range[1]) {\n                        args.range[1] = sColIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    sRowIdx += cell.rowSpan;\n                }\n                cell = getCell(sRowIdx, sColIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && sRowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = sRowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var cellIndex;\n        for (var i = args.range[2]; i <= args.range[0]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rIndex = i;\n                cellIndex = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIndex += cell.rowSpan;\n                    if (rIndex < args.range[2]) {\n                        args.range[2] = rIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIndex += cell.colSpan;\n                    if (cellIndex < args.range[1]) {\n                        args.range[1] = cellIndex;\n                    }\n                }\n                cell = getCell(rIndex, cellIndex, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && (cell.rowSpan - 1) + rIndex > args.range[0]) {\n                        args.range[0] = (cell.rowSpan - 1) + rIndex;\n                    }\n                    if (cell.colSpan > 1 && (cell.colSpan - 1) + cellIndex > args.range[3]) {\n                        args.range[3] = cellIndex;\n                        args.range[3] = (cell.colSpan - 1) + cellIndex;\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.insertHandler = function (args) {\n        this.activeCellRange(args);\n        args.range = args.range;\n        if (args.insertModel === 'Row') {\n            args.range[2] += args.insertCount;\n        }\n        else {\n            args.range[3] += args.insertCount;\n        }\n        args.preventRefresh = true;\n        args.merge = true;\n        this.mergeAll(args);\n    };\n    WorkbookMerge.prototype.pasteHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var nextCell;\n        var prevCell;\n        var activeCell = getCellIndexes(sheet.activeCell);\n        for (var i = args.range[0], l = 0; i <= args.range[2]; i++, l++) {\n            for (var j = args.range[1], k = 0; j <= args.range[3]; j++, k++) {\n                cell = getCell(i, j, args.prevSheet) || {};\n                if (cell.rowSpan > 1) {\n                    prevCell = getCell(activeCell[0] + (cell.rowSpan - 1), activeCell[1], sheet) || {};\n                    nextCell = getCell(activeCell[0] + 1, activeCell[1], sheet) || {};\n                    if ((prevCell.colSpan !== undefined && prevCell.colSpan < 0) || (nextCell.colSpan !== undefined &&\n                        nextCell.colSpan < 0)) {\n                        args.cancel = true;\n                        this.parent.notify(applyMerge, { showDialog: true });\n                        return;\n                    }\n                }\n                if (cell.colSpan > 1) {\n                    prevCell = getCell(activeCell[0], activeCell[1] + (cell.colSpan - 1), sheet) || {};\n                    nextCell = getCell(activeCell[0], activeCell[1] + 1, sheet) || {};\n                    if ((prevCell.rowSpan !== undefined && prevCell.rowSpan < 0) || (nextCell.rowSpan !== undefined &&\n                        nextCell.rowSpan < 0)) {\n                        args.cancel = true;\n                        this.parent.notify(applyMerge, { showDialog: true });\n                        return;\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.addEventListener = function () {\n        this.parent.on(setMerge, this.merge, this);\n        this.parent.on(mergedRange, this.mergedRange, this);\n        this.parent.on(activeCellMergedRange, this.activeCellRange, this);\n        this.parent.on(insertMerge, this.insertHandler, this);\n        this.parent.on(pasteMerge, this.pasteHandler, this);\n    };\n    /**\n     * Destroy workbook merge module.\n     *\n     * @returns {void} - destroy the workbook merge module.\n     */\n    WorkbookMerge.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookMerge.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setMerge, this.merge);\n            this.parent.off(mergedRange, this.mergedRange);\n            this.parent.off(activeCellMergedRange, this.activeCellRange);\n            this.parent.off(insertMerge, this.insertHandler);\n            this.parent.off(pasteMerge, this.pasteHandler);\n        }\n    };\n    /**\n     * Get the workbook merge module name.\n     *\n     * @returns {string} - Return the string.\n     */\n    WorkbookMerge.prototype.getModuleName = function () {\n        return 'workbookmerge';\n    };\n    return WorkbookMerge;\n}());\nexport { WorkbookMerge };\n","import { setCell, setRow, getSheet } from '../base/index';\nimport { setCFRule, clearCFRule, getRangeAddress, applyCellFormat, getSwapRange } from '../common/index';\nimport { getRangeIndexes } from '../common/index';\nimport { cFInitialCheck, clearCF, addHighlight, cFUndo, goto } from '../common/index';\nimport { completeAction } from '../../spreadsheet/common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookConditionalFormat` module is used to handle conditional formatting action in Spreadsheet.\n */\nvar WorkbookConditionalFormat = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookConditionalFormat module.\n     *\n     * @param {Workbook} parent - Specifies the parent element.\n     */\n    function WorkbookConditionalFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the conditional format module.\n     *\n     * @returns {void}\n     */\n    WorkbookConditionalFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookConditionalFormat.prototype.addEventListener = function () {\n        this.parent.on(setCFRule, this.setCFrulHandler, this);\n        this.parent.on(clearCFRule, this.clearRules, this);\n        this.parent.on(cFUndo, this.cFUndoHandler, this);\n    };\n    WorkbookConditionalFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setCFRule, this.setCFrulHandler);\n            this.parent.off(clearCFRule, this.clearRules);\n            this.parent.off(cFUndo, this.cFUndoHandler);\n        }\n    };\n    WorkbookConditionalFormat.prototype.setCFrulHandler = function (args) {\n        var conditionalFormat = args.conditionalFormat;\n        var range = conditionalFormat.range;\n        var sheetIndex = args.isUndoRedo ? args.sheetIdx : this.parent.getAddressInfo(range).sheetIndex;\n        var sheet = getSheet(this.parent, sheetIndex);\n        range = range || sheet.selectedRange;\n        var indexes = getSwapRange(getRangeIndexes(range));\n        conditionalFormat.range = getRangeAddress(indexes);\n        if (!sheet.conditionalFormats) {\n            this.parent.setSheetPropertyOnMute(sheet, 'conditionalFormats', []);\n        }\n        var cfrCount = sheet.conditionalFormats.length;\n        sheet.conditionalFormats[cfrCount] = conditionalFormat;\n        if (args.isUndoRedo && sheetIndex !== this.parent.activeSheetIndex) {\n            this.parent.notify(goto, { address: sheet.name + '!' + conditionalFormat.range });\n            return;\n        }\n        for (var rIdx = indexes[0]; rIdx <= indexes[2]; rIdx++) {\n            if (!sheet.rows[rIdx]) {\n                setRow(sheet, rIdx, {});\n            }\n            for (var cIdx = indexes[1]; cIdx <= indexes[3]; cIdx++) {\n                if (!sheet.rows[rIdx].cells || !sheet.rows[rIdx].cells[cIdx]) {\n                    setCell(rIdx, cIdx, sheet, {});\n                }\n                if (sheetIndex === this.parent.activeSheetIndex) {\n                    var cell = sheet.rows[rIdx].cells[cIdx];\n                    this.parent.notify(cFInitialCheck, { rowIdx: rIdx, colIdx: cIdx, cell: cell, conditionalFormat: conditionalFormat, isAction: args.isAction });\n                }\n            }\n        }\n    };\n    WorkbookConditionalFormat.prototype.clearRules = function (args) {\n        var isPublic = isNullOrUndefined(args.isPublic) ? true : false;\n        var cFormats = [];\n        var oldRange = [];\n        var isFirst = true;\n        var top;\n        var bottom;\n        var left;\n        var right;\n        var frontColIdx;\n        var backColIdx;\n        var topRowIdx;\n        var bottomRowIdx;\n        var range = args.range;\n        var sheetIndex = args.isUndoRedo ? args.sheetIdx : this.parent.getAddressInfo(range).sheetIndex;\n        var sheet = getSheet(this.parent, sheetIndex);\n        var cFRules = sheet.conditionalFormats;\n        var rangeIndexes = getRangeIndexes(range);\n        if (sheetIndex === this.parent.activeSheetIndex) {\n            for (var rIdx = rangeIndexes[0]; rIdx <= rangeIndexes[2]; rIdx++) {\n                for (var cIdx = rangeIndexes[1]; cIdx <= rangeIndexes[3]; cIdx++) {\n                    this.parent.notify(clearCF, { rIdx: rIdx, cIdx: cIdx });\n                }\n            }\n        }\n        if (!cFRules) {\n            return;\n        }\n        for (var cFRulesIdx = cFRules.length - 1; cFRulesIdx >= 0; cFRulesIdx--) {\n            var isPresent = false;\n            var result = '';\n            var cFRule = cFRules[cFRulesIdx];\n            var cFRanges = cFRule.range.split(',');\n            if (sheetIndex === this.parent.activeSheetIndex && (args.isClearCF || !args.isUndoRedo)) {\n                for (var cFRangeIdx = 0; cFRangeIdx < cFRanges.length; cFRangeIdx++) {\n                    var isFull = false;\n                    var cFRange = cFRanges[cFRangeIdx];\n                    var cFRangeIndexes = getRangeIndexes(cFRange);\n                    topRowIdx = cFRangeIndexes[0];\n                    bottomRowIdx = cFRangeIndexes[0];\n                    frontColIdx = cFRangeIndexes[1];\n                    backColIdx = cFRangeIndexes[1];\n                    if (cFRangeIndexes[0] >= rangeIndexes[0] && cFRangeIndexes[2] <= rangeIndexes[2] &&\n                        cFRangeIndexes[1] >= rangeIndexes[1] && cFRangeIndexes[3] <= rangeIndexes[3]) {\n                        isFull = true;\n                    }\n                    for (var cFRRowIdx = cFRangeIndexes[0]; cFRRowIdx <= cFRangeIndexes[2]; cFRRowIdx++) {\n                        var isTrue = 0;\n                        for (var cFRColIdx = cFRangeIndexes[1]; cFRColIdx <= cFRangeIndexes[3]; cFRColIdx++) {\n                            for (var rRowIdx = rangeIndexes[0]; rRowIdx <= rangeIndexes[2]; rRowIdx++) {\n                                for (var rColIdx = rangeIndexes[1]; rColIdx <= rangeIndexes[3]; rColIdx++) {\n                                    if (rRowIdx === cFRRowIdx && rColIdx === cFRColIdx) {\n                                        var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rRowIdx, rColIdx]);\n                                        this.parent.notify(applyCellFormat, {\n                                            style: style, rowIdx: rRowIdx, colIdx: rColIdx,\n                                            lastCell: true, isHeightCheckNeeded: true, manualUpdate: true\n                                        });\n                                        isTrue = isTrue + 1;\n                                        isPresent = true;\n                                        if (rRowIdx === cFRangeIndexes[0]) {\n                                            if (rColIdx === cFRangeIndexes[3]) {\n                                                if (frontColIdx === cFRangeIndexes[1]) {\n                                                    if (backColIdx === rColIdx) {\n                                                        backColIdx = rColIdx;\n                                                    }\n                                                    else {\n                                                        frontColIdx = rColIdx - 1;\n                                                    }\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx + 1 === rColIdx) {\n                                                    backColIdx = cFRangeIndexes[1];\n                                                    frontColIdx = frontColIdx - 1;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                            }\n                                            else if (rColIdx === cFRangeIndexes[1]) {\n                                                if (backColIdx === cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                            else {\n                                                if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (frontColIdx === cFRangeIndexes[1] && backColIdx !== cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                                else {\n                                                    backColIdx = rColIdx;\n                                                }\n                                            }\n                                        }\n                                        else {\n                                            if (rColIdx === cFRangeIndexes[1]) {\n                                                if (backColIdx === cFRangeIndexes[1] && cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                            else if (rColIdx === cFRangeIndexes[3]) {\n                                                if (frontColIdx === cFRangeIndexes[1]) {\n                                                    if (backColIdx === rColIdx) {\n                                                        backColIdx = rColIdx;\n                                                    }\n                                                    else {\n                                                        frontColIdx = rColIdx - 1;\n                                                    }\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx + 1 === rColIdx) {\n                                                    backColIdx = cFRangeIndexes[1];\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                                else {\n                                                    bottomRowIdx = rRowIdx;\n                                                }\n                                            }\n                                            else {\n                                                if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                }\n                                                else {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                        if (isTrue > 0 && !isFull) {\n                            if (isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx;\n                                left = frontColIdx;\n                                right = backColIdx;\n                            }\n                            if (frontColIdx === cFRangeIndexes[1] && backColIdx !== cFRangeIndexes[1]) {\n                                if (backColIdx === cFRangeIndexes[3]) {\n                                    if (topRowIdx !== cFRRowIdx) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, left, bottom, cFRangeIndexes[3]]);\n                                    }\n                                    if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[3]) {\n                                        if (cFRRowIdx === cFRangeIndexes[2]) {\n                                            if (cFRangeIndexes[1] === rangeIndexes[3]) {\n                                                result = result + ' ' + getRangeAddress([cFRRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                            }\n                                        }\n                                        else {\n                                            if (rangeIndexes[2] === cFRangeIndexes[0] && backColIdx !== cFRangeIndexes[3]) {\n                                                result = result + ' ' + getRangeAddress([cFRRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                            }\n                                            topRowIdx = cFRRowIdx + 1;\n                                            bottomRowIdx = cFRRowIdx + 1;\n                                            backColIdx = cFRangeIndexes[1];\n                                        }\n                                    }\n                                }\n                                else if (right !== backColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, right, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    if (backColIdx === cFRangeIndexes[3] && frontColIdx === cFRangeIndexes[1]) {\n                                        topRowIdx = cFRRowIdx + 1;\n                                        bottomRowIdx = cFRRowIdx + 1;\n                                        backColIdx = cFRangeIndexes[1];\n                                    }\n                                    else {\n                                        topRowIdx = cFRRowIdx;\n                                        bottomRowIdx = cFRRowIdx;\n                                    }\n                                    if (backColIdx === cFRangeIndexes[3] && frontColIdx !== cFRangeIndexes[1]) {\n                                        frontColIdx = cFRangeIndexes[1];\n                                    }\n                                }\n                                else if (left !== frontColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], cFRRowIdx - 1, left]);\n                                    topRowIdx = cFRRowIdx + 1;\n                                    bottomRowIdx = cFRRowIdx + 1;\n                                    frontColIdx = cFRangeIndexes[1];\n                                    backColIdx = cFRangeIndexes[1];\n                                }\n                                else if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                else {\n                                    if (bottomRowIdx < cFRRowIdx || (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[3])) {\n                                        bottomRowIdx = cFRRowIdx;\n                                    }\n                                }\n                            }\n                            else if (backColIdx === cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                if (right !== backColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, right, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    topRowIdx = cFRRowIdx;\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                                if (left !== frontColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, left, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    topRowIdx = cFRRowIdx;\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                                if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, cFRRowIdx, frontColIdx]);\n                                }\n                                else {\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                            }\n                            else if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                if (cFRRowIdx === cFRangeIndexes[2] && cFRangeIndexes[2] === rangeIndexes[0]) {\n                                    if (cFRangeIndexes[0] === cFRangeIndexes[2]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], bottomRowIdx, frontColIdx - 1]);\n                                        result = result + ' ' +\n                                            getRangeAddress([topRowIdx, backColIdx + 1, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    else {\n                                        result =\n                                            result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], bottomRowIdx, cFRangeIndexes[3]]);\n                                        result = result + ' ' +\n                                            getRangeAddress([cFRangeIndexes[2], cFRangeIndexes[1], cFRangeIndexes[2], frontColIdx - 1]);\n                                        result = result + ' ' +\n                                            getRangeAddress([cFRangeIndexes[2], backColIdx + 1, cFRangeIndexes[2], cFRangeIndexes[3]]);\n                                    }\n                                }\n                                else if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], cFRRowIdx, frontColIdx - 1]);\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx + 1, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                else {\n                                    if (left === cFRangeIndexes[1] && right === cFRangeIndexes[1]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, left, bottomRowIdx, cFRangeIndexes[3]]);\n                                        topRowIdx = cFRRowIdx;\n                                    }\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                            }\n                            else if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                if (rangeIndexes[2] !== cFRangeIndexes[0]) {\n                                    if (cFRangeIndexes[2] >= rangeIndexes[2] && cFRRowIdx > rangeIndexes[2]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    if (cFRangeIndexes[1] === cFRangeIndexes[3] &&\n                                        cFRRowIdx <= cFRangeIndexes[2] && top !== cFRangeIndexes[2] && cFRRowIdx !== top) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    if (cFRangeIndexes[1] === cFRangeIndexes[3]) {\n                                        topRowIdx = cFRRowIdx + 1;\n                                        bottomRowIdx = cFRRowIdx + 1;\n                                    }\n                                }\n                                else {\n                                    if (cFRRowIdx === cFRangeIndexes[2] || cFRRowIdx === cFRangeIndexes[0] &&\n                                        cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, backColIdx]);\n                                    }\n                                    topRowIdx = cFRRowIdx + 1;\n                                    bottomRowIdx = cFRRowIdx + 1;\n                                }\n                                if (cFRRowIdx === cFRangeIndexes[2] && cFRangeIndexes[0] !== cFRangeIndexes[2] &&\n                                    cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                    result = result + ' ' + getRangeAddress([cFRRowIdx, frontColIdx, cFRRowIdx, backColIdx]);\n                                }\n                            }\n                            if (!isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx <= cFRangeIndexes[2] ? bottomRowIdx : cFRangeIndexes[2];\n                                left = frontColIdx;\n                                right = backColIdx <= cFRangeIndexes[3] ? backColIdx : cFRangeIndexes[3];\n                            }\n                            isFirst = false;\n                        }\n                        else if (!isFull) {\n                            if (isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx;\n                                left = frontColIdx;\n                                right = backColIdx;\n                            }\n                            if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                bottomRowIdx = cFRRowIdx;\n                            }\n                            if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], (cFRRowIdx - 1), frontColIdx - 1]);\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx + 1, (cFRRowIdx - 1), cFRangeIndexes[3]]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (backColIdx !== cFRangeIndexes[1] && frontColIdx === cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, (cFRRowIdx - 1), cFRangeIndexes[3]]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, (cFRRowIdx - 1), frontColIdx]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (!isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx <= cFRangeIndexes[2] ? bottomRowIdx : cFRangeIndexes[2];\n                                left = frontColIdx;\n                                right = backColIdx <= cFRangeIndexes[3] ? backColIdx : cFRangeIndexes[3];\n                            }\n                            isFirst = false;\n                        }\n                    }\n                }\n            }\n            if (result === '') {\n                oldRange.push(sheet.conditionalFormats[cFRulesIdx].range);\n                sheet.conditionalFormats.splice(cFRulesIdx, 1);\n            }\n            else {\n                oldRange.push(sheet.conditionalFormats[cFRulesIdx].range);\n                sheet.conditionalFormats[cFRulesIdx].range = result.trim().replace(' ', ',');\n            }\n            if (isPresent && !isPublic) {\n                cFRule.range = result.trim().replace(' ', ',');\n                cFormats.push(cFRule);\n            }\n            if (args.isUndoRedo) {\n                if (this.parent.activeSheetIndex !== args.sheetIdx) {\n                    this.parent.notify(goto, { address: sheet.name + '!' + args.range });\n                }\n                break;\n            }\n        }\n        if (!isPublic) {\n            var eventArgs = { cFormats: cFormats, oldRange: oldRange, selectedRange: range, sheetIdx: sheetIndex };\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clearCF' });\n        }\n        if (!args.isclearFormat) {\n            this.parent.notify(addHighlight, { range: range, isclearFormat: true });\n        }\n    };\n    WorkbookConditionalFormat.prototype.cFUndoHandler = function (args) {\n        if (args.sheetIdx === this.parent.activeSheetIndex) {\n            var cFRule = args.conditionalFormat;\n            var cFRanges = cFRule.range.split(',');\n            var sheet = getSheet(this.parent, args.sheetIdx);\n            for (var cFRangeIdx = 0; cFRangeIdx < cFRanges.length; cFRangeIdx++) {\n                var cFRange = cFRanges[cFRangeIdx];\n                var cFRangeIndexes = getRangeIndexes(cFRange);\n                for (var cFRRowIdx = cFRangeIndexes[0]; cFRRowIdx <= cFRangeIndexes[2]; cFRRowIdx++) {\n                    for (var cFRColIdx = cFRangeIndexes[1]; cFRColIdx <= cFRangeIndexes[3]; cFRColIdx++) {\n                        var cell = sheet.rows[cFRRowIdx].cells[cFRColIdx];\n                        this.parent.notify(cFInitialCheck, {\n                            rowIdx: cFRRowIdx, colIdx: cFRColIdx, cell: cell, conditionalFormat: cFRule, isAction: true\n                        });\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Gets the module name.\n     *\n     * @returns {void} string\n     */\n    WorkbookConditionalFormat.prototype.getModuleName = function () {\n        return 'workbookConditionalFormatting';\n    };\n    return WorkbookConditionalFormat;\n}());\nexport { WorkbookConditionalFormat };\n","import { Workbook, DataBind } from '../index';\nimport { WorkbookSave, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookNumberFormat } from '../integrations/number-format';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookDelete } from '../actions/index';\nimport { WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\nimport { WorkbookChart } from '../integrations/index';\n/**\n * Workbook basic module.\n *\n * @private\n */\nvar WorkbookBasicModule = /** @class */ (function () {\n    /**\n     * Constructor for Workbook basic module.\n     *\n     * @private\n     */\n    function WorkbookBasicModule() {\n        Workbook.Inject(DataBind, WorkbookSave, WorkbookOpen, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookDelete, WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @private\n     * @returns {string} - Get the module name.\n     */\n    WorkbookBasicModule.prototype.getModuleName = function () {\n        return 'workbookBasic';\n    };\n    /**\n     * Destroys the Workbook basic module.\n     *\n     * @returns {void} - Destroys the Workbook basic module.\n     */\n    WorkbookBasicModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return WorkbookBasicModule;\n}());\nexport { WorkbookBasicModule };\n","import { Workbook, DataBind } from '../../workbook/index';\nimport { WorkbookSave, WorkbookNumberFormat, WorkbookFormula, WorkbookOpen, WorkbookChart } from '../integrations/index';\nimport { WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookDelete } from '../actions/index';\nimport { WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\n/**\n * Workbook all module.\n *\n * @private\n */\nvar WorkbookAllModule = /** @class */ (function () {\n    /**\n     * Constructor for Workbook all module.\n     *\n     * @private\n     */\n    function WorkbookAllModule() {\n        Workbook.Inject(DataBind, WorkbookSave, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookDelete, WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @private\n     * @returns {string} - Get the module name.\n     */\n    WorkbookAllModule.prototype.getModuleName = function () {\n        return 'workbook-all';\n    };\n    /**\n     * Destroys the Workbook all module.\n     *\n     * @returns {void} - Destroys the Workbook all module.\n     */\n    WorkbookAllModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return WorkbookAllModule;\n}());\nexport { WorkbookAllModule };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Property, Complex } from '@syncfusion/ej2-base';\n/**\n * Represents the cell style.\n */\nvar CellStyle = /** @class */ (function (_super) {\n    __extends(CellStyle, _super);\n    function CellStyle() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Calibri')\n    ], CellStyle.prototype, \"fontFamily\", void 0);\n    __decorate([\n        Property('bottom')\n    ], CellStyle.prototype, \"verticalAlign\", void 0);\n    __decorate([\n        Property('left')\n    ], CellStyle.prototype, \"textAlign\", void 0);\n    __decorate([\n        Property('0pt')\n    ], CellStyle.prototype, \"textIndent\", void 0);\n    __decorate([\n        Property('#000000')\n    ], CellStyle.prototype, \"color\", void 0);\n    __decorate([\n        Property('#ffffff')\n    ], CellStyle.prototype, \"backgroundColor\", void 0);\n    __decorate([\n        Property('normal')\n    ], CellStyle.prototype, \"fontWeight\", void 0);\n    __decorate([\n        Property('normal')\n    ], CellStyle.prototype, \"fontStyle\", void 0);\n    __decorate([\n        Property('11pt')\n    ], CellStyle.prototype, \"fontSize\", void 0);\n    __decorate([\n        Property('none')\n    ], CellStyle.prototype, \"textDecoration\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"border\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderTop\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderBottom\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderLeft\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderRight\", void 0);\n    return CellStyle;\n}(ChildProperty));\nexport { CellStyle };\n/**\n * Represents the Filter Collection.\n *\n */\nvar FilterCollection = /** @class */ (function (_super) {\n    __extends(FilterCollection, _super);\n    function FilterCollection() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"sheetIndex\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"filterRange\", void 0);\n    __decorate([\n        Property(false)\n    ], FilterCollection.prototype, \"hasFilter\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"column\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"criteria\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"value\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"dataType\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"predicates\", void 0);\n    return FilterCollection;\n}(ChildProperty));\nexport { FilterCollection };\n/**\n * Represents the sort Collection.\n *\n */\nvar SortCollection = /** @class */ (function (_super) {\n    __extends(SortCollection, _super);\n    function SortCollection() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property()\n    ], SortCollection.prototype, \"sortRange\", void 0);\n    __decorate([\n        Property()\n    ], SortCollection.prototype, \"columnIndex\", void 0);\n    __decorate([\n        Property()\n    ], SortCollection.prototype, \"order\", void 0);\n    __decorate([\n        Property()\n    ], SortCollection.prototype, \"sheetIndex\", void 0);\n    return SortCollection;\n}(ChildProperty));\nexport { SortCollection };\n/**\n * Represents the DefineName.\n */\nvar DefineName = /** @class */ (function (_super) {\n    __extends(DefineName, _super);\n    function DefineName() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"name\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"scope\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"comment\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"refersTo\", void 0);\n    return DefineName;\n}(ChildProperty));\nexport { DefineName };\n/**\n * Configures the Protect behavior for the spreadsheet.\n *\n */\nvar ProtectSettings = /** @class */ (function (_super) {\n    __extends(ProtectSettings, _super);\n    function ProtectSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"selectCells\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatCells\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatRows\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatColumns\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"insertLink\", void 0);\n    return ProtectSettings;\n}(ChildProperty));\nexport { ProtectSettings };\n/**\n * Represents the Hyperlink.\n *\n */\nvar Hyperlink = /** @class */ (function (_super) {\n    __extends(Hyperlink, _super);\n    function Hyperlink() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Hyperlink.prototype, \"address\", void 0);\n    return Hyperlink;\n}(ChildProperty));\nexport { Hyperlink };\n/**\n * Represents the DataValidation.\n */\nvar Validation = /** @class */ (function (_super) {\n    __extends(Validation, _super);\n    function Validation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('WholeNumber')\n    ], Validation.prototype, \"type\", void 0);\n    __decorate([\n        Property('Between')\n    ], Validation.prototype, \"operator\", void 0);\n    __decorate([\n        Property('0')\n    ], Validation.prototype, \"value1\", void 0);\n    __decorate([\n        Property('0')\n    ], Validation.prototype, \"value2\", void 0);\n    __decorate([\n        Property(true)\n    ], Validation.prototype, \"ignoreBlank\", void 0);\n    __decorate([\n        Property(true)\n    ], Validation.prototype, \"inCellDropDown\", void 0);\n    __decorate([\n        Property(false)\n    ], Validation.prototype, \"isHighlighted\", void 0);\n    return Validation;\n}(ChildProperty));\nexport { Validation };\n/**\n * Represents the Format.\n */\nvar Format = /** @class */ (function (_super) {\n    __extends(Format, _super);\n    function Format() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('General')\n    ], Format.prototype, \"format\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Format.prototype, \"style\", void 0);\n    __decorate([\n        Property(true)\n    ], Format.prototype, \"isLocked\", void 0);\n    return Format;\n}(ChildProperty));\nexport { Format };\n/**\n * Represents the Conditional Formatting.\n *\n */\nvar ConditionalFormat = /** @class */ (function (_super) {\n    __extends(ConditionalFormat, _super);\n    function ConditionalFormat() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('GreaterThan')\n    ], ConditionalFormat.prototype, \"type\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], ConditionalFormat.prototype, \"format\", void 0);\n    __decorate([\n        Property('RedFT')\n    ], ConditionalFormat.prototype, \"cFColor\", void 0);\n    __decorate([\n        Property('')\n    ], ConditionalFormat.prototype, \"value\", void 0);\n    __decorate([\n        Property('')\n    ], ConditionalFormat.prototype, \"range\", void 0);\n    return ConditionalFormat;\n}(ChildProperty));\nexport { ConditionalFormat };\n/**\n * Represents the Legend.\n *\n */\nvar LegendSettings = /** @class */ (function (_super) {\n    __extends(LegendSettings, _super);\n    function LegendSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(true)\n    ], LegendSettings.prototype, \"visible\", void 0);\n    __decorate([\n        Property('Auto')\n    ], LegendSettings.prototype, \"position\", void 0);\n    return LegendSettings;\n}(ChildProperty));\nexport { LegendSettings };\n/**\n * Represents the DataLabelSettings.\n *\n */\nvar DataLabelSettings = /** @class */ (function (_super) {\n    __extends(DataLabelSettings, _super);\n    function DataLabelSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(false)\n    ], DataLabelSettings.prototype, \"visible\", void 0);\n    __decorate([\n        Property('Auto')\n    ], DataLabelSettings.prototype, \"position\", void 0);\n    return DataLabelSettings;\n}(ChildProperty));\nexport { DataLabelSettings };\n/**\n * Specifies the major grid lines in the `axis`.\n *\n */\nvar MajorGridLines = /** @class */ (function (_super) {\n    __extends(MajorGridLines, _super);\n    function MajorGridLines() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], MajorGridLines.prototype, \"width\", void 0);\n    return MajorGridLines;\n}(ChildProperty));\nexport { MajorGridLines };\n/**\n * Specifies the minor grid lines in the `axis`.\n *\n */\nvar MinorGridLines = /** @class */ (function (_super) {\n    __extends(MinorGridLines, _super);\n    function MinorGridLines() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], MinorGridLines.prototype, \"width\", void 0);\n    return MinorGridLines;\n}(ChildProperty));\nexport { MinorGridLines };\n/**\n * Represents the axis.\n *\n */\nvar Axis = /** @class */ (function (_super) {\n    __extends(Axis, _super);\n    function Axis() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Axis.prototype, \"title\", void 0);\n    __decorate([\n        Complex({}, MajorGridLines)\n    ], Axis.prototype, \"majorGridLines\", void 0);\n    __decorate([\n        Complex({}, MinorGridLines)\n    ], Axis.prototype, \"minorGridLines\", void 0);\n    __decorate([\n        Property(true)\n    ], Axis.prototype, \"visible\", void 0);\n    return Axis;\n}(ChildProperty));\nexport { Axis };\n/**\n * Represents the Chart.\n */\nvar Chart = /** @class */ (function (_super) {\n    __extends(Chart, _super);\n    function Chart() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Line')\n    ], Chart.prototype, \"type\", void 0);\n    __decorate([\n        Property('Material')\n    ], Chart.prototype, \"theme\", void 0);\n    __decorate([\n        Property(false)\n    ], Chart.prototype, \"isSeriesInRows\", void 0);\n    __decorate([\n        Property('')\n    ], Chart.prototype, \"range\", void 0);\n    __decorate([\n        Property('')\n    ], Chart.prototype, \"id\", void 0);\n    __decorate([\n        Property('')\n    ], Chart.prototype, \"title\", void 0);\n    __decorate([\n        Property(290)\n    ], Chart.prototype, \"height\", void 0);\n    __decorate([\n        Property(480)\n    ], Chart.prototype, \"width\", void 0);\n    __decorate([\n        Property(0)\n    ], Chart.prototype, \"top\", void 0);\n    __decorate([\n        Property(0)\n    ], Chart.prototype, \"left\", void 0);\n    __decorate([\n        Complex({}, LegendSettings)\n    ], Chart.prototype, \"legendSettings\", void 0);\n    __decorate([\n        Complex({}, Axis)\n    ], Chart.prototype, \"primaryXAxis\", void 0);\n    __decorate([\n        Complex({}, Axis)\n    ], Chart.prototype, \"primaryYAxis\", void 0);\n    __decorate([\n        Complex({}, DataLabelSettings)\n    ], Chart.prototype, \"dataLabelSettings\", void 0);\n    return Chart;\n}(ChildProperty));\nexport { Chart };\n/**\n * Represents the Image.\n */\nvar Image = /** @class */ (function (_super) {\n    __extends(Image, _super);\n    function Image() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Image.prototype, \"src\", void 0);\n    __decorate([\n        Property('')\n    ], Image.prototype, \"id\", void 0);\n    __decorate([\n        Property(300)\n    ], Image.prototype, \"height\", void 0);\n    __decorate([\n        Property(400)\n    ], Image.prototype, \"width\", void 0);\n    __decorate([\n        Property(0)\n    ], Image.prototype, \"top\", void 0);\n    __decorate([\n        Property(0)\n    ], Image.prototype, \"left\", void 0);\n    return Image;\n}(ChildProperty));\nexport { Image };\n","/** @hidden */\nexport var workbookLocale = 'spreadsheetLocale';\n/**\n * Workbook locale text\n *\n * @hidden\n */\nexport var localeData = {\n    SortOutOfRangeError: 'Select a cell or range inside the used range and try again.'\n};\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * ServiceLocator\n *\n * @hidden\n */\nvar ServiceLocator = /** @class */ (function () {\n    function ServiceLocator() {\n        this.services = {};\n    }\n    ServiceLocator.prototype.getService = function (name) {\n        if (isNullOrUndefined(this.services[name])) {\n            // eslint-disable-next-line no-throw-literal\n            throw \"The service \" + name + \" is not registered\";\n        }\n        return this.services[name];\n    };\n    ServiceLocator.prototype.register = function (name, type) {\n        if (isNullOrUndefined(this.services[name])) {\n            this.services[name] = type;\n        }\n    };\n    return ServiceLocator;\n}());\nexport { ServiceLocator };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Collection, Complex } from '@syncfusion/ej2-base';\nimport { initSheet, getSheet, getSheetIndexFromId, getSheetIndexByName, getSheetIndex, Sheet, moveSheet, duplicateSheet } from './sheet';\nimport { Event, merge, L10n, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getWorkbookRequiredModules } from '../common/module';\nimport { getData, clearRange } from './index';\nimport { DefineName, CellStyle, updateUsedRange, getIndexesFromAddress, localeData, workbookLocale } from '../common/index';\nimport * as events from '../common/event';\nimport { insertModel, getAddressInfo } from '../common/index';\nimport { setCellFormat, sheetCreated, deleteModel, setLockCells } from '../common/index';\nimport { getCellIndexes, getCellAddress } from '../common/index';\nimport { setMerge, dataChanged } from '../common/index';\nimport { getCell, skipDefaultValue, setCell, wrap as wrapText } from './cell';\nimport { DataBind, setRow, setColumn } from '../index';\nimport { WorkbookSave, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookChart } from '../integrations/index';\nimport { WorkbookNumberFormat } from '../integrations/number-format';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookProtectSheet } from '../actions/index';\nimport { WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { ServiceLocator } from '../services/index';\nimport { setLinkModel, setImage, setChart, updateView } from '../common/event';\nimport { beginAction, completeAction, deleteChart } from '../../spreadsheet/common/event';\nimport { WorkbookFindAndReplace } from '../actions/find-and-replace';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\n/**\n * Represents the Workbook.\n */\nvar Workbook = /** @class */ (function (_super) {\n    __extends(Workbook, _super);\n    /**\n     * Constructor for initializing the library.\n     *\n     * @param {WorkbookModel} options - Configures Workbook model.\n     */\n    function Workbook(options) {\n        var _this = _super.call(this, options) || this;\n        /** @hidden */\n        _this.isEdit = false;\n        /**\n         * To generate sheet name based on sheet count.\n         *\n         * @hidden\n         */\n        _this.sheetNameCount = 1;\n        /**\n         * @hidden\n         */\n        _this.isOpen = false;\n        /**\n         * @hidden\n         */\n        _this.chartColl = [];\n        /**\n         * @hidden\n         */\n        _this.chartCount = 1;\n        Workbook_1.Inject(DataBind, WorkbookSave, WorkbookOpen, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookFindAndReplace, WorkbookDataValidation, WorkbookProtectSheet, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n        _this.commonCellStyle = {};\n        if (options && options.cellStyle) {\n            _this.commonCellStyle = options.cellStyle;\n        }\n        if (_this.getModuleName() === 'workbook') {\n            _this.serviceLocator = new ServiceLocator;\n            _this.initWorkbookServices();\n            _this.dataBind();\n            _this.initEmptySheet();\n        }\n        return _this;\n    }\n    Workbook_1 = Workbook;\n    /**\n     * For internal use only.\n     *\n     * @returns {void} - For internal use only.\n     * @hidden\n     */\n    Workbook.prototype.preRender = function () {\n        if (!Object.keys(this.commonCellStyle).length) {\n            this.commonCellStyle = skipDefaultValue(this.cellStyle, true);\n        }\n        if (this.getModuleName() === 'spreadsheet' && !this.refreshing) {\n            this.initEmptySheet();\n        }\n    };\n    Workbook.prototype.initWorkbookServices = function () {\n        this.serviceLocator.register(workbookLocale, new L10n(this.getModuleName(), localeData, this.locale));\n    };\n    /**\n     * For internal use only.\n     *\n     * @returns {void} - For internal use only.\n     * @hidden\n     */\n    Workbook.prototype.render = function () {\n        /** code snippets */\n    };\n    /**\n     * To provide the array of modules needed for workbook.\n     *\n     * @returns {ModuleDeclaration[]} - To provide the array of modules needed for workbook.\n     * @hidden\n     */\n    Workbook.prototype.requiredModules = function () {\n        return getWorkbookRequiredModules(this);\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     *\n     * @returns {string} - Get the properties to be maintained in the persisted state.\n     * @hidden\n     */\n    Workbook.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * Applies the style (font family, font weight, background color, etc...) to the specified range of cells.\n     *\n     * {% codeBlock src='spreadsheet/cellFormat/index.md' %}{% endcodeBlock %}\n     *\n     * @param {CellStyleModel} style - Specifies the cell style.\n     * @param {string} range - Specifies the address for the range of cells.\n     * @returns {void} - Applies the style (font family, font weight, background color, etc...) to the specified range of cells.\n     */\n    Workbook.prototype.cellFormat = function (style, range) {\n        var sheet = this.getActiveSheet();\n        range = range || sheet.selectedRange;\n        this.notify(setCellFormat, { style: style, range: range, refreshRibbon: range.indexOf(sheet.activeCell) > -1 ? true : false });\n    };\n    /**\n     * Applies cell lock to the specified range of cells.\n     *\n     * {% codeBlock src='spreadsheet/lockCells/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} range - Specifies the address for the range of cells.\n     * @param {boolean} isLocked -Specifies the cell is locked or not.\n     * @returns {void} - To Applies cell lock to the specified range of cells.\n     */\n    Workbook.prototype.lockCells = function (range, isLocked) {\n        var sheet = this.getActiveSheet();\n        range = range || sheet.selectedRange;\n        this.notify(setLockCells, { range: range, isLocked: isLocked });\n    };\n    /**\n     * @hidden\n     * @param {Workbook} cssProps - Specifies the cssProps.\n     * @param {number[]} indexes - Specifies the indexes.\n     * @returns {CellStyleModel} - To get Cell Style Value.\n     */\n    Workbook.prototype.getCellStyleValue = function (cssProps, indexes) {\n        var _this = this;\n        var cell = getCell(indexes[0], indexes[1], this.getActiveSheet());\n        var style = {};\n        cssProps.forEach(function (cssProp) {\n            style[cssProp] = _this.cellStyle[cssProp];\n            if (cell && cell.style && cell.style[cssProp]) {\n                style[cssProp] = cell.style[cssProp];\n            }\n        });\n        return style;\n    };\n    /**\n     * Applies the number format (number, currency, percentage, short date, etc...) to the specified range of cells.\n     *\n     * {% codeBlock src='spreadsheet/numberFormat/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} format - Specifies the number format code.\n     * @param {string} range - Specifies the address for the range of cells.\n     * @returns {void} - Applies the number format (number, currency, percentage, short date, etc...) to the specified range of cells.\n     */\n    Workbook.prototype.numberFormat = function (format, range) {\n        this.notify(events.applyNumberFormatting, { format: format, range: range });\n    };\n    /**\n     * Used to create new sheet.\n     *\n     * @hidden\n     * @param {number} index - Specifies the index.\n     * @param {SheetModel[]} sheets - Specifies the sheets.\n     * @returns {void} - To create new sheet.\n     */\n    Workbook.prototype.createSheet = function (index, sheets) {\n        if (index === void 0) { index = this.sheets.length; }\n        if (sheets === void 0) { sheets = [{}]; }\n        var _a;\n        (_a = this.sheets).splice.apply(_a, [index, 0].concat(sheets));\n        initSheet(this, sheets);\n        this.notify(sheetCreated, { sheetIndex: index || 0, sheets: sheets });\n        this.notify(events.workbookFormulaOperation, {\n            action: 'registerSheet', sheetIndex: index || 0, sheetCount: index + sheets.length\n        });\n    };\n    /**\n     * Used to remove sheet.\n     *\n     * @hidden\n     * @param  {number} idx - Specifies the index.\n     * @returns {void} - To remove sheet\n     */\n    Workbook.prototype.removeSheet = function (idx) {\n        this.sheets.splice(idx, 1);\n    };\n    /**\n     * Destroys the Workbook library.\n     *\n     * @returns {void} - To destroy sheet\n     */\n    Workbook.prototype.destroy = function () {\n        this.notify(events.workbookDestroyed, null);\n        _super.prototype.destroy.call(this);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     *\n     * @param {WorkbookModel} newProp - To set the properties\n     * @param {WorkbookModel} oldProp - To get the properties\n     * @returns {void} - property value changed\n     * @hidden\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Workbook.prototype.onPropertyChanged = function (newProp, oldProp) {\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'cellStyle':\n                    merge(this.commonCellStyle, newProp.cellStyle);\n                    break;\n                case 'sheets':\n                    if (newProp.sheets === this.sheets) {\n                        this.notify(events.workbookFormulaOperation, { action: 'unRegisterSheet', propertyChange: true });\n                        this.sheetNameCount = 1;\n                        this.notify(events.sheetsDestroyed, {});\n                        initSheet(this);\n                        this.notify(sheetCreated, null);\n                        this.notify(events.workbookFormulaOperation, { action: 'registerSheet' });\n                    }\n                    else {\n                        initSheet(this);\n                    }\n                    break;\n            }\n        }\n    };\n    /**\n     * Not applicable for workbook.\n     *\n     * @hidden\n     * @param {string | HTMLElement} selector - Specifies the selector.\n     * @returns {void} - To append the element.\n     */\n    Workbook.prototype.appendTo = function (selector) {\n        _super.prototype.appendTo.call(this, selector);\n    };\n    /**\n     * Used to hide/show the rows in spreadsheet.\n     *\n     * @param {number} startIndex - Specifies the start row index.\n     * @param {number} endIndex - Specifies the end row index.\n     * @param {boolean} hide - To hide/show the rows in specified range.\n     * @returns {void} - To hide/show the rows in spreadsheet.\n     */\n    Workbook.prototype.hideRow = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        var sheet = this.getActiveSheet();\n        if (hide && (sheet.frozenRows || sheet.frozenColumns)) {\n            return;\n        }\n        for (var i = startIndex; i <= endIndex; i++) {\n            setRow(sheet, i, { hidden: hide });\n        }\n    };\n    /**\n     * Used to hide/show the columns in spreadsheet.\n     *\n     * @param {number} startIndex - Specifies the start column index.\n     * @param {number} endIndex - Specifies the end column index.\n     * @param {boolean} hide - Set `true` / `false` to hide / show the columns.\n     * @returns {void} - To hide/show the columns in spreadsheet.\n     */\n    Workbook.prototype.hideColumn = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        var sheet = this.getActiveSheet();\n        if (sheet.frozenRows || sheet.frozenColumns) {\n            return;\n        }\n        for (var i = startIndex; i <= endIndex; i++) {\n            setColumn(sheet, i, { hidden: hide });\n        }\n    };\n    /**\n     * Sets the border to specified range of cells.\n     *\n     * {% codeBlock src='spreadsheet/setBorder/index.md' %}{% endcodeBlock %}\n     *\n     * @param {CellStyleModel} style - Specifies the style property which contains border value.\n     * @param {string} range - Specifies the range of cell reference. If not specified, it will considered the active cell reference.\n     * @param {BorderType} type - Specifies the range of cell reference. If not specified, it will considered the active cell reference.\n     * @returns {void} - To Sets the border to specified range of cells.\n     */\n    Workbook.prototype.setBorder = function (style, range, type) {\n        this.notify(setCellFormat, {\n            style: style, borderType: type, range: range || this.getActiveSheet().selectedRange\n        });\n    };\n    /**\n     * Used to insert rows in to the spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/insertRow/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number | RowModel[]} startRow - Specifies the start row index / row model which needs to be inserted.\n     * @param {number} endRow - Specifies the end row index.\n     * @param {number | string} sheet - Specifies the sheet name or index in which the insert operation will perform. By default,\n     * active sheet will be considered.\n     * @returns {void} - To insert rows in to the spreadsheet.\n     */\n    Workbook.prototype.insertRow = function (startRow, endRow, sheet) {\n        this.notify(insertModel, { model: this.getSheetModel(sheet), start: startRow, end: endRow,\n            modelType: 'Row' });\n    };\n    /**\n     * Used to insert columns in to the spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/insertColumn/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number | ColumnModel[]} startColumn - Specifies the start column index / column model which needs to be inserted.\n     * @param {number} endColumn - Specifies the end column index.\n     * @param {number | string} sheet - Specifies the sheet name or index in which the insert operation will perform. By default,\n     * active sheet will be considered.\n     * @returns {void} - To insert columns in to the spreadsheet.\n     */\n    Workbook.prototype.insertColumn = function (startColumn, endColumn, sheet) {\n        this.notify(insertModel, { model: this.getSheetModel(sheet), start: startColumn, end: endColumn,\n            modelType: 'Column' });\n    };\n    /**\n     * Used to insert sheets in to the spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/insertSheet/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number | SheetModel[]} startSheet - Specifies the start sheet index / sheet model which needs to be inserted.\n     * @param {number} endSheet - Specifies the end sheet index.\n     * @returns {void} - To insert sheets in to the spreadsheet.\n     */\n    Workbook.prototype.insertSheet = function (startSheet, endSheet) {\n        this.notify(insertModel, { model: this, start: startSheet, end: endSheet, modelType: 'Sheet' });\n    };\n    /**\n     * Used to delete rows, columns and sheets from the spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/delete/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} startIndex - Specifies the start sheet / row / column index.\n     * @param {number} endIndex - Specifies the end sheet / row / column index.\n     * @param {ModelType} model - Specifies the delete model type. By default, the model is considered as `Sheet`. The possible values are,\n     * - Row: To delete rows.\n     * - Column: To delete columns.\n     * - Sheet: To delete sheets.\n     * @param {number | string} sheet - Specifies the sheet name or index in which the delete operation will perform. By default,\n     * active sheet will be considered. It is applicable only for model type Row and Column.\n     * @returns {void} - To delete rows, columns and sheets from the spreadsheet.\n     */\n    Workbook.prototype.delete = function (startIndex, endIndex, model, sheet) {\n        startIndex = startIndex || 0;\n        var sheetModel;\n        if (!model || model === 'Sheet') {\n            sheetModel = this;\n        }\n        else {\n            sheetModel = this.getSheetModel(sheet);\n            if (!sheetModel) {\n                return;\n            }\n        }\n        this.notify(deleteModel, {\n            model: sheetModel, start: startIndex, end: isNullOrUndefined(endIndex) ? startIndex : endIndex, modelType: model || 'Sheet'\n        });\n    };\n    /**\n     * Used to move the sheets to the specified position in the list of sheets.\n     *\n     * {% codeBlock src='spreadsheet/moveSheet/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} position - Specifies the position to move a sheet in the list of sheets.\n     * @param {number[]} sheetIndexes - Specifies the indexes of the sheet to be moved. By default, the active sheet will be moved.\n     * @returns {void} - Used to move the sheets to the specified position in the list of sheets.\n     */\n    Workbook.prototype.moveSheet = function (position, sheetIndexes) {\n        moveSheet(this, position, sheetIndexes);\n    };\n    /**\n     * Used to make a duplicate/copy of the sheet in the spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/duplicateSheet/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} sheetIndex - Specifies the index of the sheet to be duplicated. By default, the active sheet will be duplicated.\n     * @returns {void} - Used to make a duplicate/copy of the sheet in the spreadsheet.\n     */\n    Workbook.prototype.duplicateSheet = function (sheetIndex) {\n        duplicateSheet(this, sheetIndex);\n    };\n    Workbook.prototype.getSheetModel = function (sheet) {\n        if (isNullOrUndefined(sheet)) {\n            return this.getActiveSheet();\n        }\n        else {\n            var index = typeof sheet === 'string' ? getSheetIndex(this, sheet) : sheet;\n            if (isNullOrUndefined(index) || index >= this.sheets.length) {\n                return null;\n            }\n            return this.sheets[index];\n        }\n    };\n    /**\n     * Used to merge the range of cells.\n     *\n     * {% codeBlock src='spreadsheet/merge/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} range - Specifies the range of cells as address.\n     * @param {MergeType} type - Specifies the merge type. The possible values are,\n     * - All: Merge all the cells between provided range.\n     * - Horizontally: Merge the cells row-wise.\n     * - Vertically: Merge the cells column-wise.\n     * @returns {void} - To merge the range of cells.\n     */\n    Workbook.prototype.merge = function (range, type) {\n        var sheetIdx;\n        var sheet;\n        if (range) {\n            sheetIdx = this.getAddressInfo(range).sheetIndex;\n            sheet = getSheet(this, sheetIdx);\n        }\n        else {\n            sheet = this.getActiveSheet();\n            range = sheet.selectedRange;\n        }\n        this.notify(setMerge, { merge: true, range: range, type: type || 'All', sheet: sheet, refreshRibbon: range.indexOf(sheet.activeCell) > -1 ? true : false, preventRefresh: this.activeSheetIndex !== sheetIdx });\n    };\n    /** Used to compute the specified expression/formula.\n     *\n     * {% codeBlock src='spreadsheet/computeExpression/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} formula - Specifies the formula(=SUM(A1:A3)) or expression(2+3).\n     * @returns {string | number} - to compute the specified expression/formula.\n     */\n    Workbook.prototype.computeExpression = function (formula) {\n        var args = {\n            action: 'computeExpression', formula: formula\n        };\n        this.notify(events.workbookFormulaOperation, args);\n        return args.calcValue;\n    };\n    Workbook.prototype.initEmptySheet = function () {\n        if (!this.sheets.length) {\n            this.createSheet();\n        }\n        else {\n            initSheet(this);\n        }\n    };\n    /** @hidden\n     * @returns {SheetModel} - To get Active Sheet.\n     */\n    Workbook.prototype.getActiveSheet = function () {\n        return this.sheets[this.activeSheetIndex];\n    };\n    /** @hidden\n     * @param {number} index - Specifies the index.\n     * @param {number} initIdx - Specifies the initIdx.\n     * @param {number} hiddenCount - Specifies the initIdx.\n     * @returns {number} - To skip Hidden Sheets.\n     */\n    Workbook.prototype.skipHiddenSheets = function (index, initIdx, hiddenCount) {\n        if (hiddenCount === void 0) { hiddenCount = 0; }\n        if (this.sheets[index] && this.sheets[index].state !== 'Visible') {\n            if (initIdx === undefined) {\n                initIdx = index;\n            }\n            if (index && index + 1 === this.sheets.length) {\n                index = initIdx - 1;\n            }\n            else {\n                index = index < initIdx ? --index : ++index;\n            }\n            index = this.skipHiddenSheets(index, initIdx, ++hiddenCount);\n        }\n        if (hiddenCount === this.sheets.length) {\n            this.setSheetPropertyOnMute(this.sheets[0], 'state', 'Visible');\n            return 0;\n        }\n        return index;\n    };\n    /**\n     * Used for setting the used range row and column index.\n     *\n     * @hidden\n     * @param {number} rowIdx - Specifies the rowIndex.\n     * @param {number} colIdx - Specifies the colIndex.\n     * @param {SheetModel} sheet - Specifies the active sheet.\n     * @returns {void} - To setting the used range row and column index.\n     */\n    Workbook.prototype.setUsedRange = function (rowIdx, colIdx, sheet) {\n        if (sheet === void 0) { sheet = this.getActiveSheet(); }\n        if (rowIdx > sheet.usedRange.rowIndex) {\n            sheet.usedRange.rowIndex = rowIdx;\n            if (sheet === this.getActiveSheet()) {\n                this.notify(updateUsedRange, { index: rowIdx, update: 'row' });\n            }\n        }\n        if (colIdx > sheet.usedRange.colIndex) {\n            sheet.usedRange.colIndex = colIdx;\n            if (sheet === this.getActiveSheet()) {\n                this.notify(updateUsedRange, { index: colIdx, update: 'col' });\n            }\n        }\n    };\n    /**\n     * Gets the range of data as JSON from the specified address.\n     *\n     * {% codeBlock src='spreadsheet/getData/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} address - Specifies the address for range of cells.\n     * @returns {Promise<Map<string, CellModel>>} - Gets the range of data as JSON from the specified address.\n     */\n    Workbook.prototype.getData = function (address) {\n        return getData(this, address);\n    };\n    /**\n     * Get component name.\n     *\n     * @returns {string} - Gets the module name.\n     * @hidden\n     */\n    Workbook.prototype.getModuleName = function () {\n        return 'workbook';\n    };\n    /** @hidden\n     * @param {number} sheetId - Specifies the sheet id.\n     * @param {number} rowIndex - Specifies the rowIndex.\n     * @param {number} colIndex - Specifies the colIndex.\n     * @returns {string | number} - To set the value for row and col.\n     */\n    Workbook.prototype.getValueRowCol = function (sheetId, rowIndex, colIndex, formulaCellReference, refresh) {\n        var args = {\n            action: 'getSheetInfo', sheetInfo: []\n        };\n        this.notify(events.workbookFormulaOperation, args);\n        var id = getSheetIndexByName(this, 'Sheet' + sheetId, args.sheetInfo);\n        if (id === -1) {\n            var errArgs = { action: 'getReferenceError', refError: '' };\n            this.notify(events.workbookFormulaOperation, errArgs);\n            return errArgs.refError;\n        }\n        var sheetIndex = getSheetIndexFromId(this, sheetId);\n        var sheet = getSheet(this, sheetIndex);\n        var cell = getCell(rowIndex - 1, colIndex - 1, sheet);\n        if (formulaCellReference && formulaCellReference.includes('!') && !cell && sheet.ranges && sheet.ranges.length) {\n            var isNotLoaded_1;\n            if (this.formulaRefCell && this.formulaRefCell === formulaCellReference) {\n                return cell && cell.value;\n            }\n            sheet.ranges.forEach(function (range) {\n                if (!range.info || !range.info.loadedRange || !range.info.loadedRange.length) {\n                    isNotLoaded_1 = true;\n                    return;\n                }\n            });\n            if (isNotLoaded_1) {\n                this.formulaRefCell = formulaCellReference;\n                sheetIndex = getSheetIndexFromId(this, Number(formulaCellReference.substring(formulaCellReference.lastIndexOf(',') + 1, formulaCellReference.length)));\n                if (isNullOrUndefined(sheetIndex)) {\n                    return cell && cell.value;\n                }\n                formulaCellReference = formulaCellReference.substring(formulaCellReference.lastIndexOf('!') + 1, formulaCellReference.lastIndexOf(','));\n                getData(this, sheet.name + \"!A1:\" + getCellAddress(rowIndex - 1, colIndex - 1), null, null, null, null, formulaCellReference, sheetIndex);\n            }\n        }\n        else if (cell && cell.formula && (refresh || isNullOrUndefined(cell.value)) && cell.formula.indexOf('UNIQUE') === -1) {\n            this.notify('calculateFormula', { cell: cell, rowIdx: rowIndex - 1, colIdx: colIndex - 1, sheetIndex: sheetIndex });\n        }\n        return cell && cell.value;\n    };\n    /** @hidden\n     * @param {number} sheetIndex - Specifies the sheetIndex.\n     * @param {string | number} value - Specifies the value.\n     * @param {number} rowIndex - Specifies the rowIndex.\n     * @param {number} colIndex - Specifies the colIndex.\n     * @returns {void} - To set the value for row and col.\n     */\n    Workbook.prototype.setValueRowCol = function (sheetIndex, value, rowIndex, colIndex) {\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        this.notify(events.workbookEditOperation, {\n            action: 'updateCellValue', address: [rowIndex - 1, colIndex - 1], value: value,\n            sheetIndex: sheetIndex, isValueOnly: true\n        });\n    };\n    /**\n     * Opens the specified excel file or stream.\n     *\n     * @param {OpenOptions} options - Options for opening the excel file.\n     * @returns {void} - Opens the specified excel file or stream.\n     */\n    Workbook.prototype.open = function (options) {\n        this.notify(events.workbookOpen, options);\n    };\n    /**\n     * Opens the specified JSON object.\n     *\n     * {% codeBlock src='spreadsheet/openFromJson/index.md' %}{% endcodeBlock %}\n     *\n     * The available arguments in options are:\n     * * file: Specifies the spreadsheet model as object or string. And the object contains the jsonObject,\n     * which is saved from spreadsheet using saveAsJson method.\n     *\n     * @param {Object} options - Options for opening the JSON object.\n     * @param {string | object} options.file - Options for opening the JSON object.\n     * @returns {void} - Opens the specified JSON object.\n     */\n    Workbook.prototype.openFromJson = function (options) {\n        this.isOpen = true;\n        var jsonObject = typeof options.file === 'object' ? JSON.stringify(options.file) : options.file;\n        this.notify(events.workbookOpen, { jsonObject: jsonObject });\n    };\n    /**\n     * Saves the Spreadsheet data to Excel file.\n     * <br><br>\n     * The available arguments in saveOptions are:\n     * * url: Specifies the save URL.\n     * * fileName: Specifies the file name.\n     * * saveType: Specifies the file type need to be saved.\n     *\n     * {% codeBlock src='spreadsheet/save/index.md' %}{% endcodeBlock %}\n     *\n     * @param {SaveOptions} saveOptions - Options for saving the excel file.\n     * @returns {void} - To Saves the Spreadsheet data to Excel file.\n     */\n    Workbook.prototype.save = function (saveOptions) {\n        if (saveOptions === void 0) { saveOptions = {}; }\n        if (this.allowSave) {\n            var defaultProps = {\n                url: this.saveUrl,\n                fileName: saveOptions.fileName || 'Sample',\n                saveType: 'Xlsx'\n                //passWord: args.passWord\n            };\n            var eventArgs = __assign({}, defaultProps, saveOptions, { customParams: {}, isFullPost: true, needBlobData: false, cancel: false });\n            this.trigger('beforeSave', eventArgs);\n            this.notify(beginAction, { eventArgs: eventArgs, action: 'beforeSave' });\n            if (!eventArgs.cancel) {\n                this.notify(events.beginSave, {\n                    saveSettings: eventArgs, isFullPost: eventArgs.isFullPost,\n                    needBlobData: eventArgs.needBlobData, customParams: eventArgs.customParams\n                });\n            }\n        }\n    };\n    /**\n     * Saves the Spreadsheet data as JSON object.\n     *\n     * {% codeBlock src='spreadsheet/saveAsJson/index.md' %}{% endcodeBlock %}\n     *\n     * @returns {Promise<object>} - To Saves the Spreadsheet data as JSON object.\n     */\n    Workbook.prototype.saveAsJson = function () {\n        var _this = this;\n        return new Promise(function (resolve) {\n            _this.on(events.onSave, function (args) {\n                args.cancel = true;\n                _this.off(events.onSave);\n                resolve({ jsonObject: { Workbook: args.jsonObject } });\n                _this.notify(events.saveCompleted, args);\n            });\n            _this.save();\n        });\n    };\n    Workbook.prototype.addHyperlink = function (hyperlink, cellAddress) {\n        var args = { hyperlink: hyperlink, cell: cellAddress };\n        this.notify(setLinkModel, args);\n    };\n    /**\n     * To find the specified cell value.\n     *\n     * @hidden\n     * @param {FindOptions} args - options for find.\n     * {% codeBlock src='spreadsheet/findHandler/index.md' %}{% endcodeBlock %}\n     * @returns {void} - To find the specified cell value.\n     */\n    Workbook.prototype.findHandler = function (args) {\n        if (args.findOpt === 'next') {\n            this.notify(events.findNext, args);\n        }\n        else if (args.findOpt === 'prev') {\n            this.notify(events.findPrevious, args);\n        }\n    };\n    /**\n     * @hidden\n     * @param {FindOptions} args - Specifies the FindOptions.\n     * @returns {void} - To replace the value.\n     */\n    Workbook.prototype.replaceHandler = function (args) {\n        if (args.replaceBy === 'replace') {\n            this.notify(events.replaceHandler, args);\n        }\n        else {\n            this.notify(events.replaceAllHandler, args);\n        }\n    };\n    /**\n     * Protect the active sheet based on the protect sheetings.\n     *\n     * @param {number} sheet - Specifies the protect settings of the sheet.\n     * @param {ProtectSettingsModel} protectSettings - Specifies the protect settings of the sheet.\n     * @returns {void} - Unprotect the active sheet.\n     */\n    Workbook.prototype.protectSheet = function (sheet, protectSettings) {\n        this.notify(events.protectsheetHandler, protectSettings);\n    };\n    /**\n     * Unprotect the active sheet.\n     *\n     * @param {number} sheet - Specifies the sheet to Unprotect.\n     * @returns {void} - Unprotect the active sheet.\n     */\n    Workbook.prototype.unprotectSheet = function (sheet) {\n        var args = { sheet: sheet };\n        this.notify(events.unprotectsheetHandler, args);\n    };\n    /**\n     * Sorts the range of cells in the active Spreadsheet.\n     *\n     * @param {SortOptions} sortOptions - options for sorting.\n     * @param {string} range - address of the data range.\n     * @returns {Promise<SortEventArgs>} - Sorts the range of cells in the active Spreadsheet.\n     */\n    Workbook.prototype.sort = function (sortOptions, range) {\n        if (!this.allowSorting) {\n            return Promise.reject();\n        }\n        var eventArgs = {\n            range: range || this.getActiveSheet().selectedRange,\n            sortOptions: sortOptions || { sortDescriptors: {} },\n            cancel: false\n        };\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        var sortArgs = { args: eventArgs, promise: promise };\n        this.notify(events.initiateSort, sortArgs);\n        return sortArgs.promise;\n    };\n    Workbook.prototype.addDataValidation = function (rules, range) {\n        range = range ? range : this.getActiveSheet().selectedRange;\n        var eventArgs = {\n            range: range, type: rules.type, operator: rules.operator, value1: rules.value1,\n            value2: rules.value2, ignoreBlank: rules.ignoreBlank, inCellDropDown: rules.inCellDropDown, cancel: false\n        };\n        this.notify(beginAction, { eventArgs: eventArgs, action: 'validation' });\n        if (!eventArgs.cancel) {\n            range = eventArgs.range;\n            rules.type = eventArgs.type;\n            rules.operator = eventArgs.operator;\n            rules.value1 = eventArgs.value1;\n            rules.value2 = eventArgs.value2;\n            rules.ignoreBlank = eventArgs.ignoreBlank;\n            rules.inCellDropDown = eventArgs.inCellDropDown;\n            this.notify(events.setValidation, { rules: rules, range: range });\n            delete eventArgs.cancel;\n            this.notify(completeAction, { eventArgs: eventArgs, action: 'validation' });\n        }\n    };\n    Workbook.prototype.removeDataValidation = function (range) {\n        this.notify(events.removeValidation, { range: range });\n    };\n    Workbook.prototype.addInvalidHighlight = function (range) {\n        this.notify(events.addHighlight, { range: range });\n    };\n    Workbook.prototype.removeInvalidHighlight = function (range) {\n        this.notify(events.removeHighlight, { range: range });\n    };\n    Workbook.prototype.conditionalFormat = function (conditionalFormat) {\n        conditionalFormat.range = conditionalFormat.range || this.getActiveSheet().selectedRange;\n        this.notify(events.setCFRule, { conditionalFormat: conditionalFormat });\n    };\n    Workbook.prototype.clearConditionalFormat = function (range) {\n        range = range || this.getActiveSheet().selectedRange;\n        this.notify(events.clearCFRule, { range: range });\n    };\n    /**\n     * To update a cell properties.\n     *\n     * @param {CellModel} cell - Cell properties.\n     * @param {string} address - Address to update.\n     * @returns {void} - To update a cell properties\n     * {% codeBlock src='spreadsheet/updateCell/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.updateCell = function (cell, address) {\n        var sheetIdx;\n        var range = getIndexesFromAddress(address);\n        if (address.includes('!')) {\n            sheetIdx = getSheetIndex(this, address.split('!')[0]);\n            if (sheetIdx === undefined) {\n                sheetIdx = this.activeSheetIndex;\n            }\n        }\n        else {\n            sheetIdx = this.activeSheetIndex;\n        }\n        setCell(range[0], range[1], this.sheets[sheetIdx], cell, true);\n        if (cell.value || cell.value === '') {\n            this.notify(events.workbookEditOperation, {\n                action: 'updateCellValue', address: range, value: cell.value,\n                sheetIndex: sheetIdx\n            });\n        }\n        this.notify(updateView, { indexes: range, sheetIndex: sheetIdx });\n    };\n    /**\n     * Used to get a row data from the data source with updated cell value.\n     *\n     * @param {number} index? - Specifies the row index.\n     * @param {number} sheetIndex? - Specifies the sheet index. By default, it consider the active sheet index.\n     * @returns {Object[]} - Return row data.\n     * {% codeBlock src='spreadsheet/getRowData/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.getRowData = function (index, sheetIndex) {\n        if (isNullOrUndefined(index)) {\n            index = 0;\n        }\n        if (isNullOrUndefined(sheetIndex)) {\n            sheetIndex = this.activeSheetIndex;\n        }\n        var eventArgs = { sheetIdx: sheetIndex, startIndex: index, modelType: 'Row', isDataRequest: true };\n        this.notify(dataChanged, eventArgs);\n        return eventArgs.data;\n    };\n    /**\n     * This method is used to wrap/unwrap the text content of the cell.\n     *\n     * {% codeBlock src='spreadsheet/wrap/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} address - Address of the cell to be wrapped.\n     * @param {boolean} wrap - Set `false` if the text content of the cell to be unwrapped.\n     * @returns {void} - To wrap/unwrap the text content of the cell.\n     * {% codeBlock src='spreadsheet/wrap/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.wrap = function (address, wrap) {\n        if (wrap === void 0) { wrap = true; }\n        wrapText(address, wrap, this);\n    };\n    /**\n     * Adds the defined name to the Spreadsheet.\n     *\n     * @param {DefineNameModel} definedName - Specifies the name.\n     * @returns {boolean} - Return the added status of the defined name.\n     * {% codeBlock src='spreadsheet/addDefinedName/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.addDefinedName = function (definedName) {\n        var eventArgs = {\n            action: 'addDefinedName',\n            isAdded: false,\n            definedName: definedName\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n        return eventArgs.isAdded;\n    };\n    /**\n     * Removes the defined name from the Spreadsheet.\n     *\n     * @param {string} definedName - Specifies the name.\n     * @param {string} scope - Specifies the scope of the defined name.\n     * @returns {boolean} - Return the removed status of the defined name.\n     * {% codeBlock src='spreadsheet/removeDefinedName/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.removeDefinedName = function (definedName, scope) {\n        if (scope === void 0) { scope = ''; }\n        var eventArgs = {\n            action: 'removeDefinedName',\n            isRemoved: false,\n            definedName: definedName,\n            scope: scope\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n        return eventArgs.isRemoved;\n    };\n    /** @hidden\n     * @param {string} address - Specifies the address.\n     * @param {number} sheetIndex - Specifies the sheetIndex.\n     * @param {boolean} valueOnly - Specifies the bool value.\n     * @returns {void} - To clear range.\n     */\n    Workbook.prototype.clearRange = function (address, sheetIndex, valueOnly) {\n        if (valueOnly === void 0) { valueOnly = true; }\n        clearRange(this, address || this.getActiveSheet().selectedRange, isNullOrUndefined(sheetIndex) ? this.activeSheetIndex : sheetIndex, valueOnly);\n    };\n    /**\n     * Used to set the image in spreadsheet.\n     *\n     * @param {ImageModel} images - Specifies the options to insert image in spreadsheet.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns {void} - To set the image in spreadsheet.\n     */\n    Workbook.prototype.insertImage = function (images, range) {\n        this.notify(setImage, { options: images, range: range ? range : this.getActiveSheet().selectedRange });\n    };\n    /**\n     * Used to set the chart in spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/insertChart/index.md' %}{% endcodeBlock %}\n     *\n     * @param {ChartModel} chart - Specifies the options to insert chart in spreadsheet.\n     * @returns {void} - To set the chart in spreadsheet.\n     */\n    Workbook.prototype.insertChart = function (chart) {\n        this.notify(setChart, { chart: chart });\n    };\n    /**\n     * Used to delete the chart from spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/deleteChart/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} id - Specifies the chart element id.\n     * @returns {void} - To delete the chart from spreadsheet.\n     */\n    Workbook.prototype.deleteChart = function (id) {\n        this.notify(deleteChart, { id: id });\n    };\n    /**\n     * Filters the range of cells in the sheet.\n     *\n     * @param {FilterOptions} filterOptions - Specifies the filterOptions\n     * @param {string} range - Specifies the range\n     * @returns {Promise<FilterEventArgs>} - To Filters the range of cells in the sheet.\n     */\n    Workbook.prototype.filter = function (filterOptions, range) {\n        if (!this.allowFiltering) {\n            return Promise.reject();\n        }\n        var eventArgs = {\n            range: range || this.getActiveSheet().selectedRange,\n            filterOptions: filterOptions,\n            cancel: false\n        };\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        var filterArgs = { args: eventArgs, promise: promise };\n        this.notify(events.initiateFilter, filterArgs);\n        return filterArgs.promise;\n    };\n    /**\n     * Clears the filter changes of the sheet.\n     * {% codeBlock src='spreadsheet/clearFilter/index.md' %}{% endcodeBlock %}\n     *\n     * @returns {void}\n     */\n    Workbook.prototype.clearFilter = function () {\n        this.notify(events.clearAllFilter, null);\n    };\n    /**\n     * To add custom library function.\n     *\n     * @param {string} functionHandler - Custom function handler name\n     * @param {string} functionName - Custom function name\n     * {% codeBlock src='spreadsheet/addCustomFunction/index.md' %}{% endcodeBlock %}\n     * @returns {void} - To add custom library function.\n     */\n    Workbook.prototype.addCustomFunction = function (functionHandler, functionName) {\n        functionName = functionName ? functionName : typeof functionHandler === 'string' ? functionHandler :\n            functionHandler.name.replace('bound ', '');\n        var eventArgs = {\n            action: 'addCustomFunction',\n            functionHandler: functionHandler,\n            functionName: functionName\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n    };\n    /**\n     * This method is used to Clear contents, formats and hyperlinks in spreadsheet.\n     *\n     * @param {ClearOptions} options - Options for clearing the content, formats and hyperlinks in spreadsheet.\n     * @returns {void} - To Clear contents, formats and hyperlinks.\n     */\n    Workbook.prototype.clear = function (options) {\n        this.notify(events.clear, options);\n    };\n    /**\n     * Gets the formatted text of the cell.\n     *\n     * @param {CellModel} cell - Specifies the cell.\n     * {% codeBlock src='spreadsheet/getDisplayText/index.md' %}{% endcodeBlock %}\n     * @returns {string} - To get Display Text.\n     */\n    Workbook.prototype.getDisplayText = function (cell) {\n        if (!cell) {\n            return '';\n        }\n        if (cell.format && !isNullOrUndefined(cell.value)) {\n            var eventArgs = {\n                formattedText: cell.value, value: cell.value, format: cell.format, onLoad: true\n            };\n            this.notify(events.getFormattedCellObject, eventArgs);\n            return eventArgs.formattedText;\n        }\n        else if (!cell.value && cell.hyperlink) {\n            return typeof cell.hyperlink === 'string' ? cell.hyperlink : cell.hyperlink.address;\n        }\n        else {\n            return cell.value || typeof cell.value === 'number' ? cell.value.toString() : '';\n        }\n    };\n    /**\n     * This method is used to freeze rows and columns after the specified cell in the Spreadsheet.\n     *\n     * @param {number} row - Specifies the freezed row count.\n     * @param {number} column - Specifies the freezed column count.\n     * @param {number | string} sheet - Specifies the sheet name or index in which the freeze operation will perform. By default,\n     * active sheet will be considered.\n     * {% codeBlock src='spreadsheet/freezePanes/index.md' %}{% endcodeBlock %}\n     * @returns {void}\n     */\n    Workbook.prototype.freezePanes = function (row, column, sheet) {\n        if (row === void 0) { row = 1; }\n        if (column === void 0) { column = 1; }\n        var model = this.getSheetModel(sheet);\n        if (model.frozenRows === row && model.frozenColumns === column) {\n            return;\n        }\n        this.setSheetPropertyOnMute(model, 'frozenRows', row);\n        this.setSheetPropertyOnMute(model, 'frozenColumns', column);\n        this.updateTopLeftCell();\n        if (model.name === this.getActiveSheet().name) {\n            this.notify(events.dataRefresh, null);\n        }\n    };\n    /**\n     * This method is used to unfreeze the frozen rows and columns from the active sheet.\n     *\n     * @param {number | string} sheet - Specifies the sheet name or index in which the unfreeze operation will perform. By default,\n     * active sheet will be considered.\n     * {% codeBlock src='spreadsheet/unfreezePanes/index.md' %}{% endcodeBlock %}\n     * @returns {void}\n     */\n    Workbook.prototype.Unfreeze = function (sheet) {\n        this.freezePanes(0, 0, sheet);\n    };\n    /**\n     * @param {number} top - Specifies the top.\n     * @param {number} left - Specifies the fleft.\n     * @param {string} model - Specifies the model.\n     * @param {SheetModel} sheet - Specifies the sheet.\n     * @returns {void}\n     * @hidden\n     */\n    Workbook.prototype.updateTopLeftCell = function (top, left, model, sheet) {\n        if (!sheet) {\n            sheet = this.getActiveSheet();\n        }\n        var indexes = getCellIndexes(sheet.topLeftCell);\n        if (sheet.frozenRows || sheet.frozenColumns) {\n            if (isNullOrUndefined(top)) {\n                top = sheet.frozenRows ? 0 : indexes[0];\n            }\n            if (isNullOrUndefined(left)) {\n                left = sheet.frozenColumns ? 0 : indexes[1];\n            }\n            top += this.frozenRowCount(sheet);\n            left += this.frozenColCount(sheet);\n            if (model) {\n                if (model === 'row') {\n                    top = getCellIndexes(sheet.paneTopLeftCell)[0];\n                }\n                else {\n                    left = getCellIndexes(sheet.paneTopLeftCell)[1];\n                }\n            }\n            this.setSheetPropertyOnMute(sheet, 'paneTopLeftCell', getCellAddress(top, left));\n            if (sheet.frozenRows) {\n                top = indexes[0];\n            }\n            if (sheet.frozenColumns) {\n                left = indexes[1];\n            }\n        }\n        else {\n            if (isNullOrUndefined(top)) {\n                top = indexes[0];\n            }\n            if (isNullOrUndefined(left)) {\n                left = indexes[1];\n            }\n            this.setSheetPropertyOnMute(sheet, 'paneTopLeftCell', getCellAddress(top, left));\n        }\n        this.setSheetPropertyOnMute(sheet, 'topLeftCell', getCellAddress(top, left));\n    };\n    /**\n     * @hidden\n     * @param {string} address - Specifies the address.\n     * @returns {number | number[]} - To get address info.\n     */\n    Workbook.prototype.getAddressInfo = function (address) {\n        return getAddressInfo(this, address);\n    };\n    /**\n     * @hidden\n     * @param {SheetModel} sheet - Specifies the sheet.\n     * @param {string} prop - Specifies the prop.\n     * @param {Object} value - Specifies the value.\n     * @returns {void} - To set sheet properties.\n     */\n    Workbook.prototype.setSheetPropertyOnMute = function (sheet, prop, value) {\n        this.isProtectedOnChange = true;\n        sheet[prop] = value;\n        this.isProtectedOnChange = false;\n    };\n    /**\n     * To get frozen row count from top index.\n     *\n     * @hidden\n     * @param {SheetModel} sheet - Specifies the sheet.\n     * @returns {number} - to get the frozen count.\n     */\n    Workbook.prototype.frozenRowCount = function (sheet) {\n        return sheet.frozenRows ? (sheet.topLeftCell === 'A1' ? sheet.frozenRows : getCellIndexes(sheet.topLeftCell)[0] + sheet.frozenRows)\n            : 0;\n    };\n    /**\n     * To get frozen column count from left index.\n     *\n     * @hidden\n     * @param {SheetModel} sheet - Specifies the sheet.\n     * @returns {number} - to get the frozen count.\n     */\n    Workbook.prototype.frozenColCount = function (sheet) {\n        return sheet.frozenColumns ? (sheet.topLeftCell === 'A1' ? sheet.frozenColumns : getCellIndexes(sheet.topLeftCell)[1] +\n            sheet.frozenColumns) : 0;\n    };\n    var Workbook_1;\n    __decorate([\n        Collection([], Sheet)\n    ], Workbook.prototype, \"sheets\", void 0);\n    __decorate([\n        Property(0)\n    ], Workbook.prototype, \"activeSheetIndex\", void 0);\n    __decorate([\n        Property('100%')\n    ], Workbook.prototype, \"height\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowFindAndReplace\", void 0);\n    __decorate([\n        Property()\n    ], Workbook.prototype, \"filterCollection\", void 0);\n    __decorate([\n        Property()\n    ], Workbook.prototype, \"sortCollection\", void 0);\n    __decorate([\n        Property('100%')\n    ], Workbook.prototype, \"width\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showRibbon\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showFormulaBar\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showSheetTabs\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowEditing\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowOpen\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowSave\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowSorting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowFiltering\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowNumberFormatting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowCellFormatting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowHyperlink\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowInsert\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowDelete\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowMerge\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowDataValidation\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowImage\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowChart\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowConditionalFormat\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Workbook.prototype, \"cellStyle\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"openUrl\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"saveUrl\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"password\", void 0);\n    __decorate([\n        Property(false)\n    ], Workbook.prototype, \"isProtected\", void 0);\n    __decorate([\n        Collection([], DefineName)\n    ], Workbook.prototype, \"definedNames\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"openFailure\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeSave\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"saveComplete\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeCellFormat\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"queryCellInfo\", void 0);\n    Workbook = Workbook_1 = __decorate([\n        NotifyPropertyChanges\n    ], Workbook);\n    return Workbook;\n}(Component));\nexport { Workbook };\n","import { detach, EventHandler, Browser, isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getCell, setCell, getSheet, getSwapRange, inRange } from '../../workbook/index';\nimport { getRangeAddress, workbookEditOperation, getSheetIndexFromId, getSheetName } from '../../workbook/index';\nimport { getFormattedCellObject, workbookFormulaOperation, checkIsFormula, mergedRange } from '../../workbook/index';\nimport { pasteMerge, setMerge, getCellIndexes, getCellAddress } from '../../workbook/index';\nimport { ribbonClick, cut, copy, paste, initiateFilterUI, focus, setPosition, isLockedCells } from '../common/index';\nimport { hasTemplate, getTextHeightWithBorder, getLines, getExcludedColumnWidth, editAlert } from '../common/index';\nimport { enableToolbarItems, rowHeightChanged, completeAction, beginAction } from '../common/index';\nimport { clearCopy, selectRange, dialog, contentLoaded, tabSwitch, cMenuBeforeOpen, locale, createImageElement } from '../common/index';\nimport { getMaxHgt, setMaxHgt, setRowEleHeight, deleteImage, getRowIdxFromClientY, getColIdxFromClientX } from '../common/index';\nimport { Deferred } from '@syncfusion/ej2-data';\nimport { refreshRibbonIcons, refreshClipboard, getColumn, isLocked as isCellLocked } from '../../workbook/index';\nimport { getFilteredCollection, setChart, parseIntValue, isSingleCell, activeCellMergedRange, getRowsHeight } from '../../workbook/index';\nimport { getUpdatedFormula } from '../../workbook/index';\n/**\n * Represents clipboard support for Spreadsheet.\n */\nvar Clipboard = /** @class */ (function () {\n    function Clipboard(parent) {\n        this.parent = parent;\n        this.init();\n        this.addEventListener();\n    }\n    Clipboard.prototype.init = function () {\n        this.parent.element\n            .appendChild(this.parent.createElement('input', { className: 'e-clipboard', attrs: { 'contenteditable': 'true' } }));\n    };\n    Clipboard.prototype.addEventListener = function () {\n        var ele = this.getClipboardEle();\n        this.parent.on(cut, this.cut, this);\n        this.parent.on(copy, this.copy, this);\n        this.parent.on(paste, this.paste, this);\n        this.parent.on(clearCopy, this.clearCopiedInfo, this);\n        this.parent.on(tabSwitch, this.tabSwitchHandler, this);\n        this.parent.on(cMenuBeforeOpen, this.cMenuBeforeOpenHandler, this);\n        this.parent.on(ribbonClick, this.ribbonClickHandler, this);\n        this.parent.on(contentLoaded, this.initCopyIndicator, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChanged, this);\n        this.parent.on(refreshClipboard, this.refreshOnInsertDelete, this);\n        EventHandler.add(ele, 'cut', this.cut, this);\n        EventHandler.add(ele, 'copy', this.copy, this);\n        EventHandler.add(ele, 'paste', this.paste, this);\n    };\n    Clipboard.prototype.removeEventListener = function () {\n        var ele = this.getClipboardEle();\n        if (!this.parent.isDestroyed) {\n            this.parent.off(cut, this.cut);\n            this.parent.off(copy, this.copy);\n            this.parent.off(paste, this.paste);\n            this.parent.off(clearCopy, this.clearCopiedInfo);\n            this.parent.off(tabSwitch, this.tabSwitchHandler);\n            this.parent.off(cMenuBeforeOpen, this.cMenuBeforeOpenHandler);\n            this.parent.off(ribbonClick, this.ribbonClickHandler);\n            this.parent.off(contentLoaded, this.initCopyIndicator);\n            this.parent.off(rowHeightChanged, this.rowHeightChanged);\n            this.parent.off(refreshClipboard, this.refreshOnInsertDelete);\n        }\n        EventHandler.remove(ele, 'cut', this.cut);\n        EventHandler.remove(ele, 'copy', this.copy);\n        EventHandler.remove(ele, 'paste', this.paste);\n    };\n    Clipboard.prototype.ribbonClickHandler = function (args) {\n        var parentId = this.parent.element.id;\n        switch (args.item.id) {\n            case parentId + '_cut':\n                this.cut({ isAction: true });\n                break;\n            case parentId + '_copy':\n                this.copy({ isAction: true });\n                break;\n        }\n        focus(this.parent.element);\n    };\n    Clipboard.prototype.tabSwitchHandler = function (args) {\n        if (args.activeTab === 0 && !this.copiedInfo && !this.copiedShapeInfo) {\n            this.hidePaste();\n        }\n    };\n    Clipboard.prototype.cMenuBeforeOpenHandler = function (e) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var delRowItems = [];\n        var hideRowItems = [];\n        var delColItems = [];\n        var hideColItems = [];\n        var actCell = sheet.activeCell;\n        var actCellIndex = getCellIndexes(actCell);\n        var cellObj = getCell(actCellIndex[0], actCellIndex[1], sheet);\n        var isLocked = sheet.isProtected && isCellLocked(cellObj, getColumn(sheet, actCellIndex[1]));\n        if (e.target === 'Content' || e.target === 'RowHeader' || e.target === 'ColumnHeader') {\n            this.parent.enableContextMenuItems([l10n.getConstant('Paste'), l10n.getConstant('PasteSpecial')], (this.copiedInfo ||\n                this.copiedShapeInfo && !isLocked) ? true : false);\n            this.parent.enableContextMenuItems([l10n.getConstant('Cut')], (!isLocked) ? true : false);\n        }\n        if ((e.target === 'Content') && isLocked) {\n            this.parent.enableContextMenuItems([l10n.getConstant('Cut'), l10n.getConstant('Filter'), l10n.getConstant('Sort')], false);\n        }\n        if ((e.target === 'Content') && (isLocked && !sheet.protectSettings.insertLink)) {\n            this.parent.enableContextMenuItems([l10n.getConstant('Hyperlink')], false);\n        }\n        if (e.target === 'ColumnHeader' && sheet.isProtected) {\n            delColItems = [l10n.getConstant('DeleteColumn'), l10n.getConstant('DeleteColumns'),\n                l10n.getConstant('InsertColumn'), l10n.getConstant('InsertColumns')];\n            hideColItems = [l10n.getConstant('HideColumn'), l10n.getConstant('HideColumns'),\n                l10n.getConstant('UnHideColumns')];\n            this.parent.enableContextMenuItems(delColItems, false);\n            this.parent.enableContextMenuItems(hideColItems, (sheet.protectSettings.formatColumns) ? true : false);\n        }\n        if (e.target === 'RowHeader' && sheet.isProtected) {\n            delRowItems = [l10n.getConstant('DeleteRow'), l10n.getConstant('DeleteRows'),\n                l10n.getConstant('InsertRow'), l10n.getConstant('InsertRows')];\n            hideRowItems = [l10n.getConstant('HideRow'), l10n.getConstant('HideRows'), l10n.getConstant('UnHideRows')];\n            this.parent.enableContextMenuItems(delRowItems, false);\n            this.parent.enableContextMenuItems(hideRowItems, (sheet.protectSettings.formatRows) ? true : false);\n        }\n    };\n    Clipboard.prototype.rowHeightChanged = function (args) {\n        if (this.copiedInfo && this.copiedInfo.range[0] > args.rowIdx) {\n            var ele = this.parent.element.getElementsByClassName('e-copy-indicator')[0];\n            if (ele) {\n                ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n            }\n        }\n    };\n    Clipboard.prototype.cut = function (args) {\n        this.setCopiedInfo(args, true);\n    };\n    Clipboard.prototype.copy = function (args) {\n        this.setCopiedInfo(args, false);\n    };\n    Clipboard.prototype.paste = function (args) {\n        if (this.parent.isEdit || this.parent.element.getElementsByClassName('e-dialog').length > 0) {\n            return;\n        }\n        var rfshRange;\n        args.isAction = true;\n        var isExternal = ((args && args.clipboardData) || window['clipboardData']);\n        var copiedIdx = this.getCopiedIdx();\n        var isCut;\n        var copyInfo = Object.assign({ isExternal: isExternal }, this.copiedInfo);\n        if (isExternal || this.copiedShapeInfo || (args.isInternal && this.copiedInfo)) {\n            var cSIdx = (args && args.sIdx > -1) ? args.sIdx : this.parent.activeSheetIndex;\n            var curSheet = getSheet(this.parent, cSIdx);\n            var selIdx = getSwapRange(args && args.range || getRangeIndexes(curSheet.selectedRange));\n            var rows = isExternal && this.getExternalCells(args);\n            if (!args.isInternal && rows && rows.internal) {\n                isExternal = false;\n                if (!this.copiedInfo) {\n                    return;\n                }\n            }\n            if (isExternal && !rows.length) { // If image pasted\n                return;\n            }\n            var cellLength = 0;\n            if (rows) {\n                for (var i = 0; i < rows.length; i++) {\n                    cellLength = rows[i].cells.length > cellLength ? rows[i].cells.length : cellLength;\n                }\n            }\n            var rowIdx = selIdx[0];\n            var cIdx = isExternal\n                ? [0, 0, rows.length - 1, cellLength - 1] : getSwapRange(this.copiedShapeInfo ?\n                getRangeIndexes(curSheet.selectedRange) : this.copiedInfo.range);\n            var isRepeative = (selIdx[2] - selIdx[0] + 1) % (cIdx[2] - cIdx[0] + 1) === 0\n                && (selIdx[3] - selIdx[1] + 1) % (cIdx[3] - cIdx[1] + 1) === 0;\n            rfshRange = isRepeative ? selIdx : [selIdx[0], selIdx[1]]\n                .concat([selIdx[0] + cIdx[2] - cIdx[0], selIdx[1] + cIdx[3] - cIdx[1] || selIdx[1]]);\n            var beginEventArgs = {\n                requestType: 'paste',\n                copiedInfo: this.copiedInfo,\n                copiedRange: getRangeAddress(cIdx),\n                pastedRange: getRangeAddress(rfshRange),\n                type: (args && args.type) || 'All',\n                cancel: false\n            };\n            if (args.isAction && !this.copiedShapeInfo) {\n                this.parent.notify(beginAction, { eventArgs: beginEventArgs, action: 'clipboard' });\n            }\n            if (beginEventArgs.cancel) {\n                return;\n            }\n            var cell = void 0;\n            var isExtend = void 0;\n            var prevCell = void 0;\n            var mergeCollection = [];\n            var prevSheet = getSheet(this.parent, isExternal ? cSIdx : copiedIdx);\n            var notRemoveMerge = isSingleCell(cIdx) && this.isRangeMerged(selIdx, curSheet);\n            selIdx = getRangeIndexes(beginEventArgs.pastedRange);\n            rowIdx = selIdx[0];\n            cIdx = isExternal\n                ? [0, 0, rows.length - 1, cellLength - 1] : getSwapRange(this.copiedShapeInfo ?\n                getRangeIndexes(curSheet.selectedRange) : this.copiedInfo.range);\n            isRepeative = (selIdx[2] - selIdx[0] + 1) % (cIdx[2] - cIdx[0] + 1) === 0 && (selIdx[3] - selIdx[1] + 1) %\n                (cIdx[3] - cIdx[1] + 1) === 0 && !notRemoveMerge;\n            var mergeArgs = {\n                range: cIdx, prevSheet: prevSheet, cancel: false\n            };\n            rfshRange = isRepeative ? selIdx : [selIdx[0], selIdx[1]]\n                .concat([selIdx[0] + cIdx[2] - cIdx[0], selIdx[1] + cIdx[3] - cIdx[1] || selIdx[1]]);\n            var isLockCell = this.parent.getActiveSheet().isProtected && isLockedCells(this.parent, rfshRange);\n            if (isLockCell) {\n                this.parent.notify(editAlert, null);\n                return;\n            }\n            if (this.copiedShapeInfo && !this.copiedInfo) {\n                var pictureElem = this.copiedShapeInfo.pictureElem;\n                if (pictureElem.classList.contains('e-datavisualization-chart')) {\n                    this.copiedShapeInfo.chartInfo.top = null;\n                    this.copiedShapeInfo.chartInfo.left = null;\n                    this.parent.notify(setChart, {\n                        chart: [this.copiedShapeInfo.chartInfo], isInitCell: true, isUndoRedo: true, isPaste: true,\n                        dataSheetIdx: this.copiedShapeInfo.sheetIdx, isCut: this.copiedShapeInfo.isCut,\n                        range: args.range || curSheet.selectedRange, isIdAvailabe: false\n                    });\n                }\n                else {\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            src: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: this.copiedShapeInfo.height, width: this.copiedShapeInfo.width,\n                            imageId: this.copiedShapeInfo.isCut ? pictureElem.id : ''\n                        },\n                        range: getRangeAddress([rowIdx, selIdx[1], rowIdx, selIdx[1]]), isPublic: false, isUndoRedo: true\n                    });\n                }\n                var pastedCell = getCell(rowIdx, selIdx[1], curSheet);\n                if (pastedCell && !isNullOrUndefined(pastedCell.image)) {\n                    var imgLen = pastedCell.image ? pastedCell.image.length - 1 : 0;\n                    var eventArgs = {\n                        requestType: 'imagePaste',\n                        copiedShapeInfo: this.copiedShapeInfo,\n                        pasteSheetIndex: this.parent.activeSheetIndex,\n                        pastedRange: getSheetName(this.parent) + '!' + getRangeAddress([rowIdx, selIdx[1], rowIdx, selIdx[1]]),\n                        pastedPictureElement: document.getElementById(pastedCell.image[imgLen].id)\n                    };\n                    this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clipboard' });\n                }\n            }\n            else {\n                this.parent.notify(pasteMerge, mergeArgs);\n                if (mergeArgs.cancel) {\n                    return;\n                }\n                var pasteType = beginEventArgs.type ? beginEventArgs.type : args.type;\n                var cRows = [];\n                var isInRange = this.isInRange(cIdx, selIdx, copiedIdx);\n                var isRowSelected = (selIdx[1] === 0 && selIdx[3] === curSheet.colCount - 1);\n                for (var i = cIdx[0], l = 0; i <= cIdx[2]; i++, l++) {\n                    if (isInRange) {\n                        cRows[selIdx[0] + l] = { cells: [] };\n                    }\n                    for (var j = cIdx[1], k = 0; j <= cIdx[3]; j++, k++) {\n                        if (isInRange) {\n                            cRows[selIdx[0] + l].cells[selIdx[1] + k] = getCell(selIdx[0] + l, selIdx[1] + k, prevSheet);\n                        }\n                        cell = isExternal ? rows[i].cells[j] : extend({}, (isInRange && cRows[i] && cRows[i].cells[j])\n                            ? cRows[i].cells[j] : getCell(i, j, prevSheet), null, true);\n                        if (cell && args && args.type || pasteType) {\n                            switch (pasteType) {\n                                case 'Formats':\n                                    cell = { format: cell.format, style: cell.style };\n                                    break;\n                                case 'Values':\n                                    cell = { value: cell.value };\n                                    if (cell.value && cell.value.toString().indexOf('\\n') > -1) {\n                                        var ele = this.parent.getCell(selIdx[0], selIdx[1]);\n                                        ele.classList.add('e-alt-unwrap');\n                                    }\n                                    break;\n                            }\n                            isExtend = ['Formats', 'Values'].indexOf(args.type) > -1;\n                        }\n                        if ((!this.parent.scrollSettings.isFinite && (cIdx[2] - cIdx[0] > (1048575 - selIdx[0])\n                            || cIdx[3] - cIdx[1] > (16383 - selIdx[1])))\n                            || (this.parent.scrollSettings.isFinite && (cIdx[2] - cIdx[0] > (curSheet.rowCount - 1 - selIdx[0])\n                                || cIdx[3] - cIdx[1] > (curSheet.colCount - 1 - selIdx[1])))) {\n                            this.showDialog();\n                            return;\n                        }\n                        var conditionalFormats = this.getConditionalFormats(i, j, prevSheet);\n                        if (isRepeative) {\n                            for (var x = selIdx[0]; x <= selIdx[2]; x += (cIdx[2] - cIdx[0]) + 1) {\n                                var toSkip = false;\n                                if (!copyInfo.isCut && this.parent.filteredRows && this.parent.filteredRows.rowIdxColl &&\n                                    this.parent.filteredRows.sheetIdxColl) {\n                                    for (var i_1 = 0, len = this.parent.filteredRows.sheetIdxColl.length; i_1 < len; i_1++) {\n                                        if (this.parent.filteredRows.sheetIdxColl[i_1] === cSIdx && this.parent.filteredRows.rowIdxColl[i_1] ===\n                                            x + l) {\n                                            toSkip = true;\n                                            break;\n                                        }\n                                    }\n                                }\n                                if (toSkip) {\n                                    continue;\n                                }\n                                for (var y = selIdx[1]; y <= selIdx[3]; y += (cIdx[3] - cIdx[1] + 1)) {\n                                    prevCell = getCell(x + l, y + k, curSheet) || {};\n                                    if (!isExternal && (prevCell.colSpan !== undefined || prevCell.rowSpan !== undefined)) {\n                                        if (isRowSelected) {\n                                            continue;\n                                        }\n                                        mergeArgs = { range: [x + l, y + k, x + l, y + k] };\n                                        var merge = { range: mergeArgs.range, merge: false, isAction: false, type: 'All' };\n                                        mergeCollection.push(merge);\n                                        if (this.parent.activeSheetIndex === curSheet.index) {\n                                            this.parent.notify(setMerge, merge);\n                                        }\n                                    }\n                                    var colInd = y + k;\n                                    cell = extend({}, cell ? cell : {}, null, true);\n                                    if (!isExtend) {\n                                        var newFormula = getUpdatedFormula([x + l, colInd], [i, j], prevSheet);\n                                        if (!isNullOrUndefined(newFormula)) {\n                                            cell.formula = newFormula;\n                                        }\n                                    }\n                                    this.setConditionalFormats(conditionalFormats, x + l, colInd, curSheet);\n                                    if (this.parent.getActiveSheet().isProtected && cell &&\n                                        (isNullOrUndefined(cell.isLocked) || cell.isLocked === true)) {\n                                        cell.isLocked = prevCell.isLocked;\n                                    }\n                                    this.setCell(x + l, colInd, curSheet, cell, isExtend, false, conditionalFormats.length ? true\n                                        : y === selIdx[3], isExternal);\n                                    var sId = this.parent.activeSheetIndex;\n                                    var cellElem = this.parent.getCell(x + l, colInd);\n                                    var address = getCellAddress(x + l, colInd);\n                                    var cellArgs = {\n                                        address: this.parent.sheets[sId].name + '!' + address,\n                                        requestType: 'paste',\n                                        value: getCell(x + l, colInd, curSheet) ? getCell(x + l, colInd, curSheet).value : '',\n                                        oldValue: prevCell.value,\n                                        element: cellElem,\n                                        displayText: this.parent.getDisplayText(cell)\n                                    };\n                                    this.parent.trigger('cellSave', cellArgs);\n                                }\n                            }\n                        }\n                        else {\n                            if (isExternal || !hasTemplate(this.parent, i, j, copiedIdx)) {\n                                if (notRemoveMerge) {\n                                    this.setCell(rowIdx, selIdx[1] + k, curSheet, { value: cell.value }, true, false, j === cIdx[3]);\n                                }\n                                else {\n                                    this.setCell(rowIdx, selIdx[1] + k, curSheet, cell, isExtend, false, j === cIdx[3]);\n                                }\n                            }\n                        }\n                        if (!isExternal && this.copiedInfo.isCut && !(inRange(selIdx, i, j) &&\n                            copiedIdx === this.parent.activeSheetIndex)) {\n                            var cell_1 = getCell(i, j, prevSheet);\n                            if (cell_1) {\n                                if (cell_1.isLocked || isNullOrUndefined(cell_1.isLocked)) {\n                                    cell_1 = null;\n                                }\n                                else if (cell_1.isLocked === false) {\n                                    if (this.parent.getActiveSheet().isProtected) {\n                                        cell_1 = { isLocked: false };\n                                    }\n                                    else {\n                                        cell_1 = null;\n                                    }\n                                }\n                            }\n                            this.setCell(i, j, prevSheet, cell_1, false, true, j === cIdx[3]);\n                        }\n                    }\n                    rowIdx++;\n                }\n                this.parent.notify(refreshRibbonIcons, null);\n                this.parent.setUsedRange(rfshRange[2] + 1, rfshRange[3]);\n                if (cSIdx === this.parent.activeSheetIndex) {\n                    this.parent.notify(selectRange, { address: getRangeAddress(rfshRange) });\n                }\n                if (!isExternal && this.copiedInfo.isCut) {\n                    isCut = this.copiedInfo.isCut;\n                    if (copiedIdx === this.parent.activeSheetIndex) {\n                        this.parent.serviceLocator.getService('cell').refreshRange(cIdx);\n                    }\n                    this.clearCopiedInfo();\n                }\n                if ((isExternal || isInRange) && this.copiedInfo) {\n                    this.clearCopiedInfo();\n                }\n                if (isExternal || (args && args.isAction)) {\n                    focus(this.parent.element);\n                }\n                if (args.isAction) {\n                    var sheetIndex = copyInfo && copyInfo.sId ? getSheetIndexFromId(this.parent, copyInfo.sId) :\n                        this.parent.activeSheetIndex;\n                    var eventArgs = {\n                        requestType: 'paste',\n                        copiedInfo: copyInfo,\n                        mergeCollection: mergeCollection,\n                        pasteSheetIndex: this.parent.activeSheetIndex,\n                        copiedRange: this.parent.sheets[sheetIndex].name + '!' + getRangeAddress(copyInfo && copyInfo.range ?\n                            copyInfo.range : getRangeIndexes(this.parent.sheets[sheetIndex].selectedRange)),\n                        pastedRange: getSheetName(this.parent) + '!' + getRangeAddress(rfshRange),\n                        type: pasteType || 'All'\n                    };\n                    this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clipboard' });\n                }\n                if (isCut) {\n                    this.updateFilter(copyInfo, rfshRange);\n                    setMaxHgt(prevSheet, cIdx[0], cIdx[1], this.parent.getCell(cIdx[0], cIdx[1]).offsetHeight);\n                    var hgt = getMaxHgt(prevSheet, cIdx[0]);\n                    setRowEleHeight(this.parent, prevSheet, hgt, cIdx[0]);\n                }\n                var copySheet = getSheet(this.parent, copiedIdx);\n                if (!isExternal && cIdx[0] === cIdx[2] && (cIdx[3] - cIdx[1]) === copySheet.colCount - 1) {\n                    var hgt = copySheet.rows[cIdx[0]].height;\n                    for (var i = selIdx[0]; i <= selIdx[2]; i++) {\n                        setRowEleHeight(this.parent, this.parent.getActiveSheet(), hgt, i);\n                    }\n                    if (isCut) {\n                        setRowEleHeight(this.parent, copySheet, 20, cIdx[0]);\n                    }\n                }\n            }\n        }\n        else {\n            this.getClipboardEle().select();\n        }\n    };\n    Clipboard.prototype.getConditionalFormats = function (rowIdx, colIdx, sheet) {\n        var conditionalFormats = [];\n        if (sheet.conditionalFormats) {\n            for (var i = 0; i < sheet.conditionalFormats.length; i++) {\n                if (inRange(getRangeIndexes(sheet.conditionalFormats[i].range), rowIdx, colIdx)) {\n                    conditionalFormats.push(extend({}, sheet.conditionalFormats[i]));\n                }\n            }\n        }\n        return conditionalFormats;\n    };\n    Clipboard.prototype.setConditionalFormats = function (conditionalFormats, rowIdx, colIdx, sheet) {\n        for (var i = 0; i < conditionalFormats.length; i++) {\n            sheet.conditionalFormats.push(extend({}, conditionalFormats[i].properties || conditionalFormats[i], { range: getRangeAddress([rowIdx, colIdx]) }));\n        }\n    };\n    Clipboard.prototype.isRangeMerged = function (range, sheet) {\n        var cell = getCell(range[0], range[1], sheet);\n        if (cell && (cell.colSpan > 1 || cell.rowSpan > 1)) {\n            var args = { range: range.slice(2, 4).concat(range.slice(2, 4)) };\n            this.parent.notify(activeCellMergedRange, args);\n            return args.range[0] === range[0] && args.range[1] === range[1] && args.range[2] === range[2] && args.range[3] === range[3];\n        }\n        return false;\n    };\n    Clipboard.prototype.updateFilter = function (copyInfo, pastedRange) {\n        var isFilterCut;\n        var diff;\n        this.parent.notify(getFilteredCollection, null);\n        for (var i = 0; i < this.parent.sheets.length; i++) {\n            if (this.parent.filterCollection && this.parent.filterCollection[i] &&\n                this.parent.filterCollection[i].sheetIndex === getSheetIndexFromId(this.parent, copyInfo.sId)) {\n                var range = copyInfo.range;\n                var fRange = getRangeIndexes(this.parent.filterCollection[i].filterRange);\n                range = getSwapRange(range);\n                if (fRange[0] === range[0] && fRange[2] === range[2] && fRange[1] === range[1] && fRange[3] === range[3]) {\n                    isFilterCut = true;\n                    diff = [Math.abs(range[0] - fRange[0]), Math.abs(range[1] - fRange[1]),\n                        Math.abs(range[2] - fRange[2]), Math.abs(range[3] - fRange[3])];\n                }\n            }\n        }\n        var cell = this.parent.getCell(copyInfo.range[0], copyInfo.range[1]);\n        cell = cell ? (cell.querySelector('.e-filter-icon') ? cell : this.parent.getCell(copyInfo.range[2], copyInfo.range[3])) : cell;\n        var asc = cell ? cell.querySelector('.e-sortasc-filter') : cell;\n        var desc = cell ? cell.querySelector('.e-sortdesc-filter') : cell;\n        if (isFilterCut) {\n            for (var n = 0; n < this.parent.filterCollection.length; n++) {\n                var filterCol = this.parent.filterCollection[n];\n                var sheetIndex = copyInfo && copyInfo.sId ? getSheetIndexFromId(this.parent, copyInfo.sId) :\n                    this.parent.activeSheetIndex;\n                if (filterCol.sheetIndex === sheetIndex) {\n                    this.parent.notify(initiateFilterUI, { predicates: null, range: filterCol.filterRange, sIdx: sheetIndex, isCut: true });\n                }\n                if (filterCol.sheetIndex === sheetIndex && sheetIndex === this.parent.activeSheetIndex) {\n                    diff = [pastedRange[0] + diff[0], pastedRange[1] + diff[1],\n                        Math.abs(pastedRange[2] - diff[2]), Math.abs(pastedRange[3] - diff[3])];\n                    this.parent.notify(initiateFilterUI, { predicates: null, range: getRangeAddress(diff), sIdx: null, isCut: true });\n                    if (copyInfo.range[3] === copyInfo.range[1]) { // To update sorted icon after pasting.\n                        var filteredCell = this.parent.getCell(pastedRange[0], pastedRange[1]);\n                        if (asc && filteredCell) {\n                            filteredCell.querySelector('.e-filter-icon').classList.add('e-sortasc-filter');\n                        }\n                        if (desc && filteredCell) {\n                            filteredCell.querySelector('.e-filter-icon').classList.add('e-sortdesc-filter');\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Clipboard.prototype.isInRange = function (cRng, pRng, sIdx) {\n        var activeSheetIndex = this.parent.activeSheetIndex;\n        return (inRange(cRng, pRng[0], pRng[1]) && sIdx === activeSheetIndex) ||\n            (inRange(cRng, pRng[2], pRng[3]) && sIdx === activeSheetIndex);\n    };\n    Clipboard.prototype.setCell = function (rIdx, cIdx, sheet, cell, isExtend, isCut, lastCell, isExternal) {\n        var sheetIndex = sheet ? getSheetIndexFromId(this.parent, sheet.id) : null;\n        setCell(rIdx, cIdx, sheet, cell, isExtend);\n        if (cell && cell.formula) {\n            this.parent.notify(workbookFormulaOperation, {\n                action: 'refreshCalculate', value: isCut ? '' : cell.formula, rowIndex: rIdx,\n                colIndex: cIdx, sheetIndex: this.parent.activeSheetIndex, isFormula: true\n            });\n        }\n        if (cell && !cell.formula) {\n            this.parent.notify(workbookEditOperation, {\n                action: 'updateCellValue', address: [rIdx, cIdx, rIdx,\n                    cIdx], value: cell.value, sheetIndex: sheetIndex\n            });\n        }\n        if (sheet.name === this.parent.getActiveSheet().name) {\n            this.parent.serviceLocator.getService('cell').refresh(rIdx, cIdx, lastCell);\n        }\n        if (cell && cell.style && isExternal) {\n            var hgt = getTextHeightWithBorder(this.parent, rIdx, cIdx, sheet, cell.style || this.parent.cellStyle, cell.wrap ?\n                getLines(this.parent.getDisplayText(cell), getExcludedColumnWidth(sheet, rIdx, cIdx), cell.style, this.parent.cellStyle) : 1);\n            hgt = Math.round(hgt);\n            if (hgt < 20) {\n                hgt = 20; // default height\n            }\n            setMaxHgt(sheet, rIdx, cIdx, hgt);\n            var prevHeight = getRowsHeight(sheet, rIdx);\n            var maxHgt = getMaxHgt(sheet, rIdx);\n            var heightChanged = maxHgt > prevHeight;\n            if (heightChanged) {\n                setRowEleHeight(this.parent, sheet, maxHgt, rIdx);\n            }\n        }\n    };\n    Clipboard.prototype.getCopiedIdx = function () {\n        if (this.copiedInfo) {\n            for (var i = 0; i < this.parent.sheets.length; i++) {\n                if (this.parent.sheets[i].id === this.copiedInfo.sId) {\n                    return i;\n                }\n            }\n            this.clearCopiedInfo();\n        }\n        return -1;\n    };\n    Clipboard.prototype.setCopiedInfo = function (args, isCut) {\n        var _this = this;\n        if (this.parent.isEdit) {\n            return;\n        }\n        var deferred = new Deferred();\n        args.promise = deferred.promise;\n        var sheet = this.parent.getActiveSheet();\n        var range;\n        if (args && args.range) {\n            var mergeArgs = { range: args.range };\n            this.parent.notify(mergedRange, mergeArgs);\n            range = mergeArgs.range;\n        }\n        else {\n            range = getRangeIndexes(sheet.selectedRange);\n        }\n        var option = {\n            sheet: sheet, indexes: [0, 0, sheet.rowCount - 1, sheet.colCount - 1], promise: \n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            new Promise(function (resolve, reject) { resolve((function () { })()); })\n        };\n        var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n        var pictureLen = pictureElements.length;\n        if (sheet.isLocalData && !(args && args.clipboardData) && range[0] === 0 && range[2] === (sheet.rowCount - 1)) {\n            this.parent.showSpinner();\n            this.parent.notify('updateSheetFromDataSource', option);\n        }\n        option.promise.then(function () {\n            if (pictureLen > 0) {\n                var imgRowIdx = {\n                    clientY: pictureElements[0].offsetTop,\n                    isImage: true\n                };\n                _this.parent.notify(getRowIdxFromClientY, imgRowIdx);\n                var imgColIdx = {\n                    clientX: pictureElements[0].offsetLeft,\n                    isImage: true\n                };\n                _this.parent.notify(getColIdxFromClientX, imgColIdx);\n                _this.copiedShapeInfo = {\n                    sId: (args && args.sId) ? args.sId : sheet.id, sheetIdx: sheet.index, isCut: isCut, pictureElem: pictureElements[0], copiedRange: getRangeAddress([imgRowIdx.clientY, imgColIdx.clientX,\n                        imgRowIdx.clientY, imgColIdx.clientX]), height: pictureElements[0].offsetHeight,\n                    width: pictureElements[0].offsetWidth,\n                    chartInfo: _this.getChartElemInfo(pictureElements[0])\n                };\n                _this.hidePaste(true);\n                if (isCut) {\n                    if (pictureElements[0].classList.contains('e-datavisualization-chart')) {\n                        _this.parent.deleteChart(_this.copiedShapeInfo.chartInfo.id);\n                    }\n                    else {\n                        _this.parent.notify(deleteImage, {\n                            id: _this.copiedShapeInfo.pictureElem.id, sheetIdx: _this.copiedShapeInfo.sId,\n                            range: _this.copiedShapeInfo.copiedRange\n                        });\n                    }\n                }\n            }\n            else if (!(args && args.clipboardData)) {\n                if (_this.copiedInfo) {\n                    _this.clearCopiedInfo();\n                }\n                _this.copiedInfo = {\n                    range: range, sId: (args && args.sId) ? args.sId : sheet.id, isCut: isCut\n                };\n                _this.hidePaste(true);\n                _this.initCopyIndicator();\n                if (!Browser.isIE) {\n                    _this.getClipboardEle().select();\n                }\n                if (args && args.isAction) {\n                    document.execCommand(isCut ? 'cut' : 'copy');\n                }\n                _this.parent.hideSpinner();\n            }\n            if (Browser.isIE) {\n                _this.setExternalCells(args);\n            }\n            deferred.resolve();\n        });\n        if (args && args.clipboardData) {\n            this.setExternalCells(args);\n            focus(this.parent.element);\n        }\n    };\n    Clipboard.prototype.getChartElemInfo = function (overlayEle) {\n        var chartColl = this.parent.chartColl;\n        if (overlayEle.classList.contains('e-datavisualization-chart')) {\n            var chartId = overlayEle.getElementsByClassName('e-control')[0].id;\n            for (var idx = 0; idx < chartColl.length; idx++) {\n                if (chartColl[idx].id === chartId) {\n                    var chart = chartColl[idx];\n                    return chart;\n                }\n            }\n        }\n        return null;\n    };\n    Clipboard.prototype.clearCopiedInfo = function () {\n        if (this.copiedInfo) {\n            if (this.parent.getActiveSheet().id === this.copiedInfo.sId) {\n                this.removeIndicator(this.parent.getSelectAllContent());\n                this.removeIndicator(this.parent.getColumnHeaderContent());\n                this.removeIndicator(this.parent.getRowHeaderContent());\n                this.removeIndicator(this.parent.getMainContent());\n            }\n            this.copiedInfo = null;\n            this.hidePaste();\n        }\n        if (this.copiedShapeInfo) {\n            this.copiedShapeInfo = null;\n            this.hidePaste();\n        }\n    };\n    Clipboard.prototype.removeIndicator = function (ele) {\n        if (ele) {\n            var indicator = ele.querySelector('.e-copy-indicator');\n            if (indicator) {\n                detach(indicator);\n            }\n        }\n    };\n    Clipboard.prototype.initCopyIndicator = function () {\n        if (this.copiedInfo && this.parent.getActiveSheet().id === this.copiedInfo.sId) {\n            var copyIndicator = this.parent.createElement('div', { className: 'e-copy-indicator' });\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-top' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-bottom' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-left' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-right' }));\n            setPosition(this.parent, copyIndicator, this.copiedInfo.range, 'e-copy-indicator');\n        }\n    };\n    Clipboard.prototype.showDialog = function () {\n        var _this = this;\n        this.parent.serviceLocator.getService(dialog).show({\n            header: 'Spreadsheet',\n            target: this.parent.element,\n            height: 205, width: 340, isModal: true, showCloseIcon: true,\n            content: this.parent.serviceLocator.getService(locale).getConstant('PasteAlert'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'PasteDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            }\n        });\n    };\n    Clipboard.prototype.hidePaste = function (isShow) {\n        if (this.parent.getActiveSheet().isProtected) {\n            isShow = false;\n        }\n        this.parent.notify(enableToolbarItems, [{ items: [this.parent.element.id + '_paste'], enable: isShow || false }]);\n    };\n    Clipboard.prototype.setExternalCells = function (args) {\n        var cell;\n        var text = '';\n        var range = this.copiedInfo.range;\n        var sheet = this.parent.getActiveSheet();\n        var data = '<html><body><table class=\"e-spreadsheet\" xmlns=\"http://www.w3.org/1999/xhtml\"><tbody>';\n        for (var i = range[0]; i <= range[2]; i++) {\n            data += '<tr>';\n            for (var j = range[1]; j <= range[3]; j++) {\n                cell = getCell(i, j, sheet);\n                data += '<td style=\"white-space:' + ((cell && cell.wrap) ? 'normal' : 'nowrap') + ';vertical-align:bottom;';\n                if (cell && cell.style) {\n                    Object.keys(cell.style).forEach(function (style) {\n                        var regex = style.match(/[A-Z]/);\n                        data += (style === 'backgroundColor' ? 'background' : (regex ? style.replace(regex[0], '-'\n                            + regex[0].toLowerCase()) : style)) + ':' + ((style === 'backgroundColor' || style === 'color')\n                            ? cell.style[style].slice(0, 7) : cell.style[style]) + ';';\n                    });\n                }\n                data += '\">';\n                if (cell && !isNullOrUndefined(cell.value)) {\n                    var eventArgs = {\n                        formattedText: cell.value,\n                        value: cell.value,\n                        format: cell.format,\n                        onLoad: true\n                    };\n                    if (cell.format) {\n                        this.parent.notify(getFormattedCellObject, eventArgs);\n                    }\n                    data += eventArgs.formattedText;\n                    text += eventArgs.formattedText;\n                }\n                data += '</td>';\n                text += j === range[3] ? '' : '\\t';\n            }\n            data += '</tr>';\n            text += i === range[2] ? '' : '\\n';\n        }\n        data += '</tbody></table></body></html>';\n        if (Browser.isIE) {\n            window['clipboardData'].setData('text', text);\n        }\n        else {\n            args.clipboardData.setData('text/html', data);\n            args.clipboardData.setData('text/plain', text);\n            args.preventDefault();\n        }\n    };\n    Clipboard.prototype.getExternalCells = function (args) {\n        var _this = this;\n        var html;\n        var text;\n        var rows = [];\n        var cells = [];\n        var cellStyle;\n        var ele = this.parent.createElement('span');\n        if (Browser.isIE) {\n            text = window['clipboardData'].getData('text');\n        }\n        else {\n            html = args.clipboardData.getData('text/html');\n            text = args.clipboardData.getData('text/plain');\n            ele.innerHTML = html;\n        }\n        if (ele.querySelector('table')) {\n            if (ele.querySelector('.e-spreadsheet') && this.copiedInfo) {\n                rows = { internal: true };\n            }\n            else {\n                ele.querySelectorAll('tr').forEach(function (tr) {\n                    tr.querySelectorAll('td').forEach(function (td, j) {\n                        cellStyle = _this.getStyle(td, ele);\n                        td.textContent = td.textContent.replace(/(\\r\\n|\\n|\\r)/gm, '');\n                        td.textContent = td.textContent.replace(/\\s+/g, ' ');\n                        var cSpan = isNaN(parseInt(td.getAttribute('colspan'), 10)) ? 1 : parseInt(td.getAttribute('colspan'), 10);\n                        var rSpan = isNaN(parseInt(td.getAttribute('rowspan'), 10)) ? 1 : parseInt(td.getAttribute('rowspan'), 10);\n                        var wrap;\n                        if (cellStyle.whiteSpace) {\n                            wrap = true;\n                            delete cellStyle['whiteSpace'];\n                        }\n                        cells[j] = {\n                            value: td.textContent ? parseIntValue(td.textContent.trim()) : null, style: cellStyle, colSpan: cSpan,\n                            rowSpan: rSpan, wrap: wrap\n                        };\n                    });\n                    rows.push({ cells: cells });\n                    cells = [];\n                });\n                this.updateMergeCells(rows);\n            }\n        }\n        else if (text) {\n            if (html) {\n                [].slice.call(ele.children).forEach(function (child) {\n                    cellStyle = _this.getStyle(child, ele);\n                });\n            }\n            text.trim().split('\\n').forEach(function (row) {\n                row.split('\\t').forEach(function (col, j) {\n                    if (col) {\n                        var wrap = void 0;\n                        if (cellStyle && cellStyle.whiteSpace) {\n                            wrap = true;\n                            delete cellStyle['whiteSpace'];\n                        }\n                        cells[j] = { style: cellStyle, wrap: wrap };\n                        if (checkIsFormula(col)) {\n                            cells[j].formula = col;\n                        }\n                        else {\n                            cells[j].value = parseIntValue(col.trim());\n                        }\n                    }\n                });\n                rows.push({ cells: cells });\n                cells = [];\n            });\n        }\n        setTimeout(function () { _this.getClipboardEle().innerHTML = ''; }, 0);\n        return rows;\n    };\n    Clipboard.prototype.updateMergeCells = function (rows) {\n        var rowSpan;\n        var colSpan;\n        for (var i = 0; i < rows.length; i++) {\n            for (var j = 0; j < rows[i].cells.length; j++) {\n                if (rows[i].cells[j]) {\n                    colSpan = rows[i].cells[j].colSpan;\n                    rowSpan = rows[i].cells[j].rowSpan;\n                    if (colSpan > 1) {\n                        for (var k = 1; k < colSpan; k++) {\n                            rows[i].cells.splice(j + 1, 0, { colSpan: k - colSpan });\n                        }\n                    }\n                    if (rowSpan > 1) {\n                        for (var k = rowSpan - 1; k > 0; k--) {\n                            for (var l = 0; l < colSpan; l++) {\n                                rows[i + k].cells.splice(l === 0 ? j : j + 1, 0, { rowSpan: -k, colSpan: -l });\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Clipboard.prototype.getStyle = function (td, ele) {\n        var styles = [];\n        var cellStyle = {};\n        var keys = Object.keys(this.parent.commonCellStyle);\n        if (ele.querySelector('style') && td.classList.length) {\n            if (ele.querySelector('style').innerHTML.indexOf(td.classList[0]) > -1) {\n                var styleTagCSS = ele.querySelector('style').innerHTML.split(td.classList[0]);\n                styles.push(styleTagCSS[styleTagCSS.length - 1].split('{')[1].split('}')[0]);\n            }\n        }\n        var nodeList = [].slice.call(td.querySelectorAll('*'));\n        nodeList.unshift(td);\n        nodeList.forEach(function (node) {\n            if (node.getAttribute('style')) {\n                styles.push(node.getAttribute('style'));\n            }\n            if (node.tagName === 'B') {\n                styles.push('font-weight:bold');\n            }\n        });\n        if (keys.length) {\n            if (ele.querySelector('style')) {\n                var tdStyle = ele.querySelector('style').innerHTML.split('td')[1].split('{')[1].split('}')[0];\n                for (var i = 0; i < keys.length; i++) {\n                    var key = keys[i];\n                    var regex = key.match(/[A-Z]/);\n                    if (regex) {\n                        key = key.replace(regex[0], '-' + regex[0].toLowerCase());\n                    }\n                    if (tdStyle.indexOf(key) > -1) {\n                        cellStyle[keys[i]] = tdStyle.split(key + ':')[1].split(';')[0];\n                    }\n                }\n            }\n        }\n        styles.forEach(function (styles) {\n            styles.split(';').forEach(function (style) {\n                var char = style.split(':')[0].trim();\n                if (['font-family', 'vertical-align', 'text-align', 'text-indent', 'color', 'background', 'font-weight', 'font-style',\n                    'font-size', 'text-decoration', 'border-bottom', 'border-top', 'border-right', 'border-left',\n                    'border', 'white-space'].indexOf(char) > -1) {\n                    char = char === 'background' ? 'backgroundColor' : char;\n                    var regex = char.match(/-[a-z]/);\n                    var value = style.split(':')[1];\n                    cellStyle[regex ? char.replace(regex[0], regex[0].charAt(1).toUpperCase()) : char]\n                        = (char === 'font-weight' && ['bold', 'normal'].indexOf(value) === -1)\n                            ? (value > '599' ? 'bold' : 'normal') : value;\n                }\n            });\n        });\n        if (td.innerHTML.indexOf('<s>') > -1) {\n            cellStyle.textDecoration = 'line-through';\n        }\n        return this.defaultCellStyle(cellStyle);\n    };\n    Clipboard.prototype.defaultCellStyle = function (style) {\n        var textDecoration = ['underline', 'line-through', 'underline line-through', 'none'];\n        var textAlign = ['left', 'center', 'right'];\n        var verticalAlign = ['bottom', 'middle', 'top'];\n        var fontSize = style.fontSize ? style.fontSize.trim() : null;\n        if (style.textDecoration && textDecoration.indexOf(style.textDecoration.trim()) < 0) {\n            style.textDecoration = 'none';\n        }\n        if (style.textAlign && textAlign.indexOf(style.textAlign.trim()) < 0) {\n            style.textAlign = 'left';\n        }\n        if (style.verticalAlign && verticalAlign.indexOf(style.verticalAlign.trim()) < 0) {\n            style.verticalAlign = 'bottom';\n        }\n        if (fontSize) {\n            fontSize = (fontSize.indexOf('px') > -1) ? (parseFloat(fontSize) * 0.75) + 'pt' : fontSize;\n            style.fontSize = Math.round(parseFloat(fontSize)) + 'pt';\n        }\n        return style;\n    };\n    Clipboard.prototype.refreshOnInsertDelete = function (args) {\n        if (this.copiedInfo) {\n            if (args.model.id !== this.copiedInfo.sId) {\n                return;\n            }\n            var range = this.copiedInfo.range;\n            if (args.isInsert) {\n                if (args.modelType === 'Column') {\n                    if (args.start <= range[3]) {\n                        if (args.start <= range[1]) {\n                            var len = args.end - args.start + 1;\n                            range[1] += len;\n                            range[3] += len;\n                        }\n                        else {\n                            range[3] = range[1] + (args.start - range[1] - 1);\n                        }\n                        this.performAction();\n                    }\n                }\n                else {\n                    if (args.start <= range[2]) {\n                        if (args.start <= range[0]) {\n                            var len = args.end - args.start + 1;\n                            range[0] += len;\n                            range[2] += len;\n                        }\n                        else {\n                            range[2] = range[1] + (args.start - range[1] - 1);\n                        }\n                        this.performAction();\n                    }\n                }\n            }\n            else {\n                this.clearCopiedInfo();\n            }\n        }\n    };\n    Clipboard.prototype.performAction = function () {\n        this.copiedInfo.isCut ? this.parent.cut(getRangeAddress(this.copiedInfo.range)) :\n            this.parent.copy(getRangeAddress(this.copiedInfo.range));\n    };\n    Clipboard.prototype.getClipboardEle = function () {\n        return this.parent.element.getElementsByClassName('e-clipboard')[0];\n    };\n    Clipboard.prototype.getModuleName = function () {\n        return 'clipboard';\n    };\n    Clipboard.prototype.destroy = function () {\n        this.removeEventListener();\n        var ele = this.getClipboardEle();\n        detach(ele);\n        this.parent = null;\n    };\n    return Clipboard;\n}());\nexport { Clipboard };\n","import { EventHandler, Browser, closest, isUndefined, isNullOrUndefined, select, detach } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getRangeFromAddress, getIndexesFromAddress, getRangeAddress, isSingleCell } from '../../workbook/common/address';\nimport { keyDown, editOperation, clearCopy, mouseDown, selectionComplete, enableToolbarItems, completeAction } from '../common/event';\nimport { formulaBarOperation, formulaOperation, setActionData, keyUp, getCellPosition, deleteImage, focus, isLockedCells } from '../common/index';\nimport { workbookEditOperation, getFormattedBarText, getFormattedCellObject, wrapEvent, isValidation, activeCellMergedRange, activeCellChanged, getUniqueRange, removeUniquecol, checkUniqueRange } from '../../workbook/common/event';\nimport { getSheetName, getSheetIndex, getCell, getColumn, getRowsHeight, getColumnsWidth } from '../../workbook/base/index';\nimport { getSheetNameFromAddress, getSheet } from '../../workbook/base/index';\nimport { hasTemplate, editAlert, getTextWidth } from '../common/index';\nimport { getSwapRange, getCellIndexes, wrap as wrapText, checkIsFormula, isNumber, isLocked, isCellReference } from '../../workbook/index';\nimport { initiateFormulaReference, initiateCur, clearCellRef, addressHandle } from '../common/event';\nimport { editValue, initiateEdit, forRefSelRender, isFormulaBarEdit, deleteChart, beginAction } from '../common/event';\n/**\n * The `Protect-Sheet` module is used to handle the Protecting functionalities in Spreadsheet.\n */\nvar Edit = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Spreadsheet.\n     *\n     * @param {Spreadsheet} parent - Constructor for edit module in Spreadsheet.\n     * @private\n     */\n    function Edit(parent) {\n        this.editorElem = null;\n        this.editCellData = {};\n        this.isEdit = false;\n        this.isCellEdit = true;\n        this.isNewValueEdit = true;\n        this.isAltEnter = false;\n        this.validCharacters = ['+', '-', '*', '/', ',', '(', '=', '&'];\n        this.formulaBarCurStartPos = null;\n        this.curEndPos = null;\n        this.curStartPos = null;\n        this.selectionStart = null;\n        this.selectionEnd = null;\n        this.uniqueActCell = '';\n        this.keyCodes = {\n            BACKSPACE: 8,\n            SPACE: 32,\n            TAB: 9,\n            DELETE: 46,\n            ESC: 27,\n            ENTER: 13,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            FIRSTNUMBER: 48,\n            LASTNUMBER: 59,\n            FIRSTNUMPAD: 96,\n            LASTNUMPAD: 111,\n            SYMBOLSETONESTART: 186,\n            SYMBOLSETONEEND: 192,\n            SYMBOLSETTWOSTART: 219,\n            SYMBOLSETTWOEND: 222,\n            FIREFOXEQUALPLUS: 61,\n            FIREFOXMINUS: 173,\n            F2: 113\n        };\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookEdit);\n    }\n    /**\n     * To destroy the edit module.\n     *\n     * @returns {void} - To destroy the edit module.\n     * @hidden\n     */\n    Edit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.editorElem = null;\n    };\n    Edit.prototype.addEventListener = function () {\n        EventHandler.add(this.parent.element, 'dblclick', this.dblClickHandler, this);\n        this.parent.on(mouseDown, this.mouseDownHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(editOperation, this.performEditOperation, this);\n        this.parent.on(initiateCur, this.initiateCurPosition, this);\n        this.parent.on(editValue, this.updateFormulaBarValue, this);\n        this.parent.on(addressHandle, this.addressHandler, this);\n        this.parent.on(initiateEdit, this.initiateRefSelection, this);\n        this.parent.on(forRefSelRender, this.refSelectionRender, this);\n        this.parent.on(checkUniqueRange, this.checkUniqueRange, this);\n    };\n    Edit.prototype.removeEventListener = function () {\n        EventHandler.remove(this.parent.element, 'dblclick', this.dblClickHandler);\n        if (!this.parent.isDestroyed) {\n            this.parent.off(mouseDown, this.mouseDownHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(editOperation, this.performEditOperation);\n            this.parent.off(initiateCur, this.initiateCurPosition);\n            this.parent.off(editValue, this.updateFormulaBarValue);\n            this.parent.off(addressHandle, this.addressHandler);\n            this.parent.off(initiateEdit, this.initiateRefSelection);\n            this.parent.off(forRefSelRender, this.refSelectionRender);\n            this.parent.off(checkUniqueRange, this.checkUniqueRange);\n        }\n    };\n    /**\n     * Get the module name.\n     *\n     * @returns {string} - Get the module name.\n     * @private\n     */\n    Edit.prototype.getModuleName = function () {\n        return 'edit';\n    };\n    Edit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'renderEditor':\n                this.renderEditor();\n                break;\n            case 'refreshEditor':\n                this.refreshEditor(args.value, args.refreshFormulaBar, args.refreshEditorElem, args.isAppend, args.trigEvent);\n                if (args.refreshCurPos) {\n                    this.setCursorPosition();\n                }\n                break;\n            case 'startEdit':\n                if (!this.isEdit) {\n                    this.isNewValueEdit = args.isNewValueEdit;\n                    this.startEdit(args.address, args.value, args.refreshCurPos);\n                }\n                else {\n                    var isEdit = false;\n                    var arg = { isEdit: isEdit };\n                    this.parent.notify(isFormulaBarEdit, arg);\n                    if (arg.isEdit) {\n                        this.isNewValueEdit = args.isNewValueEdit;\n                        this.startEdit(args.address, args.value, args.refreshCurPos);\n                    }\n                }\n                break;\n            case 'endEdit':\n                if (this.isEdit) {\n                    this.endEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'cancelEdit':\n                if (this.isEdit) {\n                    this.cancelEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'getCurrentEditValue':\n                args.editedValue = this.editCellData.value;\n                if (args.endFormulaRef !== undefined) {\n                    args.endFormulaRef = this.endFormulaRef;\n                }\n                break;\n            case 'refreshDependentCellValue':\n                this.refreshDependentCellValue(args.rowIdx, args.colIdx, args.sheetIdx);\n                break;\n            case 'getElement':\n                args.element = this.getEditElement(this.parent.getActiveSheet());\n                break;\n            case 'focusEditorElem':\n                this.editorElem.focus();\n                break;\n            case 'getCurrentEditSheetIdx':\n                args.sheetIndex = this.editCellData.sheetIndex;\n                break;\n        }\n    };\n    Edit.prototype.keyUpHandler = function (e) {\n        if (this.isEdit) {\n            var editElement = this.getEditElement(this.parent.getActiveSheet());\n            if (e.altKey && e.keyCode === 13) {\n                editElement.focus();\n                this.altEnter();\n                this.isAltEnter = true;\n            }\n            else if (this.isCellEdit && this.editCellData.value !== editElement.textContent && e.keyCode !== 16) {\n                this.refreshEditor(editElement.textContent, this.isCellEdit);\n            }\n            var isFormulaEdit = checkIsFormula(this.editCellData.value, true);\n            if (isFormulaEdit && (!e || e.keyCode !== 16)) {\n                this.updateFormulaReference(editElement);\n                if (this.endFormulaRef) {\n                    var curOffset = this.getCurPosition();\n                    if (curOffset.end && this.validCharacters.indexOf(this.editCellData.value[curOffset.end - 1]) > -1) {\n                        this.endFormulaRef = false;\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.updateFormulaReference = function (editElement) {\n        var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n        if (formulaRefIndicator) {\n            formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n        }\n        if (this.editCellData.value !== editElement.textContent) {\n            this.refreshEditor(editElement.textContent, true);\n        }\n        var sheetIdx = this.editCellData.sheetIndex;\n        var editValue = this.editCellData.value;\n        this.parent.notify(initiateFormulaReference, { range: editValue, formulaSheetIdx: sheetIdx });\n    };\n    Edit.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        var keyCode = e.keyCode;\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet) || {};\n        if (!closest(e.target, '.e-findtool-dlg') && !closest(e.target, '.e-validationerror-dlg')\n            && !closest(e.target, '.e-hyperlink-dlg')) {\n            if (!sheet.isProtected || closest(e.target, '.e-sheet-rename') || !isLocked(cell, getColumn(sheet, actCell[1]))) {\n                if (this.isEdit) {\n                    var editorElem = this.getEditElement(sheet);\n                    var isFormulaEdit = checkIsFormula(this.editCellData.value, true);\n                    if (this.isCellEdit || (isFormulaEdit && this.editCellData.value !== editorElem.textContent && e.keyCode !== 16)) {\n                        if (actCell[1] < this.parent.frozenColCount(sheet) && (!sheet.frozenRows || actCell[0] >=\n                            this.parent.frozenRowCount(sheet)) && editorElem && editorElem.style.height !== 'auto') {\n                            if (getTextWidth(editorElem.textContent, cell.style, this.parent.cellStyle) > parseInt(editorElem.style.maxWidth, 10)) {\n                                editorElem.style.height = 'auto';\n                            }\n                        }\n                        if (getTextWidth(editorElem.textContent, cell.style, this.parent.cellStyle) > parseInt(editorElem.style.maxWidth, 10) - 5) { // 5 decreased for padding.\n                            editorElem.style.height = 'auto';\n                        }\n                        if (actCell[0] < this.parent.frozenRowCount(sheet) && editorElem && !editorElem.style.overflow && getTextWidth(editorElem.textContent, cell.style, this.parent.cellStyle) > parseInt(editorElem.style.maxWidth, 10)) {\n                            editorElem.style.overflow = 'auto';\n                        }\n                        this.refreshEditor(editorElem.textContent, this.isCellEdit);\n                    }\n                    if (!e.altKey) {\n                        switch (keyCode) {\n                            case this.keyCodes.ENTER:\n                                if (Browser.isWindows) {\n                                    e.preventDefault();\n                                }\n                                if (this.isAltEnter) {\n                                    var text = editorElem.textContent;\n                                    if (text && text.indexOf('\\n') > -1) {\n                                        wrapText(this.parent.getActiveSheet().selectedRange, true, this.parent);\n                                        this.refreshEditor(editorElem.textContent, this.isCellEdit);\n                                        this.isAltEnter = false;\n                                    }\n                                }\n                                if (!isFormulaEdit) {\n                                    this.endEdit(false, e);\n                                }\n                                else {\n                                    var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    if (this.editCellData.sheetIndex === sheet.id - 1) {\n                                        this.endEdit(false, e);\n                                    }\n                                    else {\n                                        this.parent.goTo(this.editCellData.fullAddr);\n                                        this.endEdit(false, e);\n                                    }\n                                }\n                                break;\n                            case this.keyCodes.TAB:\n                                if (!this.hasFormulaSuggSelected()) {\n                                    this.endEdit(false, e);\n                                }\n                                break;\n                            case this.keyCodes.ESC:\n                                this.cancelEdit(true, true, e);\n                                break;\n                        }\n                    }\n                }\n                else {\n                    if (!this.isEdit && (trgtElem.classList.contains('e-spreadsheet') || closest(trgtElem, '.e-sheet-panel'))) {\n                        var isAlphabet = (keyCode >= this.keyCodes.FIRSTALPHABET && keyCode <= this.keyCodes.LASTALPHABET);\n                        var isNumeric = (keyCode >= this.keyCodes.FIRSTNUMBER && keyCode <= this.keyCodes.LASTNUMBER);\n                        var isNumpadKeys = (keyCode >= this.keyCodes.FIRSTNUMPAD && keyCode <= this.keyCodes.LASTNUMPAD);\n                        var isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETONESTART &&\n                            keyCode <= this.keyCodes.SYMBOLSETONEEND);\n                        if (!isSymbolkeys) {\n                            isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETTWOSTART && keyCode <= this.keyCodes.SYMBOLSETTWOEND);\n                        }\n                        var isFirefoxExceptionkeys = (keyCode === this.keyCodes.FIREFOXEQUALPLUS) ||\n                            (keyCode === this.keyCodes.FIREFOXMINUS);\n                        var isF2Edit = (!e.shiftKey && !e.ctrlKey && !e.metaKey && keyCode === this.keyCodes.F2);\n                        var isBackSpace = keyCode === this.keyCodes.BACKSPACE;\n                        if ((!e.ctrlKey && !e.metaKey && !e.altKey && ((!e.shiftKey && keyCode === this.keyCodes.SPACE) || isAlphabet || isNumeric ||\n                            isNumpadKeys || isSymbolkeys || (Browser.info.name === 'mozilla' && isFirefoxExceptionkeys))) || isF2Edit || isBackSpace) {\n                            if (isF2Edit) {\n                                this.isNewValueEdit = false;\n                            }\n                            var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n                            var pictureLen = pictureElements.length;\n                            if (pictureLen > 0) {\n                                if (keyCode === this.keyCodes.DELETE) {\n                                    this.parent.notify(deleteImage, {\n                                        id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                                    });\n                                }\n                            }\n                            else {\n                                this.startEdit(null, null, true, true);\n                            }\n                        }\n                        if (keyCode === this.keyCodes.DELETE) {\n                            var islockcell = sheet.isProtected && isLockedCells(this.parent);\n                            if (!islockcell) {\n                                this.editingHandler('delete');\n                                this.parent.notify(activeCellChanged, null);\n                            }\n                            else {\n                                this.parent.notify(editAlert, null);\n                            }\n                        }\n                    }\n                }\n            }\n            else {\n                if (((keyCode >= this.keyCodes.FIRSTALPHABET && keyCode <= this.keyCodes.LASTALPHABET) ||\n                    (keyCode >= this.keyCodes.FIRSTNUMBER && keyCode <= this.keyCodes.LASTNUMBER)\n                    || (keyCode === this.keyCodes.DELETE) || (keyCode === this.keyCodes.BACKSPACE) || (keyCode === this.keyCodes.SPACE)\n                    || (keyCode >= this.keyCodes.FIRSTNUMPAD && keyCode <= this.keyCodes.LASTNUMPAD) ||\n                    (keyCode >= this.keyCodes.SYMBOLSETONESTART && keyCode <= this.keyCodes.SYMBOLSETONEEND)\n                    || (keyCode >= 219 && keyCode <= 222) || (!e.shiftKey && !e.ctrlKey && !e.metaKey && keyCode === this.keyCodes.F2))\n                    && (keyCode !== 67) && (keyCode !== 89) && (keyCode !== 90)) {\n                    if (sheet.protectSettings.insertLink && keyCode === 75) {\n                        return;\n                    }\n                    if (!this.parent.element.querySelector('.e-editAlert-dlg') && !e.ctrlKey && e.keyCode !== 70 &&\n                        !trgtElem.parentElement.classList.contains('e-unprotectpwd-content') &&\n                        !trgtElem.parentElement.classList.contains('e-password-content')) {\n                        this.parent.notify(editAlert, null);\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.renderEditor = function () {\n        if (!this.editorElem || !select('#' + this.parent.element.id + '_edit', this.parent.element)) {\n            var editor = this.parent.createElement('div', { id: this.parent.element.id + '_edit', className: 'e-spreadsheet-edit' });\n            editor.contentEditable = 'true';\n            editor.spellcheck = false;\n            if (this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0]) {\n                this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0].remove();\n            }\n            this.parent.element.querySelector('.e-sheet-content').appendChild(editor);\n            this.editorElem = editor;\n        }\n        this.parent.notify(formulaOperation, { action: 'renderAutoComplete' });\n    };\n    Edit.prototype.refreshEditor = function (value, refreshFormulaBar, refreshEditorElem, isAppend, trigEvent) {\n        if (trigEvent === void 0) { trigEvent = true; }\n        if (isAppend) {\n            value = this.editCellData.value = this.editCellData.value + value;\n        }\n        else {\n            this.editCellData.value = value;\n        }\n        var editorElem = this.getEditElement(this.parent.getActiveSheet());\n        if (refreshEditorElem) {\n            editorElem.textContent = value;\n        }\n        if (refreshFormulaBar) {\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: value });\n        }\n        if (trigEvent && this.editCellData.value === editorElem.textContent) {\n            if (this.triggerEvent('cellEditing')) {\n                this.cancelEdit();\n            }\n        }\n        // if (this.editorElem.scrollHeight + 2 <= this.editCellData.element.offsetHeight) {\n        //     this.editorElem.style.height = (this.editCellData.element.offsetHeight + 1) + 'px';\n        // } else {\n        //     this.editorElem.style.removeProperty('height');\n        // }\n    };\n    Edit.prototype.startEdit = function (address, value, refreshCurPos, preventFormulaReference) {\n        if (refreshCurPos === void 0) { refreshCurPos = true; }\n        if (this.parent.showSheetTabs) {\n            this.parent.element.querySelector('.e-add-sheet-tab').setAttribute('disabled', 'true');\n        }\n        var sheet = this.parent.getActiveSheet();\n        var range = getCellIndexes(sheet.activeCell);\n        var cell = getCell(range[0], range[1], sheet, false, true);\n        if (hasTemplate(this.parent, range[0], range[1], this.parent.activeSheetIndex)) {\n            var cellEle = this.parent.getCell(range[0], range[1]);\n            var isDelTemplate = false;\n            var value_1 = cellEle.innerHTML;\n            if (cellEle) {\n                if (value_1.indexOf('<') > -1 && value_1.indexOf('>') > -1 && value_1.indexOf('input') > -1) {\n                    isDelTemplate = true;\n                }\n            }\n            if (isDelTemplate) {\n                return;\n            }\n        }\n        this.updateEditCellDetail(address, value);\n        this.initiateEditor(refreshCurPos);\n        this.positionEditor();\n        this.parent.isEdit = this.isEdit = true;\n        this.parent.notify(clearCopy, null);\n        this.parent.notify(enableToolbarItems, [{ enable: false }]);\n        if (cell.formula && !preventFormulaReference) {\n            this.parent.notify(initiateFormulaReference, { range: cell.formula, formulaSheetIdx: this.editCellData.sheetIndex });\n        }\n    };\n    Edit.prototype.setCursorPosition = function () {\n        var elem = this.getEditElement(this.parent.getActiveSheet());\n        var textLen = elem.textContent.length;\n        if (textLen) {\n            var selection = document.getSelection();\n            var range = document.createRange();\n            range.setStart(elem.firstChild, textLen);\n            range.collapse(true);\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n        elem.focus();\n    };\n    Edit.prototype.hasFormulaSuggSelected = function () {\n        var suggDdlElem = document.getElementById(this.parent.element.id + '_ac_popup');\n        return suggDdlElem && suggDdlElem.style.visibility === 'visible' &&\n            suggDdlElem.querySelectorAll('.e-item-focus').length > 0;\n    };\n    Edit.prototype.editingHandler = function (action) {\n        var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n        var pictureLen = pictureElements.length;\n        switch (action) {\n            case 'delete':\n                if (pictureLen > 0) {\n                    if (pictureElements[0].classList.contains('e-datavisualization-chart')) {\n                        this.parent.notify(deleteChart, {\n                            id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                        });\n                    }\n                    else {\n                        this.parent.notify(deleteImage, {\n                            id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                        });\n                    }\n                }\n                else {\n                    var sheet = this.parent.getActiveSheet();\n                    var address = sheet.selectedRange;\n                    var range = getIndexesFromAddress(address);\n                    range = range[0] > range[2] ? getSwapRange(range) : range;\n                    address = getRangeAddress(range);\n                    this.parent.notify(beginAction, { action: 'cellDelete', eventArgs: { address: sheet.name + '!' + address } });\n                    this.parent.clearRange(address, null, true);\n                    this.parent.serviceLocator.getService('cell').refreshRange(range);\n                    this.parent.notify(selectionComplete, {});\n                    this.parent.notify(completeAction, { action: 'cellDelete', eventArgs: { address: sheet.name + '!' + address } });\n                    var args = { cellIdx: range, isUnique: false };\n                    this.checkUniqueRange(args);\n                    if (args.isUnique && this.uniqueColl.split(':')[0] === address.split(':')[0]) {\n                        this.updateUniqueRange('');\n                        this.parent.notify(removeUniquecol, null);\n                        this.uniqueColl = '';\n                    }\n                    else if (args.isUnique) {\n                        var uniqueRange = getRangeIndexes(this.uniqueColl);\n                        if (getCell(uniqueRange[0], uniqueRange[1], sheet).value === '#SPILL!') {\n                            var skip = false;\n                            for (var j = uniqueRange[0]; j <= uniqueRange[2]; j++) {\n                                for (var k = uniqueRange[1]; k <= uniqueRange[3]; k++) {\n                                    var cell = getCell(j, k, sheet);\n                                    if (j === uniqueRange[0] && k === uniqueRange[1]) {\n                                        skip = false;\n                                    }\n                                    else if (!isNullOrUndefined(cell.value) && cell.value !== '') {\n                                        skip = true;\n                                    }\n                                }\n                            }\n                            if (!skip) {\n                                this.reApplyFormula();\n                            }\n                        }\n                    }\n                }\n                break;\n        }\n    };\n    Edit.prototype.getCurPosition = function () {\n        var cursorOffset = {};\n        var selection = window.getSelection();\n        if (this.editorElem.textContent === this.editCellData.value) {\n            cursorOffset.start = selection.anchorOffset;\n            cursorOffset.end = selection.focusOffset;\n            if (cursorOffset.start > cursorOffset.end) {\n                var x = cursorOffset.start;\n                cursorOffset.start = cursorOffset.end;\n                cursorOffset.end = x;\n            }\n        }\n        if (selection && selection.focusNode && selection.focusNode.classList &&\n            selection.focusNode.classList.contains('e-formula-bar-panel') &&\n            this.editorElem.textContent === this.editCellData.value) {\n            var formulaBar = selection.focusNode.getElementsByClassName('e-formula-bar e-css')[0];\n            cursorOffset.start = formulaBar.selectionStart;\n            cursorOffset.end = formulaBar.selectionEnd;\n        }\n        return cursorOffset;\n    };\n    Edit.prototype.mouseDownHandler = function (e) {\n        if (!closest(e.target, '.e-findtool-dlg')) {\n            if (this.isEdit) {\n                var curOffset = this.getCurPosition();\n                if (curOffset.start) {\n                    this.curStartPos = this.selectionStart = curOffset.start;\n                }\n                if (curOffset.end) {\n                    this.curEndPos = this.selectionEnd = curOffset.end;\n                }\n                var trgtElem = e.target;\n                var sheet = this.parent.getActiveSheet();\n                var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                this.isCellEdit = trgtElem.classList.contains('e-spreadsheet-edit');\n                var isFormula = checkIsFormula(this.editCellData.value, true);\n                var editorElem = this.getEditElement(sheet);\n                if (trgtElem.classList.contains('e-cell') || trgtElem.classList.contains('e-header-cell') ||\n                    trgtElem.classList.contains('e-selectall') || closest(trgtElem, '.e-toolbar-item.e-active') || closest(trgtElem, '.e-table')) {\n                    if (this.isAltEnter) {\n                        var editText = editorElem.textContent;\n                        if (editText && editText.indexOf('\\n') > -1) {\n                            this.isAltEnter = false;\n                            wrapText(this.parent.getActiveSheet().selectedRange, true, this.parent);\n                            this.refreshEditor(editorElem.textContent, this.isCellEdit);\n                        }\n                    }\n                    if (!isFormula || this.endFormulaRef) {\n                        this.endFormulaRef = false;\n                        this.endEdit(false, e);\n                    }\n                    else {\n                        var curPos = this.selectionEnd;\n                        var actCellIdx = getCellIndexes(sheet.activeCell);\n                        var cell = getCell(actCellIdx[0], actCellIdx[1], sheet);\n                        if (this.selectionStart !== this.selectionEnd && this.editCellData.value === editorElem.textContent &&\n                            this.validCharacters.indexOf(editorElem.textContent.substring((this.selectionStart - 1), this.selectionStart)) !== -1) {\n                            if (isCellReference(editorElem.textContent.substring(this.selectionStart, this.selectionEnd)) &&\n                                editorElem.textContent.indexOf(':') !== this.selectionEnd) {\n                                this.editCellData.value = editorElem.textContent.substring(0, this.selectionStart) +\n                                    editorElem.textContent.substring(this.selectionEnd, editorElem.textContent.length);\n                            }\n                        }\n                        if (this.editCellData.value === editorElem.textContent && (editorElem.textContent.indexOf('(') !==\n                            editorElem.textContent.length - 1 && editorElem.textContent.indexOf('(') !== -1) &&\n                            this.selectionStart === this.selectionEnd) {\n                            if (this.editCellData.sheetIndex !== sheet.id - 1) {\n                                var elem = this.parent.element.querySelector('.e-formula-bar');\n                                if (editorElem.textContent.substring(elem.selectionEnd - 1, elem.selectionEnd) !== ',' &&\n                                    !e.shiftKey) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.parent.goTo(this.editCellData.fullAddr);\n                                    this.endEdit(false, e);\n                                    return;\n                                }\n                            }\n                            else {\n                                if (this.validCharacters.indexOf(editorElem.textContent.substring(curPos - 1, curPos)) === -1) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                    return;\n                                }\n                            }\n                        }\n                        if (!cell) {\n                            return;\n                        }\n                        isFormula = cell.formula ?\n                            checkIsFormula(getCell(actCellIdx[0], actCellIdx[1], sheet).formula) ||\n                                (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0) : false;\n                        if (isFormula && this.parent.isEdit) {\n                            var curPos_1 = this.selectionEnd;\n                            if (this.editCellData.value.length === curPos_1) {\n                                if (this.editCellData.value.substring(this.editCellData.value.length - 1) === ')' ||\n                                    isNumber(this.editCellData.value.substring(this.editCellData.value.length - 1))) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                            }\n                            else if (this.editCellData.value === editorElem.textContent) {\n                                if (this.validCharacters.indexOf((this.editCellData.value +\n                                    sheet.selectedRange).substring(curPos_1 - 1, curPos_1)) === -1) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                                else if (this.validCharacters.indexOf(editorElem.textContent.substring(curPos_1 - 1, curPos_1)) === -1 ||\n                                    (editorElem.textContent.substring(curPos_1, curPos_1 + 1) !== ')' &&\n                                        this.validCharacters.indexOf(editorElem.textContent.substring(curPos_1, curPos_1 + 1)) === -1)) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                            }\n                        }\n                    }\n                }\n                else {\n                    if (isFormula && this.editCellData.value === editorElem.textContent && editorElem.textContent.indexOf('(') !==\n                        editorElem.textContent.length - 1 && !this.isCellEdit &&\n                        this.validCharacters.indexOf(this.editCellData.value.substring(this.selectionStart - 1, this.selectionStart)) === -1) {\n                        if (this.editCellData.sheetIndex === sheet.id - 1) {\n                            var curPos = window.getSelection().focusOffset;\n                            if (this.validCharacters.indexOf(editorElem.textContent.substring(curPos - 1, curPos)) === -1) {\n                                if (formulaRefIndicator) {\n                                    formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                }\n                                this.parent.goTo(this.editCellData.fullAddr);\n                                this.endEdit(false, e);\n                                return;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.dblClickHandler = function (e) {\n        var trgtElem = e.target;\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet) || {};\n        if (closest(trgtElem, '.e-datavisualization-chart')) {\n            return;\n        }\n        if (!sheet.isProtected || !isLocked(cell, getColumn(sheet, actCell[1]))) {\n            if ((trgtElem.className.indexOf('e-ss-overlay') < 0) &&\n                (trgtElem.classList.contains('e-active-cell') || trgtElem.classList.contains('e-cell')\n                    || closest(trgtElem, '.e-sheet-content') || trgtElem.classList.contains('e-table'))) {\n                if (this.isEdit) {\n                    if (checkIsFormula(this.editCellData.value)) {\n                        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n                        if (this.parent.getActiveSheet().name === sheetName) {\n                            this.endEdit();\n                        }\n                    }\n                    else {\n                        if (trgtElem.className.indexOf('e-spreadsheet-edit') < 0) {\n                            this.endEdit();\n                        }\n                    }\n                }\n                else {\n                    this.isNewValueEdit = false;\n                    this.startEdit();\n                }\n            }\n        }\n        else {\n            if (trgtElem.classList.contains('e-active-cell') || trgtElem.classList.contains('e-cell')) {\n                this.parent.notify(editAlert, null);\n            }\n        }\n    };\n    Edit.prototype.updateEditCellDetail = function (addr, value) {\n        var sheetIdx;\n        var sheet;\n        if (isNullOrUndefined(this.editCellData.sheetIndex)) {\n            if (addr && addr.split('!').length > 1) {\n                sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(addr));\n            }\n            else {\n                sheetIdx = this.parent.activeSheetIndex;\n            }\n        }\n        else {\n            sheetIdx = this.editCellData.sheetIndex;\n        }\n        if (!this.editCellData.addr) {\n            sheet = getSheet(this.parent, sheetIdx);\n            if (addr) {\n                addr = getRangeFromAddress(addr);\n            }\n            else {\n                addr = sheet.activeCell;\n            }\n        }\n        else if (checkIsFormula(this.editCellData.value, true)) {\n            sheet = getSheet(this.parent, sheetIdx);\n            this.isNewValueEdit = false;\n        }\n        if (addr) {\n            var range = getRangeIndexes(addr);\n            var rowIdx = range[0];\n            var colIdx = range[1];\n            var cellElem = this.parent.getCell(rowIdx, colIdx);\n            var cellPosition = getCellPosition(sheet, range, this.parent.frozenRowCount(sheet), this.parent.frozenColCount(sheet), this.parent.viewport.beforeFreezeHeight, this.parent.viewport.beforeFreezeWidth, this.parent.sheetModule.colGroupWidth);\n            this.editCellData = {\n                addr: addr,\n                fullAddr: getSheetName(this.parent, sheetIdx) + '!' + addr,\n                rowIndex: rowIdx,\n                colIndex: colIdx,\n                sheetIndex: sheetIdx,\n                element: cellElem,\n                value: value || '',\n                position: cellPosition\n            };\n        }\n    };\n    Edit.prototype.initiateEditor = function (refreshCurPos) {\n        var _this = this;\n        var data = this.parent.getData(this.editCellData.fullAddr);\n        data.then(function (values) {\n            values.forEach(function (cell) {\n                var args = { cell: cell, value: cell ? cell.value : '' };\n                _this.parent.notify(getFormattedBarText, args);\n                var value = cell ? args.value : '';\n                if (cell && cell.formula) {\n                    value = cell.formula;\n                }\n                _this.editCellData.oldValue = value;\n                if (_this.editCellData.value) {\n                    value = _this.editCellData.value;\n                }\n                else {\n                    _this.editCellData.value = value;\n                }\n                if (_this.isNewValueEdit) {\n                    value = '';\n                }\n                else {\n                    _this.isNewValueEdit = true;\n                }\n                if (!isUndefined(value)) {\n                    _this.refreshEditor(value, false, true, false, false);\n                }\n                if (refreshCurPos) {\n                    _this.setCursorPosition();\n                }\n                if (_this.triggerEvent('cellEdit')) {\n                    _this.cancelEdit(true, false);\n                }\n            });\n        });\n    };\n    Edit.prototype.positionEditor = function (isWrap) {\n        var tdElem = this.editCellData.element;\n        var isEdit = false;\n        var cellEle;\n        var arg = { isEdit: isEdit };\n        this.parent.notify(isFormulaBarEdit, arg);\n        if (arg.isEdit && isNullOrUndefined(tdElem)) {\n            cellEle = this.parent.getCell(this.editCellData.rowIndex, this.editCellData.colIndex);\n            tdElem = cellEle;\n            this.editCellData.element = cellEle;\n        }\n        if (tdElem) {\n            tdElem.classList.add('e-ss-edited');\n            var sheet = this.parent.getActiveSheet();\n            var cell = getCell(this.editCellData.rowIndex, this.editCellData.colIndex, sheet, false, true);\n            var left = this.editCellData.position.left + 1;\n            var top_1 = this.editCellData.position.top + 1;\n            var args = { range: [this.editCellData.rowIndex, this.editCellData.colIndex, this.editCellData.rowIndex,\n                    this.editCellData.colIndex] };\n            this.parent.notify(activeCellMergedRange, args);\n            var minHeight = getRowsHeight(sheet, args.range[0], args.range[2]) - 3;\n            var minWidth = getColumnsWidth(sheet, args.range[1], args.range[3]) - 3;\n            var mainContElement = this.parent.element.getElementsByClassName('e-main-panel')[0];\n            var editWidth = void 0;\n            var frozenCol = this.parent.frozenColCount(sheet);\n            var zIndex = void 0;\n            var preventWrap = void 0;\n            var frozenRow = this.parent.frozenRowCount(sheet);\n            var addWrap = void 0;\n            if (this.editCellData.colIndex < frozenCol) {\n                editWidth = Math.abs(this.parent.getRowHeaderContent().getBoundingClientRect()[this.parent.enableRtl ? 'left' : 'right'] -\n                    tdElem.getBoundingClientRect()[this.parent.enableRtl ? 'right' : 'left']) - 1;\n                if (this.editCellData.rowIndex < frozenRow) {\n                    if (this.parent.getRowHeaderContent().style.zIndex === '2') {\n                        zIndex = '3';\n                    }\n                }\n                else {\n                    if (getTextWidth(cell.value, cell.style, this.parent.cellStyle) > editWidth) {\n                        addWrap = true;\n                    }\n                }\n            }\n            else {\n                editWidth = (mainContElement.offsetWidth - left - 28) - this.parent.sheetModule.getRowHeaderWidth(sheet);\n            }\n            if (this.editCellData.rowIndex < frozenRow) {\n                preventWrap = true;\n            }\n            var height = !preventWrap && ((cell && cell.wrap) || (tdElem && isWrap) || addWrap) ? 'auto;' : minHeight + 'px;';\n            // let editHeight: number = mainContElement.offsetHeight - top - 28;\n            var inlineStyles = 'display:block;top:' + top_1 + 'px;' + (this.parent.enableRtl ? 'right:' : 'left:') + left + 'px;' +\n                'min-width:' + minWidth + 'px;max-width:' + (cell && cell.wrap ? minWidth : editWidth) + 'px;' +\n                'height:' + height + (cell && cell.wrap ? ('width:' + minWidth + 'px;') : '') + 'min-height:' + minHeight + 'px;' +\n                (zIndex ? 'z-index: ' + zIndex + ';' : '') + (preventWrap && ((cell && !cell.wrap) || (tdElem && isWrap)) && (getTextWidth(cell.value, cell.style, this.parent.cellStyle) > editWidth || (tdElem && isWrap)) ? 'overflow: auto;' : '');\n            inlineStyles += tdElem.style.cssText;\n            var editorElem = this.getEditElement(sheet, true);\n            editorElem.setAttribute('style', inlineStyles);\n            if (getTextWidth(editorElem.textContent, cell.style, this.parent.cellStyle) > editWidth) {\n                editorElem.style.height = 'auto';\n            }\n            // we using edit div height as auto , while editing div enlarges and hide active cell bottom border for that\n            // we increasing 1px height to active cell.\n            this.parent.element.querySelector('.e-active-cell').style.height = (minHeight + 4) + 'px';\n            if (tdElem.classList.contains('e-right-align')) {\n                editorElem.classList.add('e-right-align');\n            }\n            else if (tdElem.classList.contains('e-center-align')) {\n                editorElem.classList.add('e-center-align');\n            }\n        }\n    };\n    Edit.prototype.updateEditedValue = function (tdRefresh) {\n        if (tdRefresh === void 0) { tdRefresh = true; }\n        var oldCellValue = this.editCellData.oldValue;\n        var newVal = this.editCellData.value;\n        var oldValue = oldCellValue ? oldCellValue.toString().toUpperCase() : '';\n        var isValidate = true;\n        var address = this.editCellData.addr;\n        var cellIndex = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(cellIndex[0], cellIndex[1], sheet);\n        var column = getColumn(sheet, cellIndex[1]);\n        if (oldCellValue && oldCellValue.toString().indexOf('=UNIQUE(') > -1 && this.editCellData.value === '') {\n            this.parent.notify(removeUniquecol, null);\n        }\n        var args = { cellIdx: cellIndex, isUnique: false };\n        this.checkUniqueRange(args);\n        var isUniqueRange = args.isUnique;\n        if (isUniqueRange && oldCellValue !== '' && this.editCellData.value === '') {\n            var rangeIdx = getRangeIndexes(this.uniqueColl);\n            if (getCell(rangeIdx[0], rangeIdx[1], sheet).value.indexOf('#SPILL!') === -1) {\n                return isValidate;\n            }\n        }\n        /* To set the before cell details for undo redo. */\n        this.parent.notify(setActionData, { args: { action: 'beforeCellSave', eventArgs: { address: this.editCellData.addr } } });\n        if (this.parent.allowDataValidation && ((cell && cell.validation) || (column && column.validation))) {\n            var value = this.getEditElement(sheet).innerText;\n            var isCell = true;\n            var sheetIdx = this.parent.activeSheetIndex;\n            var range = void 0;\n            if (typeof address === 'string') {\n                range = getRangeIndexes(address);\n            }\n            else {\n                range = address;\n            }\n            this.parent.notify(isValidation, { value: value, range: range, sheetIdx: sheetIdx, isCell: isCell });\n            isValidate = this.parent.allowDataValidation;\n            this.editCellData.value = isValidate ? value : this.editCellData.value;\n            this.parent.allowDataValidation = true;\n        }\n        if ((oldCellValue !== this.editCellData.value || oldValue.indexOf('=RAND()') > -1 || oldValue.indexOf('RAND()') > -1 ||\n            oldValue.indexOf('=RANDBETWEEN(') > -1 || oldValue.indexOf('RANDBETWEEN(') > -1) && isValidate) {\n            var sheet_1 = this.parent.getActiveSheet();\n            var cellIndex_1 = getRangeIndexes(sheet_1.activeCell);\n            this.parent.notify(workbookEditOperation, { action: 'updateCellValue', address: this.editCellData.addr, value: this.editCellData.value });\n            var cell_1 = getCell(cellIndex_1[0], cellIndex_1[1], sheet_1, true);\n            var eventArgs = this.getRefreshNodeArgs(cell_1, cellIndex_1[0], cellIndex_1[1]);\n            this.editCellData.value = eventArgs.value;\n            if (cell_1 && cell_1.formula) {\n                this.editCellData.formula = cell_1.formula;\n            }\n            if (cell_1 && cell_1.wrap) {\n                this.parent.notify(wrapEvent, { range: cellIndex_1, wrap: true, sheet: sheet_1 });\n            }\n            if (tdRefresh) {\n                this.parent.refreshNode(this.editCellData.element, eventArgs);\n            }\n            if (isUniqueRange) {\n                if ((oldCellValue !== '' && this.editCellData.value === '') ||\n                    (this.editCellData.formula && this.editCellData.formula.length > 1 && oldCellValue !== this.editCellData.formula)) {\n                    var rangeIdx = getRangeIndexes(this.uniqueColl);\n                    var skip = false;\n                    for (var j = rangeIdx[0]; j <= rangeIdx[2]; j++) {\n                        for (var k = rangeIdx[1]; k <= rangeIdx[3]; k++) {\n                            var cell_2 = getCell(j, k, sheet_1);\n                            if (j === rangeIdx[0] && k === rangeIdx[1]) {\n                                skip = false;\n                            }\n                            else if (!isNullOrUndefined(cell_2.value) && cell_2.value !== '') {\n                                skip = true;\n                            }\n                        }\n                    }\n                    if (!skip) {\n                        this.reApplyFormula();\n                    }\n                }\n                else {\n                    this.updateUniqueRange(newVal);\n                }\n            }\n        }\n        return isValidate;\n    };\n    Edit.prototype.checkUniqueRange = function (uniquArgs) {\n        var args = { range: [] };\n        this.parent.notify(getUniqueRange, args);\n        var collection = args.range;\n        for (var i = 0; i < collection.length; i++) {\n            var rangeIdx = getRangeIndexes(collection[i]);\n            for (var j = rangeIdx[0]; j <= rangeIdx[2]; j++) {\n                for (var k = rangeIdx[1]; k <= rangeIdx[3]; k++) {\n                    if (uniquArgs.cellIdx[0] === j && uniquArgs.cellIdx[1] === k) {\n                        uniquArgs.isUnique = true;\n                        this.uniqueCell = true;\n                        this.uniqueColl = collection[i];\n                        uniquArgs.uniqueRange = collection[i];\n                        break;\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.updateUniqueRange = function (value) {\n        var rangeIdx = getRangeIndexes(this.uniqueColl);\n        var skip = false;\n        if (getCell(rangeIdx[0], rangeIdx[1], this.parent.getActiveSheet()).value !== '#SPILL!') {\n            skip = true;\n        }\n        for (var j = rangeIdx[0]; j <= rangeIdx[2]; j++) {\n            for (var k = rangeIdx[1]; k <= rangeIdx[3]; k++) {\n                if (skip) {\n                    if (j === rangeIdx[0] && k === rangeIdx[1]) {\n                        this.parent.updateCell({ value: '#SPILL!' }, getRangeAddress([j, k]));\n                    }\n                    else {\n                        if (getRangeAddress([j, k]).split(':')[0] === this.editCellData.addr) {\n                            this.parent.updateCell({ value: value }, getRangeAddress([j, k]));\n                        }\n                        else {\n                            this.parent.updateCell({ value: '' }, getRangeAddress([j, k]));\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.reApplyFormula = function () {\n        var cellIdx = getRangeIndexes(this.uniqueColl);\n        var cell = getCell(cellIdx[0], cellIdx[1], this.parent.getActiveSheet());\n        this.parent.updateCell({ value: '' }, getRangeAddress([cellIdx[0], cellIdx[1]]));\n        var sheets = this.parent.sheets;\n        var formula = cell.formula;\n        for (var i = 0; i < sheets.length; i++) {\n            if (formula.indexOf(sheets[i].name) > -1) {\n                formula = formula.replace(sheets[i].name, '!' + i);\n            }\n        }\n        this.parent.computeExpression(formula);\n        this.uniqueCell = false;\n        if (this.uniqueActCell !== '') {\n            this.editCellData.value = this.uniqueActCell;\n            this.uniqueActCell = '';\n        }\n    };\n    Edit.prototype.refreshDependentCellValue = function (rowIdx, colIdx, sheetIdx) {\n        if (rowIdx && colIdx) {\n            rowIdx--;\n            colIdx--;\n            if ((this.editCellData.rowIndex !== rowIdx || this.editCellData.colIndex !== colIdx)\n                && this.parent.activeSheetIndex === sheetIdx || this.uniqueCell) {\n                var td = this.parent.getCell(rowIdx, colIdx);\n                if (td) {\n                    var sheet = getSheet(this.parent, sheetIdx);\n                    var cell = getCell(rowIdx, colIdx, sheet);\n                    var actCell = getRangeIndexes(sheet.activeCell);\n                    if (actCell[0] === rowIdx && actCell[1] === colIdx) {\n                        this.uniqueActCell = cell.value;\n                    }\n                    var eventArgs = this.getRefreshNodeArgs(cell, rowIdx, colIdx);\n                    this.parent.refreshNode(td, eventArgs);\n                }\n            }\n        }\n    };\n    Edit.prototype.getRefreshNodeArgs = function (cell, rowIdx, colIdx) {\n        cell = cell ? cell : {};\n        var fCode = (cell && cell.format) ? cell.format : '';\n        var eventArgs = {\n            value: cell.value, format: fCode, onLoad: true, rowIdx: rowIdx, colIdx: colIdx,\n            formattedText: '', isRightAlign: false, type: 'General', cell: cell\n        };\n        this.parent.notify(getFormattedCellObject, eventArgs);\n        eventArgs.formattedText = this.parent.allowNumberFormatting ? eventArgs.formattedText : eventArgs.value;\n        var args = {\n            isRightAlign: eventArgs.isRightAlign,\n            result: eventArgs.formattedText,\n            type: eventArgs.type,\n            value: eventArgs.value,\n            curSymbol: eventArgs.curSymbol\n        };\n        return args;\n    };\n    Edit.prototype.endEdit = function (refreshFormulaBar, event) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = false; }\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = this.parent.getCell(actCell[0], actCell[1]);\n        var fSize = '';\n        if (this.editCellData.element && this.editCellData.element.children[0] &&\n            this.editCellData.element.children[0].className === 'e-cf-databar') {\n            fSize = cell.children[0].querySelector('.e-databar-value').style.fontSize;\n        }\n        if (refreshFormulaBar) {\n            this.refreshEditor(this.editCellData.oldValue, false, true, false, false);\n        }\n        if (this.triggerEvent('beforeCellSave')) {\n            event.preventDefault();\n            return;\n        }\n        var isValidate = this.updateEditedValue();\n        if (isValidate) {\n            this.triggerEvent('cellSave', event);\n            this.resetEditState();\n            this.focusElement();\n        }\n        else if (event) {\n            event.preventDefault();\n        }\n        if (fSize !== '') {\n            cell.children[0].querySelector('.e-databar-value').style.fontSize = fSize;\n        }\n        if (this.parent.showSheetTabs && !this.parent.isProtected) {\n            this.parent.element.querySelector('.e-add-sheet-tab').removeAttribute('disabled');\n        }\n    };\n    Edit.prototype.cancelEdit = function (refreshFormulaBar, trigEvent, event) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = true; }\n        if (trigEvent === void 0) { trigEvent = true; }\n        this.refreshEditor(this.editCellData.oldValue, refreshFormulaBar, false, false, false);\n        if (trigEvent) {\n            this.triggerEvent('cellSave', event);\n        }\n        this.resetEditState();\n        this.focusElement();\n    };\n    Edit.prototype.focusElement = function () {\n        focus(this.parent.element);\n        this.parent.notify(enableToolbarItems, [{ enable: true }]);\n    };\n    Edit.prototype.triggerEvent = function (eventName, event) {\n        var cell = getCell(this.editCellData.rowIndex, this.editCellData.colIndex, this.parent.getActiveSheet());\n        var eventArgs = {\n            element: this.editCellData.element,\n            value: this.editCellData.value,\n            oldValue: this.editCellData.oldValue,\n            address: this.editCellData.fullAddr,\n            displayText: this.parent.getDisplayText(cell)\n        };\n        if (eventArgs.value !== eventArgs.oldValue) {\n            if (eventName === 'cellSave') {\n                if (this.editCellData.formula) {\n                    eventArgs.formula = this.editCellData.formula;\n                }\n                eventArgs.originalEvent = event;\n                this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'cellSave' });\n            }\n            if (eventName !== 'cellSave') {\n                eventArgs.cancel = false;\n            }\n        }\n        this.parent.trigger(eventName, eventArgs);\n        return eventArgs.cancel;\n    };\n    Edit.prototype.altEnter = function () {\n        this.positionEditor(true);\n        var selection = window.getSelection();\n        var node = selection.anchorNode;\n        var offset;\n        var range = document.createRange();\n        offset = (node.nodeType === 3) ? selection.anchorOffset : node.textContent.length;\n        if (offset === 0 && node.textContent.length > 0) {\n            offset = node.textContent.length;\n        }\n        var text = node.textContent;\n        var textBefore = text.slice(0, offset);\n        var textAfter = text.slice(offset) || ' ';\n        node.textContent = textBefore + '\\n' + textAfter;\n        range = document.createRange();\n        if (node.nodeType === 3) {\n            range.setStart(node, offset + 1);\n            range.setEnd(node, offset + 1);\n        }\n        else if (node.nodeType === 1) {\n            range.setStart(node.firstChild, offset + 1);\n            range.setEnd(node.firstChild, offset + 1);\n        }\n        selection.removeAllRanges();\n        selection.addRange(range);\n    };\n    Edit.prototype.resetEditState = function (elemRefresh) {\n        if (elemRefresh === void 0) { elemRefresh = true; }\n        if (elemRefresh) {\n            var editorElem = this.getEditElement(this.parent.getActiveSheet());\n            if (checkIsFormula(editorElem.textContent)) {\n                this.parent.notify(clearCellRef, null);\n            }\n            if (this.editCellData.element) {\n                this.editCellData.element.classList.remove('e-ss-edited');\n                this.editorElem.textContent = '';\n                if (editorElem === this.editorElem) {\n                    this.editorElem.removeAttribute('style');\n                    this.editorElem.classList.remove('e-right-align');\n                }\n                else {\n                    detach(editorElem);\n                }\n            }\n        }\n        this.editCellData = {};\n        this.parent.isEdit = this.isEdit = false;\n        this.isCellEdit = true;\n        this.parent.notify(formulaOperation, { action: 'endEdit' });\n    };\n    Edit.prototype.refSelectionRender = function () {\n        var editorElem = this.getEditElement(this.parent.getActiveSheet());\n        if (editorElem) {\n            if (checkIsFormula(editorElem.textContent)) {\n                this.parent.notify(initiateFormulaReference, {\n                    range: editorElem.textContent, formulaSheetIdx: this.editCellData.sheetIndex\n                });\n            }\n        }\n    };\n    // Start edit the formula cell and set cursor position\n    Edit.prototype.initiateRefSelection = function () {\n        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n        var value = this.parent.element.querySelector('.e-formula-bar').value;\n        if (this.parent.getActiveSheet().name === sheetName && checkIsFormula(this.editCellData.value, true)) {\n            this.startEdit(this.editCellData.addr, value, false);\n            this.parent.notify(initiateFormulaReference, {\n                range: this.editCellData.value, formulaSheetIdx: this.editCellData.sheetIndex\n            });\n            this.getEditElement(this.parent.getActiveSheet()).innerHTML = value;\n            this.initiateCurPosition();\n        }\n        else {\n            this.initiateCurPosition();\n        }\n    };\n    Edit.prototype.addressHandler = function (args) {\n        var selection = window.getSelection();\n        this.selectionStart = selection.anchorOffset;\n        this.selectionEnd = selection.focusOffset;\n        if (this.selectionStart > this.selectionEnd) {\n            var x = this.selectionStart;\n            this.selectionStart = this.selectionEnd;\n            this.selectionEnd = x;\n        }\n        if ((selection && selection.focusNode && selection.focusNode.classList &&\n            selection.focusNode.classList.contains('e-formula-bar-panel'))) {\n            var formulaBar = selection.focusNode.getElementsByClassName('e-formula-bar e-css')[0];\n            this.selectionStart = formulaBar.selectionStart;\n            this.selectionEnd = formulaBar.selectionEnd;\n        }\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var address = args.range;\n        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n        var sheetIdx = this.editCellData.sheetIndex;\n        var editorEle = this.getEditElement(this.parent.getActiveSheet());\n        if (this.parent.getActiveSheet().name !== sheetName) {\n            address = '\\'' + this.parent.getActiveSheet().name + '\\'' + '!' + address;\n        }\n        if (args.isSelect) {\n            this.parent.notify(initiateFormulaReference, { range: eventArgs.editedValue + address, formulaSheetIdx: sheetIdx });\n        }\n        else {\n            var sheetName_1 = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n            if (this.parent.getActiveSheet().name === sheetName_1) {\n                var editedValue = eventArgs.editedValue;\n                if (this.selectionStart !== this.selectionEnd) {\n                    this.formulaBarCurStartPos = this.selectionStart;\n                    this.curStartPos = this.selectionStart;\n                    this.curEndPos = this.selectionStart + address.length;\n                    editorEle.textContent = editedValue.substring(0, this.selectionStart)\n                        + address + editedValue.substring(this.selectionStart);\n                }\n                else if (editedValue.indexOf(')') === editedValue.length - 1 && this.selectionEnd === editedValue.length) {\n                    editorEle.textContent = editedValue.substring(0, editedValue.length - 1)\n                        + address + editedValue.substring(editedValue.length - 1);\n                    this.curEndPos = editorEle.textContent.length - 1;\n                }\n                else if (editedValue.indexOf(')') !== editedValue.length - 1) {\n                    editorEle.textContent = editedValue + address;\n                    this.curEndPos = editorEle.textContent.length;\n                }\n                else if (editorEle.textContent !== editedValue) {\n                    editorEle.textContent = editedValue.substring(0, this.curStartPos)\n                        + address + editedValue.substring(this.curStartPos);\n                    this.curEndPos = this.curStartPos + address.length;\n                }\n                else if (this.selectionStart === this.selectionEnd &&\n                    this.validCharacters.indexOf(editedValue.substring(this.selectionStart - 1, this.selectionEnd)) !== -1 &&\n                    (this.validCharacters.indexOf(editedValue.substring(this.selectionStart, this.selectionEnd + 1)) !== -1 ||\n                        editedValue.substring(this.selectionStart, this.selectionEnd + 1) === ')')) {\n                    editorEle.textContent = editedValue.substring(0, this.selectionStart)\n                        + address + editedValue.substring(this.selectionEnd);\n                    this.curStartPos = this.selectionStart;\n                    this.curEndPos = this.selectionStart + address.length;\n                    this.formulaBarCurStartPos = this.curStartPos;\n                }\n            }\n        }\n    };\n    Edit.prototype.updateFormulaBarValue = function () {\n        var selection = window.getSelection();\n        var value = this.editCellData.value;\n        var address = this.parent.getActiveSheet().selectedRange;\n        address = isSingleCell(getIndexesFromAddress(address)) ? address.split(':')[0] : address;\n        var formulaBar = this.parent.element.querySelector('.e-formula-bar');\n        if (value && checkIsFormula(value, true)) {\n            var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n            if (this.parent.getActiveSheet().name !== sheetName) {\n                address = '\\'' + this.parent.getActiveSheet().name + '\\'' + '!' + address;\n            }\n            if (!isNullOrUndefined(this.formulaBarCurStartPos)) {\n                formulaBar.value = value.substring(0, this.formulaBarCurStartPos)\n                    + address + value.substring(this.formulaBarCurStartPos);\n            }\n            else if (value.indexOf(')') === value.length - 1 && selection.focusOffset === value.length) {\n                formulaBar.value = value.substring(0, value.length - 1) + address + value.substring(value.length - 1);\n            }\n            else if (value.indexOf(')') !== value.length - 1) {\n                formulaBar.value = value + address;\n            }\n            else if (formulaBar.value !== value) {\n                formulaBar.value = value.substring(0, this.curStartPos)\n                    + address + value.substring(this.curStartPos);\n            }\n            this.curEndPos = this.curStartPos + address.length;\n        }\n    };\n    Edit.prototype.setFormulaBarCurPosition = function (input, selectionStart, selectionEnd) {\n        if (input.setSelectionRange) {\n            input.focus();\n            input.selectionStart = selectionStart;\n            input.selectionEnd = selectionStart;\n            input.setSelectionRange(selectionStart, selectionEnd);\n        }\n    };\n    Edit.prototype.initiateCurPosition = function (args) {\n        if (args === void 0) { args = { isCellEdit: false }; }\n        var el = this.getEditElement(this.parent.getActiveSheet(), true);\n        if (args.isCellEdit) {\n            var curOffset = this.getCurPosition();\n            if (!this.endFormulaRef && curOffset.start === curOffset.end) {\n                this.updateFormulaReference(el);\n                if (curOffset.end && this.validCharacters.indexOf(this.editCellData.value[curOffset.end - 1]) === -1) {\n                    this.endFormulaRef = true;\n                }\n            }\n            return;\n        }\n        var value = el.innerText;\n        var selection = window.getSelection();\n        if ((selection && selection.focusNode && selection.focusNode.classList &&\n            selection.focusNode.classList.contains('e-formula-bar-panel'))) {\n            var formulaBar = this.parent.element.querySelector('.e-formula-bar');\n            this.setFormulaBarCurPosition(formulaBar, this.curEndPos, this.curEndPos);\n            return;\n        }\n        if (value) {\n            var range = document.createRange();\n            if (value.indexOf(')') === value.length - 1) {\n                range.setStart(el.childNodes[0], this.curEndPos);\n                range.setEnd(el.childNodes[0], this.curEndPos);\n            }\n            else {\n                range.setStart(el.childNodes[0], this.curEndPos);\n                range.setEnd(el.childNodes[0], this.curEndPos);\n            }\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n        var sheetIdx = this.editCellData.sheetIndex;\n        if (sheetIdx !== this.parent.getActiveSheet().id - 1) {\n            var elem = this.parent.element.querySelector('.e-formula-bar');\n            if (elem.value) {\n                var valueLength = elem.value.length;\n                if (elem.value.indexOf(')') === valueLength - 1) {\n                    this.setFormulaBarCurPosition(elem, valueLength - 1, valueLength - 1);\n                }\n                else {\n                    this.setFormulaBarCurPosition(elem, valueLength, valueLength);\n                }\n            }\n        }\n    };\n    Edit.prototype.getEditElement = function (sheet, isEdit) {\n        if ((this.isEdit || isEdit) && (sheet.frozenRows || sheet.frozenColumns)) {\n            var frozenRow = this.parent.frozenRowCount(sheet);\n            var frozenCol = this.parent.frozenColCount(sheet);\n            var range = getCellIndexes(sheet.activeCell);\n            var content = void 0;\n            if (range[0] < frozenRow && range[1] < frozenCol) {\n                content = this.parent.getSelectAllContent();\n            }\n            else if (range[0] < frozenRow) {\n                content = this.parent.getColumnHeaderContent();\n            }\n            else if (range[1] < frozenCol) {\n                content = this.parent.getRowHeaderContent();\n            }\n            else {\n                return this.editorElem;\n            }\n            var editEle = content.getElementsByClassName('e-spreadsheet-edit')[0];\n            if (!editEle && isEdit) {\n                editEle = content.appendChild(this.editorElem.cloneNode());\n            }\n            return editEle;\n        }\n        return this.editorElem;\n    };\n    return Edit;\n}());\nexport { Edit };\n","import { contentLoaded, mouseDown, virtualContentLoaded, cellNavigate, getUpdateUsingRaf, focusBorder } from '../common/index';\nimport { showAggregate, refreshImgElem, getRowIdxFromClientY, getColIdxFromClientX, clearChartBorder } from '../common/index';\nimport { updateSelectedRange, getColumnWidth, mergedRange, activeCellMergedRange } from '../../workbook/index';\nimport { getRowHeight, isSingleCell, activeCellChanged, checkIsFormula, getSheetIndex } from '../../workbook/index';\nimport { EventHandler, addClass, removeClass, isNullOrUndefined, Browser, closest, remove, detach } from '@syncfusion/ej2-base';\nimport { selectionComplete, getMoveEvent, getEndEvent, isTouchStart, isMouseUp } from '../common/index';\nimport { isTouchEnd, isTouchMove, getClientX, getClientY, mouseUpAfterSelection, selectRange, rowHeightChanged } from '../common/index';\nimport { colWidthChanged, protectSelection, editOperation, initiateFormulaReference, initiateCur, clearCellRef } from '../common/index';\nimport { getRangeIndexes, getCellAddress, getRangeAddress, getCellIndexes, getSwapRange } from '../../workbook/common/address';\nimport { addressHandle, removeDesignChart, isMouseDown, isMouseMove, selectionStatus, setPosition, removeRangeEle } from '../common/index';\nimport { isCellReference, getSheetNameFromAddress, isLocked, getColumn, getCell } from '../../workbook/index';\nimport { getIndexesFromAddress } from '../../workbook/common/address';\n/**\n * Represents selection support for Spreadsheet.\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet selection module.\n     *\n     * @param {Spreadsheet} parent - Constructor for the Spreadsheet selection module.\n     * @private\n     */\n    function Selection(parent) {\n        this.uniqueOBracket = String.fromCharCode(129);\n        this.uniqueCBracket = String.fromCharCode(130);\n        this.uniqueCSeparator = String.fromCharCode(131);\n        this.uniqueCOperator = String.fromCharCode(132);\n        this.uniquePOperator = String.fromCharCode(133);\n        this.uniqueSOperator = String.fromCharCode(134);\n        this.uniqueMOperator = String.fromCharCode(135);\n        this.uniqueDOperator = String.fromCharCode(136);\n        this.uniqueModOperator = String.fromCharCode(137);\n        this.uniqueConcateOperator = String.fromCharCode(138);\n        this.uniqueEqualOperator = String.fromCharCode(139);\n        this.uniqueExpOperator = String.fromCharCode(140);\n        this.uniqueGTOperator = String.fromCharCode(141);\n        this.uniqueLTOperator = String.fromCharCode(142);\n        this.invalidOperators = ['%'];\n        this.formulaRange = [];\n        this.tableRangesFormula = {};\n        this.parent = parent;\n        this.addEventListener();\n        this.mouseMoveEvt = this.mouseMoveHandler.bind(this);\n    }\n    Selection.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.init, this);\n        this.parent.on(mouseDown, this.mouseDownHandler, this);\n        this.parent.on(virtualContentLoaded, this.virtualContentLoadedHandler, this);\n        this.parent.on(cellNavigate, this.cellNavigateHandler, this);\n        this.parent.on(selectRange, this.selectRange, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChanged, this);\n        this.parent.on(colWidthChanged, this.colWidthChanged, this);\n        this.parent.on(protectSelection, this.protectHandler, this);\n        this.parent.on(initiateFormulaReference, this.initiateFormulaSelection, this);\n        this.parent.on(clearCellRef, this.clearBorder, this);\n        this.parent.on(getRowIdxFromClientY, this.getRowIdxFromClientY, this);\n        this.parent.on(getColIdxFromClientX, this.getColIdxFromClientX, this);\n        this.parent.on(focusBorder, this.chartBorderHandler, this);\n        this.parent.on(selectionStatus, this.isTouchSelectionStarted, this);\n    };\n    Selection.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(contentLoaded, this.init);\n            this.parent.off(mouseDown, this.mouseDownHandler);\n            this.parent.off(virtualContentLoaded, this.virtualContentLoadedHandler);\n            this.parent.off(cellNavigate, this.cellNavigateHandler);\n            this.parent.off(selectRange, this.selectRange);\n            this.parent.off(rowHeightChanged, this.rowHeightChanged);\n            this.parent.off(colWidthChanged, this.colWidthChanged);\n            this.parent.off(protectSelection, this.protectHandler);\n            this.parent.off(initiateFormulaReference, this.initiateFormulaSelection);\n            this.parent.off(clearCellRef, this.clearBorder);\n            this.parent.off(getRowIdxFromClientY, this.getRowIdxFromClientY);\n            this.parent.off(getColIdxFromClientX, this.getColIdxFromClientX);\n            this.parent.off(focusBorder, this.chartBorderHandler);\n            this.parent.off(selectionStatus, this.isTouchSelectionStarted);\n        }\n    };\n    Selection.prototype.isTouchSelectionStarted = function (args) {\n        args.touchSelectionStarted = this.touchSelectionStarted;\n    };\n    Selection.prototype.rowHeightChanged = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var ele = _this.getActiveCell();\n            var sheet = _this.parent.getActiveSheet();\n            if (ele) {\n                var cellIndex = getCellIndexes(sheet.activeCell);\n                if (sheet.frozenRows || sheet.frozenColumns) {\n                    var e = { range: [cellIndex[0], cellIndex[1], cellIndex[0], cellIndex[1]] };\n                    _this.parent.notify(activeCellMergedRange, e);\n                    setPosition(_this.parent, ele, e.range, 'e-active-cell');\n                }\n                else {\n                    if (cellIndex[0] === args.rowIdx) {\n                        ele.style.height = parseFloat(ele.style.height) + args.threshold + \"px\";\n                    }\n                    else if (cellIndex[0] > args.rowIdx) {\n                        ele.style.top = parseFloat(ele.style.top) + args.threshold + \"px\";\n                    }\n                }\n            }\n            ele = _this.getSelectionElement();\n            if (ele) {\n                var selectedRange = getRangeIndexes(sheet.selectedRange);\n                var sRange = getSwapRange(selectedRange);\n                var mergeArgs = { range: sRange, isActiveCell: false, skipChecking: true };\n                _this.parent.notify(mergedRange, mergeArgs);\n                if (mergeArgs.isActiveCell || (sRange[0] === sRange[2] && sRange[1] === sRange[3])) {\n                    return;\n                }\n                if (sheet.frozenRows || sheet.frozenColumns) {\n                    setPosition(_this.parent, ele, selectedRange);\n                    return;\n                }\n                var rowStart = sRange[0];\n                var rowEnd = sRange[2];\n                if (rowStart <= args.rowIdx && rowEnd >= args.rowIdx && ele) {\n                    ele.style.height = parseFloat(ele.style.height) + args.threshold + \"px\";\n                }\n                else if (rowStart > args.rowIdx && ele) {\n                    ele.style.top = parseFloat(ele.style.top) + args.threshold + \"px\";\n                }\n            }\n        });\n    };\n    Selection.prototype.colWidthChanged = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var sheet = _this.parent.getActiveSheet();\n            var ele = _this.getActiveCell();\n            if (ele) {\n                var cellIndex = getCellIndexes(_this.parent.getActiveSheet().activeCell);\n                if (sheet.frozenRows || sheet.frozenColumns) {\n                    var mergeArgs = { range: [cellIndex[0], cellIndex[1], cellIndex[0], cellIndex[1]] };\n                    _this.parent.notify(activeCellMergedRange, mergeArgs);\n                    setPosition(_this.parent, ele, mergeArgs.range, 'e-active-cell');\n                }\n                else {\n                    if (cellIndex[1] === args.colIdx) {\n                        ele.style.width = parseFloat(ele.style.width) + args.threshold + \"px\";\n                    }\n                    else if (cellIndex[1] > args.colIdx) {\n                        ele.style.left = parseFloat(ele.style.left) + args.threshold + \"px\";\n                    }\n                }\n            }\n            ele = _this.getSelectionElement();\n            var selectedRange = getRangeIndexes(_this.parent.getActiveSheet().selectedRange);\n            var sRange = getSwapRange(selectedRange);\n            var e = { range: sRange, isActiveCell: false, skipChecking: true };\n            _this.parent.notify(mergedRange, e);\n            if (e.isActiveCell || (sRange[0] === sRange[2] && sRange[1] === sRange[3])) {\n                return;\n            }\n            if (sheet.frozenRows || sheet.frozenColumns) {\n                setPosition(_this.parent, ele, selectedRange);\n                return;\n            }\n            var colStart = sRange[1];\n            var colEnd = sRange[3];\n            if (colStart <= args.colIdx && colEnd >= args.colIdx && ele) {\n                ele.style.width = parseFloat(ele.style.width) + args.threshold + \"px\";\n            }\n            else if (colStart > args.colIdx && ele) {\n                ele.style.left = parseFloat(ele.style.left) + args.threshold + \"px\";\n            }\n        });\n    };\n    Selection.prototype.selectRange = function (args) {\n        args.address = this.parent.selectionSettings.mode === 'Single' ? getRangeAddress(getCellIndexes(args.address)) : args.address;\n        this.selectMultiRange(args.address, null, null, args.skipChecking);\n    };\n    Selection.prototype.init = function () {\n        this.createSelectionElement();\n        var sheet = this.parent.getActiveSheet();\n        var sRange = getSwapRange(getRangeIndexes(sheet.selectedRange));\n        var actRange = getCellIndexes(sheet.activeCell);\n        var inRange = sRange[0] <= actRange[0] && sRange[2] >= actRange[0] && sRange[1] <= actRange[1]\n            && sRange[3] >= actRange[1];\n        this.selectMultiRange(sheet.selectedRange, true, inRange);\n    };\n    Selection.prototype.selectMultiRange = function (address, isInit, inRange, skipChecking) {\n        var _this = this;\n        var sheetIdx = this.parent.activeSheetIndex;\n        if (address.indexOf('!') > -1) {\n            sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(address));\n            address = address.split('!')[1];\n        }\n        if (this.parent.activeSheetIndex === sheetIdx) {\n            address.split(' ').forEach(function (rng, idx) {\n                _this.selectRangeByIdx(getRangeIndexes(rng), { type: 'mousedown', ctrlKey: idx === 0 ? false : true }, null, inRange, isInit, skipChecking);\n            });\n        }\n        else {\n            updateSelectedRange(this.parent, address, this.parent.sheets[sheetIdx]);\n        }\n    };\n    Selection.prototype.createSelectionElement = function () {\n        var content = this.parent.getMainContent();\n        var ele = this.parent.createElement('div', { className: 'e-selection' });\n        content.appendChild(ele);\n        ele = this.parent.createElement('div', { className: 'e-active-cell' });\n        content.appendChild(ele);\n    };\n    Selection.prototype.mouseDownHandler = function (e) {\n        if (closest(e.target, '.e-scrollbar') || e.target.classList.contains('e-main-panel') ||\n            e.target.classList.contains('e-sheet')) {\n            return;\n        }\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue, true);\n        if (!this.parent.isEdit || isFormulaEdit) {\n            var overlayElem = document.getElementById(this.parent.element.id + '_overlay');\n            if (typeof (e.target.className) === 'string') {\n                if (e.target.className.indexOf('e-ss-overlay') > -1) {\n                    return;\n                }\n            }\n            else if (overlayElem) {\n                overlayElem.classList.remove('e-ss-overlay-active');\n            }\n            if (closest(e.target, '.e-datavisualization-chart')) {\n                return;\n            }\n            if (this.parent.getActiveSheet().isProtected && !this.parent.getActiveSheet().protectSettings.selectCells) {\n                return;\n            }\n            if (!closest(e.target, '.e-findtool-dlg')) {\n                if (this.getSheetElement().contains(e.target) && !e.target.classList.contains('e-colresize')\n                    && !e.target.classList.contains('e-rowresize')) {\n                    var sheet = this.parent.getActiveSheet();\n                    var mode = this.parent.selectionSettings.mode;\n                    var rowIdx = this.getRowIdxFromClientY({ clientY: getClientY(e), target: e.target });\n                    var colIdx = this.getColIdxFromClientX({ clientX: getClientX(e), target: e.target });\n                    var activeIdx = getCellIndexes(sheet.activeCell);\n                    var isRowSelected = void 0;\n                    var isColSelected = void 0;\n                    if (sheet.showHeaders) {\n                        var trgt = e.target;\n                        if (sheet.frozenColumns || sheet.frozenRows) {\n                            var headerEle = this.parent.getSelectAllContent().querySelector('thead');\n                            if (headerEle) {\n                                isColSelected = (this.parent.getColumnHeaderContent().contains(trgt) || headerEle.contains(trgt)) &&\n                                    trgt.classList.contains('e-header-cell');\n                            }\n                            else {\n                                isColSelected = this.parent.getColumnHeaderContent().contains(trgt) &&\n                                    trgt.classList.contains('e-header-cell');\n                            }\n                            headerEle = this.parent.getSelectAllContent().querySelector('tbody');\n                            if (headerEle) {\n                                isRowSelected = (this.parent.getRowHeaderContent().contains(trgt) || headerEle.contains(trgt)) &&\n                                    trgt.classList.contains('e-header-cell');\n                            }\n                            else {\n                                isRowSelected = this.parent.getRowHeaderContent().contains(trgt) &&\n                                    trgt.classList.contains('e-header-cell');\n                            }\n                        }\n                        else {\n                            isRowSelected = this.parent.getRowHeaderContent().contains(e.target);\n                            isColSelected = this.parent.getColumnHeaderContent().contains(e.target);\n                        }\n                    }\n                    if (e.which === 3 && this.isSelected(rowIdx, colIdx)) {\n                        return;\n                    }\n                    if (mode === 'Multiple' && (!isTouchEnd(e) && (!isTouchStart(e) ||\n                        (isTouchStart(e) && activeIdx[0] === rowIdx && activeIdx[1] === colIdx)) || isColSelected || isRowSelected)) {\n                        document.addEventListener(getMoveEvent().split(' ')[0], this.mouseMoveEvt);\n                        if (!Browser.isPointer) {\n                            document.addEventListener(getMoveEvent().split(' ')[1], this.mouseMoveEvt, { passive: false });\n                        }\n                        this.touchSelectionStarted = true;\n                    }\n                    else {\n                        this.touchSelectionStarted = false;\n                    }\n                    if (!isTouchEnd(e)) {\n                        EventHandler.add(document, getEndEvent(), this.mouseUpHandler, this);\n                    }\n                    if (isTouchStart(e) && !(isColSelected || isRowSelected)) {\n                        this.touchEvt = e;\n                        return;\n                    }\n                    var topLeftIdx = getRangeIndexes(sheet.topLeftCell);\n                    if (isRowSelected) {\n                        this.isRowSelected = true;\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [rowIdx, 0];\n                        }\n                        this.selectRangeByIdx([this.startCell[0], sheet.frozenColumns ? topLeftIdx[1] : 0, rowIdx, sheet.colCount - 1], e);\n                    }\n                    else if (isColSelected) {\n                        this.isColSelected = true;\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [0, colIdx];\n                        }\n                        this.selectRangeByIdx([sheet.frozenRows ? topLeftIdx[0] : 0, this.startCell[1], sheet.rowCount - 1, colIdx], e);\n                    }\n                    else if (closest(e.target, '.e-select-all-cell')) {\n                        this.startCell = [sheet.frozenRows ? topLeftIdx[0] : 0, sheet.frozenColumns ? topLeftIdx[1] : 0];\n                        this.selectRangeByIdx([].concat(this.startCell, [sheet.rowCount - 1, sheet.colCount - 1]), e);\n                    }\n                    else if (!e.target.classList.contains('e-sheet-content')) {\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [rowIdx, colIdx];\n                        }\n                        this.selectRangeByIdx([].concat(this.startCell ? this.startCell : getCellIndexes(sheet.activeCell), [rowIdx, colIdx]), e);\n                    }\n                    if (this.parent.isMobileView()) {\n                        this.parent.element.classList.add('e-mobile-focused');\n                        this.parent.renderModule.setSheetPanelSize();\n                    }\n                }\n            }\n        }\n        if (isFormulaEdit && (e.target.classList.contains('e-cell') ||\n            e.target.classList.contains('e-header-cell')) && this.parent.isEdit) {\n            var range = this.parent.getActiveSheet().selectedRange;\n            range = isSingleCell(getIndexesFromAddress(range)) ? range.split(':')[0] : range;\n            this.parent.notify(addressHandle, { range: range, isSelect: false });\n        }\n    };\n    Selection.prototype.mouseMoveHandler = function (e) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        if (isTouchMove(e)) {\n            e.preventDefault();\n        }\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue, true);\n        var verticalContent = this.parent.getMainContent().parentElement;\n        var horizontalContent = this.parent.element.getElementsByClassName('e-scroller')[0];\n        var clientRect = verticalContent.getBoundingClientRect();\n        var frozenCol = this.parent.frozenColCount(sheet);\n        var left = clientRect.left + this.parent.sheetModule.getRowHeaderWidth(sheet);\n        var top = clientRect.top;\n        var right = clientRect.right;\n        var bottom = clientRect.bottom;\n        var clientX = getClientX(e);\n        var clientY = getClientY(e);\n        // remove math.min or handle top and left auto scroll\n        var colIdx = this.isRowSelected ? sheet.colCount - 1 :\n            this.getColIdxFromClientX({ clientX: Math.min(clientX, right), target: e.target });\n        var rowIdx = this.isColSelected ? sheet.rowCount - 1 :\n            this.getRowIdxFromClientY({ clientY: Math.min(clientY, bottom), target: e.target });\n        var prevIndex = getRangeIndexes(sheet.selectedRange);\n        var mergeArgs = { range: [rowIdx, colIdx, rowIdx, colIdx] };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        if (mergeArgs.range[2] === prevIndex[2] && mergeArgs.range[3] === prevIndex[3]) {\n            return;\n        }\n        var frozenRow = this.parent.frozenRowCount(sheet);\n        var isScrollDown = clientY > bottom && rowIdx < sheet.rowCount;\n        var isScrollUp = clientY < top && rowIdx >= 0 && !this.isColSelected && !!verticalContent.scrollTop;\n        var isScrollRight = clientX > right && colIdx < sheet.colCount;\n        var isScrollLeft = clientX < left && colIdx >= 0 && !this.isRowSelected && !!horizontalContent.scrollLeft;\n        this.clearInterval();\n        var scrollUpRowIdx;\n        var scrollUpColIdx;\n        if (!isFormulaEdit && !this.isColSelected && !this.isRowSelected) {\n            prevIndex = getCellIndexes(sheet.activeCell);\n        }\n        if (isScrollDown || isScrollUp || isScrollRight || isScrollLeft) {\n            if (isScrollUp || isScrollLeft) {\n                scrollUpRowIdx = rowIdx;\n                scrollUpColIdx = colIdx;\n            }\n            this.scrollInterval = setInterval(function () {\n                if ((isScrollDown || isScrollUp) && !_this.isColSelected) {\n                    rowIdx = _this.getRowIdxFromClientY({ clientY: isScrollDown ? bottom : top });\n                    if (rowIdx >= sheet.rowCount) { // clear interval when scroll up\n                        _this.clearInterval();\n                        return;\n                    }\n                    verticalContent.scrollTop += (isScrollDown ? 1 : -1) * getRowHeight(sheet, rowIdx);\n                }\n                if ((isScrollRight || isScrollLeft) && !_this.isRowSelected) {\n                    colIdx = _this.getColIdxFromClientX({ clientX: isScrollRight ? right : left });\n                    if (colIdx >= sheet.colCount) { // clear interval when scroll left\n                        _this.clearInterval();\n                        return;\n                    }\n                    horizontalContent.scrollLeft += (isScrollRight ? 1 : -1) * getColumnWidth(sheet, colIdx);\n                }\n                if ((isScrollUp && !verticalContent.scrollTop) || (isScrollLeft && !horizontalContent.scrollLeft)) {\n                    _this.selectRangeByIdx([].concat(prevIndex[0], prevIndex[1], [scrollUpRowIdx, scrollUpColIdx]), e);\n                    _this.clearInterval();\n                    return;\n                }\n                _this.selectRangeByIdx([].concat(prevIndex[0], prevIndex[1], [rowIdx, colIdx]), e);\n            }, 100);\n        }\n        else {\n            var indexes = [].concat(prevIndex[0], prevIndex[1], [rowIdx, colIdx]);\n            if (frozenRow && indexes[0] < frozenRow && indexes[2] >= frozenRow && verticalContent.scrollTop) {\n                verticalContent.scrollTop = 0;\n                indexes[2] = frozenRow;\n            }\n            if (frozenCol && indexes[1] < frozenCol && indexes[3] >= frozenCol && horizontalContent.scrollLeft) {\n                horizontalContent.scrollLeft = 0;\n                indexes[3] = frozenCol;\n            }\n            this.selectRangeByIdx(indexes, e);\n        }\n        if (isFormulaEdit && this.parent.isEdit && !closest(e.target, '#' + this.parent.element.id + '_edit')) {\n            var range = this.parent.getActiveSheet().selectedRange;\n            this.parent.notify(addressHandle, { range: range, isSelect: false });\n        }\n    };\n    Selection.prototype.mouseUpHandler = function (e) {\n        var rowIdx = this.getRowIdxFromClientY({ clientY: getClientY(e), target: e.target });\n        var colIdx = this.getColIdxFromClientX({ clientX: getClientX(e), target: e.target });\n        this.clearInterval();\n        if (isTouchEnd(e) && !(this.isColSelected || this.isRowSelected) &&\n            (this.getRowIdxFromClientY({ clientY: getClientY(this.touchEvt), target: e.target }) === rowIdx &&\n                this.getColIdxFromClientX({ clientX: getClientX(this.touchEvt), target: e.target }) === colIdx)) {\n            this.mouseDownHandler(e);\n        }\n        this.parent.trigger('select', { range: this.parent.getActiveSheet().selectedRange });\n        document.removeEventListener(getMoveEvent().split(' ')[0], this.mouseMoveEvt);\n        if (!Browser.isPointer) {\n            document.removeEventListener(getMoveEvent().split(' ')[1], this.mouseMoveEvt);\n        }\n        EventHandler.remove(document, getEndEvent(), this.mouseUpHandler);\n        this.parent.notify(mouseUpAfterSelection, e);\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue) ||\n            (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0);\n        if (isFormulaEdit && this.parent.isEdit) {\n            this.parent.notify(initiateCur, { isCellEdit: e.target.classList.contains('e-spreadsheet-edit') });\n        }\n    };\n    Selection.prototype.isSelected = function (rowIdx, colIdx) {\n        var indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n        return indexes[0] <= rowIdx && rowIdx <= indexes[2] && indexes[1] <= colIdx && colIdx <= indexes[3];\n    };\n    Selection.prototype.virtualContentLoadedHandler = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        var isColSelected;\n        var isRowSelected;\n        sheet.selectedRange.split(' ').forEach(function (rng, idx) {\n            indexes = getRangeIndexes(rng);\n            isRowSelected = (indexes[1] === 0 && indexes[3] === args.prevRowColCnt.colCount - 1);\n            isColSelected = (indexes[0] === 0 && indexes[2] === args.prevRowColCnt.rowCount - 1);\n            if (isColSelected && isRowSelected) {\n                _this.selectRangeByIdx([0, 0, sheet.rowCount - 1, sheet.colCount - 1], null, true, null, null, null, idx);\n            }\n            else if (isColSelected) {\n                _this.selectRangeByIdx([0, indexes[1], sheet.rowCount - 1, indexes[3]], null, true, null, null, null, idx);\n            }\n            else if (isRowSelected) {\n                _this.selectRangeByIdx([indexes[0], 0, indexes[2], sheet.colCount - 1], null, true, null, null, null, idx);\n            }\n            else {\n                indexes = getRangeIndexes(rng);\n                _this.highlightHdr(indexes, idx === 0 ? false : true, indexes[0] >= _this.parent.viewport.topIndex || indexes[2] >= _this.parent.viewport.topIndex, indexes[1] >= _this.parent.viewport.leftIndex || indexes[3] >= _this.parent.viewport.leftIndex);\n            }\n        });\n    };\n    Selection.prototype.clearInterval = function () {\n        clearInterval(this.scrollInterval);\n        this.scrollInterval = null;\n    };\n    Selection.prototype.getScrollLeft = function () {\n        return this.parent.scrollModule ? this.parent.scrollModule.prevScroll.scrollLeft : 0;\n    };\n    Selection.prototype.cellNavigateHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n            return;\n        }\n        this.selectRangeByIdx(args.range.concat(args.range));\n    };\n    Selection.prototype.getColIdxFromClientX = function (e) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var left = 0;\n        if (e.isImage) {\n            left = e.clientX;\n        }\n        else {\n            var cliRect = document.getElementById(this.parent.element.id + '_sheet').getBoundingClientRect();\n            if (this.parent.enableRtl) {\n                left = (cliRect.right - this.parent.sheetModule.getRowHeaderWidth(sheet, true) - 1) - e.clientX;\n            }\n            else {\n                left = e.clientX - (cliRect.left + this.parent.sheetModule.getRowHeaderWidth(sheet, true) + 1);\n            }\n            left += this.parent.viewport.beforeFreezeWidth;\n            if (!e.target || (!closest(e.target, '.e-row-header') && !closest(e.target, '.e-selectall-container')) ||\n                this.isScrollableArea(e.clientX, e.target, true)) {\n                left += this.getScrollLeft();\n            }\n        }\n        for (var i = 0;; i++) {\n            width += getColumnWidth(sheet, i, null, true);\n            if (left < width || (this.parent.scrollSettings.isFinite && i === sheet.colCount - 1)) {\n                if (!e.isImage) {\n                    e.size = left;\n                }\n                e.clientX = i;\n                return i;\n            }\n        }\n    };\n    Selection.prototype.isScrollableArea = function (offset, target, isclientX) {\n        if (!target.classList.contains('e-table')) {\n            return false;\n        }\n        if (isclientX) {\n            return offset > this.parent.getMainContent().getBoundingClientRect().left;\n        }\n        else {\n            return offset > this.parent.getMainContent().parentElement.getBoundingClientRect().top;\n        }\n    };\n    Selection.prototype.getRowIdxFromClientY = function (args) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        var top = 0;\n        if (args.isImage) {\n            top = args.clientY;\n        }\n        else {\n            var sheetEle = document.getElementById(this.parent.element.id + '_sheet');\n            top = args.clientY + this.parent.viewport.beforeFreezeHeight -\n                (sheetEle.getBoundingClientRect().top + (sheet.showHeaders ? 31 : 0));\n            if (!args.target || !closest(args.target, '.e-header-panel') || this.isScrollableArea(args.clientY, args.target)) {\n                top += this.parent.getMainContent().parentElement.scrollTop;\n            }\n        }\n        for (var i = 0;; i++) {\n            height += getRowHeight(sheet, i, true);\n            if (top < height || (this.parent.scrollSettings.isFinite && i === sheet.rowCount - 1)) {\n                if (!args.isImage) {\n                    args.size = top;\n                }\n                args.clientY = i;\n                return i;\n            }\n        }\n    };\n    Selection.prototype.initFormulaReferenceIndicator = function (range) {\n        if (this.parent.isEdit) {\n            var forRefIndicator = this.parent.createElement('div', { className: 'e-formularef-indicator' });\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-top' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-bottom' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-left' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-right' }));\n            this.parent.getMainContent().appendChild(forRefIndicator);\n            setPosition(this.parent, forRefIndicator, range, 'e-formularef-indicator');\n        }\n    };\n    Selection.prototype.selectRangeByIdx = function (range, e, isScrollRefresh, isActCellChanged, isInit, skipChecking, selectedRowColIdx) {\n        if (e && e.target && closest(e.target, '#' + this.parent.element.id + '_edit')) {\n            return;\n        }\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '',\n            endFormulaRef: false };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue, true) && !eventArgs.endFormulaRef;\n        var isMultiRange = e && e.ctrlKey && isMouseDown(e);\n        var ele = this.getSelectionElement(e, selectedRowColIdx);\n        var sheet = this.parent.getActiveSheet();\n        var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n        var mergeArgs = { range: [].slice.call(range), isActiveCell: false, skipChecking: skipChecking };\n        var isMergeRange;\n        var overlayEle = document.querySelector('.e-datavisualization-chart.e-ss-overlay-active');\n        if (!this.isColSelected && !this.isRowSelected) {\n            this.parent.notify(mergedRange, mergeArgs);\n        }\n        if (range !== mergeArgs.range) {\n            isMergeRange = true;\n        }\n        range = mergeArgs.range;\n        var args = { range: getRangeAddress(range), cancel: false };\n        this.parent.trigger('beforeSelect', args);\n        if (args.cancel) {\n            return;\n        }\n        if (isFormulaEdit && formulaRefIndicator) {\n            formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n        }\n        if ((isSingleCell(range) || mergeArgs.isActiveCell) && !isMultiRange) {\n            if (ele) {\n                if (!ele.classList.contains('e-multi-range')) {\n                    ele.classList.add('e-hide');\n                }\n                if (sheet.frozenRows || sheet.frozenColumns) {\n                    removeRangeEle(this.parent.getSelectAllContent(), null, false);\n                    removeRangeEle(this.parent.getColumnHeaderContent(), null, false);\n                    removeRangeEle(this.parent.getRowHeaderContent(), null, false);\n                }\n            }\n            if (!sheet.frozenColumns && !sheet.frozenRows && ele) {\n                setPosition(this.parent, ele, range);\n            }\n            if (isFormulaEdit && e && e.target && !e.target.classList.contains('e-spreadsheet-edit')\n                && this.parent.isEdit) {\n                this.parent.notify(addressHandle, { range: getRangeAddress(range).split(':')[0], isSelect: true });\n                this.initFormulaReferenceIndicator(range);\n            }\n        }\n        else {\n            if (isFormulaEdit && this.parent.isEdit) {\n                if (e && e.target && !e.target.classList.contains('e-spreadsheet-edit') && this.parent.isEdit) {\n                    this.parent.notify(addressHandle, { range: getRangeAddress(range), isSelect: true });\n                    this.initFormulaReferenceIndicator(range);\n                }\n            }\n            else {\n                if (ele) {\n                    ele.classList.remove('e-hide');\n                }\n                var offset = (this.isColSelected && this.isRowSelected) ? undefined\n                    : this.getOffset(range[2], range[3]);\n                if (isMergeRange && offset) { // Need to handle half hidden merge cell in better way\n                    offset.left = { idx: 0, size: 0 };\n                }\n                setPosition(this.parent, ele, range);\n            }\n        }\n        var eArgs = { action: 'getCurrentEditSheetIdx', sheetIndex: null };\n        this.parent.notify(editOperation, eArgs);\n        var selRange = getRangeAddress(range);\n        if (e && e.ctrlKey && (isMouseMove(e) || isMouseUp(e))) {\n            selRange = sheet.selectedRange.slice(0, sheet.selectedRange.lastIndexOf(' ')) + ' ' + selRange;\n        }\n        else if (selectedRowColIdx > -1) {\n            var selRanges = sheet.selectedRange.split(' ');\n            selRanges[selectedRowColIdx] = selRange;\n            selRange = selRanges.join(' ');\n        }\n        if (!isFormulaEdit) {\n            updateSelectedRange(this.parent, selRange, sheet, isMultiRange);\n        }\n        else if (!isInit) {\n            updateSelectedRange(this.parent, selRange, sheet, isMultiRange);\n        }\n        this.UpdateRowColSelected(range);\n        this.highlightHdr(range, e && e.ctrlKey);\n        if (!isScrollRefresh && !(e && (e.type === 'mousemove' || isTouchMove(e)))) {\n            if (!isFormulaEdit) {\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n            else if (eArgs.sheetIndex === this.parent.getActiveSheet().id - 1 && isInit) {\n                isActCellChanged = true;\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n            else if (!this.parent.isEdit) {\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n        }\n        if (isNullOrUndefined(e)) {\n            e = { type: 'mousedown' };\n        }\n        if (!isFormulaEdit) {\n            this.parent.notify(selectionComplete, e);\n        }\n        else if (!isInit) {\n            this.parent.notify(selectionComplete, e);\n        }\n        this.parent.notify(showAggregate, {});\n        this.parent.notify(refreshImgElem, {});\n        if (overlayEle) {\n            this.parent.notify(removeDesignChart, {});\n        }\n        this.parent.notify(clearChartBorder, {});\n    };\n    Selection.prototype.UpdateRowColSelected = function (indexes) {\n        var sheet = this.parent.getActiveSheet();\n        this.isRowSelected = (indexes[1] === 0 && indexes[3] === sheet.colCount - 1);\n        this.isColSelected = (indexes[0] === 0 && indexes[2] === sheet.rowCount - 1);\n    };\n    Selection.prototype.updateActiveCell = function (range, isInit) {\n        var sheet = this.parent.getActiveSheet();\n        var topLeftIdx = getRangeIndexes(sheet.topLeftCell);\n        var rowIdx;\n        var colIdx;\n        var isMergeRange;\n        if (this.isColSelected) {\n            rowIdx = topLeftIdx[0];\n            colIdx = range[1];\n            if (this.isRowSelected) {\n                colIdx = topLeftIdx[1];\n            }\n        }\n        else {\n            rowIdx = range[0];\n            colIdx = range[1];\n            if (this.isRowSelected) {\n                colIdx = topLeftIdx[1];\n            }\n        }\n        var mergeArgs = { range: [rowIdx, colIdx].concat([rowIdx, colIdx]) };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        if (range !== mergeArgs.range) {\n            isMergeRange = true;\n        }\n        range = mergeArgs.range;\n        if (sheet.activeCell !== getCellAddress(range[0], range[1]) || isInit) {\n            this.parent.setSheetPropertyOnMute(sheet, 'activeCell', getCellAddress(range[0], range[1]));\n            if (sheet.isProtected) {\n                var element = this.parent.element.querySelector('.e-formula-bar');\n                var cell = getCell(range[0], range[1], sheet);\n                var isCellLocked = isLocked(cell, getColumn(sheet, range[1]));\n                if (isCellLocked && element && !element.disabled) {\n                    element.disabled = true;\n                }\n                else if (!isCellLocked && element && element.disabled) {\n                    element.disabled = false;\n                }\n            }\n            if (this.getActiveCell()) {\n                var offset = this.getOffset(range[2], range[3]);\n                if (isMergeRange) {\n                    offset.left = { idx: 0, size: 0 };\n                }\n                setPosition(this.parent, this.getActiveCell(), range, 'e-active-cell');\n            }\n            this.parent.notify(activeCellChanged, null);\n        }\n        else {\n            setPosition(this.parent, this.getActiveCell(), range, 'e-active-cell');\n        }\n    };\n    Selection.prototype.getOffset = function (rowIdx, colIdx) {\n        var offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } };\n        if (this.parent.scrollModule) {\n            if (colIdx >= this.parent.scrollModule.offset.left.idx) {\n                offset.left = this.parent.scrollModule.offset.left;\n            }\n            if (rowIdx >= this.parent.scrollModule.offset.top.idx) {\n                offset.top = this.parent.scrollModule.offset.top;\n            }\n        }\n        return offset;\n    };\n    Selection.prototype.getSelectionElement = function (e, selectedRowColIdx) {\n        if (e && e.ctrlKey) {\n            if (isMouseUp(e) || isMouseMove(e)) {\n                return this.parent.getMainContent().querySelector('.e-selection:last-child');\n            }\n            else {\n                var selElem = this.parent.element.getElementsByClassName('e-selection')[0];\n                selElem.classList.remove('e-hide');\n                var ele = selElem.cloneNode();\n                ele.classList.add('e-multi-range');\n                return this.parent.getMainContent().appendChild(ele);\n            }\n        }\n        else if (selectedRowColIdx > -1) {\n            return this.parent.getMainContent().getElementsByClassName('e-selection')[selectedRowColIdx];\n        }\n        else {\n            var elems = [].slice.call(this.parent.element.getElementsByClassName('e-multi-range'));\n            elems.forEach(function (ele) {\n                remove(ele);\n            });\n            return this.parent.getMainContent().getElementsByClassName('e-selection')[0];\n        }\n    };\n    Selection.prototype.getActiveCell = function () {\n        return this.parent.getMainContent().getElementsByClassName('e-active-cell')[0];\n    };\n    Selection.prototype.getSheetElement = function () {\n        return document.getElementById(this.parent.element.id + '_sheet');\n    };\n    Selection.prototype.highlightHdr = function (range, isMultiRange, isRowRefresh, isColRefresh) {\n        if (isRowRefresh === void 0) { isRowRefresh = true; }\n        if (isColRefresh === void 0) { isColRefresh = true; }\n        if (this.parent.getActiveSheet().showHeaders) {\n            var sheet = this.parent.getActiveSheet();\n            var rowHdr = [];\n            var colHdr = [];\n            var swapRange = getSwapRange(range);\n            swapRange = this.getHdrIndexes(swapRange);\n            var selectAll = this.parent.element.getElementsByClassName('e-select-all-cell')[0];\n            if (!isMultiRange) {\n                removeClass(this.getSheetElement().querySelectorAll('.e-highlight'), 'e-highlight');\n                removeClass(this.getSheetElement().querySelectorAll('.e-prev-highlight'), 'e-prev-highlight');\n            }\n            if (selectAll) {\n                removeClass([selectAll], ['e-prev-highlight-right', 'e-prev-highlight-bottom']);\n            }\n            if (isRowRefresh) {\n                var frozenRow = this.parent.frozenRowCount(sheet);\n                var selectAll_1;\n                var td = void 0;\n                var selectAllHdr = this.parent.getSelectAllContent().querySelector('tbody');\n                if (selectAllHdr) {\n                    selectAll_1 = [].slice.call(selectAllHdr.querySelectorAll('.e-header-cell'));\n                }\n                var header = [].slice.call(this.parent.getRowHeaderContent().querySelectorAll('.e-header-cell'));\n                var topIndex = getCellIndexes(sheet.topLeftCell)[0];\n                for (var i = swapRange[0]; i < swapRange[2] + 1; i++) {\n                    if (i < frozenRow) {\n                        td = selectAll_1[i - topIndex];\n                    }\n                    else {\n                        td = header[i - frozenRow];\n                    }\n                    if (td) {\n                        rowHdr.push(td);\n                    }\n                }\n            }\n            if (isColRefresh) {\n                var frozenCol = this.parent.frozenColCount(sheet);\n                var selectAll_2;\n                var td = void 0;\n                var selectAllHdr = this.parent.getSelectAllContent().querySelector('thead');\n                if (selectAllHdr) {\n                    selectAll_2 = [].slice.call(selectAllHdr.querySelectorAll('.e-header-cell'));\n                }\n                var header = [].slice.call(this.parent.getColumnHeaderContent().querySelectorAll('th'));\n                var leftIndex = getCellIndexes(sheet.topLeftCell)[1];\n                for (var i = swapRange[1]; i < swapRange[3] + 1; i++) {\n                    if (i < frozenCol) {\n                        td = selectAll_2[i - leftIndex];\n                    }\n                    else {\n                        td = header[i - frozenCol];\n                    }\n                    if (td) {\n                        colHdr.push(td);\n                    }\n                }\n            }\n            if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n                removeClass([].concat(rowHdr, colHdr), 'e-highlight');\n            }\n            else {\n                addClass([].concat(rowHdr, colHdr), 'e-highlight');\n            }\n            if (rowHdr.length && rowHdr[0].parentElement.previousElementSibling) {\n                rowHdr[0].parentElement.previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (colHdr.length && colHdr[0].previousElementSibling) {\n                colHdr[0].previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (this.isRowSelected && this.isColSelected) {\n                if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n                    document.getElementById(this.parent.element.id + \"_select_all\").classList.remove('e-highlight');\n                }\n                else {\n                    document.getElementById(this.parent.element.id + \"_select_all\").classList.add('e-highlight');\n                }\n            }\n            if (selectAll) {\n                if (swapRange[0] === 0) {\n                    selectAll.classList.add('e-prev-highlight-bottom');\n                }\n                if (swapRange[1] === 0) {\n                    selectAll.classList.add('e-prev-highlight-right');\n                }\n            }\n        }\n    };\n    Selection.prototype.protectHandler = function () {\n        var range = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var swapRange = getSwapRange(range);\n        var actRange = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var inRange = swapRange[0] <= actRange[0] && swapRange[2] >= actRange[0] && swapRange[1] <= actRange[1]\n            && swapRange[3] >= actRange[1];\n        this.selectRangeByIdx(range, null, null, inRange);\n    };\n    Selection.prototype.getHdrIndexes = function (range) {\n        if (this.parent.scrollSettings.enableVirtualization) {\n            var indexes = [];\n            var hiddenRowCount = this.parent.hiddenCount(this.parent.viewport.topIndex, range[0]);\n            var hiddenColCount = this.parent.hiddenCount(this.parent.viewport.leftIndex, range[1], 'columns');\n            indexes[0] = this.isColSelected ? range[0] : (range[0] - this.parent.viewport.topIndex) < 0\n                ? 0 : ((range[0] - hiddenRowCount) - this.parent.viewport.topIndex);\n            indexes[1] = this.isRowSelected ? range[1] : (range[1] - this.parent.viewport.leftIndex) < 0\n                ? 0 : ((range[1] - hiddenColCount) - this.parent.viewport.leftIndex);\n            indexes[2] = this.isColSelected ? this.parent.viewport.rowCount + this.parent.getThreshold('row') * 2 : range[2] -\n                this.parent.hiddenCount(range[0], range[2]) - hiddenRowCount - this.parent.viewport.topIndex;\n            indexes[3] = this.isRowSelected ? this.parent.viewport.colCount + this.parent.getThreshold('col') * 2 :\n                range[3] - this.parent.hiddenCount(range[1], range[3], 'columns') - hiddenColCount - this.parent.viewport.leftIndex;\n            return indexes;\n        }\n        return range;\n    };\n    Selection.prototype.initiateFormulaSelection = function (args) {\n        this.processFormulaEditRange(args.range, args.formulaSheetIdx);\n    };\n    Selection.prototype.processFormulaEditRange = function (val, formulaStartSheetIdx) {\n        var str;\n        var formulaSheetIdx = formulaStartSheetIdx;\n        var i = 0;\n        var parsedVal = this.parseFormula(val);\n        var len = parsedVal.length;\n        var ctrlKeyCount = 0;\n        var formulaBorder = [['e-vborderright', 'e-vborderbottom'], ['e-pborderright', 'e-pborderbottom'],\n            ['e-cborderright', 'e-cborderbottom'], ['e-gborderright', 'e-gborderbottom'], ['e-oborderright', 'e-oborderbottom'],\n            ['e-bborderright', 'e-bborderbottom']];\n        this.clearBorder();\n        var actSheetIdx = this.parent.getActiveSheet().id - 1;\n        while (i < len) {\n            str = parsedVal[i];\n            if (this.invalidOperators.indexOf(str) > -1) {\n                break;\n            }\n            if (isCellReference(str.toUpperCase())) {\n                str = str.replace(/\\$/g, '');\n                if (i > 0) {\n                    if (parsedVal[i - 1].indexOf('!') === parsedVal[i - 1].length - 1) {\n                        var splitStr = parsedVal[i - 1].split('!');\n                        formulaSheetIdx = getSheetIndex(this.parent, splitStr[0].substring(1, splitStr[0].length - 1));\n                    }\n                }\n                if (parsedVal[i + 1] === ':') {\n                    i++;\n                    if (parsedVal[i + 1] && isCellReference(parsedVal[i + 1].toUpperCase())) {\n                        str = str + ':' + parsedVal[i + 1];\n                        i++;\n                    }\n                }\n                if (actSheetIdx === formulaSheetIdx) {\n                    this.updateFormulaEditRange(str, ctrlKeyCount, formulaBorder);\n                }\n                formulaSheetIdx = formulaStartSheetIdx;\n                ctrlKeyCount++;\n            }\n            i++;\n        }\n    };\n    Selection.prototype.updateFormulaEditRange = function (str, i, formulaBorder) {\n        var indices = getRangeIndexes(str);\n        this.formulaRange[i] = str;\n        this.dStartCell = { rowIndex: indices[0], colIndex: indices[1] };\n        this.dEndCell = { rowIndex: indices[2], colIndex: indices[3] };\n        this.focusBorder(this.dStartCell, this.dEndCell, formulaBorder[i % 6]);\n    };\n    Selection.prototype.chartBorderHandler = function (args) {\n        this.focusBorder(args.startcell, args.endcell, args.classes, true);\n    };\n    Selection.prototype.focusBorder = function (startcell, endcell, classes, isChart) {\n        isChart = isNullOrUndefined(isChart) ? false : isChart;\n        var range = getSwapRange([startcell.rowIndex, startcell.colIndex, endcell.rowIndex, endcell.colIndex]);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.frozenRows || sheet.frozenColumns) {\n            var rangeReference = this.parent.createElement('div', {\n                className: isChart ? 'e-range-indicator e-chart-range' : 'e-range-indicator e-formuala-range'\n            });\n            rangeReference.appendChild(this.parent.createElement('div', { className: 'e-top' }));\n            rangeReference.appendChild(this.parent.createElement('div', { className: 'e-bottom' }));\n            rangeReference.appendChild(this.parent.createElement('div', { className: 'e-left' }));\n            rangeReference.appendChild(this.parent.createElement('div', { className: 'e-right' }));\n            setPosition(this.parent, rangeReference, range, 'e-range-indicator');\n            return;\n        }\n        var minr = range[0];\n        var minc = range[1];\n        var maxr = range[2];\n        var maxc = range[3];\n        if (minr) {\n            (this.getEleFromRange([minr - 1, minc, minr - 1, maxc])).forEach(function (td) {\n                if (td) {\n                    td.classList.add(classes[1]);\n                    if (!isChart) {\n                        td.classList.add('e-formularef-selection');\n                    }\n                }\n            }); // top\n        }\n        (this.getEleFromRange([minr, maxc, maxr, maxc])).forEach(function (td) {\n            if (td) {\n                td.classList.add(classes[0]);\n                if (!isChart) {\n                    td.classList.add('e-formularef-selection');\n                }\n            }\n        }); // right\n        this.getEleFromRange([maxr, minc, maxr, maxc]).forEach(function (td) {\n            if (td) {\n                td.classList.add(classes[1]);\n                if (!isChart) {\n                    td.classList.add('e-formularef-selection');\n                }\n            }\n        }); // bottom\n        if (minc) {\n            (this.getEleFromRange([minr, minc - 1, maxr, minc - 1])).forEach(function (td) {\n                if (td) {\n                    td.classList.add(classes[0]);\n                    if (!isChart) {\n                        td.classList.add('e-formularef-selection');\n                    }\n                }\n            }); // left\n        }\n    };\n    Selection.prototype.getEleFromRange = function (range) {\n        var startRIndex = range[0];\n        var startCIndex = range[1];\n        var endRIndex = range[2];\n        var endCIndex = range[3];\n        var i;\n        var rowIdx;\n        var temp;\n        var tempCells = [];\n        var rowCells;\n        var cells = [];\n        if (startRIndex > endRIndex) {\n            temp = startRIndex;\n            startRIndex = endRIndex;\n            endRIndex = temp;\n        }\n        if (startCIndex > endCIndex) {\n            temp = startCIndex;\n            startCIndex = endCIndex;\n            endCIndex = temp;\n        }\n        if (this.parent.scrollSettings.enableVirtualization) {\n            for (i = startRIndex; i <= endRIndex; i++) {\n                rowIdx = i;\n                if (rowIdx > -1) {\n                    var row = this.parent.getRow(rowIdx, null);\n                    if (row) {\n                        rowCells = row.getElementsByClassName('e-cell');\n                        tempCells = (endCIndex === startCIndex) ?\n                            [rowCells[endCIndex]] : this.getRowCells(rowCells, startCIndex, endCIndex + 1);\n                        this.merge(cells, tempCells);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    Selection.prototype.getRowCells = function (rowCells, startCIndex, endCIndex) {\n        var tdCol = [];\n        for (startCIndex; startCIndex < endCIndex; startCIndex++) {\n            if (rowCells[startCIndex]) {\n                tdCol.push(rowCells[startCIndex]);\n            }\n        }\n        return tdCol;\n    };\n    Selection.prototype.merge = function (first, second) {\n        if (!first || !second) {\n            return;\n        }\n        Array.prototype.push.apply(first, second);\n    };\n    Selection.prototype.clearBorder = function () {\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.frozenColumns || sheet.frozenRows) {\n            var formualIndicator = [].slice.call(this.parent.element.getElementsByClassName('e-formuala-range'));\n            formualIndicator.forEach(function (indicator) { detach(indicator); });\n            return;\n        }\n        var borderEleColl = this.parent.element.getElementsByClassName('e-formularef-selection');\n        for (var idx = 0; idx < borderEleColl.length; idx++) {\n            var td = borderEleColl[idx];\n            var classArr = ['e-vborderright', 'e-vborderbottom', 'e-pborderright', 'e-pborderbottom',\n                'e-cborderright', 'e-cborderbottom', 'e-gborderright', 'e-gborderbottom', 'e-oborderright',\n                'e-oborderbottom', 'e-bborderright', 'e-bborderbottom'];\n            for (var idx_1 = 0; idx_1 < classArr.length; idx_1++) {\n                td.classList.remove(classArr[idx_1]);\n            }\n        }\n        // for (let idx: number = 0; idx < borderEleColl.length; idx++) {\n        //     const td: HTMLElement = borderEleColl[idx] as HTMLElement;\n        // }\n    };\n    Selection.prototype.parseFormula = function (formulaStr) {\n        var tempStr;\n        var str;\n        var i = 0;\n        var arr = [];\n        formulaStr = this.markSpecialChar(formulaStr.replace('=', ''));\n        var formula = formulaStr.split(/\\(|\\)|=|\\^|>|<|,|:|\\+|-|\\*|\\/|%|&/g);\n        var len = formula.length;\n        while (i < len) {\n            tempStr = formula[i];\n            if (!tempStr) {\n                i++;\n                continue;\n            }\n            if (tempStr.length === 1) {\n                arr.push(this.isUniqueChar(tempStr) ? this.getUniqueCharVal(tempStr) : tempStr);\n            }\n            else {\n                str = tempStr[0];\n                if (tempStr.indexOf('!') > 0) {\n                    if (this.isUniqueChar(str)) {\n                        arr.push(this.getUniqueCharVal(str));\n                        tempStr = tempStr.substr(1);\n                    }\n                    var strVal = tempStr.indexOf('!') + 1;\n                    arr.push(tempStr.substr(0, strVal));\n                    arr.push(tempStr.substr(strVal));\n                }\n                else if (this.isUniqueChar(str)) {\n                    arr.push(this.getUniqueCharVal(str));\n                    arr.push(tempStr.substr(1));\n                }\n                else {\n                    arr.push(tempStr);\n                }\n            }\n            i++;\n        }\n        return arr;\n    };\n    Selection.prototype.isUniqueChar = function (str) {\n        var code = str.charCodeAt(str.charAt[0]);\n        return code >= 129 && code <= 142;\n    };\n    Selection.prototype.getUniqueCharVal = function (tempStr) {\n        switch (tempStr) {\n            case this.uniqueOBracket:\n                return '(';\n            case this.uniqueCBracket:\n                return ')';\n            case this.uniqueCOperator:\n                return ':';\n            case this.uniqueSOperator:\n                return '-';\n            case this.uniquePOperator:\n                return '+';\n            case this.uniqueMOperator:\n                return '*';\n            case this.uniqueDOperator:\n                return '/';\n            case this.uniqueModOperator:\n                return '%';\n            case this.uniqueCSeparator:\n                return ',';\n            case this.uniqueConcateOperator:\n                return '&';\n            case this.uniqueEqualOperator:\n                return '=';\n            case this.uniqueExpOperator:\n                return '^';\n            case this.uniqueLTOperator:\n                return '<';\n            case this.uniqueGTOperator:\n                return '>';\n        }\n        return '';\n    };\n    Selection.prototype.markSpecialChar = function (formulaVal) {\n        formulaVal = formulaVal.replace(/\\(/g, '(' + this.uniqueOBracket).replace(/\\)/g, ')' + this.uniqueCBracket);\n        formulaVal = formulaVal.replace(/,/g, ',' + this.uniqueCSeparator).replace(/:/g, ':' + this.uniqueCOperator);\n        formulaVal = formulaVal.replace(/\\+/g, '+' + this.uniquePOperator).replace(/-/g, '-' + this.uniqueSOperator);\n        formulaVal = formulaVal.replace(/\\*/g, '*' + this.uniqueMOperator).replace(/\\//g, '/' + this.uniqueDOperator);\n        formulaVal = formulaVal.replace(/&/g, '&' + this.uniqueConcateOperator);\n        formulaVal = formulaVal.replace(/=/g, '=' + this.uniqueEqualOperator);\n        formulaVal = formulaVal.replace(/\\^/g, '^' + this.uniqueExpOperator);\n        formulaVal = formulaVal.replace(/>/g, '>' + this.uniqueGTOperator).replace(/</g, '<' + this.uniqueLTOperator);\n        return formulaVal.replace(/%/g, '%' + this.uniqueModOperator);\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @private\n     * @returns {string} - Get the module name.\n     */\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    Selection.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return Selection;\n}());\nexport { Selection };\n","import { Browser, EventHandler, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { contentLoaded, spreadsheetDestroyed, onVerticalScroll, onHorizontalScroll, getScrollBarWidth } from '../common/index';\nimport { onContentScroll, deInitProperties, setScrollEvent, skipHiddenIdx, mouseDown, selectionStatus } from '../common/index';\nimport { getRowHeight, getColumnWidth, getCellAddress } from '../../workbook/index';\nimport { isFormulaBarEdit, virtualContentLoaded, colWidthChanged, getUpdateUsingRaf } from '../common/index';\nimport { updateScroll } from '../common/index';\n/**\n * The `Scroll` module is used to handle scrolling behavior.\n * @hidden\n */\nvar Scroll = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet scroll module.\n     *\n     * @param {Spreadsheet} parent - Constructor for the Spreadsheet scroll module.\n     * @private\n     */\n    function Scroll(parent) {\n        this.clientX = 0;\n        this.parent = parent;\n        this.addEventListener();\n        this.initProps();\n    }\n    Scroll.prototype.onContentScroll = function (e) {\n        var target = this.parent.getMainContent().parentElement;\n        var scrollLeft = e.scrollLeft;\n        var top = e.scrollTop || target.scrollTop;\n        var left = scrollLeft && this.parent.enableRtl ? this.initScrollValue - scrollLeft : scrollLeft;\n        var scrollArgs;\n        var prevSize;\n        if (!isNullOrUndefined(scrollLeft) && this.prevScroll.scrollLeft !== left) {\n            var scrollRight = left > this.prevScroll.scrollLeft;\n            prevSize = this.offset.left.size;\n            this.offset.left = this.getColOffset(left, scrollRight, e.skipHidden);\n            if (!e.preventScroll) {\n                this.parent.getColumnHeaderContent().scrollLeft = scrollLeft;\n                this.parent.getMainContent().scrollLeft = scrollLeft;\n                e.scrollLeft = scrollLeft;\n            }\n            scrollArgs = {\n                cur: this.offset.left, prev: { idx: this.leftIndex, size: prevSize }, increase: scrollRight, preventScroll: e.preventScroll\n            };\n            this.updateTopLeftCell(scrollRight);\n            this.parent.notify(onHorizontalScroll, scrollArgs);\n            if (!this.parent.scrollSettings.enableVirtualization && scrollRight && !this.parent.scrollSettings.isFinite) {\n                this.updateNonVirtualCols();\n            }\n            this.leftIndex = scrollArgs.prev.idx;\n            this.prevScroll.scrollLeft = left;\n        }\n        if (this.prevScroll.scrollTop !== top) {\n            var scrollDown = top > this.prevScroll.scrollTop;\n            prevSize = this.offset.top.size;\n            this.offset.top = this.getRowOffset(top, scrollDown);\n            scrollArgs = {\n                cur: this.offset.top, prev: { idx: this.topIndex, size: prevSize }, increase: scrollDown, preventScroll: e.preventScroll\n            };\n            this.updateTopLeftCell(scrollDown);\n            this.parent.notify(onVerticalScroll, scrollArgs);\n            if (!this.parent.scrollSettings.enableVirtualization && scrollDown && !this.parent.scrollSettings.isFinite) {\n                this.updateNonVirtualRows();\n            }\n            this.topIndex = scrollArgs.prev.idx;\n            this.prevScroll.scrollTop = top;\n        }\n        var isEdit = false;\n        var args = { isEdit: isEdit };\n        this.parent.notify(isFormulaBarEdit, args);\n        if (args.isEdit) {\n            var textArea = this.parent.element.querySelector('.e-formula-bar');\n            textArea.focus();\n        }\n    };\n    Scroll.prototype.updateNonVirtualRows = function () {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = this.parent.getThreshold('row');\n        if (this.offset.top.idx > sheet.rowCount - (this.parent.viewport.rowCount + threshold)) {\n            this.parent.renderModule.refreshUI({ rowIndex: sheet.rowCount, colIndex: 0, direction: 'first', refresh: 'RowPart' }, getCellAddress(sheet.rowCount, 0) + \":\" + getCellAddress(sheet.rowCount + threshold - 1, sheet.colCount - 1));\n            this.parent.setSheetPropertyOnMute(sheet, 'rowCount', sheet.rowCount + threshold);\n            this.parent.viewport.bottomIndex = sheet.rowCount - 1;\n        }\n    };\n    Scroll.prototype.updateNonVirtualCols = function () {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = this.parent.getThreshold('col');\n        if (this.offset.left.idx > sheet.colCount - (this.parent.viewport.colCount + threshold)) {\n            this.parent.renderModule.refreshUI({ rowIndex: 0, colIndex: sheet.colCount, direction: 'first', refresh: 'ColumnPart' }, getCellAddress(0, sheet.colCount) + \":\" + getCellAddress(sheet.rowCount - 1, sheet.colCount + threshold - 1));\n            this.parent.setSheetPropertyOnMute(sheet, 'colCount', sheet.colCount + threshold);\n            this.parent.viewport.rightIndex = sheet.colCount - 1;\n        }\n    };\n    Scroll.prototype.updateTopLeftCell = function (increase) {\n        var sheet = this.parent.getActiveSheet();\n        var top = this.offset.top.idx;\n        var left = this.offset.left.idx;\n        if (!increase) {\n            top = skipHiddenIdx(sheet, top, true);\n            left = skipHiddenIdx(sheet, left, true, 'columns');\n        }\n        this.parent.updateTopLeftCell(top, left);\n    };\n    Scroll.prototype.getRowOffset = function (scrollTop, scrollDown) {\n        var temp = this.offset.top.size;\n        var sheet = this.parent.getActiveSheet();\n        var i = scrollDown ? this.offset.top.idx + 1 : (this.offset.top.idx ? this.offset.top.idx - 1 : 0);\n        var frozenRow = this.parent.frozenRowCount(sheet);\n        var count = this.parent.scrollSettings.isFinite ? sheet.rowCount : Infinity;\n        scrollTop = Math.round(scrollTop);\n        while (i < count) {\n            if (scrollDown) {\n                temp += getRowHeight(sheet, i - 1 + frozenRow, true);\n                if (Math.abs(Math.round(temp) - scrollTop) <= 1) { // <=1 -> For other resolution scrollTop value slightly various with row height\n                    return { idx: i, size: temp };\n                }\n                if (Math.round(temp) > scrollTop) {\n                    return { idx: i - 1, size: temp - getRowHeight(sheet, i - 1 + frozenRow, true) };\n                }\n                i++;\n            }\n            else {\n                if (temp === 0) {\n                    return { idx: 0, size: 0 };\n                }\n                temp -= getRowHeight(sheet, i + frozenRow, true);\n                if (temp < 0) {\n                    temp = 0;\n                }\n                if (Math.abs(Math.round(temp) - scrollTop) <= 1) {\n                    return { idx: i, size: temp };\n                }\n                if (Math.round(temp) < scrollTop) {\n                    temp += getRowHeight(sheet, i + frozenRow, true);\n                    if (Math.round(temp) > scrollTop) {\n                        return { idx: i, size: temp - getRowHeight(sheet, i + frozenRow, true) < 0 ? 0 :\n                                temp - getRowHeight(sheet, i + frozenRow, true) };\n                    }\n                    else {\n                        return { idx: i + 1, size: temp };\n                    }\n                }\n                i--;\n            }\n        }\n        return { idx: this.offset.top.idx, size: this.offset.top.size };\n    };\n    Scroll.prototype.getColOffset = function (scrollLeft, increase, skipHidden) {\n        var temp = this.offset.left.size;\n        var sheet = this.parent.getActiveSheet();\n        var i = increase ? this.offset.left.idx + 1 : this.offset.left.idx - 1;\n        var frozenCol = this.parent.frozenColCount(sheet);\n        var count = this.parent.scrollSettings.isFinite ? sheet.colCount : Infinity;\n        scrollLeft = Math.round(scrollLeft);\n        while (i < count) {\n            if (increase) {\n                temp += getColumnWidth(sheet, i - 1 + frozenCol, skipHidden, true);\n                if (Math.round(temp) === scrollLeft) {\n                    return { idx: i, size: temp };\n                }\n                if (Math.round(temp) > scrollLeft) {\n                    return { idx: i - 1, size: temp - getColumnWidth(sheet, i - 1 + frozenCol, skipHidden, true) };\n                }\n                i++;\n            }\n            else {\n                if (temp === 0) {\n                    return { idx: 0, size: 0 };\n                }\n                temp -= getColumnWidth(sheet, i + frozenCol, skipHidden, true);\n                if (Math.round(temp) === scrollLeft) {\n                    return { idx: i, size: temp };\n                }\n                if (Math.round(temp) < scrollLeft) {\n                    temp += getColumnWidth(sheet, i + frozenCol, skipHidden, true);\n                    if (Math.round(temp) > scrollLeft) {\n                        return { idx: i, size: temp - getColumnWidth(sheet, i + frozenCol, skipHidden, true) };\n                    }\n                    else {\n                        return { idx: i + 1, size: temp };\n                    }\n                }\n                i--;\n            }\n        }\n        return { idx: this.offset.left.idx, size: this.offset.left.size };\n    };\n    Scroll.prototype.contentLoaded = function (args) {\n        if (!this.parent.scrollSettings.enableVirtualization) {\n            var scrollTrack = this.parent.createElement('div', { className: 'e-virtualtrack' });\n            this.updateNonVirualScrollWidth({ scrollTrack: scrollTrack });\n            this.parent.getScrollElement().appendChild(scrollTrack);\n        }\n        if (args.left) {\n            this.parent.getScrollElement().scrollLeft = args.left;\n        }\n        this.setScrollEvent();\n        if (this.parent.enableRtl) {\n            this.initScrollValue = this.parent.getScrollElement().scrollLeft;\n        }\n    };\n    Scroll.prototype.updateNonVirualScrollWidth = function (args) {\n        if (!args.scrollTrack) {\n            args.scrollTrack = this.parent.getScrollElement().getElementsByClassName('e-virtualtrack')[0];\n        }\n        args.scrollTrack.style.width = Math.abs(this.parent.getContentTable().getBoundingClientRect().width) + 'px';\n    };\n    Scroll.prototype.onHeaderWheel = function (e) {\n        e.preventDefault();\n        this.parent.getMainContent().parentElement.scrollTop += e.deltaY;\n        this.parent.getScrollElement().scrollLeft += e.deltaX;\n    };\n    Scroll.prototype.onContentWheel = function (e) {\n        if (e.deltaX !== 0) {\n            e.preventDefault();\n            this.parent.getScrollElement().scrollLeft += e.deltaX;\n        }\n    };\n    Scroll.prototype.scrollHandler = function (e) {\n        this.onContentScroll({ scrollLeft: e.target.scrollLeft });\n    };\n    Scroll.prototype.updateScroll = function (args) {\n        if (isNullOrUndefined(args.left)) {\n            this.parent.sheetModule.contentPanel.scrollTop = args.top;\n        }\n        else {\n            this.parent.getScrollElement().scrollLeft = args.left;\n        }\n    };\n    Scroll.prototype.setScrollEvent = function (args) {\n        if (args === void 0) { args = { set: true }; }\n        if (args.set) {\n            EventHandler.add(this.parent.sheetModule.contentPanel, 'scroll', this.onContentScroll, this);\n            EventHandler.add(this.parent.getColumnHeaderContent(), 'wheel', this.onHeaderWheel, this);\n            EventHandler.add(this.parent.getSelectAllContent(), 'wheel', this.onHeaderWheel, this);\n            EventHandler.add(this.parent.getMainContent(), 'wheel', this.onContentWheel, this);\n            EventHandler.add(this.parent.getRowHeaderContent(), 'wheel', this.onContentWheel, this);\n            EventHandler.add(this.parent.getScrollElement(), 'scroll', this.scrollHandler, this);\n        }\n        else {\n            EventHandler.remove(this.parent.sheetModule.contentPanel, 'scroll', this.onContentScroll);\n            EventHandler.remove(this.parent.getColumnHeaderContent(), 'wheel', this.onHeaderWheel);\n            EventHandler.remove(this.parent.getSelectAllContent(), 'wheel', this.onHeaderWheel);\n            EventHandler.remove(this.parent.getMainContent(), 'wheel', this.onContentWheel);\n            EventHandler.remove(this.parent.getRowHeaderContent(), 'wheel', this.onContentWheel);\n            EventHandler.remove(this.parent.getScrollElement(), 'scroll', this.scrollHandler);\n        }\n    };\n    Scroll.prototype.initProps = function () {\n        this.topIndex = 0;\n        this.leftIndex = 0;\n        this.prevScroll = { scrollLeft: 0, scrollTop: 0 };\n        this.offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } };\n    };\n    /**\n     * @hidden\n     *\n     * @returns {void} - To Set padding\n     */\n    Scroll.prototype.setPadding = function () {\n        this.parent.sheetModule.contentPanel.style.overflowY = 'scroll';\n        var scrollWidth = getScrollBarWidth();\n        if (scrollWidth > 0) {\n            var colHeader = this.parent.getColumnHeaderContent();\n            var cssProps = this.parent.enableRtl ? { margin: 'marginLeft', border: 'borderLeftWidth' }\n                : { margin: 'marginRight', border: 'borderRightWidth' };\n            colHeader.parentElement.style[cssProps.margin] = scrollWidth + 'px';\n            colHeader.style[cssProps.border] = '1px';\n        }\n    };\n    Scroll.prototype.setClientX = function (e) {\n        if (e.type === 'mousedown' || e.pointerType === 'mouse') {\n            return;\n        }\n        var args = { touchSelectionStarted: false };\n        this.parent.notify(selectionStatus, args);\n        if (args.touchSelectionStarted) {\n            return;\n        }\n        this.clientX = this.getPointX(e);\n        var sheetContent = document.getElementById(this.parent.element.id + '_sheet');\n        EventHandler.add(sheetContent, Browser.isPointer ? 'pointermove' : 'touchmove', this.onTouchScroll, this);\n        EventHandler.add(sheetContent, Browser.isPointer ? 'pointerup' : 'touchend', this.pointerUpHandler, this);\n    };\n    Scroll.prototype.getPointX = function (e) {\n        var clientX = 0;\n        if (e.touches && e.touches.length) {\n            clientX = e.touches[0].clientX;\n        }\n        else {\n            clientX = e.clientX;\n        }\n        return clientX;\n    };\n    Scroll.prototype.onTouchScroll = function (e) {\n        if (e.pointerType === 'mouse') {\n            return;\n        }\n        var clientX = this.getPointX(e);\n        var diff = this.clientX - clientX;\n        var scroller = this.parent.element.getElementsByClassName('e-scroller')[0];\n        if ((diff > 10 || diff < -10) && scroller.scrollLeft + diff >= 0) {\n            e.preventDefault();\n            this.clientX = clientX;\n            getUpdateUsingRaf(function () { scroller.scrollLeft += diff; });\n        }\n    };\n    Scroll.prototype.pointerUpHandler = function () {\n        var sheetContent = document.getElementById(this.parent.element.id + '_sheet');\n        EventHandler.remove(sheetContent, Browser.isPointer ? 'pointermove' : 'touchmove', this.onTouchScroll);\n        EventHandler.remove(sheetContent, Browser.isPointer ? 'pointerup' : 'touchend', this.pointerUpHandler);\n    };\n    Scroll.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.contentLoaded, this);\n        this.parent.on(onContentScroll, this.onContentScroll, this);\n        this.parent.on(updateScroll, this.updateScroll, this);\n        this.parent.on(deInitProperties, this.initProps, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n        this.parent.on(setScrollEvent, this.setScrollEvent, this);\n        this.parent.on(mouseDown, this.setClientX, this);\n        if (!this.parent.scrollSettings.enableVirtualization) {\n            this.parent.on(virtualContentLoaded, this.updateNonVirualScrollWidth, this);\n            this.parent.on(colWidthChanged, this.updateNonVirualScrollWidth, this);\n        }\n    };\n    Scroll.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Scroll.prototype.removeEventListener = function () {\n        this.parent.off(contentLoaded, this.contentLoaded);\n        this.parent.off(onContentScroll, this.onContentScroll);\n        this.parent.off(updateScroll, this.updateScroll);\n        this.parent.off(deInitProperties, this.initProps);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n        this.parent.off(setScrollEvent, this.setScrollEvent);\n        this.parent.off(mouseDown, this.setClientX);\n        if (!this.parent.scrollSettings.enableVirtualization) {\n            this.parent.off(virtualContentLoaded, this.updateNonVirualScrollWidth);\n            this.parent.off(colWidthChanged, this.updateNonVirualScrollWidth);\n        }\n    };\n    return Scroll;\n}());\nexport { Scroll };\n","import { closest, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { spreadsheetDestroyed, beforeContentLoaded, beforeVirtualContentLoaded, virtualContentLoaded } from '../common/index';\nimport { colWidthChanged, updateTableWidth, focus } from '../common/index';\nimport { onVerticalScroll, onHorizontalScroll, rowHeightChanged, deInitProperties } from '../common/index';\nimport { getRowHeight, getRowsHeight, getColumnWidth, getColumnsWidth } from './../../workbook/index';\nimport { getCellIndexes, getRangeAddress } from '../../workbook/common/index';\nimport { updateUsedRange, sheetCreated, sheetsDestroyed } from '../../workbook/common/event';\n/**\n * VirtualScroll module\n *\n * @hidden\n */\nvar VirtualScroll = /** @class */ (function () {\n    function VirtualScroll(parent) {\n        this.scroll = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    VirtualScroll.prototype.createVirtualElement = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var container = this.parent.getMainContent();\n        this.content = this.parent.createElement('div', { className: 'e-virtualable' });\n        this.content.appendChild(container.querySelector('.e-table'));\n        container.appendChild(this.content);\n        var vTrack = container.appendChild(this.parent.createElement('div', { className: 'e-virtualtrack' }));\n        var height = 0;\n        var width;\n        if (this.parent.sheets.length > this.scroll.length) {\n            this.initScroll();\n        }\n        var endIndex = this.parent.viewport.bottomIndex;\n        if (sheet.rowCount > endIndex + 1 || sheet.usedRange.rowIndex > endIndex) {\n            if (!this.parent.scrollSettings.isFinite && sheet.rowCount <= sheet.usedRange.rowIndex) {\n                this.parent.setSheetPropertyOnMute(sheet, 'rowCount', sheet.usedRange.rowIndex + 1);\n            }\n            this.setScrollCount(sheet.rowCount, 'row');\n        }\n        else {\n            if (!this.parent.scrollSettings.isFinite) {\n                this.parent.setSheetPropertyOnMute(sheet, 'rowCount', endIndex + 1);\n            }\n            this.scroll[this.parent.activeSheetIndex].rowCount = sheet.rowCount;\n        }\n        var startIndex = this.parent.frozenRowCount(sheet);\n        var indexes = getCellIndexes(sheet.topLeftCell);\n        if (args.top) {\n            height = args.top;\n            if (sheet.frozenRows) {\n                height += getRowsHeight(sheet, indexes[0], startIndex - 1, true);\n            }\n            startIndex = getCellIndexes(sheet.paneTopLeftCell)[0];\n        }\n        height += getRowsHeight(sheet, startIndex, this.scroll[this.parent.activeSheetIndex].rowCount - 1, true);\n        endIndex = this.parent.viewport.rightIndex;\n        var size = 0;\n        var frozenCol = this.parent.frozenColCount(sheet);\n        if (args.left) {\n            size = args.left;\n            if (frozenCol) {\n                size += getColumnsWidth(sheet, indexes[1], frozenCol - 1, true);\n            }\n            startIndex = getCellIndexes(sheet.paneTopLeftCell)[1];\n        }\n        else {\n            startIndex = frozenCol;\n        }\n        if (sheet.colCount > endIndex + 1 || sheet.usedRange.colIndex > endIndex) {\n            if (!this.parent.scrollSettings.isFinite && sheet.colCount <= sheet.usedRange.colIndex) {\n                this.parent.setSheetPropertyOnMute(sheet, 'colCount', sheet.usedRange.colIndex + 1);\n            }\n            size += getColumnsWidth(sheet, startIndex, endIndex, true);\n            this.setScrollCount(sheet.colCount, 'col');\n            width = size + getColumnsWidth(sheet, endIndex + 1, this.scroll[this.parent.activeSheetIndex].colCount - 1, true);\n        }\n        else {\n            if (!this.parent.scrollSettings.isFinite) {\n                this.parent.setSheetPropertyOnMute(sheet, 'colCount', endIndex + 1);\n            }\n            size += getColumnsWidth(sheet, startIndex, sheet.colCount - 1, true);\n            this.scroll[this.parent.activeSheetIndex].colCount = sheet.colCount;\n            width = size;\n        }\n        if (isNullOrUndefined(this.parent.viewport.leftIndex)) {\n            this.parent.viewport.leftIndex = 0;\n        }\n        if (isNullOrUndefined(this.parent.viewport.topIndex)) {\n            this.parent.viewport.topIndex = 0;\n        }\n        if (args.left) {\n            size = getColumnsWidth(sheet, this.parent.viewport.leftIndex + frozenCol, endIndex, true);\n        }\n        if (isNullOrUndefined(this.translateX)) {\n            this.translateX = 0;\n        }\n        if (isNullOrUndefined(this.translateY)) {\n            this.translateY = 0;\n        }\n        container = this.parent.getRowHeaderContent();\n        this.rowHeader = this.content.cloneNode();\n        this.rowHeader.appendChild(container.querySelector('.e-table'));\n        container.appendChild(this.rowHeader);\n        var rowVTrack = container.appendChild(vTrack.cloneNode());\n        this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n        container = this.parent.getColumnHeaderContent();\n        this.colHeader = this.content.cloneNode();\n        this.colHeader.appendChild(container.querySelector('.e-table'));\n        container.appendChild(this.colHeader);\n        var colVTrack = container.appendChild(vTrack.cloneNode());\n        this.colHeader.style.width = size + \"px\";\n        rowVTrack.style.height = height + \"px\";\n        colVTrack.style.width = width + \"px\";\n        this.colHeader.style.transform = \"translate(\" + this.translateX + \"px, 0px)\";\n        this.content.style.transform = \"translate(\" + this.translateX + \"px, \" + this.translateY + \"px)\";\n        this.content.style.width = size + \"px\";\n        vTrack.style.height = height + \"px\";\n        vTrack.style.width = width + \"px\";\n        if (this.parent.allowScrolling) {\n            this.parent.getScrollElement().appendChild(colVTrack.cloneNode(true));\n        }\n    };\n    VirtualScroll.prototype.initScroll = function () {\n        var i = 0;\n        while (i < this.parent.sheets.length) {\n            if (!this.scroll[i]) {\n                this.scroll.push({ rowCount: 0, colCount: 0 });\n            }\n            i++;\n        }\n    };\n    VirtualScroll.prototype.setScrollCount = function (count, layout) {\n        var activeSheetIdx = this.parent.activeSheetIndex;\n        if (!this.scroll[activeSheetIdx][layout + 'Count']) {\n            this.scroll[activeSheetIdx][layout + 'Count'] = count;\n        }\n    };\n    VirtualScroll.prototype.getRowAddress = function (indexes) {\n        var sheet = this.parent.getActiveSheet();\n        return getRangeAddress([indexes[0], sheet.frozenColumns ? getCellIndexes(sheet.topLeftCell)[1] : this.parent.viewport.leftIndex,\n            indexes[1], this.parent.viewport.rightIndex]);\n    };\n    VirtualScroll.prototype.getColAddress = function (indexes) {\n        var sheet = this.parent.getActiveSheet();\n        return getRangeAddress([sheet.frozenRows ? getCellIndexes(sheet.topLeftCell)[0] : this.parent.viewport.topIndex, indexes[0],\n            this.parent.viewport.bottomIndex, indexes[1]]);\n    };\n    VirtualScroll.prototype.updateScrollCount = function (idx, layout, threshold) {\n        if (threshold === void 0) { threshold = idx; }\n        var sheet = this.parent.getActiveSheet();\n        var rowCount = idx + this.parent.viewport[layout + 'Count'] + 1 + threshold;\n        var usedRangeCount = this.scroll[this.parent.activeSheetIndex][layout + 'Count'];\n        if (rowCount < usedRangeCount) {\n            if (sheet[layout + 'Count'] === usedRangeCount) {\n                return;\n            }\n            rowCount = usedRangeCount;\n        }\n        if (!this.parent.scrollSettings.isFinite) {\n            this.parent.setSheetPropertyOnMute(sheet, layout + 'Count', rowCount);\n        }\n    };\n    VirtualScroll.prototype.onVerticalScroll = function (args) {\n        var idx = args.cur.idx;\n        var height = args.cur.size;\n        var prevIdx = args.prev.idx;\n        var idxDiff = Math.abs(idx - prevIdx);\n        var threshold = this.parent.getThreshold('row');\n        if (idxDiff > Math.round(threshold / 2)) {\n            var startIdx = void 0;\n            var lastIdx = void 0;\n            var prevTopIdx = void 0;\n            var sheet = this.parent.getActiveSheet();\n            if (idx <= threshold) {\n                if (!args.increase) {\n                    if (this.translateY && prevIdx > threshold) {\n                        this.translateY = 0;\n                        var frozenCol = this.parent.frozenColCount(sheet);\n                        var frozenRow = this.parent.frozenRowCount(sheet);\n                        this.parent.viewport.topIndex = prevIdx - (threshold - frozenRow);\n                        if (!args.preventScroll) {\n                            var colIndex = frozenCol ? getCellIndexes(sheet.topLeftCell)[1] : this.parent.viewport.leftIndex;\n                            var fIndexes = frozenCol ? [frozenRow, this.parent.viewport.leftIndex + frozenCol] : [];\n                            if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                                lastIdx = this.parent.viewport.topIndex - 1;\n                                startIdx = this.parent.skipHidden(frozenRow, lastIdx)[0];\n                                this.parent.viewport.topIndex = this.parent.renderModule.skipHiddenIdx(startIdx - frozenRow, true);\n                                var hiddenCount = this.hiddenCount(startIdx, lastIdx);\n                                var skippedHiddenIdx = this.parent.renderModule.skipHiddenIdx((this.parent.viewport.bottomIndex - ((lastIdx - startIdx + 1) - hiddenCount)), args.increase);\n                                this.parent.viewport.bottomIndex -= (((lastIdx - startIdx + 1) - hiddenCount) +\n                                    (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.bottomIndex)));\n                                this.parent.renderModule.refreshUI({\n                                    colIndex: colIndex, rowIndex: startIdx, direction: 'last', refresh: 'RowPart',\n                                    skipUpdateOnFirst: true, frozenIndexes: fIndexes\n                                }, this.getRowAddress([startIdx, this.parent.renderModule.skipHiddenIdx(lastIdx, false)]));\n                            }\n                            else {\n                                var prevColIndex = this.parent.viewport.leftIndex;\n                                this.parent.renderModule.refreshUI({ rowIndex: 0, colIndex: colIndex, refresh: 'Row', skipUpdateOnFirst: true,\n                                    frozenIndexes: fIndexes, skipTranslate: true });\n                                if (frozenCol) {\n                                    this.parent.viewport.leftIndex = prevColIndex;\n                                }\n                                this.translate({ refresh: 'Row' });\n                            }\n                            focus(this.parent.element);\n                        }\n                    }\n                    this.updateScrollCount(threshold, 'row');\n                }\n            }\n            if (prevIdx < threshold) {\n                idxDiff = Math.abs(idx - threshold);\n            }\n            if (!args.increase && this.parent.scrollSettings.isFinite && this.parent.viewport.bottomIndex === sheet.rowCount - 1) {\n                var thresholdIdx = this.parent.viewport.topIndex + threshold;\n                thresholdIdx += this.hiddenCount(this.parent.viewport.topIndex, thresholdIdx);\n                if (idx > thresholdIdx) {\n                    args.prev.idx = idx;\n                    return;\n                }\n                idxDiff = thresholdIdx - idx;\n            }\n            if (idx > threshold) {\n                prevTopIdx = this.parent.viewport.topIndex;\n                this.parent.viewport.topIndex = idx - threshold;\n                if (args.increase && prevTopIdx > this.parent.viewport.topIndex) {\n                    this.parent.viewport.topIndex = prevTopIdx;\n                    return;\n                }\n                var frozenRow = this.parent.frozenRowCount(sheet);\n                if (!args.preventScroll) {\n                    var frozenCol = this.parent.frozenColCount(sheet);\n                    var colIndex = frozenCol ? getCellIndexes(sheet.topLeftCell)[1] : this.parent.viewport.leftIndex;\n                    var frozenIndexes = [];\n                    if (sheet.frozenColumns) {\n                        frozenIndexes = [frozenRow, this.parent.viewport.leftIndex + frozenCol];\n                    }\n                    if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                        if (args.increase) {\n                            startIdx = this.parent.viewport.bottomIndex + 1;\n                            lastIdx = this.parent.viewport.bottomIndex + (this.parent.viewport.topIndex - prevTopIdx);\n                            lastIdx -= this.hiddenCount(prevTopIdx, this.parent.viewport.topIndex - 1);\n                            if (lastIdx <= this.parent.viewport.bottomIndex) {\n                                this.parent.viewport.topIndex = this.parent.renderModule.skipHiddenIdx(this.parent.viewport.topIndex, args.increase);\n                                this.setThresholdHeight(height, threshold, frozenRow);\n                                return;\n                            }\n                            var indexes = this.parent.skipHidden(startIdx, lastIdx);\n                            var finiteOffset = this.checkLastIdx(indexes[1], 'row');\n                            startIdx = indexes[0];\n                            lastIdx = finiteOffset.index;\n                            this.parent.viewport.topIndex = this.parent.renderModule.skipHiddenIdx(this.parent.viewport.topIndex - finiteOffset.diff, args.increase);\n                            this.setThresholdHeight(height, threshold + finiteOffset.diff, frozenRow);\n                            this.parent.viewport.bottomIndex = lastIdx;\n                            this.parent.renderModule.refreshUI({ colIndex: colIndex, rowIndex: startIdx, direction: 'first', refresh: 'RowPart',\n                                frozenIndexes: frozenIndexes }, this.getRowAddress([startIdx, lastIdx]));\n                        }\n                        else {\n                            startIdx = this.parent.viewport.topIndex + frozenRow;\n                            lastIdx = startIdx + idxDiff - 1;\n                            var hiddenCount = this.hiddenCount(startIdx, lastIdx);\n                            var skippedHiddenIdx = this.parent.renderModule.skipHiddenIdx((this.parent.viewport.bottomIndex - ((lastIdx - startIdx) - hiddenCount)), args.increase);\n                            this.parent.viewport.bottomIndex -= ((idxDiff - hiddenCount) +\n                                (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.bottomIndex)));\n                            startIdx = this.parent.skipHidden(startIdx, lastIdx)[0];\n                            this.parent.viewport.topIndex = this.parent.renderModule.skipHiddenIdx(startIdx - frozenRow, true);\n                            this.setThresholdHeight(height, threshold, frozenRow);\n                            this.parent.renderModule.refreshUI({ colIndex: colIndex, rowIndex: startIdx, direction: 'last', refresh: 'RowPart',\n                                frozenIndexes: frozenIndexes }, this.getRowAddress([startIdx, lastIdx]));\n                        }\n                    }\n                    else {\n                        prevTopIdx = this.parent.viewport.leftIndex;\n                        this.parent.renderModule.refreshUI({\n                            rowIndex: this.parent.viewport.topIndex, colIndex: colIndex, refresh: 'Row',\n                            frozenIndexes: frozenIndexes, skipTranslate: true\n                        });\n                        if (frozenCol) {\n                            this.parent.viewport.leftIndex = prevTopIdx;\n                        }\n                        this.setThresholdHeight(height, threshold, frozenRow);\n                        this.translate({ refresh: 'Row' });\n                    }\n                    this.updateScrollCount(idx, 'row', threshold);\n                    this.focusSheet();\n                }\n                else {\n                    this.setThresholdHeight(height, threshold, frozenRow);\n                }\n            }\n            args.prev.idx = idx;\n        }\n    };\n    VirtualScroll.prototype.hiddenCount = function (startIdx, endIdx, layout) {\n        if (layout === void 0) { layout = 'rows'; }\n        var index = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = startIdx; i <= endIdx; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                index++;\n            }\n        }\n        return index;\n    };\n    VirtualScroll.prototype.checkLastIdx = function (idx, layout) {\n        var diff = 0;\n        if (this.parent.scrollSettings.isFinite) {\n            var count = this.parent.getActiveSheet()[layout + 'Count'] - 1;\n            if (idx > count) {\n                diff = idx - count;\n                idx = count;\n            }\n        }\n        return { index: idx, diff: diff };\n    };\n    VirtualScroll.prototype.onHorizontalScroll = function (args) {\n        var idx = args.cur.idx;\n        var width = args.cur.size;\n        var prevIdx = args.prev.idx;\n        var idxDiff = Math.abs(idx - prevIdx);\n        var threshold = this.parent.getThreshold('col');\n        if (idxDiff > Math.round(threshold / 2)) {\n            var startIdx = void 0;\n            var endIdx = void 0;\n            var prevLeftIdx = void 0;\n            var sheet = this.parent.getActiveSheet();\n            if (idx <= threshold) {\n                if (!args.increase) {\n                    if (this.translateX && prevIdx > threshold) {\n                        var frozenCol = this.parent.frozenColCount(sheet);\n                        var frozenRow = this.parent.frozenRowCount(sheet);\n                        this.translateX = 0;\n                        this.parent.viewport.leftIndex = prevIdx - (threshold - frozenCol);\n                        if (!args.preventScroll) {\n                            var rowIndex = frozenRow ? getCellIndexes(sheet.topLeftCell)[0] : this.parent.viewport.topIndex;\n                            var fIndexes = frozenRow ? [this.parent.viewport.topIndex + frozenRow, frozenCol] : [];\n                            if (idxDiff < this.parent.viewport.colCount + threshold) {\n                                endIdx = this.parent.viewport.leftIndex - 1;\n                                startIdx = this.parent.skipHidden(frozenCol, endIdx, 'columns')[0];\n                                this.parent.viewport.leftIndex = this.parent.renderModule.skipHiddenIdx(startIdx - frozenCol, true);\n                                var hiddenCount = this.hiddenCount(startIdx, endIdx, 'columns');\n                                var skippedHiddenIdx = this.parent.renderModule.skipHiddenIdx((this.parent.viewport.rightIndex - ((endIdx - startIdx + 1) - hiddenCount)), args.increase, 'columns');\n                                this.parent.viewport.rightIndex -= (((endIdx - startIdx + 1) - hiddenCount) +\n                                    (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.rightIndex, 'columns')));\n                                this.parent.renderModule.refreshUI({ rowIndex: rowIndex, colIndex: startIdx, direction: 'last', refresh: 'ColumnPart',\n                                    skipUpdateOnFirst: true, frozenIndexes: fIndexes }, this.getColAddress([startIdx, this.parent.renderModule.skipHiddenIdx(endIdx, false, 'columns')]));\n                            }\n                            else {\n                                var prevRowIndex = this.parent.viewport.topIndex;\n                                this.parent.renderModule.refreshUI({ rowIndex: rowIndex, colIndex: 0, refresh: 'Column', skipUpdateOnFirst: true,\n                                    frozenIndexes: fIndexes, skipTranslate: true });\n                                if (frozenRow) {\n                                    this.parent.viewport.topIndex = prevRowIndex;\n                                }\n                                this.translate({ refresh: 'Column' });\n                            }\n                            focus(this.parent.element);\n                        }\n                    }\n                    this.updateScrollCount(threshold, 'col');\n                }\n            }\n            if (prevIdx < threshold) {\n                idxDiff = Math.abs(idx - threshold);\n            }\n            if (!args.increase && this.parent.scrollSettings.isFinite && this.parent.viewport.rightIndex === sheet.colCount - 1) {\n                var thresholdIdx = this.parent.viewport.leftIndex + threshold;\n                thresholdIdx += this.hiddenCount(this.parent.viewport.leftIndex, thresholdIdx);\n                if (idx > thresholdIdx) {\n                    args.prev.idx = idx;\n                    return;\n                }\n                idxDiff = thresholdIdx - idx;\n            }\n            if (idx > threshold) {\n                prevLeftIdx = this.parent.viewport.leftIndex;\n                this.parent.viewport.leftIndex = idx - threshold;\n                if (args.increase && prevLeftIdx > this.parent.viewport.leftIndex) {\n                    this.parent.viewport.leftIndex = prevLeftIdx;\n                    return;\n                }\n                var frozenCol = this.parent.frozenColCount(sheet);\n                if (!args.preventScroll) {\n                    var frozenRow = this.parent.frozenRowCount(sheet);\n                    var rowIndex = frozenRow ? getCellIndexes(sheet.topLeftCell)[0] : this.parent.viewport.topIndex;\n                    var frozenIndexes = [];\n                    if (frozenRow) {\n                        frozenIndexes = [frozenRow + this.parent.viewport.topIndex, frozenCol];\n                    }\n                    if (idxDiff < this.parent.viewport.colCount + threshold) {\n                        if (args.increase) {\n                            startIdx = this.parent.viewport.rightIndex + 1;\n                            endIdx = this.parent.viewport.rightIndex + (this.parent.viewport.leftIndex - prevLeftIdx);\n                            endIdx -= this.hiddenCount(prevLeftIdx, this.parent.viewport.leftIndex - 1, 'columns');\n                            if (endIdx <= this.parent.viewport.rightIndex) {\n                                this.parent.viewport.leftIndex = this.parent.renderModule.skipHiddenIdx(this.parent.viewport.leftIndex, args.increase, 'columns');\n                                this.setThresholdWidth(width, threshold, frozenCol);\n                                return;\n                            }\n                            var indexes = this.parent.skipHidden(startIdx, endIdx, 'columns');\n                            var finiteOffset = this.checkLastIdx(indexes[1], 'col');\n                            startIdx = indexes[0];\n                            endIdx = finiteOffset.index;\n                            this.parent.viewport.leftIndex = this.parent.renderModule.skipHiddenIdx(this.parent.viewport.leftIndex - finiteOffset.diff, args.increase, 'columns');\n                            this.setThresholdWidth(width, threshold, frozenCol);\n                            this.parent.viewport.rightIndex = endIdx;\n                            this.parent.renderModule.refreshUI({ rowIndex: rowIndex, colIndex: startIdx, direction: 'first', refresh: 'ColumnPart',\n                                frozenIndexes: frozenIndexes }, this.getColAddress([startIdx, endIdx]));\n                        }\n                        else {\n                            startIdx = this.parent.viewport.leftIndex + frozenCol;\n                            endIdx = startIdx + idxDiff - 1;\n                            var hiddenCount = this.hiddenCount(startIdx, endIdx, 'columns');\n                            var skippedHiddenIdx = this.parent.renderModule.skipHiddenIdx((this.parent.viewport.rightIndex - ((endIdx - startIdx) - hiddenCount)), args.increase, 'columns');\n                            this.parent.viewport.rightIndex -= ((idxDiff - hiddenCount) +\n                                (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.rightIndex, 'columns')));\n                            startIdx = this.parent.skipHidden(startIdx, endIdx, 'columns')[0];\n                            this.parent.viewport.leftIndex = this.parent.renderModule.skipHiddenIdx(startIdx - frozenCol, true, 'columns', sheet);\n                            this.setThresholdWidth(width, threshold, frozenCol);\n                            this.parent.renderModule.refreshUI({ rowIndex: rowIndex, colIndex: startIdx, direction: 'last', refresh: 'ColumnPart',\n                                frozenIndexes: frozenIndexes }, this.getColAddress([startIdx, endIdx]));\n                        }\n                    }\n                    else {\n                        prevLeftIdx = this.parent.viewport.topIndex;\n                        this.parent.renderModule.refreshUI({\n                            rowIndex: rowIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column', frozenIndexes: frozenIndexes,\n                            skipTranslate: true\n                        });\n                        if (frozenRow) {\n                            this.parent.viewport.topIndex = prevLeftIdx;\n                        }\n                        this.setThresholdWidth(width, threshold, frozenCol);\n                        this.translate({ refresh: 'Column' });\n                    }\n                    this.updateScrollCount(idx, 'col', threshold);\n                    this.focusSheet();\n                }\n                else {\n                    this.setThresholdWidth(width, threshold, frozenCol);\n                }\n            }\n            args.prev.idx = idx;\n        }\n    };\n    VirtualScroll.prototype.focusSheet = function () {\n        if (!document.activeElement.classList.contains('e-text-findNext-short') || !closest(document.activeElement, '#' + this.parent.element.id)) {\n            focus(this.parent.element);\n        }\n    };\n    VirtualScroll.prototype.setThresholdHeight = function (scrollHeight, threshold, frozenRow) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = this.parent.viewport.topIndex + frozenRow, len = i + threshold; i < len; i++) {\n            height += getRowHeight(sheet, i, true);\n        }\n        this.translateY = scrollHeight - height;\n    };\n    VirtualScroll.prototype.setThresholdWidth = function (scrollWidth, threshold, frozenCol) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = this.parent.viewport.leftIndex + frozenCol, len = i + threshold; i < len; i++) {\n            width += getColumnWidth(sheet, i, null, true);\n        }\n        this.translateX = scrollWidth - width;\n    };\n    VirtualScroll.prototype.translate = function (args) {\n        if (args.skipTranslate) {\n            return;\n        }\n        var translateX = this.parent.enableRtl ? -this.translateX : this.translateX;\n        if (args.refresh === 'Row' || args.refresh === 'RowPart') {\n            this.content.style.transform = \"translate(\" + translateX + \"px, \" + this.translateY + \"px)\";\n            this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n        }\n        if (args.refresh === 'Column' || args.refresh === 'ColumnPart') {\n            this.content.style.transform = \"translate(\" + translateX + \"px, \" + this.translateY + \"px)\";\n            this.colHeader.style.transform = \"translate(\" + translateX + \"px, 0px)\";\n        }\n    };\n    VirtualScroll.prototype.updateColumnWidth = function (args) {\n        if (args.refresh === 'Column') {\n            this.content.style.width = '';\n            var sheet = this.parent.getActiveSheet();\n            var width = getColumnsWidth(sheet, this.parent.viewport.leftIndex + this.parent.frozenColCount(sheet), this.parent.viewport.rightIndex, true);\n            this.colHeader.style.width = width + 'px';\n            this.content.style.width = width + 'px';\n            if (!this.parent.scrollSettings.isFinite || args.isUpdate) {\n                var scroll_1 = this.parent.element.querySelector('.e-scroller .e-virtualtrack');\n                var scrollWidth = parseInt(scroll_1.style.width, 10);\n                var newWidth = width + this.translateX + this.parent.viewport.beforeFreezeWidth;\n                if (newWidth > scrollWidth) {\n                    var diff = newWidth - scrollWidth;\n                    scroll_1.style.width = scrollWidth + diff + 'px';\n                }\n                else {\n                    var diff = scrollWidth - newWidth;\n                    var vTrack = this.parent.getMainContent().getElementsByClassName('e-virtualtrack')[0];\n                    if (scrollWidth - diff < parseInt(vTrack.style.width, 10)) {\n                        scroll_1.style.width = vTrack.style.width;\n                    }\n                }\n            }\n        }\n        else if (!this.parent.scrollSettings.isFinite) {\n            var vTrack = this.parent.getMainContent().getElementsByClassName('e-virtualtrack')[0];\n            var vTrackHeight = parseInt(vTrack.style.height, 10);\n            var height = this.content.getBoundingClientRect().height;\n            var newHeight = height + this.translateY + this.parent.viewport.beforeFreezeHeight;\n            if (newHeight > vTrackHeight) {\n                var diff = newHeight - vTrackHeight;\n                vTrack.style.height = vTrackHeight + diff + 'px';\n            }\n            else {\n                var diff = vTrackHeight - newHeight;\n                var hVTrack = this.parent.getRowHeaderContent().getElementsByClassName('e-virtualtrack')[0];\n                if (vTrackHeight - diff < parseInt(hVTrack.style.height, 10)) {\n                    vTrack.style.height = hVTrack.style.height;\n                }\n            }\n        }\n    };\n    VirtualScroll.prototype.updateUsedRange = function (args) {\n        if (!this.scroll.length) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        if (args.update === 'row') {\n            if (args.index !== this.scroll[this.parent.activeSheetIndex].rowCount - 1) {\n                var height = this.getVTrackHeight('height');\n                var newHeight = height;\n                if (args.index >= this.scroll[this.parent.activeSheetIndex].rowCount) {\n                    newHeight += getRowsHeight(sheet, this.scroll[this.parent.activeSheetIndex].rowCount, args.index, true);\n                }\n                else {\n                    newHeight -= getRowsHeight(sheet, args.index + 1, this.scroll[this.parent.activeSheetIndex].rowCount - 1, true);\n                }\n                if (newHeight < height) {\n                    return;\n                }\n                this.scroll[this.parent.activeSheetIndex].rowCount = args.index + 1;\n                this.updateVTrack(this.rowHeader, height, 'height');\n                if (this.scroll[this.parent.activeSheetIndex].rowCount > sheet.rowCount) {\n                    this.parent.setSheetPropertyOnMute(sheet, 'rowCount', this.scroll[this.parent.activeSheetIndex].rowCount);\n                }\n            }\n        }\n        else {\n            if (args.index > this.scroll[this.parent.activeSheetIndex].colCount) {\n                var width = this.getVTrackHeight('width');\n                width += getColumnsWidth(sheet, this.scroll[this.parent.activeSheetIndex].colCount, args.index, true);\n                this.scroll[this.parent.activeSheetIndex].colCount = args.index + 1;\n                this.updateVTrack(this.colHeader, width, 'width');\n                if (this.scroll[this.parent.activeSheetIndex].colCount > sheet.colCount) {\n                    this.parent.setSheetPropertyOnMute(sheet, 'colCount', this.scroll[this.parent.activeSheetIndex].colCount);\n                }\n            }\n        }\n    };\n    VirtualScroll.prototype.getVTrackHeight = function (str) {\n        var height = this.content.nextElementSibling.style[str];\n        if (height.includes('e+')) {\n            height = height.split('px')[0];\n            var heightArr = height.split('e+');\n            return Number(heightArr[0]) * Math.pow(10, Number(heightArr[1]));\n        }\n        else {\n            return parseFloat(height);\n        }\n    };\n    VirtualScroll.prototype.updateVTrackHeight = function (args) {\n        if (args.rowIdx < this.scroll[this.parent.activeSheetIndex].rowCount) {\n            this.updateVTrack(this.rowHeader, this.getVTrackHeight('height') + args.threshold, 'height');\n        }\n    };\n    VirtualScroll.prototype.updateVTrackWidth = function (args) {\n        if (args.colIdx >= this.parent.viewport.leftIndex && args.colIdx <= this.parent.viewport.rightIndex) {\n            var hdrVTrack = this.parent.getColumnHeaderContent().getElementsByClassName('e-virtualtrack')[0];\n            hdrVTrack.style.width = parseFloat(hdrVTrack.style.width) + args.threshold + 'px';\n            var cntVTrack = this.parent.getMainContent().getElementsByClassName('e-virtualtrack')[0];\n            cntVTrack.style.width = parseFloat(cntVTrack.style.width) + args.threshold + 'px';\n            var hdrColumn = this.parent.getColumnHeaderContent().getElementsByClassName('e-virtualable')[0];\n            hdrColumn.style.width = parseFloat(hdrColumn.style.width) + args.threshold + 'px';\n            var cntColumn = this.parent.getMainContent().getElementsByClassName('e-virtualable')[0];\n            cntColumn.style.width = parseFloat(cntColumn.style.width) + args.threshold + 'px';\n        }\n    };\n    VirtualScroll.prototype.updateVTrack = function (header, size, sizeStr) {\n        header.nextElementSibling.style[sizeStr] = size + \"px\";\n        this.content.nextElementSibling.style[sizeStr] = size + \"px\";\n    };\n    VirtualScroll.prototype.deInitProps = function () {\n        this.parent.viewport.leftIndex = null;\n        this.parent.viewport.topIndex = null;\n        this.parent.viewport.bottomIndex = null;\n        this.translateX = null;\n        this.translateY = null;\n    };\n    VirtualScroll.prototype.updateScrollProps = function (args) {\n        var _this = this;\n        if (args === void 0) { args = { sheetIndex: 0, sheets: this.parent.sheets }; }\n        if (this.scroll.length === 0) {\n            this.initScroll();\n        }\n        else {\n            args.sheets.forEach(function () { _this.scroll.splice(args.sheetIndex, 0, { rowCount: 0, colCount: 0 }); });\n        }\n    };\n    VirtualScroll.prototype.sliceScrollProps = function (args) {\n        if (isNullOrUndefined(args.sheetIndex)) {\n            this.scroll.length = 0;\n        }\n        else {\n            this.scroll.splice(args.sheetIndex, 1);\n        }\n    };\n    VirtualScroll.prototype.addEventListener = function () {\n        this.parent.on(beforeContentLoaded, this.createVirtualElement, this);\n        this.parent.on(beforeVirtualContentLoaded, this.translate, this);\n        this.parent.on(virtualContentLoaded, this.updateColumnWidth, this);\n        this.parent.on(updateTableWidth, this.updateColumnWidth, this);\n        this.parent.on(onVerticalScroll, this.onVerticalScroll, this);\n        this.parent.on(onHorizontalScroll, this.onHorizontalScroll, this);\n        this.parent.on(updateUsedRange, this.updateUsedRange, this);\n        this.parent.on(rowHeightChanged, this.updateVTrackHeight, this);\n        this.parent.on(colWidthChanged, this.updateVTrackWidth, this);\n        this.parent.on(deInitProperties, this.deInitProps, this);\n        this.parent.on(sheetsDestroyed, this.sliceScrollProps, this);\n        this.parent.on(sheetCreated, this.updateScrollProps, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    VirtualScroll.prototype.destroy = function () {\n        this.removeEventListener();\n        this.rowHeader = null;\n        this.colHeader = null;\n        this.content = null;\n        this.parent = null;\n        this.scroll.length = 0;\n        this.translateX = null;\n        this.translateY = null;\n    };\n    VirtualScroll.prototype.removeEventListener = function () {\n        this.parent.off(beforeContentLoaded, this.createVirtualElement);\n        this.parent.off(beforeVirtualContentLoaded, this.translate);\n        this.parent.off(virtualContentLoaded, this.updateColumnWidth);\n        this.parent.off(updateTableWidth, this.updateColumnWidth);\n        this.parent.off(onVerticalScroll, this.onVerticalScroll);\n        this.parent.off(onHorizontalScroll, this.onHorizontalScroll);\n        this.parent.off(updateUsedRange, this.updateUsedRange);\n        this.parent.off(rowHeightChanged, this.updateVTrackHeight);\n        this.parent.off(colWidthChanged, this.updateVTrackWidth);\n        this.parent.off(sheetsDestroyed, this.sliceScrollProps);\n        this.parent.off(sheetCreated, this.updateScrollProps);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return VirtualScroll;\n}());\nexport { VirtualScroll };\n","import { keyDown, cellNavigate, renameSheet, filterCellKeyDown } from '../common/index';\nimport { getCellIndexes, getRangeAddress, getRowHeight, getColumnWidth, getCell } from '../../workbook/index';\nimport { getRangeIndexes, getSwapRange, isHiddenRow } from '../../workbook/index';\nimport { closest, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Represents keyboard navigation support for Spreadsheet.\n */\nvar KeyboardNavigation = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Navigation module.\n     *\n     * @private\n     * @param {Spreadsheet} parent - Specify the spreadsheet\n     */\n    function KeyboardNavigation(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        /* code snippet */\n    }\n    KeyboardNavigation.prototype.addEventListener = function () {\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(keyDown, this.keyDownHandler);\n        }\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.keyDownHandler = function (e) {\n        if (!this.parent.isEdit && (document.activeElement.classList.contains('e-spreadsheet') ||\n            closest(document.activeElement, '.e-sheet')) && !closest(e.target, '.e-name-box')) {\n            var isNavigate = void 0;\n            var scrollIdxes = void 0;\n            var isRtl = this.parent.enableRtl;\n            var sheet = this.parent.getActiveSheet();\n            var filterArgs = { e: e, isFilterCell: false };\n            var actIdxes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n            if ([9, 37, 38, 39, 40].indexOf(e.keyCode) > -1) {\n                e.preventDefault();\n            }\n            if (e.shiftKey) { // shift selection\n                this.shiftSelection(e);\n            }\n            if (!e.shiftKey && e.altKey && (e.keyCode === 38 || e.keyCode === 40)) {\n                this.parent.notify(filterCellKeyDown, filterArgs);\n            }\n            if ((!e.shiftKey && ((!isRtl && e.keyCode === 37) || (isRtl && e.keyCode === 39)))\n                || (e.shiftKey && e.keyCode === 9)) { //left key\n                if (actIdxes[1] > 0) {\n                    actIdxes[1] -= 1;\n                    isNavigate = true;\n                }\n                else {\n                    var content = this.parent.getMainContent();\n                    if (actIdxes[1] === 0 && content.scrollLeft && !isRtl) {\n                        content.scrollLeft = 0;\n                    }\n                }\n            }\n            else if (e.shiftKey && e.keyCode === 13) { // Up key\n                if (!this.parent.element.querySelector('.e-find-toolbar')) {\n                    if (actIdxes[0] > 0) {\n                        actIdxes[0] -= 1;\n                        isNavigate = true;\n                    }\n                    else {\n                        var content = this.parent.getMainContent().parentElement;\n                        if (actIdxes[0] === 0 && content.scrollTop) {\n                            content.scrollTop = 0;\n                        }\n                    }\n                }\n            }\n            else if (!filterArgs.isFilterCell && !e.shiftKey && e.keyCode === 38) { // Up key\n                if (actIdxes[0] > 0) {\n                    actIdxes[0] -= 1;\n                    isNavigate = true;\n                }\n                else {\n                    var content = this.parent.getMainContent().parentElement;\n                    if (actIdxes[0] === 0 && content.scrollTop) {\n                        content.scrollTop = 0;\n                    }\n                }\n            }\n            else if ((!e.shiftKey && ((!isRtl && e.keyCode === 39) || (isRtl && e.keyCode === 37))) || e.keyCode === 9) { // Right key\n                var cell = getCell(actIdxes[0], actIdxes[1], sheet);\n                if (cell && cell.colSpan > 1) {\n                    actIdxes[1] += (cell.colSpan - 1);\n                }\n                if (actIdxes[1] < sheet.colCount - 1) {\n                    actIdxes[1] += 1;\n                    isNavigate = true;\n                }\n            }\n            else if ((!filterArgs.isFilterCell && !e.shiftKey && e.keyCode === 40) || e.keyCode === 13) { // Down Key\n                var cell = getCell(actIdxes[0], actIdxes[1], sheet);\n                if (cell && cell.rowSpan > 1) {\n                    actIdxes[0] += (cell.rowSpan - 1);\n                }\n                if (actIdxes[0] < sheet.rowCount - 1) {\n                    actIdxes[0] += 1;\n                    isNavigate = true;\n                }\n            }\n            /* else if (e.keyCode === 36) {\n                actIdxes[1] = 0;\n                if (e.ctrlKey) {\n                    actIdxes[0] = 0;\n                }\n                isNavigate = true;\n                e.preventDefault();\n            } else if (e.keyCode === 35 && e.ctrlKey) {\n                actIdxes = [sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n                scrollIdxes = [sheet.usedRange.rowIndex - this.parent.viewport.rowCount,\n                    sheet.usedRange.colIndex - this.parent.viewport.colCount];\n                isNavigate = true;\n                e.preventDefault();\n            } */\n            if (isNavigate) {\n                while (isHiddenRow(this.parent.getActiveSheet(), actIdxes[0])) {\n                    if (e.keyCode === 40) {\n                        actIdxes[0] = actIdxes[0] + 1;\n                    }\n                    if (e.keyCode === 38) {\n                        actIdxes[0] = actIdxes[0] - 1;\n                    }\n                }\n                this.scrollNavigation(scrollIdxes || actIdxes, scrollIdxes ? true : false);\n                this.parent.setSheetPropertyOnMute(sheet, 'activeCell', getRangeAddress(actIdxes));\n                this.parent.notify(cellNavigate, { range: actIdxes });\n            }\n        }\n        var target = e.target;\n        if (target.classList.contains('e-sheet-rename')) {\n            if (e.keyCode === 32) {\n                e.stopPropagation();\n            }\n            else if (e.keyCode === 13 || e.keyCode === 27) {\n                this.parent.notify(renameSheet, e);\n            }\n        }\n    };\n    KeyboardNavigation.prototype.shiftSelection = function (e) {\n        var sheet = this.parent.getActiveSheet();\n        var selectedRange = getRangeIndexes(sheet.selectedRange);\n        var swapRange = getSwapRange(selectedRange);\n        var noHidden = true;\n        if (e.keyCode === 38) { // shift + up arrow\n            for (var i = swapRange[1]; i <= swapRange[3]; i++) {\n                var cell = getCell(selectedRange[2], i, this.parent.getActiveSheet());\n                if (!isNullOrUndefined(cell) && cell.rowSpan && cell.rowSpan < 0) {\n                    selectedRange[2] = selectedRange[2] - (Math.abs(cell.rowSpan) + 1);\n                    noHidden = false;\n                    break;\n                }\n            }\n            if (noHidden) {\n                selectedRange[2] = selectedRange[2] - 1;\n            }\n            if (selectedRange[2] < 0) {\n                selectedRange[2] = 0;\n            }\n        }\n        if (e.keyCode === 40) { // shift + down arrow\n            for (var i = swapRange[1]; i <= swapRange[3]; i++) {\n                var cell = getCell(selectedRange[2], i, this.parent.getActiveSheet());\n                if (!isNullOrUndefined(cell) && cell.rowSpan && cell.rowSpan > 0) {\n                    selectedRange[2] = selectedRange[2] + Math.abs(cell.rowSpan);\n                    noHidden = false;\n                    break;\n                }\n            }\n            if (noHidden) {\n                selectedRange[2] = selectedRange[2] + 1;\n            }\n        }\n        if (e.keyCode === 39) { // shift + right arrow\n            for (var i = swapRange[0]; i <= swapRange[2]; i++) {\n                var cell = getCell(i, selectedRange[3], this.parent.getActiveSheet());\n                if (!isNullOrUndefined(cell) && cell.colSpan && cell.colSpan > 0) {\n                    selectedRange[3] = selectedRange[3] + Math.abs(cell.colSpan);\n                    noHidden = false;\n                    break;\n                }\n            }\n            if (noHidden) {\n                selectedRange[3] = selectedRange[3] + 1;\n            }\n        }\n        if (e.keyCode === 37) { // shift + left arrow\n            for (var i = swapRange[0]; i <= swapRange[2]; i++) {\n                var cell = getCell(i, selectedRange[3], this.parent.getActiveSheet());\n                if (!isNullOrUndefined(cell) && cell.colSpan && cell.colSpan < 0) {\n                    selectedRange[3] = selectedRange[3] - (Math.abs(cell.colSpan) + 1);\n                    noHidden = false;\n                    break;\n                }\n            }\n            if (noHidden) {\n                selectedRange[3] = selectedRange[3] - 1;\n            }\n            if (selectedRange[3] < 0) {\n                selectedRange[3] = 0;\n            }\n        }\n        if (e.shiftKey && e.ctrlKey && !this.parent.scrollSettings.enableVirtualization) { // ctrl + shift selection\n            var usedRange = [sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n            if (e.keyCode === 37) {\n                if (selectedRange[3] <= usedRange[1]) {\n                    selectedRange[3] = 0;\n                }\n                else {\n                    selectedRange[3] = usedRange[1];\n                }\n            }\n            if (e.keyCode === 38) {\n                if (selectedRange[2] <= usedRange[0]) {\n                    selectedRange[2] = 0;\n                }\n                else {\n                    selectedRange[2] = usedRange[0];\n                }\n            }\n            if (e.keyCode === 39) {\n                if (selectedRange[3] <= usedRange[1]) {\n                    selectedRange[3] = usedRange[1];\n                }\n                else {\n                    selectedRange[3] = this.parent.getActiveSheet().colCount;\n                }\n            }\n            if (e.keyCode === 40) {\n                if (selectedRange[2] <= usedRange[0]) {\n                    selectedRange[2] = usedRange[0];\n                }\n                else {\n                    selectedRange[2] = this.parent.getActiveSheet().rowCount;\n                }\n            }\n        }\n        if (e.keyCode === 37 || e.keyCode === 39 || e.keyCode === 38 || e.keyCode === 40) {\n            while (isHiddenRow(this.parent.getActiveSheet(), selectedRange[2])) {\n                if (e.keyCode === 40) {\n                    selectedRange[2] = selectedRange[2] + 1;\n                }\n                if (e.keyCode === 38) {\n                    selectedRange[2] = selectedRange[2] - 1;\n                }\n            }\n            this.parent.selectRange(getRangeAddress(selectedRange));\n            this.scrollNavigation([selectedRange[2], selectedRange[3]], false);\n        }\n    };\n    KeyboardNavigation.prototype.scrollNavigation = function (actIdxes, isScroll) {\n        if (!this.parent.allowScrolling) {\n            return;\n        }\n        var x = this.parent.enableRtl ? -1 : 1;\n        var cont = this.parent.getMainContent().parentElement;\n        var hCont = this.parent.getScrollElement();\n        var sheet = this.parent.getActiveSheet();\n        var selectedRange = getSwapRange(getRangeIndexes(sheet.selectedRange));\n        var topLeftIdxes = getCellIndexes(sheet.topLeftCell);\n        var frozenRow = this.parent.frozenRowCount(sheet);\n        var frozenCol = this.parent.frozenColCount(sheet);\n        var paneTopLeftIdxes = getCellIndexes(sheet.paneTopLeftCell);\n        var topIdx = actIdxes[0] < frozenRow ? topLeftIdxes[0] : paneTopLeftIdxes[0];\n        var leftIdx = actIdxes[1] < frozenCol ? topLeftIdxes[1] : paneTopLeftIdxes[1];\n        var offsetLeftSize = this.parent.scrollModule.offset.left.size;\n        var offsetTopSize = this.parent.scrollModule.offset.top.size;\n        if (frozenRow && actIdxes[0] !== selectedRange[2] && cont.scrollTop) {\n            if (actIdxes[0] === frozenRow) {\n                cont.scrollTop = 0;\n                return;\n            }\n            if (actIdxes[0] === frozenRow - 1) {\n                cont.scrollTop = 0;\n            }\n        }\n        if (frozenCol && actIdxes[1] !== selectedRange[3] && hCont.scrollLeft) {\n            if (actIdxes[1] === frozenCol) {\n                hCont.scrollLeft = 0;\n                return;\n            }\n            if (actIdxes[1] === frozenCol - 1) {\n                hCont.scrollLeft = 0;\n            }\n        }\n        if (this.getBottomIdx(topIdx) <= actIdxes[0] || isScroll) {\n            cont.scrollTop = offsetTopSize + getRowHeight(sheet, paneTopLeftIdxes[0], true);\n        }\n        else if (topIdx > actIdxes[0]) {\n            cont.scrollTop = offsetTopSize - Math.ceil(getRowHeight(sheet, actIdxes[0], true));\n        }\n        if (this.getRightIdx(leftIdx) <= actIdxes[1] || isScroll) {\n            hCont.scrollLeft = offsetLeftSize + getColumnWidth(sheet, paneTopLeftIdxes[1], null, true) * x;\n        }\n        else if (leftIdx > actIdxes[1]) {\n            hCont.scrollLeft = offsetLeftSize - getColumnWidth(sheet, actIdxes[1], null, true) * x;\n        }\n    };\n    KeyboardNavigation.prototype.getBottomIdx = function (top) {\n        var hgt = 0;\n        var sheet = this.parent.getActiveSheet();\n        var viewPortHeight = (sheet.frozenRows ? this.parent.viewport.height - this.parent.sheetModule.getColHeaderHeight(sheet, true) : this.parent.viewport.height) - 17 || 20;\n        for (var i = top;; i++) {\n            hgt += getRowHeight(sheet, i, true);\n            if (hgt >= viewPortHeight) {\n                return i;\n            }\n        }\n    };\n    KeyboardNavigation.prototype.getRightIdx = function (left) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var contWidth = this.parent.getMainContent().parentElement.offsetWidth -\n            this.parent.sheetModule.getRowHeaderWidth(sheet);\n        for (var i = left;; i++) {\n            width += getColumnWidth(sheet, i, null, true);\n            if (width >= contWidth - 17) {\n                return i;\n            }\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @private\n     * @returns {string} - Get the module name.\n     */\n    KeyboardNavigation.prototype.getModuleName = function () {\n        return 'keyboardNavigation';\n    };\n    KeyboardNavigation.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardNavigation;\n}());\nexport { KeyboardNavigation };\n","import { keyDown, cut, paste, copy, clearCopy, performUndoRedo, initiateHyperlink, editHyperlink } from '../common/index';\nimport { findDlg, gotoDlg } from '../common/index';\nimport { setCellFormat, textDecorationUpdate, getCellIndexes, ribbonFind } from '../../workbook/common/index';\nimport { getColumn, isLocked as isCellLocked } from '../../workbook/index';\nimport { setCell, getCell } from '../../workbook/base/cell';\nimport { isNullOrUndefined, closest, select } from '@syncfusion/ej2-base';\n/**\n * Represents keyboard shortcut support for Spreadsheet.\n */\nvar KeyboardShortcut = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Shortcut module.\n     *\n     * @param {Spreadsheet} parent - Specify the spreadsheet.\n     * @private\n     */\n    function KeyboardShortcut(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    KeyboardShortcut.prototype.addEventListener = function () {\n        this.parent.on(keyDown, this.keyDownHandler, this);\n    };\n    KeyboardShortcut.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(keyDown, this.keyDownHandler);\n        }\n    };\n    KeyboardShortcut.prototype.keyDownHandler = function (e) {\n        if (e.ctrlKey || e.metaKey) {\n            if (!closest(e.target, '.e-find-dlg')) {\n                if ([79, 83].indexOf(e.keyCode) > -1) {\n                    e.preventDefault();\n                }\n                else if (e.keyCode === 65 && !this.parent.isEdit) {\n                    e.preventDefault();\n                }\n            }\n            if (e.keyCode === 79) {\n                select('#' + this.parent.element.id + '_fileUpload', this.parent.element).click();\n            }\n            else if (e.keyCode === 83) {\n                if (this.parent.saveUrl && this.parent.allowSave) {\n                    this.parent.save();\n                }\n            }\n            else if (e.keyCode === 67) {\n                this.parent.notify(copy, { promise: Promise });\n            }\n            else if (e.keyCode === 75) {\n                var sheet = this.parent.getActiveSheet();\n                var indexes = getCellIndexes(sheet.activeCell);\n                var row = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]];\n                var cell = void 0;\n                e.preventDefault();\n                if (!isNullOrUndefined(row)) {\n                    cell = row.cells[indexes[1]];\n                }\n                if (isNullOrUndefined(cell)) {\n                    setCell(indexes[0], indexes[1], this.parent.getActiveSheet(), cell, false);\n                }\n                if (cell && cell.hyperlink) {\n                    this.parent.notify(editHyperlink, null);\n                }\n                else {\n                    this.parent.notify(initiateHyperlink, null);\n                }\n            }\n            else if (e.keyCode === 90) { /* Ctrl + Z */\n                if (!this.parent.isEdit) {\n                    e.preventDefault();\n                    this.parent.notify(performUndoRedo, { isUndo: true });\n                }\n            }\n            else if (e.keyCode === 89) { /* Ctrl + Y */\n                if (!this.parent.isEdit) {\n                    e.preventDefault();\n                    this.parent.notify(performUndoRedo, { isUndo: false });\n                }\n            }\n            var actSheet = this.parent.sheets[this.parent.getActiveSheet().id - 1];\n            var isLocked = void 0;\n            if (actSheet) {\n                var actCell = actSheet.activeCell;\n                var actCellIndex = getCellIndexes(actCell);\n                var cellObj = getCell(actCellIndex[0], actCellIndex[1], actSheet);\n                isLocked = actSheet.isProtected && isCellLocked(cellObj, getColumn(actSheet, actCellIndex[1]));\n            }\n            if (e.keyCode === 70) {\n                e.preventDefault();\n                this.parent.notify(ribbonFind, null);\n            }\n            if ((!isLocked || !actSheet.isProtected || e.keyCode === 86) && e.keyCode !== 70) {\n                if (e.keyCode === 71) {\n                    e.preventDefault();\n                    this.parent.notify(gotoDlg, null);\n                }\n                else if (e.keyCode === 72) {\n                    e.preventDefault();\n                    this.parent.notify(findDlg, null);\n                }\n                else if (e.keyCode === 88) {\n                    this.parent.notify(cut, { promise: Promise });\n                }\n                else if (e.keyCode === 86) {\n                    this.parent.notify(paste, { isAction: true });\n                }\n                else if (e.keyCode === 66) {\n                    e.preventDefault();\n                    var value = this.parent.getCellStyleValue(['fontWeight'], getCellIndexes(this.parent.getActiveSheet().activeCell)).fontWeight;\n                    value = value === 'bold' ? 'normal' : 'bold';\n                    this.parent.notify(setCellFormat, { style: { fontWeight: value }, onActionUpdate: true, refreshRibbon: true });\n                }\n                else if (e.keyCode === 73) {\n                    e.preventDefault();\n                    var value = this.parent.getCellStyleValue(['fontStyle'], getCellIndexes(this.parent.getActiveSheet().activeCell)).fontStyle;\n                    value = value === 'italic' ? 'normal' : 'italic';\n                    this.parent.notify(setCellFormat, { style: { fontStyle: value }, onActionUpdate: true, refreshRibbon: true });\n                }\n                else if (e.keyCode === 85) {\n                    e.preventDefault();\n                    this.parent.notify(textDecorationUpdate, { style: { textDecoration: 'underline' }, refreshRibbon: true });\n                }\n                else if (e.keyCode === 53) {\n                    e.preventDefault();\n                    this.parent.notify(textDecorationUpdate, { style: { textDecoration: 'line-through' }, refreshRibbon: true });\n                }\n                if (e.shiftKey) {\n                    if (e.keyCode === 76) { /* Ctrl + Shift + L */\n                        if (!this.parent.isEdit) {\n                            e.preventDefault();\n                            this.parent.applyFilter();\n                        }\n                    }\n                }\n            }\n        }\n        if (e.keyCode === 27) {\n            this.parent.notify(clearCopy, null);\n        }\n    };\n    KeyboardShortcut.prototype.getModuleName = function () {\n        return 'keyboardShortcut';\n    };\n    KeyboardShortcut.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardShortcut;\n}());\nexport { KeyboardShortcut };\n","import { clearViewer, beginAction, getTextHeightWithBorder } from '../../spreadsheet/index';\nimport { getExcludedColumnWidth, selectRange } from '../common/index';\nimport { rowHeightChanged, setRowEleHeight, setMaxHgt, getTextHeight, getMaxHgt, getLines, initialLoad } from '../common/index';\nimport { getRowHeight, applyCellFormat } from '../../workbook/index';\nimport { isHiddenRow, getCell, getRangeIndexes, getSheetIndex, clearCFRule } from '../../workbook/index';\nimport { wrapEvent, getRangeAddress, clear, activeCellMergedRange, addHighlight } from '../../workbook/index';\nimport { removeClass, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * CellFormat module allows to format the cell styles.\n */\nvar CellFormat = /** @class */ (function () {\n    function CellFormat(parent) {\n        this.checkHeight = false;\n        this.parent = parent;\n        this.row = parent.createElement('tr', { className: 'e-row' });\n        this.parent.on(initialLoad, this.addEventListener, this);\n    }\n    CellFormat.prototype.applyCellFormat = function (args) {\n        var keys = Object.keys(args.style);\n        var sheet = this.parent.getActiveSheet();\n        if (args.lastCell && getMaxHgt(sheet, args.rowIdx) <= 20 && !keys.length) {\n            return;\n        }\n        var cell = args.cell || this.parent.getCell(args.rowIdx, args.colIdx);\n        if (cell) {\n            this.updateMergeBorder(args, sheet);\n            if (args.style.border !== undefined || args.style.borderTop !== undefined || args.style.borderLeft !== undefined) {\n                var curStyle_1 = {};\n                Object.keys(args.style).forEach(function (key) { curStyle_1[key] = args.style[key]; });\n                if (curStyle_1.border !== undefined) {\n                    Object.assign(cell.style, { borderRight: args.style.border, borderBottom: args.style.border });\n                    this.setLeftBorder(args.style.border, cell, args.rowIdx, args.colIdx, args.row, args.onActionUpdate, args.first, sheet);\n                    this.setTopBorder(args.style.border, cell, args.rowIdx, args.colIdx, args.pRow, args.pHRow, args.onActionUpdate, args.first, args.lastCell, args.manualUpdate, sheet);\n                    delete curStyle_1.border;\n                }\n                if (curStyle_1.borderTop !== undefined) {\n                    this.setTopBorder(args.style.borderTop, cell, args.rowIdx, args.colIdx, args.pRow, args.pHRow, args.onActionUpdate, args.first, args.lastCell, args.manualUpdate, sheet);\n                    delete curStyle_1.borderTop;\n                }\n                if (curStyle_1.borderLeft !== undefined) {\n                    this.setLeftBorder(args.style.borderLeft, cell, args.rowIdx, args.colIdx, args.row, args.onActionUpdate, args.first, sheet);\n                    delete curStyle_1.borderLeft;\n                }\n                if (Object.keys(curStyle_1).length) {\n                    if (curStyle_1.borderBottom !== undefined) {\n                        this.setThickBorderHeight(curStyle_1.borderBottom, args.rowIdx, args.colIdx, cell, args.row, args.hRow, args.onActionUpdate, args.lastCell, args.manualUpdate);\n                    }\n                    Object.assign(cell.style, curStyle_1);\n                }\n            }\n            else {\n                if (args.style.borderBottom !== undefined) {\n                    this.setThickBorderHeight(args.style.borderBottom, args.rowIdx, args.colIdx, cell, args.row, args.hRow, args.onActionUpdate, args.lastCell, args.manualUpdate);\n                }\n                Object.assign(cell.style, args.style);\n                if (cell.firstElementChild && cell.firstElementChild.classList.contains(\"e-wrap-content\")) {\n                    var wrapEle = cell.firstElementChild;\n                    Object.assign(wrapEle.style, args.style);\n                }\n                var CellElem = getCell(args.rowIdx, args.colIdx, sheet); // Need to remove after adding span support to merge\n                if (CellElem && (CellElem.rowSpan || CellElem.colSpan) && cell.offsetHeight > 0) {\n                    var height = getTextHeight(this.parent, CellElem.style || this.parent.cellStyle);\n                    if (height > cell.offsetHeight) {\n                        setRowEleHeight(this.parent, sheet, cell.offsetHeight, args.rowIdx);\n                    }\n                }\n            }\n            if (args.isHeightCheckNeeded) {\n                if (!sheet.rows[args.rowIdx] || !sheet.rows[args.rowIdx].customHeight) {\n                    if (!args.manualUpdate) {\n                        var cellModel = getCell(args.rowIdx, args.colIdx, sheet);\n                        if (!(cellModel && cellModel.wrap) && this.isHeightCheckNeeded(args.style)) {\n                            setMaxHgt(sheet, args.rowIdx, args.colIdx, getTextHeightWithBorder(this.parent, args.rowIdx, args.colIdx, sheet, args.style));\n                        }\n                        if (args.lastCell) {\n                            var height = getMaxHgt(sheet, args.rowIdx);\n                            if (height > 20 && height > getRowHeight(sheet, args.rowIdx)) {\n                                setRowEleHeight(this.parent, sheet, height, args.rowIdx, args.row, args.hRow, this.parent.scrollSettings.isFinite);\n                            }\n                        }\n                    }\n                    else {\n                        if (!this.checkHeight) {\n                            this.checkHeight = this.isHeightCheckNeeded(args.style, args.onActionUpdate);\n                        }\n                        if (cell && cell.children[0] && cell.children[0].className === 'e-cf-databar' && args.style.fontSize) {\n                            cell.children[0].querySelector('.e-databar-value').style.fontSize = args.style.fontSize;\n                        }\n                        this.updateRowHeight(args.rowIdx, args.colIdx, args.lastCell, args.onActionUpdate);\n                    }\n                }\n            }\n        }\n        else {\n            this.updateRowHeight(args.rowIdx, args.colIdx, true, args.onActionUpdate);\n        }\n    };\n    CellFormat.prototype.updateRowHeight = function (rowIdx, colIdx, isLastCell, onActionUpdate) {\n        if (this.checkHeight) {\n            var hgt = 0;\n            var maxHgt = void 0;\n            var sheet = this.parent.getActiveSheet();\n            var cell = getCell(rowIdx, colIdx, sheet, null, true);\n            var td = this.parent.getCell(rowIdx, colIdx);\n            if (cell && (!cell.rowSpan && !cell.colSpan)) {\n                hgt = getTextHeightWithBorder(this.parent, rowIdx, colIdx, sheet, cell.style ||\n                    this.parent.cellStyle, cell.wrap ? getLines(this.parent.getDisplayText(cell), getExcludedColumnWidth(sheet, rowIdx, colIdx), cell.style, this.parent.cellStyle) : 1);\n                if (!isNullOrUndefined(cell.value)) {\n                    var val = cell.value.toString();\n                    if (val.indexOf('\\n') > -1) {\n                        var i = void 0;\n                        var splitVal = cell.value.split('\\n');\n                        var n = 0;\n                        var valLength = splitVal.length;\n                        for (i = 0; i < valLength; i++) {\n                            var lines = getLines(splitVal[i], getExcludedColumnWidth(sheet, rowIdx, colIdx), cell.style, this.parent.cellStyle);\n                            if (lines === 0) {\n                                lines = 1; // for empty new line\n                            }\n                            n = n + lines;\n                        }\n                        hgt =\n                            getTextHeightWithBorder(this.parent, rowIdx, colIdx, sheet, cell.style || this.parent.cellStyle, n);\n                    }\n                }\n                if (hgt < 20) {\n                    hgt = 20; // default height\n                }\n                if (td && td.children[0] && td.children[0].className === 'e-cf-databar') {\n                    td.children[0].style.height = '100%';\n                    td.children[0].firstElementChild.nextElementSibling.style.height = '100%';\n                }\n                setMaxHgt(sheet, rowIdx, colIdx, hgt);\n                if (isLastCell) {\n                    this.checkHeight = false;\n                    var row = sheet.frozenRows ? this.parent.getRow(rowIdx, null, sheet.frozenColumns) :\n                        this.parent.getRow(rowIdx);\n                    if (!row) {\n                        return;\n                    }\n                    var prevHeight = getRowHeight(sheet, rowIdx);\n                    maxHgt = getMaxHgt(sheet, rowIdx);\n                    var heightChanged = onActionUpdate ? maxHgt !== prevHeight : maxHgt > prevHeight;\n                    if (heightChanged) {\n                        setRowEleHeight(this.parent, sheet, maxHgt, rowIdx, row, null, true);\n                    }\n                }\n            }\n        }\n    };\n    CellFormat.prototype.updateMergeBorder = function (args, sheet) {\n        var cellModel = getCell(args.rowIdx, args.colIdx, sheet, null, true);\n        var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        if (cellModel.rowSpan > 1 && !args.style.borderBottom) {\n            var bottomCell = getCell(mergeArgs.range[2], mergeArgs.range[1], sheet, null, true);\n            if (bottomCell.style && bottomCell.style.borderBottom) {\n                args.style.borderBottom = bottomCell.style.borderBottom;\n            }\n        }\n        if (cellModel.colSpan > 1 && !args.style.borderRight) {\n            var rightCell = getCell(mergeArgs.range[0], mergeArgs.range[3], sheet, null, true);\n            if (rightCell.style && rightCell.style.borderRight) {\n                args.style.borderRight = rightCell.style.borderRight;\n            }\n        }\n    };\n    CellFormat.prototype.isHeightCheckNeeded = function (style, onActionUpdate) {\n        var keys = Object.keys(style);\n        return (onActionUpdate ? keys.indexOf('fontSize') > -1 : keys.indexOf('fontSize') > -1\n            && Number(style.fontSize.split('pt')[0]) > 12) || keys.indexOf('fontFamily') > -1 || keys.indexOf('borderTop') > -1\n            || keys.indexOf('borderBottom') > -1;\n    };\n    CellFormat.prototype.setLeftBorder = function (border, cell, rowIdx, colIdx, row, actionUpdate, first, sheet) {\n        if (first && first.includes('Column')) {\n            return;\n        }\n        var prevCell = this.parent.getCell(rowIdx, colIdx - 1, row);\n        if (prevCell) {\n            var model = getCell(rowIdx, colIdx - 1, sheet, false, true);\n            if (!!model.rowSpan || !!model.colSpan) {\n                var mergeArgs = { range: [rowIdx, colIdx - 1, rowIdx, colIdx - 1] };\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                model = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet, false, true);\n                if (model.style && model.style.borderRight) {\n                    return;\n                }\n                else {\n                    model = getCell(mergeArgs.range[0], mergeArgs.range[3], sheet, null, true);\n                    if (model.style && model.style.borderRight) {\n                        return;\n                    }\n                    cell.style.borderLeft = border;\n                }\n            }\n            else {\n                if (actionUpdate && border !== '' && colIdx === this.parent.viewport.leftIndex) {\n                    this.parent.getMainContent().scrollLeft -= this.getBorderSize(border);\n                }\n                prevCell.style.borderRight = (border === 'none') ? prevCell.style.borderRight : border;\n            }\n        }\n        else {\n            cell.style.borderLeft = border;\n        }\n    };\n    CellFormat.prototype.setTopBorder = function (border, cell, rowIdx, colIdx, pRow, pHRow, actionUpdate, first, lastCell, manualUpdate, sheet) {\n        if (first && first.includes('Row')) {\n            return;\n        }\n        var prevCell = this.parent.getCell(rowIdx - 1, colIdx, pRow);\n        if (prevCell) {\n            var model = getCell(rowIdx - 1, colIdx, sheet, false, true);\n            if (!!model.rowSpan || !!model.colSpan) {\n                var mergeArgs = { range: [rowIdx - 1, colIdx, rowIdx - 1, colIdx] };\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                model = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet, false, true);\n                if (model.style && model.style.borderBottom) {\n                    return;\n                }\n                else {\n                    model = getCell(mergeArgs.range[2], mergeArgs.range[1], sheet, null, true);\n                    if (model.style && model.style.borderBottom) {\n                        return;\n                    }\n                    cell.style.borderTop = border;\n                }\n            }\n            else {\n                if (isHiddenRow(sheet, rowIdx - 1)) {\n                    var index = [Number(prevCell.parentElement.getAttribute('aria-rowindex')) - 1, colIdx];\n                    if (this.parent.getCellStyleValue(['bottomPriority'], index).bottomPriority) {\n                        return;\n                    }\n                }\n                if (actionUpdate && border !== '' && sheet.topLeftCell.includes(\"\" + (rowIdx + 1))) {\n                    this.parent.getMainContent().parentElement.scrollTop -= this.getBorderSize(border);\n                }\n                this.setThickBorderHeight(border, rowIdx - 1, colIdx, prevCell, pRow, pHRow, actionUpdate, lastCell, manualUpdate);\n                prevCell.style.borderBottom = (border === 'none') ? prevCell.style.borderBottom : border;\n            }\n        }\n        else {\n            cell.style.borderTop = border;\n        }\n    };\n    CellFormat.prototype.setThickBorderHeight = function (border, rowIdx, colIdx, cell, row, hRow, actionUpdate, lastCell, manualUpdate) {\n        var size = border ? this.getBorderSize(border) : 1;\n        var sheet = this.parent.getActiveSheet();\n        if (size > 2 && (!sheet.rows[rowIdx] || !sheet.rows[rowIdx].customHeight)) {\n            if (manualUpdate) {\n                if (!this.checkHeight) {\n                    this.checkHeight = true;\n                }\n                this.updateRowHeight(rowIdx, colIdx, lastCell, actionUpdate);\n            }\n            else {\n                var prevHeight = getRowHeight(sheet, rowIdx);\n                var height = Math.ceil(this.parent.calculateHeight(this.parent.getCellStyleValue(['fontFamily', 'fontSize'], [rowIdx, colIdx]), 1, 3));\n                if (height > prevHeight) {\n                    setRowEleHeight(this.parent, sheet, height, rowIdx, row, hRow, false);\n                    this.parent.notify(rowHeightChanged, { rowIdx: rowIdx, threshold: height - 20 });\n                }\n            }\n        }\n        if (actionUpdate && (lastCell || !this.checkHeight) && size < 3 && (!sheet.rows[rowIdx] || !sheet.rows[rowIdx].customHeight)) {\n            if (!this.checkHeight) {\n                this.checkHeight = true;\n            }\n            this.updateRowHeight(rowIdx, colIdx, lastCell, actionUpdate);\n        }\n    };\n    CellFormat.prototype.getBorderSize = function (border) {\n        var size = border.split(' ')[0];\n        return size === 'thin' ? 1 : (size === 'medium' ? 2 : (size === 'thick' ? 3 :\n            (parseInt(size, 10) ? parseInt(size, 10) : 1)));\n    };\n    CellFormat.prototype.clearObj = function (args) {\n        var options = args.options;\n        var range = options.range ? (options.range.indexOf('!') > 0) ? options.range.split('!')[1] : options.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIndex = (options.range && options.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, options.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var rangeIdx = getRangeIndexes(range);\n        var sheet = this.parent.sheets[sheetIndex];\n        var sRIdx = rangeIdx[0];\n        var eRIdx = rangeIdx[2];\n        var sCIdx;\n        var eCIdx;\n        var eventArgs = { range: range, type: options.type, requestType: 'clear', sheetIndex: sheetIndex };\n        if (!args.isPublic) {\n            this.parent.notify(beginAction, { action: 'beforeClear', eventArgs: eventArgs });\n        }\n        if (options.type === 'Clear Formats' || options.type === 'Clear All') {\n            this.parent.notify(clearCFRule, { range: range, isPublic: false, isclearFormat: true });\n            for (sRIdx; sRIdx <= eRIdx; sRIdx++) {\n                sCIdx = rangeIdx[1];\n                eCIdx = rangeIdx[3];\n                for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n                    var cell = getCell(sRIdx, sCIdx, sheet);\n                    var cellElem = this.parent.getCell(sRIdx, sCIdx);\n                    if (cell) {\n                        if (cell.wrap) {\n                            this.parent.notify(wrapEvent, { range: [sRIdx, sCIdx, sRIdx, sCIdx], wrap: false, sheet: sheet });\n                        }\n                        if (cell.hyperlink) {\n                            removeClass(cellElem.querySelectorAll('.e-hyperlink'), 'e-hyperlink-style');\n                            if (options.type === 'Clear All') {\n                                this.parent.removeHyperlink(getRangeAddress([sRIdx, sCIdx, sRIdx, sCIdx]));\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (options.type === 'Clear Hyperlinks') {\n            this.parent.removeHyperlink(range);\n            return;\n        }\n        this.parent.notify(clear, { range: sheet.name + '!' + range, type: options.type });\n        this.parent.serviceLocator.getService('cell').refreshRange(getRangeIndexes(range));\n        if (!args.isPublic) {\n            eventArgs = { range: sheet.name + '!' + range, type: options.type, sheetIndex: sheetIndex };\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'clear' });\n        }\n        this.parent.notify(addHighlight, { range: range, isclearFormat: true });\n        this.parent.notify(selectRange, { address: range });\n    };\n    CellFormat.prototype.addEventListener = function () {\n        this.parent.on(applyCellFormat, this.applyCellFormat, this);\n        this.parent.on(clearViewer, this.clearObj, this);\n    };\n    CellFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initialLoad, this.addEventListener);\n            this.parent.off(applyCellFormat, this.applyCellFormat);\n            this.parent.off(clearViewer, this.clearObj);\n        }\n    };\n    /**\n     * Destroy cell format module.\n     *\n     * @returns {void} - Destroy cell format module.\n     */\n    CellFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.row = null;\n        this.checkHeight = null;\n    };\n    /**\n     * Get the cell format module name.\n     *\n     * @returns {string} - Get the cell format module name.\n     */\n    CellFormat.prototype.getModuleName = function () {\n        return 'cellformat';\n    };\n    return CellFormat;\n}());\nexport { CellFormat };\n","import { getDPRValue } from '../index';\nimport { closest, EventHandler } from '@syncfusion/ej2-base';\nimport { colWidthChanged, rowHeightChanged, contentLoaded, hideShow, getFilterRange } from '../common/index';\nimport { findMaxValue, setResize, autoFit, completeAction, setAutoFit } from '../common/index';\nimport { setRowHeight, isHiddenRow, getRowHeight, getColumnWidth, setColumn, isHiddenCol } from '../../workbook/base/index';\nimport { getColumn, setRow, getCell } from '../../workbook/base/index';\nimport { getRangeIndexes, getSwapRange, getCellIndexes, setMerge } from '../../workbook/common/index';\n/**\n * The `Resize` module is used to handle the resizing functionalities in Spreadsheet.\n */\nvar Resize = /** @class */ (function () {\n    /**\n     * Constructor for resize module in Spreadsheet.\n     *\n     * @param {Spreadsheet} parent - Constructor for resize module in Spreadsheet.\n     * @private\n     */\n    function Resize(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Resize.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.wireEvents, this);\n        this.parent.on(autoFit, this.autoFit, this);\n        this.parent.on(setAutoFit, this.setAutoFitHandler, this);\n    };\n    Resize.prototype.autoFit = function (args) {\n        var element = args.isRow ? this.parent.getRowHeaderTable() : this.parent.getColHeaderTable().rows[0];\n        for (var i = args.startIndex; i <= args.endIndex; i++) {\n            this.trgtEle = args.isRow ? this.parent.getRow(i, element) :\n                this.parent.getCell(null, i, element);\n            this.setAutofit(i, !args.isRow);\n        }\n    };\n    Resize.prototype.wireEvents = function () {\n        var rowHeader = this.parent.getRowHeaderContent();\n        var colHeader = this.parent.element.getElementsByClassName('e-header-panel')[0];\n        EventHandler.add(colHeader, 'dblclick', this.dblClickHandler, this);\n        EventHandler.add(rowHeader, 'dblclick', this.dblClickHandler, this);\n        EventHandler.add(colHeader, 'mousedown', this.mouseDownHandler, this);\n        EventHandler.add(rowHeader, 'mousedown', this.mouseDownHandler, this);\n        this.wireResizeCursorEvent(rowHeader, colHeader);\n    };\n    Resize.prototype.wireResizeCursorEvent = function (rowHeader, colHeader) {\n        EventHandler.add(rowHeader, 'mousemove', this.setTarget, this);\n        EventHandler.add(colHeader, 'mousemove', this.setTarget, this);\n    };\n    Resize.prototype.unWireResizeCursorEvent = function () {\n        EventHandler.remove(this.parent.getRowHeaderContent(), 'mousemove', this.setTarget);\n        EventHandler.remove(this.parent.element.getElementsByClassName('e-header-panel')[0], 'mousemove', this.setTarget);\n    };\n    Resize.prototype.unwireEvents = function () {\n        EventHandler.remove(this.parent.getColumnHeaderContent(), 'dblclick', this.dblClickHandler);\n        EventHandler.remove(this.parent.getRowHeaderContent(), 'dblclick', this.dblClickHandler);\n        EventHandler.remove(this.parent.getColumnHeaderContent(), 'mousedown', this.mouseDownHandler);\n        EventHandler.remove(this.parent.getRowHeaderContent(), 'mousedown', this.mouseDownHandler);\n        this.unWireResizeCursorEvent();\n    };\n    Resize.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(contentLoaded, this.wireEvents);\n            this.parent.off(autoFit, this.autoFit);\n            this.parent.off(setAutoFit, this.setAutoFitHandler);\n        }\n    };\n    Resize.prototype.mouseMoveHandler = function (e) {\n        var colResizeHandler = this.parent.element.getElementsByClassName('e-colresize-handler')[0];\n        var rowResizeHandler = this.parent.element.getElementsByClassName('e-rowresize-handler')[0];\n        if (colResizeHandler || rowResizeHandler) {\n            this.isMouseMoved = true;\n            if (colResizeHandler) {\n                if (e.x > this.trgtEle.parentElement.firstChild.getBoundingClientRect().left) {\n                    colResizeHandler.style.left = e.clientX -\n                        document.getElementById(this.parent.element.id + '_sheet').getBoundingClientRect().left + 'px';\n                }\n            }\n            else if (rowResizeHandler) {\n                if (e.y >= this.trgtEle.parentElement.parentElement.firstChild.getBoundingClientRect().top) {\n                    rowResizeHandler.style.top = e.clientY -\n                        document.getElementById(this.parent.element.id + '_sheet').getBoundingClientRect().top + 'px';\n                }\n            }\n        }\n    };\n    Resize.prototype.mouseDownHandler = function (e) {\n        if (!closest(e.target, '.e-header-cell')) {\n            return;\n        }\n        this.event = e;\n        this.trgtEle = e.target;\n        if (this.trgtEle.parentElement.classList.contains('e-hide-end') || this.trgtEle.classList.contains('e-hide-end')) {\n            var offsetSize = this.trgtEle.offsetHeight;\n            var offset = e.offsetY;\n            if ((offsetSize >= 10 && offset < 5) || (offsetSize - 2 < 8 && offset < Math.ceil((offset - 2) / 2))) {\n                this.trgtEle.classList.add('e-skip-resize');\n            }\n        }\n        this.updateTarget(e, this.trgtEle);\n        var trgt = this.trgtEle;\n        var className = trgt.classList.contains('e-colresize') ? 'e-colresize-handler' :\n            trgt.classList.contains('e-rowresize') ? 'e-rowresize-handler' : '';\n        this.createResizeHandler(trgt, className);\n        this.unWireResizeCursorEvent();\n        EventHandler.add(this.parent.element, 'mousemove', this.mouseMoveHandler, this);\n        EventHandler.add(document, 'mouseup', this.mouseUpHandler, this);\n    };\n    Resize.prototype.mouseUpHandler = function (e) {\n        var colResizeHandler = this.parent.element.getElementsByClassName('e-colresize-handler')[0];\n        var rowResizeHandler = this.parent.element.getElementsByClassName('e-rowresize-handler')[0];\n        this.resizeOn(e);\n        this.isMouseMoved = null;\n        var resizeHandler = colResizeHandler || rowResizeHandler;\n        if (resizeHandler) {\n            document.getElementById(this.parent.element.id + '_sheet').removeChild(resizeHandler);\n            this.updateCursor();\n        }\n        EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n        EventHandler.remove(this.parent.element, 'mousemove', this.mouseMoveHandler);\n        this.wireResizeCursorEvent(this.parent.getRowHeaderContent(), this.parent.element.getElementsByClassName('e-header-panel')[0]);\n    };\n    Resize.prototype.dblClickHandler = function (e) {\n        if (!closest(e.target, '.e-header-cell')) {\n            return;\n        }\n        this.trgtEle = e.target;\n        this.updateTarget(e, this.trgtEle);\n        if (this.trgtEle.classList.contains('e-colresize')) {\n            var colIndx = parseInt(this.trgtEle.getAttribute('aria-colindex'), 10) - 1;\n            var prevWidth = getColumnWidth(this.parent.getActiveSheet(), colIndx) + \"px\";\n            if (this.trgtEle.classList.contains('e-unhide-column')) {\n                this.showHiddenColumns(colIndx - 1);\n            }\n            else {\n                this.setAutofit(colIndx, true, prevWidth);\n            }\n        }\n        else if (this.trgtEle.classList.contains('e-rowresize')) {\n            var rowIndx = parseInt(this.trgtEle.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            var prevHeight = getRowHeight(this.parent.getActiveSheet(), rowIndx) + \"px\";\n            this.setAutofit(rowIndx, false, prevHeight);\n        }\n    };\n    Resize.prototype.setTarget = function (e) {\n        if (!closest(e.target, '.e-header-cell')) {\n            return;\n        }\n        var trgt = e.target;\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && (!sheet.protectSettings.formatColumns || !sheet.protectSettings.formatRows)) {\n            if (!sheet.protectSettings.formatRows && !sheet.protectSettings.formatColumns) {\n                return;\n            }\n            if (sheet.protectSettings.formatRows) {\n                if (closest(trgt, '.e-colhdr-table')) {\n                    return;\n                }\n            }\n            if (sheet.protectSettings.formatColumns) {\n                if (closest(trgt, '.e-rowhdr-table')) {\n                    return;\n                }\n            }\n        }\n        var newTrgt;\n        var tOffsetV;\n        var eOffsetV;\n        var tClass;\n        if (closest(trgt, '.e-header-row')) {\n            eOffsetV = e.offsetX;\n            tOffsetV = trgt.offsetWidth;\n            tClass = 'e-colresize';\n            var prevSibling = this.getColPrevSibling(trgt);\n            if (prevSibling && !prevSibling.classList.contains('e-select-all-cell')) {\n                newTrgt = prevSibling;\n            }\n            else {\n                if (Number(trgt.getAttribute('aria-colindex')) > 1) {\n                    newTrgt = trgt;\n                }\n            }\n        }\n        else if (closest(trgt, '.e-row')) {\n            eOffsetV = e.offsetY;\n            tOffsetV = trgt.offsetHeight;\n            tClass = 'e-rowresize';\n            var prevSibling = this.getRowPrevSibling(trgt);\n            if (prevSibling) {\n                newTrgt = prevSibling.firstElementChild;\n            }\n            else {\n                if (Number(trgt.parentElement.getAttribute('aria-rowindex')) > 1) {\n                    newTrgt = trgt;\n                }\n            }\n        }\n        if (tOffsetV - 2 < 8 && eOffsetV !== Math.ceil((tOffsetV - 2) / 2)) {\n            if (eOffsetV < Math.ceil((tOffsetV - 2) / 2)) {\n                trgt.classList.add(tClass);\n                newTrgt.classList.add(tClass);\n            }\n            else if (eOffsetV > Math.ceil((tOffsetV - 2) / 2)) {\n                trgt.classList.add(tClass);\n            }\n        }\n        else if (tOffsetV - 5 < eOffsetV && eOffsetV <= tOffsetV && tOffsetV >= 10) {\n            trgt.classList.add(tClass);\n        }\n        else if (eOffsetV < 5 && newTrgt && tOffsetV >= 10) {\n            trgt.classList.add(tClass);\n            newTrgt.classList.add(tClass);\n        }\n        else {\n            var resEle = this.parent.element.getElementsByClassName(tClass);\n            for (var index = 0; index < resEle.length; index++) {\n                resEle[index].classList.remove(tClass);\n            }\n        }\n    };\n    Resize.prototype.getColPrevSibling = function (trgt) {\n        var frozenCol = this.parent.frozenColCount(this.parent.getActiveSheet());\n        return trgt.previousElementSibling || (frozenCol && closest(trgt, '.e-column-header') ?\n            this.parent.getSelectAllContent().querySelector('.e-header-row').lastElementChild : null);\n    };\n    Resize.prototype.getRowPrevSibling = function (trgt) {\n        var frozenRow = this.parent.frozenRowCount(this.parent.getActiveSheet());\n        return trgt.parentElement.previousElementSibling || (frozenRow && closest(trgt, '.e-row-header') ?\n            this.parent.getSelectAllContent().querySelector('tbody').lastElementChild : null);\n    };\n    Resize.prototype.updateTarget = function (e, trgt) {\n        if (closest(trgt, '.e-header-row')) {\n            if ((trgt.offsetWidth < 10 && e.offsetX < Math.ceil((trgt.offsetWidth - 2) / 2)) || (e.offsetX < 5 &&\n                trgt.offsetWidth >= 10) && trgt.classList.contains('e-colresize')) {\n                var sheet = this.parent.getActiveSheet();\n                var prevIdx = Number(this.trgtEle.getAttribute('aria-colindex')) - 2;\n                var prevSibling = this.getColPrevSibling(trgt);\n                if (prevSibling && !isHiddenCol(sheet, prevIdx)) {\n                    this.trgtEle = prevSibling;\n                }\n                else {\n                    if (prevIdx > -1) {\n                        this.trgtEle.classList.add('e-unhide-column');\n                    }\n                }\n            }\n        }\n        else {\n            if ((trgt.offsetHeight < 10 && e.offsetY < Math.ceil((trgt.offsetHeight - 2) / 2)) || (e.offsetY < 5 &&\n                trgt.offsetHeight >= 10) && trgt.classList.contains('e-rowresize')) {\n                var sheet = this.parent.getActiveSheet();\n                var prevIdx = Number(trgt.parentElement.getAttribute('aria-rowindex')) - 2;\n                var prevSibling = this.getRowPrevSibling(trgt);\n                if (prevSibling || isHiddenRow(sheet, prevIdx)) {\n                    if (e.type === 'dblclick' && isHiddenRow(sheet, prevIdx)) {\n                        var selectRange = getSwapRange(getRangeIndexes(sheet.selectedRange));\n                        var eventArgs = void 0;\n                        if (prevIdx <= selectRange[2] && prevIdx > selectRange[0]) {\n                            eventArgs = { startIndex: selectRange[0], endIndex: selectRange[2], hide: false, autoFit: true };\n                        }\n                        else {\n                            eventArgs = { startIndex: prevIdx, endIndex: prevIdx, hide: false, autoFit: true };\n                        }\n                        this.parent.notify(hideShow, eventArgs);\n                    }\n                    else {\n                        if (!isHiddenRow(sheet, prevIdx)) {\n                            this.trgtEle = prevSibling.getElementsByClassName('e-header-cell')[0];\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Resize.prototype.setAutoFitHandler = function (args) {\n        this.setAutofit(args.idx, args.isCol);\n    };\n    Resize.prototype.setAutofit = function (idx, isCol, prevData) {\n        var index = 0;\n        var sheet = this.parent.getActiveSheet();\n        var mainContent = this.parent.getMainContent();\n        var oldValue = isCol ? getColumnWidth(this.parent.getActiveSheet(), idx) + \"px\" :\n            getRowHeight(this.parent.getActiveSheet(), idx) + \"px\";\n        var contentClone = [];\n        var contentTable = mainContent.getElementsByClassName('e-content-table')[0];\n        if (this.parent.getActiveSheet().showHeaders) {\n            var headerTable = isCol ? this.parent.getColHeaderTable() : this.parent.getRowHeaderTable();\n            headerTable.getElementsByTagName('tr');\n        }\n        var isWrap = false;\n        var wrapCount = 0;\n        if (isCol) {\n            var rowLength = sheet.rows.length;\n            for (var rowIdx = 0; rowIdx < rowLength; rowIdx++) {\n                if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[idx]) {\n                    if (getCell(rowIdx, idx, sheet).wrap) {\n                        isWrap = true;\n                        wrapCount++;\n                    }\n                    var td = this.parent.createElement('td', { className: 'e-cell' });\n                    td.textContent = this.parent.getDisplayText(sheet.rows[rowIdx].cells[idx]);\n                    if (sheet.rows[rowIdx].cells[idx].style) {\n                        var style = sheet.rows[rowIdx].cells[idx].style;\n                        if (style.fontFamily) {\n                            td.style.fontFamily = style.fontFamily;\n                        }\n                        if (style.fontSize) {\n                            td.style.fontSize = style.fontSize;\n                        }\n                    }\n                    contentClone[index] = td;\n                    index++;\n                }\n            }\n        }\n        else {\n            var colLength = sheet.rows[idx] && sheet.rows[idx].cells ? sheet.rows[idx].cells.length : 0;\n            for (var colIdx = 0; colIdx < colLength; colIdx++) {\n                if (sheet.rows[idx] && sheet.rows[idx].cells[colIdx]) {\n                    if (getCell(idx, colIdx, sheet).wrap) {\n                        isWrap = true;\n                        wrapCount++;\n                    }\n                    var td = this.parent.createElement('td');\n                    td.textContent = this.parent.getDisplayText(sheet.rows[idx].cells[colIdx]);\n                    if (sheet.rows[idx].cells[colIdx].style) {\n                        var style = sheet.rows[idx].cells[colIdx].style;\n                        if (style.fontFamily) {\n                            td.style.fontFamily = style.fontFamily;\n                        }\n                        if (style.fontSize) {\n                            td.style.fontSize = style.fontSize;\n                        }\n                    }\n                    contentClone[index] = td;\n                    index++;\n                }\n            }\n        }\n        if (wrapCount === 0) {\n            var contentFit = findMaxValue(contentTable, contentClone, isCol, this.parent, prevData, isWrap);\n            if (isCol) {\n                contentFit = this.getFloatingElementWidth(contentFit, idx);\n            }\n            var autofitValue = contentFit === 0 ? parseInt(oldValue, 10) : contentFit;\n            var threshold = parseInt(oldValue, 10) > autofitValue ?\n                -(parseInt(oldValue, 10) - autofitValue) : autofitValue - parseInt(oldValue, 10);\n            if (isCol) {\n                if (idx >= this.parent.viewport.leftIndex && idx <= this.parent.viewport.rightIndex) {\n                    getColumn(sheet, idx).width = autofitValue > 0 ? autofitValue : 0;\n                    this.resizeStart(idx, this.parent.getViewportIndex(idx, true), autofitValue + 'px', isCol, true, prevData);\n                    this.parent.notify(colWidthChanged, { threshold: threshold, colIdx: idx });\n                }\n                else {\n                    var oldWidth = getColumnWidth(sheet, idx);\n                    var threshold_1;\n                    if (autofitValue > 0) {\n                        threshold_1 = -(oldWidth - autofitValue);\n                    }\n                    else {\n                        threshold_1 = -oldWidth;\n                    }\n                    this.parent.notify(colWidthChanged, { threshold: threshold_1, colIdx: idx });\n                    getColumn(sheet, idx).width = autofitValue > 0 ? autofitValue : 0;\n                }\n            }\n            else if (!isCol) {\n                if (idx >= this.parent.viewport.topIndex && idx <= this.parent.viewport.bottomIndex) {\n                    autofitValue = autofitValue > 20 ? autofitValue : 20;\n                    setRowHeight(sheet, idx, autofitValue > 0 ? autofitValue : 0);\n                    setRow(sheet, idx, { customHeight: false });\n                    this.resizeStart(idx, this.parent.getViewportIndex(idx), autofitValue + 'px', isCol, true, prevData);\n                    this.parent.notify(rowHeightChanged, { threshold: threshold, rowIdx: idx });\n                }\n                else {\n                    var oldHeight = getRowHeight(sheet, idx);\n                    var threshold_2;\n                    if (autofitValue > 0) {\n                        threshold_2 = -(oldHeight - autofitValue);\n                    }\n                    else {\n                        threshold_2 = -oldHeight;\n                    }\n                    this.parent.notify(rowHeightChanged, { threshold: threshold_2, rowIdx: idx });\n                    setRowHeight(sheet, idx, autofitValue > 0 ? autofitValue : 0);\n                }\n            }\n        }\n    };\n    Resize.prototype.createResizeHandler = function (trgt, className) {\n        var editor = this.parent.createElement('div', { className: className });\n        var sheet = document.getElementById(this.parent.element.id + '_sheet');\n        if (trgt.classList.contains('e-colresize')) {\n            editor.style.height = this.parent.getMainContent().parentElement.clientHeight + this.parent.getColumnHeaderContent().offsetHeight + 'px';\n            editor.style.left = this.event.clientX - sheet.getBoundingClientRect().left + 'px';\n            editor.style.top = '0px';\n        }\n        else if (trgt.classList.contains('e-rowresize')) {\n            editor.style.width = this.parent.getMainContent().parentElement.clientWidth + 'px';\n            editor.style.left = '0px';\n            editor.style.top = this.event.clientY - sheet.getBoundingClientRect().top + 'px';\n        }\n        sheet.appendChild(editor);\n        this.updateCursor();\n    };\n    Resize.prototype.setColWidth = function (index, viewportIdx, width, curWidth) {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = getDPRValue(width) - curWidth;\n        if (threshold < 0 && curWidth < -(threshold)) {\n            threshold = -curWidth;\n        }\n        if (width > 0) {\n            if (this.isMouseMoved && this.trgtEle.classList.contains('e-unhide-column')) {\n                this.showHiddenColumns(index, width);\n                this.parent.notify(completeAction, {\n                    eventArgs: {\n                        index: index, width: 0 + \"px\", isCol: true, sheetIdx: this.parent.activeSheetIndex, oldWidth: curWidth + \"px\",\n                        hide: false\n                    }, action: 'resize'\n                });\n                return;\n            }\n            this.resizeStart(index, viewportIdx, width + \"px\", true, false, curWidth + \"px\");\n            setColumn(sheet, index, { width: width, customWidth: true });\n            this.parent.notify(colWidthChanged, { threshold: threshold, colIdx: index });\n        }\n        else {\n            if (this.isMouseMoved) {\n                this.parent.hideColumn(index);\n                this.parent.notify(completeAction, {\n                    eventArgs: {\n                        index: index, width: 0 + \"px\", isCol: true, sheetIdx: this.parent.activeSheetIndex, oldWidth: curWidth + \"px\",\n                        hide: true\n                    }, action: 'resize'\n                });\n            }\n        }\n    };\n    Resize.prototype.showHiddenColumns = function (index, width) {\n        var sheet = this.parent.getActiveSheet();\n        var selectedRange = getRangeIndexes(sheet.selectedRange);\n        var startIdx;\n        var endIdx;\n        var colgroup;\n        if (index >= selectedRange[1] && index <= selectedRange[3] && selectedRange[2] === sheet.rowCount - 1 &&\n            getCellIndexes(sheet.activeCell)[0] === getCellIndexes(sheet.topLeftCell)[0]) {\n            startIdx = selectedRange[1];\n            endIdx = selectedRange[3];\n            colgroup = this.parent.getMainContent().querySelector('colgroup');\n        }\n        else {\n            startIdx = endIdx = index;\n        }\n        if (width !== undefined) {\n            for (var i = startIdx; i <= endIdx; i++) {\n                setColumn(sheet, i, { width: width, customWidth: true });\n                if (i >= this.parent.viewport.leftIndex && i <= this.parent.viewport.rightIndex && !isHiddenCol(sheet, i)) {\n                    colgroup.children[this.parent.getViewportIndex(i, true)].style.width = width + \"px\";\n                }\n            }\n        }\n        this.trgtEle.classList.remove('e-unhide-column');\n        this.parent.hideColumn(startIdx, endIdx, false);\n        if (width === undefined) {\n            this.autoFit({ isRow: false, startIndex: startIdx, endIndex: endIdx });\n        }\n    };\n    Resize.prototype.setRowHeight = function (rowIdx, viewportIdx, height, prevData) {\n        var sheet = this.parent.getActiveSheet();\n        var frozenCol = this.parent.frozenColCount(sheet);\n        var eleHeight = parseInt(this.parent.getRow(rowIdx, null, frozenCol).style.height, 10);\n        var rowHeight = height;\n        var threshold = getDPRValue(parseInt(rowHeight, 10)) - eleHeight;\n        if (threshold < 0 && eleHeight < -(threshold)) {\n            threshold = -eleHeight;\n        }\n        this.resizeStart(rowIdx, viewportIdx, rowHeight, false, false, prevData);\n        setRow(sheet, rowIdx, { height: parseInt(rowHeight, 10) > 0 ? parseInt(rowHeight, 10) : 0, customHeight: true });\n        this.parent.notify(rowHeightChanged, { threshold: threshold, rowIdx: rowIdx, isCustomHgt: true });\n    };\n    Resize.prototype.resizeOn = function (e) {\n        var _this = this;\n        var idx;\n        var actualIdx;\n        var sheet = this.parent.getActiveSheet();\n        var activeCell = getRangeIndexes(sheet.activeCell);\n        var CellElem = getCell(activeCell[0], activeCell[1], sheet);\n        if (this.trgtEle.classList.contains('e-rowresize')) {\n            var prevIdx = Number(this.trgtEle.parentElement.getAttribute('aria-rowindex')) - 2;\n            if (this.isMouseMoved && isHiddenRow(sheet, prevIdx) && this.trgtEle.classList.contains('e-skip-resize') &&\n                e.clientY > this.trgtEle.getBoundingClientRect().top) {\n                this.trgtEle.classList.remove('e-skip-resize');\n                var eventArgs = { startIndex: prevIdx, endIndex: prevIdx, hide: false, skipAppend: true };\n                this.parent.notify(hideShow, eventArgs);\n                var rTbody = this.parent.getRowHeaderTable().tBodies[0];\n                var tbody = this.parent.getContentTable().tBodies[0];\n                eventArgs.hdrRow.style.display = 'none';\n                eventArgs.row.style.display = 'none';\n                rTbody.insertBefore(eventArgs.hdrRow, rTbody.children[eventArgs.insertIdx]);\n                tbody.insertBefore(eventArgs.row, tbody.children[eventArgs.insertIdx]);\n                this.trgtEle = eventArgs.hdrRow.firstElementChild;\n                eventArgs.hdrRow.nextElementSibling.classList.remove('e-hide-end');\n                eventArgs.mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n            }\n            else {\n                if (this.trgtEle.classList.contains('e-skip-resize')) {\n                    this.trgtEle.classList.remove('e-skip-resize');\n                    if ((!this.isMouseMoved && isHiddenRow(sheet, prevIdx)) || !this.trgtEle.parentElement.previousElementSibling) {\n                        return;\n                    }\n                    this.trgtEle = this.trgtEle.parentElement.previousElementSibling.getElementsByClassName('e-header-cell')[0];\n                }\n            }\n            actualIdx = idx = parseInt(this.trgtEle.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            idx = this.parent.getViewportIndex(actualIdx);\n            var frozenCol = this.parent.frozenColCount(sheet);\n            var prevData = this.parent.getRow(actualIdx, null, frozenCol).style.height;\n            var rowHeight = e.clientY - this.event.clientY + parseInt(prevData, 10);\n            if (rowHeight <= 0) {\n                this.parent.hideRow(actualIdx);\n                setRow(sheet, actualIdx, { height: 0, customHeight: true });\n                this.parent.notify(completeAction, {\n                    eventArgs: { index: actualIdx, height: '0px', isCol: false, sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData },\n                    action: 'resize'\n                });\n                return;\n            }\n            this.setRowHeight(actualIdx, idx, rowHeight + \"px\", prevData);\n            if (CellElem && CellElem.rowSpan) {\n                var td = this.parent.getCell(activeCell[0], activeCell[1]);\n                this.parent.element.querySelector('.e-active-cell').style.height = td.offsetHeight + 'px';\n            }\n            if (this.trgtEle.parentElement.style.display === 'none') {\n                var sheet_1 = this.parent.getActiveSheet();\n                var selectedRange = getSwapRange(getRangeIndexes(sheet_1.selectedRange));\n                if (actualIdx <= selectedRange[2] && actualIdx > selectedRange[0]) {\n                    rowHeight = getRowHeight(sheet_1, actualIdx);\n                    var count = void 0;\n                    for (var i = selectedRange[0]; i <= selectedRange[2]; i++) {\n                        if (i === actualIdx) {\n                            continue;\n                        }\n                        prevData = getRowHeight(sheet_1, i) + \"px\";\n                        setRow(sheet_1, i, { customHeight: true, height: rowHeight });\n                        if (isHiddenRow(sheet_1, i)) {\n                            if (!count) {\n                                count = i;\n                            }\n                        }\n                        else {\n                            this.parent.getRow(i).style.height = rowHeight + \"px\";\n                            if (sheet_1.showHeaders) {\n                                this.parent.getRow(i, this.parent.getRowHeaderTable()).style.height = rowHeight + \"px\";\n                            }\n                        }\n                        this.parent.notify(completeAction, {\n                            eventArgs: {\n                                index: i, height: rowHeight + \"px\", isCol: false,\n                                sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData\n                            },\n                            action: 'resize'\n                        });\n                    }\n                    this.parent.hideRow(selectedRange[0], actualIdx - 1, false);\n                    idx += Math.abs(actualIdx - count);\n                }\n                else {\n                    if (idx !== 0 && !isHiddenRow(sheet_1, actualIdx - 1)) {\n                        this.trgtEle.parentElement.previousElementSibling.classList.remove('e-hide-start');\n                    }\n                    else {\n                        if (idx !== 0) {\n                            this.trgtEle.parentElement.classList.add('e-hide-end');\n                        }\n                    }\n                    this.parent.selectRange(sheet_1.selectedRange);\n                }\n                this.trgtEle.parentElement.style.display = '';\n                this.parent.getContentTable().rows[idx].style.display = '';\n            }\n        }\n        else if (this.trgtEle.classList.contains('e-colresize')) {\n            if (this.isMouseMoved && this.trgtEle.classList.contains('e-unhide-column') &&\n                e.clientX < this.trgtEle.getBoundingClientRect().left) {\n                this.trgtEle.classList.remove('e-unhide-column');\n                if (this.trgtEle.previousElementSibling) {\n                    this.trgtEle = this.trgtEle.previousElementSibling;\n                }\n            }\n            idx = parseInt(this.trgtEle.getAttribute('aria-colindex'), 10) - 1;\n            var curWidth = void 0;\n            if (this.trgtEle.classList.contains('e-unhide-column')) {\n                idx -= 1;\n                curWidth = 0;\n            }\n            else {\n                curWidth = getColumnWidth(this.parent.getActiveSheet(), idx);\n            }\n            this.setColWidth(idx, this.parent.getViewportIndex(idx, true), (e.clientX - this.event.clientX) + curWidth, curWidth);\n            if (CellElem && CellElem.colSpan) {\n                var td = this.parent.getCell(activeCell[0], activeCell[1]);\n                this.parent.element.querySelector('.e-active-cell').style.width = td.offsetWidth + 'px';\n            }\n        }\n    };\n    Resize.prototype.resizeStart = function (idx, viewportIdx, value, isCol, isFit, prevData) {\n        setResize(idx, viewportIdx, value, isCol, this.parent);\n        var action = isFit ? 'resizeToFit' : 'resize';\n        var eventArgs;\n        var isAction;\n        if (isCol) {\n            eventArgs = { index: idx, width: value, isCol: isCol, sheetIdx: this.parent.activeSheetIndex, oldWidth: prevData };\n            isAction = prevData !== value;\n        }\n        else {\n            eventArgs = { index: idx, height: value, isCol: isCol, sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData };\n            isAction = prevData !== value;\n        }\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: action });\n        }\n    };\n    Resize.prototype.updateCursor = function () {\n        if (this.parent.element.getElementsByClassName('e-colresize-handler')[0]) {\n            this.parent.element.classList.add('e-col-resizing');\n        }\n        else if (this.parent.element.classList.contains('e-col-resizing')) {\n            this.parent.element.classList.remove('e-col-resizing');\n        }\n        if (this.parent.element.getElementsByClassName('e-rowresize-handler')[0]) {\n            this.parent.element.classList.add('e-row-resizing');\n        }\n        else if (this.parent.element.classList.contains('e-row-resizing')) {\n            this.parent.element.classList.remove('e-row-resizing');\n        }\n    };\n    // To get the floating element width like filter\n    Resize.prototype.getFloatingElementWidth = function (oldWidth, colIdx) {\n        var floatingWidth = oldWidth;\n        var eventArgs = { filterRange: [], hasFilter: false };\n        this.parent.notify(getFilterRange, eventArgs);\n        if (eventArgs.hasFilter && eventArgs.filterRange) {\n            if (eventArgs.filterRange[1] <= colIdx && eventArgs.filterRange[3] >= colIdx) {\n                floatingWidth = oldWidth + 22; // default width and padding for button\n            }\n        }\n        return floatingWidth;\n    };\n    /**\n     * To destroy the resize module.\n     *\n     * @returns {void} - To destroy the resize module.\n     */\n    Resize.prototype.destroy = function () {\n        this.unwireEvents();\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the module name.\n     *\n     * @returns {string} - Get the module name.\n     */\n    Resize.prototype.getModuleName = function () {\n        return 'resize';\n    };\n    return Resize;\n}());\nexport { Resize };\n","import { collaborativeUpdate, updateAction } from '../common/index';\n/**\n * Collaborative Editing module for real time changes in the Spreadsheet.\n */\nvar CollaborativeEditing = /** @class */ (function () {\n    function CollaborativeEditing(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    CollaborativeEditing.prototype.refreshClients = function (options) {\n        updateAction(options, this.parent);\n    };\n    CollaborativeEditing.prototype.addEventListener = function () {\n        this.parent.on(collaborativeUpdate, this.refreshClients, this);\n    };\n    CollaborativeEditing.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(collaborativeUpdate, this.refreshClients);\n        }\n    };\n    /**\n     * Destroy collaborative editing module.\n     *\n     * @returns {void} - Destroy collaborative editing module.\n     */\n    CollaborativeEditing.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the collaborative editing module name.\n     *\n     * @returns {string} - Get the collaborative editing module name.\n     */\n    CollaborativeEditing.prototype.getModuleName = function () {\n        return 'collaborativeEditing';\n    };\n    return CollaborativeEditing;\n}());\nexport { CollaborativeEditing };\n","import { spreadsheetDestroyed, getUpdateUsingRaf } from '../common/index';\nimport { autoFit, hideShow, virtualContentLoaded, completeAction, setScrollEvent, onContentScroll, skipHiddenIdx } from '../common/index';\nimport { beginAction, hiddenMerge, updateTableWidth } from '../common/index';\nimport { getCellAddress, isHiddenRow, setRow, setColumn, isHiddenCol, getRangeAddress, getCell } from '../../workbook/index';\nimport { getCellIndexes, getColumnWidth, applyCellFormat, refreshChart } from '../../workbook/index';\nimport { activeCellMergedRange, setMerge } from '../../workbook/index';\nimport { detach } from '@syncfusion/ej2-base';\n/**\n * The `ShowHide` module is used to perform hide/show the rows and columns.\n *\n * @hidden\n */\nvar ShowHide = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet show hide module.\n     *\n     * @param {Spreadsheet} parent - Specify the spreadsheet instance.\n     * @private\n     */\n    function ShowHide(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    ShowHide.prototype.hideShow = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.frozenRows || sheet.frozenColumns) {\n            return;\n        }\n        if (args.startIndex > args.endIndex) {\n            var temp = args.startIndex;\n            args.startIndex = args.endIndex;\n            args.endIndex = temp;\n        }\n        if (args.actionUpdate) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'hideShow' });\n        }\n        if (args.isCol) {\n            this.hideCol(args);\n        }\n        else {\n            this.hideRow(args);\n        }\n        if (args.actionUpdate) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'hideShow' });\n        }\n    };\n    ShowHide.prototype.hideRow = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var count = 0;\n        var idx;\n        var nextIdx;\n        var merge;\n        if (args.hide) {\n            var content = void 0;\n            var rowHdr = void 0;\n            var row = void 0;\n            for (var i = args.startIndex; i <= args.endIndex; i++) {\n                if (isHiddenRow(sheet, i)) {\n                    continue;\n                }\n                if (idx === undefined) {\n                    if (sheet.showHeaders) {\n                        rowHdr = this.parent.getRowHeaderTable();\n                    }\n                    content = this.parent.getContentTable();\n                    idx = this.parent.getViewportIndex(i);\n                    count = 0;\n                }\n                setRow(sheet, i, { hidden: true });\n                this.refreshChart(i, 'rows');\n                row = content && content.rows[idx];\n                if (row) {\n                    if (!merge) {\n                        for (var j = 0; j <= sheet.usedRange.colIndex; j++) {\n                            cell = getCell(i, j, sheet) || {};\n                            if ((cell.colSpan || cell.rowSpan) && (args.startIndex >= this.parent.viewport.topIndex ||\n                                this.parent.scrollSettings.enableVirtualization)) {\n                                merge = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (merge) {\n                        continue;\n                    }\n                    if (sheet.showHeaders) {\n                        detach(rowHdr.rows[idx]);\n                    }\n                    detach(row);\n                    count++;\n                    row = content.rows[idx];\n                    if (row && i === args.endIndex) {\n                        var cell_1 = void 0;\n                        nextIdx = skipHiddenIdx(sheet, i + 1, true);\n                        var first = nextIdx !== skipHiddenIdx(sheet, 0, true) && nextIdx ===\n                            (this.parent.viewport.topIndex >= args.startIndex ? args.endIndex + 1 : this.parent.viewport.topIndex) ? 'Row' : '';\n                        for (var j = this.parent.viewport.leftIndex; j <= this.parent.viewport.rightIndex; j++) {\n                            var borderTop = this.parent.getCellStyleValue(['borderTop'], [nextIdx, j]).borderTop;\n                            if (borderTop !== '') {\n                                cell_1 = row.cells[j];\n                                this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: nextIdx, colIdx: j,\n                                    style: { borderTop: borderTop }, row: row, pRow: row.previousElementSibling,\n                                    first: first, cell: cell_1 });\n                            }\n                        }\n                    }\n                }\n                else {\n                    if (i <= this.parent.viewport.bottomIndex) {\n                        count++;\n                    }\n                    else {\n                        count--;\n                    }\n                }\n            }\n            if (merge && (args.startIndex >= this.parent.viewport.topIndex || !this.parent.scrollSettings.enableVirtualization)) {\n                this.parent.selectRange(sheet.selectedRange);\n                this.parent.renderModule.refreshUI({\n                    rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                });\n                return;\n            }\n            if (!count) {\n                return;\n            }\n            this.parent.selectRange(sheet.selectedRange);\n            if (this.parent.scrollSettings.enableVirtualization) {\n                var startIndex = args.startIndex;\n                var endIndex = args.startIndex;\n                if (this.parent.viewport.topIndex >= args.startIndex) {\n                    this.parent.viewport.topIndex = args.endIndex + 1;\n                }\n                args.startIndex = this.parent.viewport.bottomIndex + 1;\n                args.endIndex = args.startIndex + count - 1;\n                var indexes = this.parent.skipHidden(args.startIndex, args.endIndex);\n                args.startIndex = indexes[0];\n                args.endIndex = indexes[1];\n                this.parent.viewport.bottomIndex = args.endIndex;\n                if (count > this.parent.viewport.rowCount + (this.parent.getThreshold('row') * 2)) {\n                    startIndex = startIndex < 1 ? endIndex + 1 : startIndex - 1;\n                    this.parent.updateTopLeftCell(startIndex, null);\n                    this.parent.renderModule.refreshSheet();\n                }\n                else {\n                    this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, direction: '', refresh: 'RowPart' }, getCellAddress(args.startIndex, this.parent.viewport.leftIndex) + \":\" + getCellAddress(args.endIndex, this.parent.viewport.leftIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2)));\n                }\n            }\n            if (sheet.showHeaders) {\n                if (idx === 0) {\n                    if (rowHdr.rows[0]) {\n                        rowHdr.rows[0].classList.add('e-hide-end');\n                    }\n                }\n                else {\n                    if (rowHdr && rowHdr.rows[idx - 1]) {\n                        rowHdr.rows[idx - 1].classList.add('e-hide-start');\n                    }\n                    if (rowHdr && rowHdr.rows[idx]) {\n                        rowHdr.rows[idx].classList.add('e-hide-end');\n                    }\n                }\n            }\n        }\n        else {\n            var hFrag = void 0;\n            var frag = void 0;\n            var hRow = void 0;\n            var row = void 0;\n            var rowRenderer = void 0;\n            var rTBody = void 0;\n            var tBody = void 0;\n            var startRow = void 0;\n            var endRow = args.startIndex - 1;\n            var newStartRow = void 0;\n            var mergeCollection = [];\n            for (var i = args.startIndex, len = args.endIndex; i <= len; i++) {\n                if (!isHiddenRow(sheet, i)) {\n                    if (args.startIndex === args.endIndex) {\n                        return;\n                    }\n                    if (idx === undefined) {\n                        endRow++;\n                    }\n                    else {\n                        newStartRow = i;\n                    }\n                    continue;\n                }\n                if (newStartRow !== undefined) {\n                    len = i;\n                    continue;\n                }\n                if (i > this.parent.viewport.bottomIndex) {\n                    setRow(sheet, i, { hidden: false });\n                    if (startRow === undefined) {\n                        return;\n                    }\n                    continue;\n                }\n                if (startRow === undefined) {\n                    startRow = i;\n                }\n                setRow(sheet, i, { hidden: false });\n                this.refreshChart(i, 'rows');\n                if (idx === undefined) {\n                    hFrag = document.createDocumentFragment();\n                    frag = document.createDocumentFragment();\n                    rowRenderer = this.parent.serviceLocator.getService('row');\n                    if (sheet.showHeaders && this.parent.getRowHeaderTable()) {\n                        rTBody = this.parent.getRowHeaderTable().tBodies[0];\n                    }\n                    tBody = this.parent.getContentTable() ? this.parent.getContentTable().tBodies[0] : this.parent.getContentTable();\n                    if (i < this.parent.viewport.topIndex) {\n                        this.parent.viewport.topIndex = i;\n                    }\n                    if (i === 0) {\n                        idx = 0;\n                    }\n                    else {\n                        idx = this.parent.getViewportIndex(i);\n                    }\n                }\n                endRow++;\n                if (sheet.showHeaders) {\n                    hRow = rowRenderer.refresh(i, null, null, true);\n                    hFrag.appendChild(hRow);\n                    if (rTBody && rTBody.childElementCount) {\n                        detach(rTBody.lastElementChild);\n                    }\n                }\n                row = frag.appendChild(rowRenderer.refresh(i, row, hRow));\n                if (tBody && tBody.childElementCount) {\n                    detach(tBody.lastElementChild);\n                }\n                for (var j = this.parent.viewport.leftIndex; j <= this.parent.viewport.rightIndex; j++) {\n                    cell = getCell(i, j, sheet) || {};\n                    if (cell.rowSpan !== undefined) {\n                        var mergeArgs = { range: [i, j, i, j], isAction: false, merge: true,\n                            type: 'All', skipChecking: true };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        if (!mergeCollection.length || mergeArgs.range[1] !== mergeCollection[mergeCollection.length - 1].range[1]) {\n                            mergeCollection.push(mergeArgs);\n                        }\n                    }\n                }\n            }\n            this.parent.viewport.bottomIndex = this.parent.viewport.topIndex + this.parent.viewport.rowCount +\n                (this.parent.getThreshold('row') * 2);\n            count = this.parent.hiddenCount(this.parent.viewport.topIndex, args.startIndex) +\n                this.parent.hiddenCount(args.endIndex + 1, this.parent.viewport.bottomIndex);\n            this.parent.viewport.bottomIndex += count;\n            args.insertIdx = idx;\n            args.row = frag.querySelector('.e-row');\n            args.mergeCollection = mergeCollection;\n            if (sheet.showHeaders) {\n                args.hdrRow = hFrag.querySelector('.e-row');\n                if (idx !== 0 && !isHiddenRow(sheet, endRow - 1) && rTBody.children[idx - 1]) {\n                    rTBody.children[idx - 1].classList.remove('e-hide-start');\n                }\n                if (args.startIndex !== 0 && isHiddenRow(sheet, args.startIndex - 1)) {\n                    args.hdrRow.classList.add('e-hide-end');\n                }\n                if (isHiddenRow(sheet, endRow + 1)) {\n                    hFrag.lastElementChild.classList.add('e-hide-start');\n                }\n                else {\n                    if (rTBody.children[idx]) {\n                        rTBody.children[idx].classList.remove('e-hide-end');\n                    }\n                }\n            }\n            if (row && tBody && tBody.children[idx]) {\n                nextIdx = skipHiddenIdx(sheet, endRow + 1, true);\n                for (var i = this.parent.viewport.leftIndex; i <= this.parent.viewport.rightIndex; i++) {\n                    var borderTop = this.parent.getCellStyleValue(['borderTop'], [nextIdx, i]).borderTop;\n                    if (borderTop !== '') {\n                        this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: nextIdx, colIdx: i,\n                            style: { borderTop: borderTop }, pRow: row, cell: tBody.children[idx].children[i],\n                            first: '' });\n                        var prevIdx = skipHiddenIdx(sheet, startRow - 1, false);\n                        if (prevIdx > -1) {\n                            if (tBody.children[idx - 1] && !this.parent.getCellStyleValue(['borderBottom'], [prevIdx, i]).borderBottom &&\n                                !this.parent.getCellStyleValue(['borderTop'], [startRow, i]).borderTop) {\n                                tBody.children[idx - 1].children[i].style.borderBottom = '';\n                            }\n                        }\n                        else {\n                            tBody.children[idx].children[i].style.borderTop = '';\n                        }\n                    }\n                }\n            }\n            if (args.skipAppend) {\n                return;\n            }\n            if (Math.abs(endRow - startRow) > this.parent.viewport.rowCount + (this.parent.getThreshold('row') * 2)) {\n                this.parent.renderModule.refreshSheet();\n            }\n            else {\n                if (sheet.showHeaders && rTBody) {\n                    rTBody.insertBefore(hFrag, rTBody.children[idx]);\n                }\n                if (tBody) {\n                    tBody.insertBefore(frag, tBody.children[idx]);\n                }\n                this.parent.selectRange(sheet.selectedRange);\n                if (args.autoFit && sheet.showHeaders) {\n                    this.parent.notify(autoFit, { startIndex: args.startIndex, endIndex: args.endIndex, isRow: true });\n                }\n                mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n                if (newStartRow !== undefined && newStartRow !== args.endIndex) {\n                    args.startIndex = newStartRow;\n                    this.hideRow(args);\n                }\n            }\n        }\n    };\n    ShowHide.prototype.hideCol = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var hiddenIndex = [];\n        var beforeViewportIdx = [];\n        var topLeftCell = getCellIndexes(sheet.topLeftCell);\n        var scrollable;\n        for (var i = args.startIndex; i <= args.endIndex; i++) {\n            if (args.hide ? isHiddenCol(sheet, i) : !isHiddenCol(sheet, i)) {\n                continue;\n            }\n            setColumn(sheet, i, { hidden: args.hide });\n            this.refreshChart(i, 'columns');\n            if (this.parent.scrollSettings.enableVirtualization && (i < this.parent.viewport.leftIndex ||\n                i > this.parent.viewport.rightIndex)) {\n                if (i < this.parent.viewport.leftIndex) {\n                    beforeViewportIdx.push(i);\n                }\n                continue;\n            }\n            hiddenIndex.push(i);\n            if (args.hide && topLeftCell[1] === i) {\n                scrollable = true;\n            }\n        }\n        if (!beforeViewportIdx.length && !hiddenIndex.length) {\n            return;\n        }\n        if (args.hide) {\n            if (!hiddenIndex.length) {\n                return;\n            }\n            if (hiddenIndex.length <= this.parent.getThreshold('col') || !this.parent.scrollSettings.enableVirtualization) {\n                this.removeCell(sheet, hiddenIndex);\n            }\n            if (this.parent.scrollSettings.enableVirtualization) {\n                if (hiddenIndex[0] === this.parent.viewport.leftIndex) {\n                    this.parent.viewport.leftIndex = skipHiddenIdx(sheet, hiddenIndex[hiddenIndex.length - 1] + 1, true, 'columns');\n                }\n                if (scrollable) {\n                    var scrollWidth_1 = 0;\n                    hiddenIndex.slice(0, hiddenIndex.indexOf(topLeftCell[1])).forEach(function (colIdx) {\n                        scrollWidth_1 += getColumnWidth(sheet, colIdx, true);\n                    });\n                    if (scrollWidth_1) {\n                        this.parent.notify(setScrollEvent, { set: false });\n                        var content = this.parent.getMainContent();\n                        content.scrollLeft -= scrollWidth_1;\n                        this.parent.notify(onContentScroll, { scrollLeft: content.scrollLeft, preventScroll: true, skipHidden: true });\n                        getUpdateUsingRaf(function () { return _this.parent.notify(setScrollEvent, { set: true }); });\n                    }\n                }\n                if (this.parent.scrollSettings.isFinite) {\n                    var colCount = skipHiddenIdx(sheet, sheet.colCount - 1, false, 'columns');\n                    var startIdx = this.parent.viewport.leftIndex;\n                    var endIndex = this.parent.viewport.rightIndex;\n                    if (endIndex + hiddenIndex.length >= colCount) {\n                        var index = skipHiddenIdx(sheet, startIdx - ((endIndex + hiddenIndex.length) - colCount), false, 'columns');\n                        if (index > -1) {\n                            this.parent.viewport.leftIndex = index;\n                            this.parent.viewport.leftIndex -= this.parent.hiddenCount(endIndex, colCount);\n                        }\n                        this.parent.viewport.rightIndex = colCount;\n                        if (startIdx !== this.parent.viewport.leftIndex || endIndex !== this.parent.viewport.rightIndex) {\n                            this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column' });\n                        }\n                        else {\n                            this.parent.notify(updateTableWidth, { refresh: 'Column', isUpdate: true });\n                        }\n                        this.parent.selectRange(sheet.selectedRange);\n                        return;\n                    }\n                }\n                if (hiddenIndex.length <= this.parent.getThreshold('col')) {\n                    var indexes = this.parent.skipHidden(this.parent.viewport.rightIndex + 1, this.parent.viewport.rightIndex + hiddenIndex.length, 'columns');\n                    this.parent.viewport.rightIndex = indexes[1];\n                    this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: indexes[0], direction: '', refresh: 'ColumnPart' }, \"\" + getRangeAddress([this.parent.viewport.topIndex, indexes[0], this.parent.viewport.bottomIndex, indexes[1]]));\n                }\n                else {\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex,\n                        refresh: 'Column' });\n                }\n            }\n            this.parent.selectRange(sheet.selectedRange);\n        }\n        else {\n            if (beforeViewportIdx.length) {\n                beforeViewportIdx.sort(function (i, j) { return i - j; });\n                if (this.parent.scrollSettings.enableVirtualization && beforeViewportIdx[0] < this.parent.getThreshold('col')) {\n                    var rowIdx = getCellIndexes(sheet.topLeftCell)[0] + 1;\n                    this.parent.setSheetPropertyOnMute(sheet, 'topLeftCell', \"A\" + rowIdx);\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, rowIndex: this.parent.viewport.topIndex, colIndex: 0,\n                        refresh: 'Column' });\n                    this.parent.selectRange(sheet.selectedRange);\n                }\n                else {\n                    this.parent.goTo(getCellAddress(this.parent.viewport.topIndex, beforeViewportIdx[0]));\n                }\n                return;\n            }\n            if (hiddenIndex.length <= this.parent.getThreshold('col') || !this.parent.scrollSettings.enableVirtualization) {\n                this.appendCell(sheet, hiddenIndex);\n                if (this.parent.scrollSettings.enableVirtualization) {\n                    this.parent.notify(virtualContentLoaded, { refresh: 'Column',\n                        prevRowColCnt: { rowCount: sheet.rowCount, colCount: sheet.colCount } });\n                }\n            }\n            else {\n                this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex,\n                    refresh: 'Column' });\n            }\n            this.parent.selectRange(sheet.selectedRange);\n        }\n    };\n    ShowHide.prototype.removeCell = function (sheet, indexes) {\n        var _this = this;\n        var startIdx;\n        var endIdx;\n        var hRow;\n        var row;\n        var hColgrp;\n        var rowIdx = 0;\n        var cellIdx = this.parent.getViewportIndex(indexes[0], true) + 1;\n        var cell;\n        if (this.parent.scrollSettings.enableVirtualization) {\n            startIdx = this.parent.viewport.topIndex;\n            endIdx = this.parent.viewport.bottomIndex;\n        }\n        else {\n            startIdx = 0;\n            endIdx = sheet.rowCount - 1;\n        }\n        var table = this.parent.getContentTable();\n        var nextIdx;\n        var colgrp = table.getElementsByTagName('colgroup')[0];\n        if (sheet.showHeaders) {\n            var hTable = this.parent.getColHeaderTable();\n            hColgrp = hTable.getElementsByTagName('colgroup')[0];\n            hRow = hTable.rows[0];\n        }\n        var modelLen = indexes.length - 1;\n        while (startIdx <= endIdx) {\n            if (isHiddenRow(sheet, startIdx)) {\n                startIdx++;\n                continue;\n            }\n            row = table.rows[rowIdx];\n            indexes.forEach(function (idx, index) {\n                detach(row.cells[cellIdx]);\n                if (rowIdx === 0) {\n                    if (sheet.showHeaders) {\n                        detach(hRow.cells[cellIdx]);\n                        detach(hColgrp.children[cellIdx]);\n                    }\n                    detach(colgrp.children[cellIdx]);\n                }\n                if (index === 0) {\n                    cell = getCell(startIdx, idx, sheet) || {};\n                    if (cell.colSpan !== undefined && (cell.rowSpan === undefined || cell.colSpan > 1)) {\n                        _this.parent.notify(hiddenMerge, { rowIdx: startIdx, colIdx: idx, model: 'col',\n                            start: indexes[0], end: indexes[modelLen] });\n                    }\n                }\n                if (index === modelLen) {\n                    nextIdx = skipHiddenIdx(sheet, idx + 1, true, 'columns');\n                    var borderLeft = _this.parent.getCellStyleValue(['borderLeft'], [rowIdx, nextIdx]).borderLeft;\n                    if (borderLeft !== '') {\n                        _this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: rowIdx, colIdx: nextIdx,\n                            style: { borderLeft: borderLeft }, row: row, first: '' });\n                    }\n                    cell = getCell(startIdx, idx, sheet) || {};\n                    if (cell.colSpan !== undefined && (cell.rowSpan === undefined || cell.colSpan > 1)) {\n                        _this.parent.notify(hiddenMerge, { rowIdx: startIdx, colIdx: idx, model: 'col',\n                            start: indexes[0], end: indexes[modelLen], isEnd: true });\n                    }\n                }\n            });\n            startIdx++;\n            rowIdx++;\n        }\n        if (cellIdx - 1 > -1) {\n            if (sheet.showHeaders && hRow.cells[cellIdx - 1]) {\n                hRow.cells[cellIdx - 1].classList.add('e-hide-start');\n            }\n        }\n        if (sheet.showHeaders && hRow.cells[cellIdx]) {\n            hRow.cells[cellIdx].classList.add('e-hide-end');\n        }\n    };\n    ShowHide.prototype.appendCell = function (sheet, indexes) {\n        var _this = this;\n        var startIdx;\n        var endIdx;\n        var hRow;\n        var row;\n        var hColgrp;\n        var rowIdx = 0;\n        var prevIdx;\n        if (this.parent.scrollSettings.enableVirtualization) {\n            startIdx = this.parent.viewport.topIndex;\n            endIdx = this.parent.viewport.bottomIndex;\n        }\n        else {\n            startIdx = 0;\n            endIdx = sheet.rowCount - 1;\n        }\n        var table = this.parent.getContentTable();\n        var hTable = this.parent.getColHeaderTable();\n        var colgrp = table.getElementsByTagName('colgroup')[0];\n        if (sheet.showHeaders) {\n            hColgrp = hTable.getElementsByTagName('colgroup')[0];\n            hRow = hTable.rows[0];\n        }\n        var cellRenderer = this.parent.serviceLocator.getService('cell');\n        indexes.sort(function (i, j) { return i - j; });\n        var cellModel;\n        var mergeCollection = [];\n        var cellIdx = [];\n        var cell;\n        var refCell;\n        var modelLen = indexes.length - 1;\n        while (startIdx <= endIdx) {\n            if (isHiddenRow(sheet, startIdx)) {\n                startIdx++;\n                continue;\n            }\n            row = table.rows[rowIdx];\n            indexes.forEach(function (idx, index) {\n                if (rowIdx === 0) {\n                    cellIdx[index] = _this.parent.getViewportIndex(idx, true);\n                    if (colgrp.children[cellIdx[index]]) {\n                        colgrp.insertBefore(_this.parent.sheetModule.updateCol(sheet, idx), colgrp.children[cellIdx[index]]);\n                        if (sheet.showHeaders) {\n                            refCell = hRow.cells[cellIdx[index]];\n                            if (index === 0 && indexes[index] && !isHiddenCol(sheet, indexes[index] - 1)) {\n                                refCell.previousElementSibling.classList.remove('e-hide-start');\n                            }\n                            hRow.insertBefore(cellRenderer.renderColHeader(idx), refCell);\n                            if (index === modelLen) {\n                                refCell.classList.remove('e-hide-end');\n                            }\n                        }\n                    }\n                    else {\n                        colgrp.appendChild(_this.parent.sheetModule.updateCol(sheet, idx));\n                        if (sheet.showHeaders) {\n                            hRow.appendChild(cellRenderer.renderColHeader(idx));\n                        }\n                    }\n                    detach(colgrp.lastChild);\n                    if (sheet.showHeaders) {\n                        detach(hRow.lastChild);\n                        if (index === modelLen) {\n                            detach(hColgrp);\n                            hTable.insertBefore(colgrp.cloneNode(true), hTable.tHead[0]);\n                        }\n                    }\n                }\n                detach(row.lastChild);\n                refCell = row.cells[cellIdx[index]];\n                cell = cellRenderer.render({ rowIdx: startIdx, colIdx: idx, cell: getCell(startIdx, idx, sheet),\n                    address: getCellAddress(startIdx, idx), lastCell: idx === modelLen, isHeightCheckNeeded: true,\n                    first: idx !== skipHiddenIdx(sheet, 0, true, 'columns') && idx === _this.parent.viewport.leftIndex ? 'Column' : '',\n                    checkNextBorder: index === modelLen ? 'Column' : '' });\n                if (refCell) {\n                    row.insertBefore(cell, refCell);\n                }\n                else {\n                    row.appendChild(cell);\n                }\n                if (index === 0 && cell.previousSibling) {\n                    var borderLeft = _this.parent.getCellStyleValue(['borderLeft'], [rowIdx, skipHiddenIdx(sheet, indexes[indexes.length - 1] + 1, true, 'columns')]).borderLeft;\n                    if (borderLeft !== '') {\n                        prevIdx = skipHiddenIdx(sheet, indexes[0] - 1, false, 'columns');\n                        if (prevIdx > -1 && !_this.parent.getCellStyleValue(['borderRight'], [rowIdx, prevIdx]).borderRight &&\n                            !_this.parent.getCellStyleValue(['borderLeft'], [rowIdx, indexes[0]]).borderLeft) {\n                            cell.previousSibling.style.borderRight = '';\n                        }\n                    }\n                }\n                cellModel = getCell(rowIdx, idx, sheet) || {};\n                if (cellModel.colSpan !== undefined && (cellModel.rowSpan === undefined || cellModel.colSpan > 1)) {\n                    var mergeArgs = { range: [rowIdx, idx, rowIdx, idx], isAction: false, merge: true,\n                        type: 'All', skipChecking: true };\n                    _this.parent.notify(activeCellMergedRange, mergeArgs);\n                    if (!mergeCollection.length || mergeArgs.range[1] !== mergeCollection[mergeCollection.length - 1].range[1]) {\n                        mergeCollection.push(mergeArgs);\n                    }\n                }\n            });\n            startIdx++;\n            rowIdx++;\n        }\n        mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n        this.parent.viewport.rightIndex = skipHiddenIdx(sheet, this.parent.viewport.rightIndex - indexes.length, false, 'columns');\n    };\n    ShowHide.prototype.refreshChart = function (index, showHide) {\n        this.parent.notify(refreshChart, { rIdx: index, showHide: showHide });\n    };\n    ShowHide.prototype.addEventListener = function () {\n        this.parent.on(hideShow, this.hideShow, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    ShowHide.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    ShowHide.prototype.removeEventListener = function () {\n        this.parent.off(hideShow, this.hideShow);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return ShowHide;\n}());\nexport { ShowHide };\n","import { initiateHyperlink, locale, dialog, click, keyUp, createHyperlinkElement, getUpdateUsingRaf, focus } from '../common/index';\nimport { editHyperlink, openHyperlink, editAlert } from '../common/index';\nimport { isNullOrUndefined, closest } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getCellIndexes, getRangeAddress } from '../../workbook/common/address';\nimport { getTypeFromFormat, getCell } from '../../workbook/index';\nimport { beforeHyperlinkClick, afterHyperlinkClick, refreshRibbonIcons, deleteHyperlink } from '../../workbook/common/event';\nimport { isCellReference } from '../../workbook/index';\nimport { Tab, TreeView } from '@syncfusion/ej2-navigations';\n/**\n * `Hyperlink` module\n */\nvar SpreadsheetHyperlink = /** @class */ (function () {\n    /**\n     * Constructor for Hyperlink module.\n     *\n     * @param {Spreadsheet} parent - Constructor for Hyperlink module.\n     */\n    function SpreadsheetHyperlink(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Hyperlink module.\n     *\n     * @returns {void} - To destroy the Hyperlink module.\n     */\n    SpreadsheetHyperlink.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    SpreadsheetHyperlink.prototype.addEventListener = function () {\n        this.parent.on(initiateHyperlink, this.initiateHyperlinkHandler, this);\n        this.parent.on(editHyperlink, this.editHyperlinkHandler, this);\n        this.parent.on(openHyperlink, this.openHyperlinkHandler, this);\n        this.parent.on(click, this.hyperlinkClickHandler, this);\n        this.parent.on(createHyperlinkElement, this.createHyperlinkElementHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(deleteHyperlink, this.removeHyperlink, this);\n    };\n    SpreadsheetHyperlink.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateHyperlink, this.initiateHyperlinkHandler);\n            this.parent.off(editHyperlink, this.editHyperlinkHandler);\n            this.parent.off(openHyperlink, this.openHyperlinkHandler);\n            this.parent.off(click, this.hyperlinkClickHandler);\n            this.parent.off(createHyperlinkElement, this.createHyperlinkElementHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(deleteHyperlink, this.removeHyperlink);\n        }\n    };\n    /**\n     * Gets the module name.\n     *\n     * @returns {string} - Gets the module name.\n     */\n    SpreadsheetHyperlink.prototype.getModuleName = function () {\n        return 'spreadsheetHyperlink';\n    };\n    SpreadsheetHyperlink.prototype.keyUpHandler = function (e) {\n        var trgt = e.target;\n        if (closest(trgt, '.e-document')) {\n            var hyperlinkText = document.querySelector('.e-hyp-text');\n            var hyperlinkSpan = this.parent.element.querySelector('.e-hyperlink-alert-span');\n            var dlgElement = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var footerEle = dlgElement.getElementsByClassName('e-footer-content')[0];\n            var insertBut = footerEle.firstChild;\n            if (hyperlinkText && hyperlinkText.value) {\n                if (!isCellReference(hyperlinkText.value.toUpperCase())) {\n                    this.showDialog();\n                    insertBut.setAttribute('disabled', 'true');\n                }\n                else if (hyperlinkSpan) {\n                    hyperlinkSpan.remove();\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n        }\n        if (trgt.classList.contains('e-text') && closest(trgt, '.e-cont')) {\n            if (closest(trgt, '.e-webpage') && closest(trgt, '.e-webpage').getElementsByClassName('e-cont')[1] === trgt.parentElement) {\n                var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n                var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n                var insertBut = ftrEle.firstChild;\n                if (trgt.value !== '') {\n                    insertBut.removeAttribute('disabled');\n                }\n                else {\n                    var linkDialog = closest(trgt, '.e-link-dialog');\n                    var webPage = linkDialog.querySelector('.e-webpage');\n                    var isUrl = webPage.querySelectorAll('.e-cont')[1].querySelector('.e-text').value ? true : false;\n                    if (!isUrl) {\n                        insertBut.setAttribute('disabled', 'true');\n                    }\n                }\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.initiateHyperlinkHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && !sheet.protectSettings.insertLink) {\n            this.parent.notify(editAlert, null);\n            return;\n        }\n        if (!this.parent.element.querySelector('.e-hyperlink-dlg')) {\n            var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            dialogInst_1.show({\n                width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-hyperlink-dlg',\n                header: l10n.getConstant('InsertLink'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'InsertLinkDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst_1.dialogInstance.content = _this.hyperlinkContent();\n                    dialogInst_1.dialogInstance.dataBind();\n                    focus(_this.parent.element);\n                },\n                open: function () {\n                    setTimeout(function () {\n                        focus(dialogInst_1.dialogInstance.element.querySelectorAll('.e-webpage input')[1]);\n                    });\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Insert'), isPrimary: true, disabled: true\n                        },\n                        click: function () {\n                            _this.dlgClickHandler();\n                            dialogInst_1.hide();\n                        }\n                    }]\n            });\n        }\n    };\n    SpreadsheetHyperlink.prototype.dlgClickHandler = function () {\n        var value;\n        var address;\n        //const spreadsheetInst: Spreadsheet = this.parent;\n        var item = this.parent.element.querySelector('.e-link-dialog').\n            getElementsByClassName('e-content')[0].querySelector('.e-item.e-active');\n        if (item) {\n            if (item.querySelector('.e-webpage')) {\n                value = item.getElementsByClassName('e-cont')[0].querySelector('.e-text').value;\n                address = item.getElementsByClassName('e-cont')[1].querySelector('.e-text').value;\n                var args = { address: address };\n                this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n            }\n            else {\n                value = item.getElementsByClassName('e-cont')[0].querySelector('.e-text').value;\n                address = item.getElementsByClassName('e-cont')[1].querySelector('.e-text').value;\n                var dlgContent = item.getElementsByClassName('e-cont')[2];\n                if (dlgContent.getElementsByClassName('e-list-item')[0].querySelector('.e-active')) {\n                    var sheetName = item.getElementsByClassName('e-cont')[2].querySelector('.e-active').textContent;\n                    // const sheets: SheetModel[] = spreadsheetInst.sheets;\n                    // for (let idx: number = 0; idx < sheets.length; idx++) {\n                    //     if (sheets[idx].name === sheetName) {\n                    //         const sheetIdx: number = idx + 1;\n                    //     }\n                    // }\n                    address = sheetName + '!' + address.toUpperCase();\n                    var args = { address: address };\n                    this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n                }\n                else if (dlgContent.querySelector('.e-active')) {\n                    var definedName = item.getElementsByClassName('e-cont')[2].querySelector('.e-active').textContent;\n                    for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                        if (this.parent.definedNames[idx].name === definedName) {\n                            var args = {\n                                address: this.parent.definedNames[idx].name\n                            };\n                            this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.showDialog = function () {\n        if (this.parent.element.querySelector('.e-hyperlink-alert-span')) {\n            this.parent.element.querySelector('.e-hyperlink-alert-span').remove();\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var hyperlinkSpan = this.parent.createElement('span', {\n            className: 'e-hyperlink-alert-span',\n            innerHTML: l10n.getConstant('HyperlinkAlert')\n        });\n        var dlgEle = this.parent.element.querySelector('.e-hyperlink-dlg') || this.parent.element.querySelector('.e-edithyperlink-dlg');\n        (dlgEle.querySelector('.e-dlg-content')).appendChild(hyperlinkSpan);\n    };\n    SpreadsheetHyperlink.prototype.editHyperlinkHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-edithyperlink-dlg',\n            header: l10n.getConstant('EditLink'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'EditLinkDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                dialogInst.dialogInstance.content = _this.hyperEditContent();\n                dialogInst.dialogInstance.dataBind();\n                focus(_this.parent.element);\n            },\n            open: function () {\n                setTimeout(function () {\n                    if (dialogInst.dialogInstance.element.querySelector('.e-webpage')) {\n                        focus(dialogInst.dialogInstance.element.querySelectorAll('.e-webpage input')[1]);\n                    }\n                    else {\n                        focus(dialogInst.dialogInstance.element.querySelectorAll('.e-document input')[1]);\n                    }\n                });\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Update'), isPrimary: true\n                    },\n                    click: function () {\n                        _this.dlgClickHandler();\n                        dialogInst.hide();\n                    }\n                }]\n        });\n    };\n    SpreadsheetHyperlink.prototype.openHyperlinkHandler = function () {\n        var cellIndexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var trgt = this.parent.getCell(cellIndexes[0], cellIndexes[1]);\n        if (trgt.getElementsByClassName('e-hyperlink')[0]) {\n            trgt = trgt.querySelector('.e-hyperlink');\n        }\n        this.hlOpenHandler(trgt);\n    };\n    SpreadsheetHyperlink.prototype.hlOpenHandler = function (trgt) {\n        var _this = this;\n        if (trgt.classList.contains('e-hyperlink')) {\n            var range = ['', ''];\n            // let selRange: string;\n            var rangeIndexes = void 0;\n            var isEmpty = true;\n            trgt.style.color = '#551A8B';\n            if (closest(trgt, '.e-cell')) {\n                closest(trgt, '.e-cell').style.color = '#551A8B';\n            }\n            var sheet = this.parent.getActiveSheet();\n            var colIdx = parseInt(trgt.parentElement.getAttribute('aria-colindex'), 10) - 1;\n            var rowIdx = parseInt(trgt.parentElement.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            var rangeAddr = sheet.rows[rowIdx].cells[colIdx].hyperlink;\n            var address = void 0;\n            var befArgs = { hyperlink: rangeAddr, cell: this.parent.getActiveSheet().activeCell, target: '_blank', cancel: false };\n            this.parent.trigger(beforeHyperlinkClick, befArgs);\n            if (befArgs.cancel) {\n                return;\n            }\n            rangeAddr = befArgs.hyperlink;\n            var aftArgs = { hyperlink: rangeAddr, cell: this.parent.getActiveSheet().activeCell };\n            if (typeof (rangeAddr) === 'string') {\n                address = rangeAddr;\n            }\n            if (typeof (rangeAddr) === 'object') {\n                address = rangeAddr.address;\n            }\n            var definedNameCheck = address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                if (!isNullOrUndefined(address)) {\n                    if (this.parent.definedNames) {\n                        for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                            if (this.parent.definedNames[idx].name === address) {\n                                address = this.parent.definedNames[idx].refersTo;\n                                address = address.slice(1);\n                                break;\n                            }\n                        }\n                    }\n                    if (address.indexOf('!') !== -1) {\n                        range = address.split('!');\n                        if (range[0].indexOf(' ') !== -1) {\n                            range[0] = range[0].slice(1, range[0].length - 1);\n                        }\n                    }\n                    else {\n                        range[0] = this.parent.getActiveSheet().name;\n                        range[1] = address;\n                    }\n                    // selRange = range[1];\n                    var sheetIdx_1;\n                    for (var idx = 0; idx < this.parent.sheets.length; idx++) {\n                        if (this.parent.sheets[idx].name === range[0]) {\n                            sheetIdx_1 = idx;\n                        }\n                    }\n                    sheet = this.parent.sheets[sheetIdx_1];\n                    if (range[1].indexOf(':') !== -1) {\n                        var colIndex = range[1].indexOf(':');\n                        var left = range[1].substr(0, colIndex);\n                        var right = range[1].substr(colIndex + 1, range[1].length);\n                        left = left.replace('$', '');\n                        right = right.replace('$', '');\n                        if (right.match(/\\D/g) && !right.match(/[0-9]/g) && left.match(/\\D/g) && !left.match(/[0-9]/g)) {\n                            // selRange = left + '1' + ':' + right + sheet.rowCount;\n                            left = left + '1';\n                            right = right + sheet.rowCount;\n                            range[1] = left + ':' + right;\n                        }\n                        else if (!right.match(/\\D/g) && right.match(/[0-9]/g) && !left.match(/\\D/g) && left.match(/[0-9]/g)) {\n                            // selRange = getCellAddress(parseInt(left, 10) - 1, 0) + ':' +\n                            //     getCellAddress(parseInt(right, 10) - 1, sheet.colCount - 1);\n                            rangeIndexes = [parseInt(left, 10) - 1, 0, parseInt(right, 10) - 1, sheet.colCount - 1];\n                            isEmpty = false;\n                        }\n                    }\n                    var isDefinedNamed = void 0;\n                    var definedname = this.parent.definedNames;\n                    if (!isNullOrUndefined(definedname)) {\n                        for (var idx = 0; idx < definedname.length; idx++) {\n                            if (definedname[idx].name === definedNameCheck) {\n                                isDefinedNamed = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (isCellReference(range[1]) || isDefinedNamed) {\n                        rangeIndexes = isEmpty ? getRangeIndexes(range[1]) : rangeIndexes;\n                        if (this.parent.scrollSettings.enableVirtualization) {\n                            rangeIndexes[0] = rangeIndexes[0] >= this.parent.viewport.topIndex ?\n                                rangeIndexes[0] - this.parent.viewport.topIndex : rangeIndexes[0];\n                            rangeIndexes[1] = rangeIndexes[1] >= this.parent.viewport.leftIndex ?\n                                rangeIndexes[1] - this.parent.viewport.leftIndex : rangeIndexes[1];\n                        }\n                        if (!isNullOrUndefined(sheet)) {\n                            var rangeAddr_1 = getRangeAddress(rangeIndexes);\n                            if (sheet === this.parent.getActiveSheet()) {\n                                getUpdateUsingRaf(function () { _this.parent.goTo(rangeAddr_1); });\n                            }\n                            else {\n                                if (rangeAddr_1.indexOf(':') >= 0) {\n                                    var addArr = rangeAddr_1.split(':');\n                                    rangeAddr_1 = addArr[0] === addArr[1] ? addArr[0] : rangeAddr_1;\n                                }\n                                getUpdateUsingRaf(function () { _this.parent.goTo(_this.parent.sheets[sheetIdx_1].name + '!' + rangeAddr_1); });\n                            }\n                        }\n                    }\n                    else {\n                        this.showInvalidHyperlinkDialog();\n                    }\n                }\n            }\n            else {\n                if (this.isValidUrl(address)) {\n                    window.open(address, befArgs.target);\n                }\n                else {\n                    this.showInvalidHyperlinkDialog();\n                }\n            }\n            this.parent.trigger(afterHyperlinkClick, aftArgs);\n        }\n    };\n    SpreadsheetHyperlink.prototype.isValidUrl = function (url) {\n        // eslint-disable-next-line no-useless-escape\n        return /(ftp|http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-\\/]))?/.test(url);\n    };\n    SpreadsheetHyperlink.prototype.showInvalidHyperlinkDialog = function () {\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        var l10n = this.parent.serviceLocator.getService(locale);\n        dialogInst.show({\n            width: 323, isModal: true, showCloseIcon: true,\n            header: l10n.getConstant('Hyperlink'),\n            content: l10n.getConstant('InvalidHyperlinkAlert'),\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'), isPrimary: true\n                    },\n                    click: function () {\n                        dialogInst.hide();\n                    }\n                }]\n        }, false);\n    };\n    SpreadsheetHyperlink.prototype.hyperlinkClickHandler = function (e) {\n        var trgt = e.target;\n        if (closest(trgt, '.e-link-dialog') && closest(trgt, '.e-toolbar-item')) {\n            var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n            var insertBut = ftrEle.firstChild;\n            var docEle = dlgEle.querySelector('.e-document');\n            var webEle = dlgEle.querySelector('.e-webpage');\n            var webEleText = webEle ? webEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value :\n                docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value;\n            var docEleText = docEle ? docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value :\n                webEleText;\n            var toolbarItems = closest(trgt, '.e-toolbar-items');\n            if (toolbarItems.getElementsByClassName('e-toolbar-item')[1].classList.contains('e-active')) {\n                var actEle = docEle.querySelectorAll('.e-cont')[2].querySelector('.e-active');\n                docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value = webEleText;\n                if (closest(actEle, '.e-list-item').classList.contains('e-level-2') && insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n                else if (closest(actEle, '.e-list-item').classList.contains('e-level-1') && !insertBut.hasAttribute('disabled')) {\n                    insertBut.setAttribute('disabled', 'true');\n                }\n            }\n            else {\n                var isEmpty = webEle.querySelectorAll('.e-cont')[1].querySelector('.e-text').value ? false : true;\n                webEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value = docEleText;\n                if (isEmpty && !insertBut.hasAttribute('disabled')) {\n                    insertBut.setAttribute('disabled', 'true');\n                }\n                else if (!isEmpty && insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n        }\n        if (closest(trgt, '.e-list-item') && trgt.classList.contains('e-fullrow')) {\n            var item = this.parent.element.getElementsByClassName('e-link-dialog')[0].\n                getElementsByClassName('e-content')[0].getElementsByClassName('e-active')[0];\n            var cellRef = item.getElementsByClassName('e-cont')[1].getElementsByClassName('e-text')[0];\n            var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n            var insertBut = ftrEle.firstChild;\n            if (closest(trgt, '.e-list-item').classList.contains('e-level-2')) {\n                if (closest(trgt, '.e-list-item').getAttribute('data-uid') === 'defName') {\n                    if (!cellRef.classList.contains('e-disabled') && !cellRef.hasAttribute('readonly')) {\n                        cellRef.setAttribute('readonly', 'true');\n                        cellRef.classList.add('e-disabled');\n                        cellRef.setAttribute('disabled', 'true');\n                    }\n                }\n                else if (closest(trgt, '.e-list-item').getAttribute('data-uid') === 'sheet') {\n                    if (cellRef.classList.contains('e-disabled') && cellRef.hasAttribute('readonly')) {\n                        cellRef.removeAttribute('readonly');\n                        cellRef.classList.remove('e-disabled');\n                        cellRef.removeAttribute('disabled');\n                    }\n                }\n                if (insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n            else if (closest(trgt, '.e-list-item').classList.contains('e-level-1')) {\n                insertBut.setAttribute('disabled', 'true');\n            }\n        }\n        else {\n            this.hlOpenHandler(trgt);\n        }\n    };\n    SpreadsheetHyperlink.prototype.createHyperlinkElementHandler = function (args) {\n        var cell = args.cell;\n        var td = args.td;\n        var hyperEle = this.parent.createElement('a', { className: 'e-hyperlink e-hyperlink-style' });\n        hyperEle.style.color = '#00e';\n        if (!isNullOrUndefined(cell.hyperlink)) {\n            var hyperlink = cell.hyperlink;\n            if (typeof (hyperlink) === 'string') {\n                if (hyperlink.indexOf('http://') === -1 && hyperlink.indexOf('https://') === -1 &&\n                    hyperlink.indexOf('ftp://') === -1 && hyperlink.indexOf('www.') !== -1) {\n                    hyperlink = 'http://' + hyperlink;\n                }\n                if (hyperlink.indexOf('http://') === 0 || hyperlink.indexOf('https://') === 0 || hyperlink.indexOf('ftp://') === 0) {\n                    hyperEle.setAttribute('href', hyperlink);\n                    hyperEle.setAttribute('target', '_blank');\n                }\n                else if (hyperlink.includes('=') || hyperlink.includes('!')) {\n                    hyperEle.setAttribute('ref', hyperlink);\n                }\n                hyperEle.innerText = td.innerText !== '' ? td.innerText : hyperlink;\n                td.textContent = '';\n                td.innerText = '';\n                td.appendChild(hyperEle);\n            }\n            else if (typeof (hyperlink) === 'object') {\n                if (hyperlink.address.indexOf('http://') === 0 || hyperlink.address.indexOf('https://') === 0 ||\n                    hyperlink.address.indexOf('ftp://') === 0) {\n                    hyperEle.setAttribute('href', hyperlink.address);\n                    hyperEle.setAttribute('target', '_blank');\n                }\n                else if (hyperlink.address.includes('=') || hyperlink.address.includes('!')) {\n                    hyperEle.setAttribute('ref', hyperlink.address);\n                }\n                if (getTypeFromFormat(cell.format) === 'Accounting') {\n                    hyperEle.innerHTML = td.innerHTML;\n                }\n                else {\n                    hyperEle.innerText = td.innerText !== '' ? td.innerText : hyperlink.address;\n                }\n                td.textContent = '';\n                td.innerText = '';\n                td.appendChild(hyperEle);\n            }\n        }\n        else if (td.querySelector('a') && cell.hyperlink) {\n            if (typeof (cell.hyperlink) === 'string') {\n                td.querySelector('a').setAttribute('href', cell.hyperlink);\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.hyperEditContent = function () {\n        var isWeb = true;\n        var dialog = this.hyperlinkContent();\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var cell = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]].cells[indexes[1]];\n        if (this.parent.scrollSettings.enableVirtualization) {\n            indexes[0] = indexes[0] - this.parent.viewport.topIndex;\n            indexes[1] = indexes[1] - this.parent.viewport.leftIndex;\n        }\n        var value = this.parent.getDisplayText(cell);\n        var address;\n        var hyperlink = cell.hyperlink;\n        if (typeof (hyperlink) === 'string') {\n            address = hyperlink;\n            value = value || address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                isWeb = false;\n            }\n        }\n        else if (typeof (hyperlink) === 'object') {\n            address = hyperlink.address;\n            value = value || address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                isWeb = false;\n            }\n        }\n        var definedNamesCount = 0;\n        var rangeCount = 0;\n        var definedNames = this.parent.definedNames;\n        var sheets = this.parent.sheets;\n        for (var idx = 0, len = definedNames.length; idx < len; idx++) {\n            if (definedNames[idx].name === address) {\n                definedNamesCount++;\n            }\n        }\n        for (var idx = 0, len = sheets.length; idx < len; idx++) {\n            if (address.includes(sheets[idx].name)) {\n                rangeCount++;\n            }\n        }\n        if (definedNamesCount === 0 && rangeCount === 0) {\n            isWeb = true;\n        }\n        var item = dialog.querySelector('.e-content');\n        if (isWeb) {\n            var webContElem = item.querySelector('.e-webpage');\n            webContElem.getElementsByClassName('e-cont')[0].getElementsByClassName('e-text')[0].setAttribute('value', value);\n            if (typeof (hyperlink) === 'string') {\n                webContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text').setAttribute('value', hyperlink);\n            }\n            else {\n                var address_1 = webContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text');\n                address_1.setAttribute('value', hyperlink.address);\n            }\n        }\n        else {\n            var isDefinedNamed = void 0;\n            var docContElem = item.querySelector('.e-document');\n            docContElem.getElementsByClassName('e-cont')[0].getElementsByClassName('e-text')[0].setAttribute('value', value);\n            var rangeArr = void 0;\n            // let sheet: SheetModel = this.parent.getActiveSheet();\n            // let sheetIdx: number;\n            if (this.parent.definedNames) {\n                for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                    if (this.parent.definedNames[idx].name === address) {\n                        isDefinedNamed = true;\n                        break;\n                    }\n                }\n            }\n            if (isDefinedNamed) {\n                var cellRef = docContElem.getElementsByClassName('e-cont')[1].getElementsByClassName('e-text')[0];\n                cellRef.setAttribute('readonly', 'true');\n                cellRef.classList.add('e-disabled');\n                cellRef.setAttribute('disabled', 'true');\n                var treeCont = docContElem.getElementsByClassName('e-cont')[2];\n                var listEle = treeCont.querySelectorAll('.e-list-item.e-level-1')[1];\n                for (var idx = 0; idx < listEle.getElementsByTagName('li').length; idx++) {\n                    if (listEle.getElementsByTagName('li')[idx].innerText === address) {\n                        listEle.getElementsByTagName('li')[idx].classList.add('e-active');\n                    }\n                }\n            }\n            else {\n                if (address && address.indexOf('!') !== -1) {\n                    rangeArr = address.split('!');\n                    // sheetIdx = parseInt(rangeArr[0].replace(/\\D/g, ''), 10) - 1;\n                    // sheet = this.parent.sheets[sheetIdx];\n                }\n                var sheetName = rangeArr[0];\n                docContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text').setAttribute('value', rangeArr[1]);\n                var treeCont = docContElem.getElementsByClassName('e-cont')[2];\n                var listEle = treeCont.querySelectorAll('.e-list-item.e-level-1')[0];\n                for (var idx = 0; idx < listEle.getElementsByTagName('li').length; idx++) {\n                    if (listEle.getElementsByTagName('li')[idx].innerText === sheetName) {\n                        if (listEle.getElementsByTagName('li')[idx].classList.contains('e-active')) {\n                            break;\n                        }\n                        else {\n                            listEle.getElementsByTagName('li')[idx].classList.add('e-active');\n                        }\n                    }\n                    else {\n                        if (listEle.getElementsByTagName('li')[idx].classList.contains('e-active')) {\n                            listEle.getElementsByTagName('li')[idx].classList.remove('e-active');\n                        }\n                    }\n                }\n            }\n        }\n        return dialog;\n    };\n    SpreadsheetHyperlink.prototype.hyperlinkContent = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var idx = 0;\n        var selIdx = 0;\n        var isWeb = true;\n        var isDefinedName;\n        var isCellRef = true;\n        var address;\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var isEnable = true;\n        if (cell) {\n            if ((cell.value && typeof (cell.value) === 'string' && cell.value.match('[A-Za-z]+') !== null) ||\n                cell.value === '' || isNullOrUndefined(cell.value)) {\n                isEnable = true;\n            }\n            else {\n                isEnable = false;\n            }\n            var hyperlink = cell.hyperlink;\n            if (typeof (hyperlink) === 'string') {\n                var hl = hyperlink;\n                if (hl.indexOf('http://') === -1 && hl.indexOf('https://') === -1 && hl.indexOf('ftp://') === -1) {\n                    address = hyperlink;\n                    isWeb = false;\n                }\n            }\n            else if (typeof (hyperlink) === 'object') {\n                var hl = hyperlink.address;\n                if (hl.indexOf('http://') === -1 && hl.indexOf('https://') === -1 && hl.indexOf('ftp://') === -1) {\n                    address = hyperlink.address;\n                    isWeb = false;\n                }\n            }\n            if (address) {\n                var defNamesCnt = 0;\n                var rangeCnt = 0;\n                var definedNames = this.parent.definedNames;\n                var sheets_1 = this.parent.sheets;\n                for (var idx_1 = 0, len = sheets_1.length; idx_1 < len; idx_1++) {\n                    if (address.includes(sheets_1[idx_1].name)) {\n                        rangeCnt++;\n                    }\n                }\n                for (var idx_2 = 0, len = definedNames.length; idx_2 < len; idx_2++) {\n                    if (definedNames[idx_2].name === address) {\n                        defNamesCnt++;\n                    }\n                }\n                if (defNamesCnt === 0 && rangeCnt === 0) {\n                    isWeb = true;\n                }\n            }\n            if (isWeb) {\n                selIdx = 0;\n            }\n            else {\n                selIdx = 1;\n            }\n            if (this.parent.definedNames) {\n                for (var idx_3 = 0; idx_3 < this.parent.definedNames.length; idx_3++) {\n                    if (this.parent.definedNames[idx_3].name === address) {\n                        isDefinedName = true;\n                        isCellRef = false;\n                        break;\n                    }\n                }\n            }\n        }\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var webContElem = this.parent.createElement('div', { className: 'e-webpage' });\n        var docContElem = this.parent.createElement('div', { className: 'e-document' });\n        var headerTabs = new Tab({\n            selectedItem: selIdx,\n            items: [\n                {\n                    header: { 'text': l10n.getConstant('WebPage') },\n                    content: webContElem\n                },\n                {\n                    header: { 'text': l10n.getConstant('ThisDocument') },\n                    content: docContElem\n                }\n            ]\n        });\n        headerTabs.appendTo(dialogElem);\n        if (isWeb) {\n            dialogElem.querySelector('.e-toolbar-items').querySelector('.e-indicator').setAttribute('style', 'left: 0; right: 136px');\n        }\n        else {\n            dialogElem.querySelector('.e-toolbar-items').querySelector('.e-indicator').setAttribute('style', 'left: 136px; right: 0');\n        }\n        var textCont = this.parent.createElement('div', { className: 'e-cont' });\n        var urlCont = this.parent.createElement('div', { className: 'e-cont' });\n        var textH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('DisplayText') });\n        var urlH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('Url') });\n        var textInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' } });\n        if (!isEnable) {\n            textInput.classList.add('e-disabled');\n            textInput.setAttribute('readonly', 'true');\n            textInput.setAttribute('disabled', 'true');\n        }\n        if (cell && isNullOrUndefined(cell.hyperlink)) {\n            textInput.setAttribute('value', this.parent.getDisplayText(cell));\n        }\n        var urlInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' } });\n        textInput.setAttribute('placeholder', l10n.getConstant('EnterTheTextToDisplay'));\n        urlInput.setAttribute('placeholder', l10n.getConstant('EnterTheUrl'));\n        textCont.appendChild(textInput);\n        textCont.insertBefore(textH, textInput);\n        urlCont.appendChild(urlInput);\n        urlCont.insertBefore(urlH, urlInput);\n        webContElem.appendChild(urlCont);\n        webContElem.insertBefore(textCont, urlCont);\n        var cellRef = [];\n        var definedName = [];\n        var sheets = this.parent.sheets;\n        for (idx; idx < this.parent.sheets.length; idx++) {\n            var sheetName = this.parent.sheets[idx].name;\n            if (this.parent.sheets[idx].state === 'Visible') {\n                if (sheets[idx] === this.parent.getActiveSheet()) {\n                    cellRef.push({\n                        nodeId: 'sheet',\n                        nodeText: sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName,\n                        selected: true\n                    });\n                }\n                else {\n                    cellRef.push({\n                        nodeId: 'sheet',\n                        nodeText: sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName\n                    });\n                }\n            }\n        }\n        for (idx = 0; idx < this.parent.definedNames.length; idx++) {\n            definedName.push({\n                nodeId: 'defName',\n                nodeText: this.parent.definedNames[idx].name\n            });\n        }\n        var data = [\n            {\n                nodeId: '01', nodeText: l10n.getConstant('CellReference'), expanded: isCellRef,\n                nodeChild: cellRef\n            },\n            {\n                nodeId: '02', nodeText: l10n.getConstant('DefinedNames'), expanded: isDefinedName,\n                nodeChild: definedName\n            }\n        ];\n        var treeObj = new TreeView({\n            fields: { dataSource: data, id: 'nodeId', text: 'nodeText', child: 'nodeChild' }\n        });\n        var cellrefCont = this.parent.createElement('div', { className: 'e-cont' });\n        var cellrefH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('CellReference') });\n        var cellrefInput = this.parent.createElement('input', {\n            className: 'e-input e-text e-hyp-text',\n            attrs: { 'type': 'Text' }\n        });\n        cellrefInput.setAttribute('value', 'A1');\n        cellrefCont.appendChild(cellrefInput);\n        cellrefCont.insertBefore(cellrefH, cellrefInput);\n        var textCont1 = this.parent.createElement('div', { className: 'e-cont' });\n        var textH1 = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('DisplayText') });\n        var textInput1 = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' } });\n        if (!isEnable) {\n            textInput1.classList.add('e-disabled');\n            textInput1.setAttribute('readonly', 'true');\n            textInput1.setAttribute('disabled', 'true');\n        }\n        if (cell && isNullOrUndefined(cell.hyperlink)) {\n            textInput1.setAttribute('value', this.parent.getDisplayText(cell));\n        }\n        textInput1.setAttribute('placeholder', l10n.getConstant('EnterTheTextToDisplay'));\n        textCont1.appendChild(textInput1);\n        textCont1.insertBefore(textH1, textInput1);\n        var sheetCont = this.parent.createElement('div', { className: 'e-cont' });\n        var sheetH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('Sheet') });\n        var refCont = this.parent.createElement('div', { className: 'e-refcont' });\n        sheetCont.appendChild(refCont);\n        sheetCont.insertBefore(sheetH, refCont);\n        docContElem.appendChild(cellrefCont);\n        docContElem.insertBefore(textCont1, cellrefCont);\n        treeObj.appendTo(refCont);\n        docContElem.appendChild(sheetCont);\n        return dialogElem;\n    };\n    SpreadsheetHyperlink.prototype.removeHyperlink = function (args) {\n        var cell = getCell(args.rowIdx, args.colIdx, args.sheet);\n        if (cell && cell.hyperlink) {\n            if (typeof (cell.hyperlink) === 'string') {\n                cell.value = cell.value ? cell.value : cell.hyperlink;\n            }\n            else {\n                cell.value = cell.value ? cell.value : cell.hyperlink.address;\n            }\n            delete (cell.hyperlink);\n            if (cell.style) {\n                delete cell.style.textDecoration;\n                delete cell.style.color;\n            }\n            if (args.sheet === this.parent.getActiveSheet()) {\n                if (cell.style) {\n                    this.parent.notify(refreshRibbonIcons, null);\n                }\n                if (!args.preventRefresh) {\n                    this.parent.serviceLocator.getService('cell').refreshRange([args.rowIdx, args.colIdx, args.rowIdx, args.colIdx]);\n                }\n            }\n        }\n    };\n    return SpreadsheetHyperlink;\n}());\nexport { SpreadsheetHyperlink };\n","import { locale, deleteImage, createImageElement } from '../../spreadsheet/index';\nimport { performUndoRedo, updateUndoRedoCollection, enableToolbarItems, completeAction } from '../common/index';\nimport { setActionData, getBeforeActionData, updateAction, initiateFilterUI } from '../common/index';\nimport { setUndoRedo } from '../common/index';\nimport { selectRange, clearUndoRedoCollection, setMaxHgt, getMaxHgt, setRowEleHeight } from '../common/index';\nimport { getRangeFromAddress, getRangeIndexes, getSheet, workbookEditOperation, getSwapRange } from '../../workbook/index';\nimport { getCell, setCell, getSheetIndex, wrapEvent, getSheetIndexFromId } from '../../workbook/index';\nimport { setMerge, getRangeAddress, triggerDataChange } from '../../workbook/index';\nimport { addClass, extend } from '@syncfusion/ej2-base';\nimport { getFilteredCollection, setCellFormat, refreshRibbonIcons } from '../../workbook/index';\n/**\n * UndoRedo module allows to perform undo redo functionalities.\n */\nvar UndoRedo = /** @class */ (function () {\n    function UndoRedo(parent) {\n        this.undoCollection = [];\n        this.redoCollection = [];\n        this.isUndo = false;\n        this.undoRedoStep = 100;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    UndoRedo.prototype.setActionData = function (options) {\n        var sheet = this.parent.getActiveSheet();\n        var address;\n        var cells = [];\n        var cutCellDetails = [];\n        var args = options.args;\n        var eventArgs = args.eventArgs;\n        var copiedInfo = {};\n        switch (args.action) {\n            case 'format':\n                address = getRangeIndexes(args.eventArgs.range);\n                break;\n            case 'clipboard':\n                copiedInfo = eventArgs.copiedInfo;\n                address = getRangeIndexes(getRangeFromAddress(eventArgs.pastedRange));\n                if (copiedInfo && copiedInfo.isCut) {\n                    cutCellDetails = this.getCellDetails(copiedInfo.range, getSheet(this.parent, getSheetIndexFromId(this.parent, copiedInfo.sId)));\n                }\n                break;\n            case 'beforeSort':\n                address = getRangeIndexes(args.eventArgs.range);\n                if (address[0] === address[2] && (address[2] - address[0]) === 0) { //if selected range is a single cell\n                    address[0] = 0;\n                    address[1] = 0;\n                    address[2] = sheet.usedRange.rowIndex;\n                    address[3] = sheet.usedRange.colIndex;\n                }\n                break;\n            case 'beforeCellSave':\n            case 'cellDelete':\n                address = getRangeIndexes(eventArgs.address);\n                break;\n            case 'beforeWrap':\n                address = this.parent.getAddressInfo(eventArgs.address).indices;\n                break;\n            case 'beforeReplace':\n                address = this.parent.getAddressInfo(eventArgs.address).indices;\n                break;\n            case 'beforeClear':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'beforeInsertImage':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'beforeInsertChart':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'filter':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n        }\n        cells = this.getCellDetails(address, sheet);\n        this.beforeActionData = { cellDetails: cells, cutCellDetails: cutCellDetails };\n    };\n    UndoRedo.prototype.getBeforeActionData = function (args) {\n        args.beforeDetails = this.beforeActionData;\n    };\n    UndoRedo.prototype.performUndoRedo = function (args) {\n        var undoRedoArgs = args.isUndo ? this.undoCollection.pop() : this.redoCollection.pop();\n        this.isUndo = args.isUndo;\n        if (undoRedoArgs) {\n            switch (undoRedoArgs.action) {\n                case 'cellSave':\n                case 'format':\n                case 'sorting':\n                case 'wrap':\n                case 'cellDelete':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'clipboard':\n                    undoRedoArgs = this.undoForClipboard(undoRedoArgs);\n                    break;\n                case 'resize':\n                    undoRedoArgs = this.undoForResize(undoRedoArgs);\n                    break;\n                case 'hideShow':\n                    undoRedoArgs.eventArgs.hide = !undoRedoArgs.eventArgs.hide;\n                    updateAction(undoRedoArgs, this.parent);\n                    break;\n                case 'replace':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'insert':\n                case 'filter':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'delete':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'validation':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'merge':\n                    undoRedoArgs.eventArgs.merge = !undoRedoArgs.eventArgs.merge;\n                    updateAction(undoRedoArgs, this.parent);\n                    break;\n                case 'clear':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'conditionalFormat':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo, this.undoCollection);\n                    break;\n                case 'clearCF':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'insertImage':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'imageRefresh':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'insertChart':\n                case 'deleteChart':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'chartRefresh':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n            }\n            if (args.isUndo) {\n                this.redoCollection.push(undoRedoArgs);\n            }\n            else {\n                this.undoCollection.push(undoRedoArgs);\n            }\n            if (this.undoCollection.length > this.undoRedoStep) {\n                this.undoCollection.splice(0, 1);\n            }\n            if (this.redoCollection.length > this.undoRedoStep) {\n                this.redoCollection.splice(0, 1);\n            }\n            this.updateUndoRedoIcons();\n            var completeArgs = Object.assign({}, undoRedoArgs.eventArgs);\n            completeArgs.requestType = args.isUndo ? 'undo' : 'redo';\n            delete completeArgs.beforeActionData;\n            if (!args.isPublic) {\n                this.parent.notify(triggerDataChange, extend({ isUndo: args.isUndo }, undoRedoArgs, null, true));\n                this.parent.notify(completeAction, { eventArgs: completeArgs, action: 'undoRedo' });\n            }\n            this.parent.notify(refreshRibbonIcons, null);\n        }\n    };\n    UndoRedo.prototype.updateUndoRedoCollection = function (options) {\n        var actionList = ['clipboard', 'format', 'sorting', 'cellSave', 'resize', 'resizeToFit', 'wrap', 'hideShow', 'replace',\n            'validation', 'merge', 'clear', 'conditionalFormat', 'clearCF', 'insertImage', 'imageRefresh', 'insertChart', 'deleteChart',\n            'chartRefresh', 'filter', 'cellDelete'];\n        if ((options.args.action === 'insert' || options.args.action === 'delete') && options.args.eventArgs.modelType !== 'Sheet') {\n            actionList.push(options.args.action);\n        }\n        var action = options.args.action;\n        if (actionList.indexOf(action) === -1 && !options.isPublic) {\n            return;\n        }\n        var eventArgs = options.args.eventArgs;\n        if (action === 'clipboard' || action === 'sorting' || action === 'format' || action === 'cellSave' ||\n            action === 'wrap' || action === 'replace' || action === 'validation' || action === 'clear' || action === 'conditionalFormat' ||\n            action === 'clearCF' || action === 'insertImage' || action === 'imageRefresh' || action === 'insertChart' ||\n            action === 'chartRefresh' || action === 'filter' || action === 'cellDelete') {\n            var beforeActionDetails = { beforeDetails: { cellDetails: [] } };\n            this.parent.notify(getBeforeActionData, beforeActionDetails);\n            eventArgs.beforeActionData = beforeActionDetails.beforeDetails;\n        }\n        if (action === 'clipboard' && eventArgs.copiedInfo.isExternal) {\n            var addressInfo = this.parent.getAddressInfo(eventArgs.pastedRange);\n            eventArgs.copiedInfo.cellDetails = this.getCellDetails(addressInfo.indices, getSheet(this.parent, addressInfo.sheetIndex));\n        }\n        this.undoCollection.push(options.args);\n        this.redoCollection = [];\n        if (this.undoCollection.length > this.undoRedoStep) {\n            this.undoCollection.splice(0, 1);\n        }\n        this.updateUndoRedoIcons();\n    };\n    UndoRedo.prototype.clearUndoRedoCollection = function () {\n        this.undoCollection = [];\n        this.redoCollection = [];\n        this.updateUndoRedoIcons();\n    };\n    UndoRedo.prototype.updateUndoRedoIcons = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.parent.notify(enableToolbarItems, [{\n                tab: l10n.getConstant('Home'), items: [this.parent.element.id + '_undo'],\n                enable: this.undoCollection.length > 0\n            }]);\n        this.parent.notify(enableToolbarItems, [{\n                tab: l10n.getConstant('Home'), items: [this.parent.element.id + '_redo'],\n                enable: this.redoCollection.length > 0\n            }]);\n    };\n    UndoRedo.prototype.undoForClipboard = function (args) {\n        var _this = this;\n        var eventArgs = args.eventArgs;\n        var address = eventArgs.pastedRange.split('!');\n        var range = getRangeIndexes(address[1]);\n        var sheetIndex = getSheetIndex(this.parent, address[0]);\n        var sheet = getSheet(this.parent, sheetIndex);\n        var copiedInfo = eventArgs.copiedInfo;\n        var actionData = eventArgs.beforeActionData;\n        var isRefresh = this.checkRefreshNeeded(sheetIndex);\n        var pictureElem;\n        if (args.eventArgs.requestType === 'imagePaste') {\n            var copiedShapeInfo = eventArgs.copiedShapeInfo;\n            if (this.isUndo) {\n                pictureElem = copiedShapeInfo.pictureElem;\n                if (copiedShapeInfo.isCut) {\n                    this.parent.notify(deleteImage, {\n                        id: pictureElem.id, sheetIdx: eventArgs.pasteSheetIndex + 1\n                    });\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            src: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: copiedShapeInfo.height, width: copiedShapeInfo.width, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.copiedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n                else {\n                    this.parent.notify(deleteImage, {\n                        id: eventArgs.pastedPictureElement.id, sheetIdx: eventArgs.pasteSheetIndex + 1\n                    });\n                }\n            }\n            else {\n                if (copiedShapeInfo.isCut) {\n                    pictureElem = copiedShapeInfo.pictureElem;\n                    this.parent.notify(deleteImage, {\n                        id: pictureElem.id, sheetIdx: copiedShapeInfo.sId\n                    });\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            src: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: copiedShapeInfo.height, width: copiedShapeInfo.width, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.pastedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n                else {\n                    pictureElem = eventArgs.pastedPictureElement;\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            src: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: pictureElem.offsetHeight, width: pictureElem.offsetWidth, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.pastedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n            }\n        }\n        else {\n            if (this.isUndo) {\n                if (copiedInfo.isCut) {\n                    var cells = actionData.cutCellDetails;\n                    this.updateCellDetails(cells, getSheet(this.parent, getSheetIndexFromId(this.parent, copiedInfo.sId)), getSwapRange(copiedInfo.range), isRefresh);\n                    this.parent.notify(getFilteredCollection, null);\n                    for (var i = 0; i < this.parent.sheets.length; i++) {\n                        var sheetIndex_1 = getSheetIndexFromId(this.parent, copiedInfo.sId);\n                        if (this.parent.filterCollection && this.parent.filterCollection[i] &&\n                            this.parent.filterCollection[i].sheetIndex === eventArgs.pasteSheetIndex) {\n                            var filterCol = this.parent.filterCollection[i];\n                            var fRange = getRangeIndexes(filterCol.filterRange);\n                            var pRange = getSwapRange(range);\n                            if (fRange[0] >= pRange[0] && fRange[2] <= pRange[2]) {\n                                this.parent.notify(initiateFilterUI, {\n                                    predicates: null, range: filterCol.filterRange,\n                                    sIdx: eventArgs.pasteSheetIndex, isCut: true\n                                });\n                                var diff = [Math.abs(pRange[0] - fRange[0]), Math.abs(pRange[1] - fRange[1]),\n                                    Math.abs(pRange[2] - fRange[2]), Math.abs(pRange[3] - fRange[3])];\n                                var copiedRange = getSwapRange(copiedInfo.range);\n                                diff = [copiedRange[0] + diff[0], copiedRange[1] + diff[1],\n                                    Math.abs(copiedRange[2] - diff[2]), Math.abs(copiedRange[3] - diff[3])];\n                                this.parent.notify(initiateFilterUI, {\n                                    predicates: null,\n                                    range: getRangeAddress(diff), sIdx: sheetIndex_1, isCut: true\n                                });\n                            }\n                        }\n                    }\n                }\n                if (actionData) {\n                    this.updateCellDetails(actionData.cellDetails, sheet, range, isRefresh);\n                }\n                setMaxHgt(sheet, range[0], range[1], 20);\n                var hgt = getMaxHgt(sheet, range[0]);\n                setRowEleHeight(this.parent, sheet, hgt, range[0]);\n                eventArgs.mergeCollection.forEach(function (mergeArgs) {\n                    mergeArgs.merge = !mergeArgs.merge;\n                    _this.parent.notify(setMerge, mergeArgs);\n                    mergeArgs.merge = !mergeArgs.merge;\n                });\n            }\n            else {\n                if (copiedInfo.isExternal) {\n                    var addressInfo = this.parent.getAddressInfo(eventArgs.pastedRange);\n                    this.updateCellDetails(copiedInfo.cellDetails, getSheet(this.parent, addressInfo.sheetIndex), addressInfo.indices, true);\n                }\n                else {\n                    updateAction(args, this.parent, copiedInfo.isCut);\n                }\n            }\n            if (isRefresh) {\n                this.parent.notify(selectRange, { address: address[1] });\n            }\n        }\n        return args;\n    };\n    UndoRedo.prototype.undoForResize = function (args) {\n        var eventArgs = args.eventArgs;\n        if (eventArgs.hide === undefined) {\n            if (eventArgs.isCol) {\n                var temp = eventArgs.oldWidth;\n                eventArgs.oldWidth = eventArgs.width;\n                eventArgs.width = temp;\n            }\n            else {\n                var temp = eventArgs.oldHeight;\n                eventArgs.oldHeight = eventArgs.height;\n                eventArgs.height = temp;\n            }\n        }\n        else {\n            eventArgs.hide = !eventArgs.hide;\n        }\n        updateAction(args, this.parent);\n        var sheet = this.parent.getActiveSheet();\n        var activeCell = getRangeIndexes(sheet.activeCell);\n        var CellElem = getCell(activeCell[0], activeCell[1], sheet);\n        if (CellElem && CellElem.rowSpan) {\n            var td = this.parent.getCell(activeCell[0], activeCell[1]);\n            this.parent.element.querySelector('.e-active-cell').style.height = td.offsetHeight + 'px';\n        }\n        else if (CellElem && CellElem.colSpan) {\n            var td = this.parent.getCell(activeCell[0], activeCell[1]);\n            this.parent.element.querySelector('.e-active-cell').style.width = td.offsetWidth + 'px';\n        }\n        return args;\n    };\n    UndoRedo.prototype.performOperation = function (args) {\n        var eventArgs = args.eventArgs;\n        var address = (args.action === 'cellSave' || args.action === 'wrap' || args.action === 'replace'\n            || args.action === 'cellDelete') ? eventArgs.address.split('!') : eventArgs.range.split('!');\n        var range = getRangeIndexes(address[1]);\n        var indexes = range;\n        var sheetIndex = getSheetIndex(this.parent, address[0]);\n        var sheet = getSheet(this.parent, sheetIndex);\n        var actionData = eventArgs.beforeActionData;\n        var isRefresh = this.checkRefreshNeeded(sheetIndex);\n        if (this.isUndo) {\n            this.updateCellDetails(actionData.cellDetails, sheet, range, isRefresh, args);\n        }\n        else {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var argsEventArgs = args.eventArgs;\n            var activeCellIndexes = getRangeIndexes(sheet.activeCell);\n            var cellValue = this.parent.getCellStyleValue(['textDecoration'], activeCellIndexes).textDecoration;\n            if (argsEventArgs && argsEventArgs.style && argsEventArgs.style.textDecoration) {\n                var value = argsEventArgs.style.textDecoration;\n                var changedValue = value;\n                var changedStyle = void 0;\n                var removeProp = false;\n                if (cellValue === 'underline') {\n                    changedValue = value === 'underline' ? 'none' : 'underline line-through';\n                }\n                else if (cellValue === 'line-through') {\n                    changedValue = value === 'line-through' ? 'none' : 'underline line-through';\n                }\n                else if (cellValue === 'underline line-through') {\n                    changedValue = value === 'underline' ? 'line-through' : 'underline';\n                    removeProp = true;\n                }\n                if (changedValue === 'none') {\n                    removeProp = true;\n                }\n                argsEventArgs.style.textDecoration = changedValue;\n                args.eventArgs = argsEventArgs;\n                this.parent.notify(setCellFormat, {\n                    style: { textDecoration: changedValue }, range: activeCellIndexes, refreshRibbon: true,\n                    onActionUpdate: true\n                });\n                for (var i = indexes[0]; i <= indexes[2]; i++) {\n                    for (var j = indexes[1]; j <= indexes[3]; j++) {\n                        if (i === activeCellIndexes[0] && j === activeCellIndexes[1]) {\n                            continue;\n                        }\n                        changedStyle = {};\n                        cellValue = this.parent.getCellStyleValue(['textDecoration'], [i, j]).textDecoration;\n                        if (cellValue === 'none') {\n                            if (removeProp) {\n                                continue;\n                            }\n                            changedStyle.textDecoration = value;\n                        }\n                        else if (cellValue === 'underline' || cellValue === 'line-through') {\n                            if (removeProp) {\n                                if (value === cellValue) {\n                                    changedStyle.textDecoration = 'none';\n                                }\n                                else {\n                                    continue;\n                                }\n                            }\n                            else {\n                                changedStyle.textDecoration = value !== cellValue ? 'underline line-through' : value;\n                            }\n                        }\n                        else if (cellValue === 'underline line-through') {\n                            if (removeProp) {\n                                changedStyle.textDecoration = value === 'underline' ? 'line-through' : 'underline';\n                            }\n                            else {\n                                continue;\n                            }\n                        }\n                        this.parent.notify(setCellFormat, {\n                            style: { textDecoration: changedStyle.textDecoration }, range: [i, j, i, j], refreshRibbon: true,\n                            onActionUpdate: true\n                        });\n                    }\n                }\n                argsEventArgs.style.textDecoration = value;\n                args.eventArgs = argsEventArgs;\n            }\n            else {\n                updateAction(args, this.parent, true);\n            }\n        }\n        if (isRefresh) {\n            this.parent.notify(selectRange, { address: address[1] });\n        }\n        return args;\n    };\n    UndoRedo.prototype.getCellDetails = function (address, sheet) {\n        var cells = [];\n        var cell;\n        address = getSwapRange(address);\n        for (var i = address[0]; i <= address[2]; i++) {\n            for (var j = address[1]; j <= address[3]; j++) {\n                cell = getCell(i, j, sheet);\n                cells.push({\n                    rowIndex: i, colIndex: j, format: cell ? cell.format : null, isLocked: cell ? cell.isLocked : null,\n                    style: cell && cell.style ? Object.assign({}, cell.style) : null, value: cell ? cell.value : '', formula: cell ?\n                        cell.formula : '', wrap: cell && cell.wrap, rowSpan: cell && cell.rowSpan, colSpan: cell && cell.colSpan,\n                    hyperlink: cell && cell.hyperlink, image: cell && cell.image && cell.chart\n                });\n            }\n        }\n        return cells;\n    };\n    UndoRedo.prototype.updateCellDetails = function (cells, sheet, range, isRefresh, args) {\n        var len = cells.length;\n        var cellElem;\n        for (var i = 0; i < len; i++) {\n            setCell(cells[i].rowIndex, cells[i].colIndex, sheet, {\n                value: cells[i].value, format: cells[i].format, isLocked: cells[i].isLocked,\n                style: cells[i].style && Object.assign({}, cells[i].style), formula: cells[i].formula,\n                wrap: cells[i].wrap, rowSpan: cells[i].rowSpan,\n                colSpan: cells[i].colSpan, hyperlink: cells[i].hyperlink\n            });\n            this.parent.notify(workbookEditOperation, {\n                action: 'updateCellValue', address: [cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                    cells[i].colIndex], value: cells[i].formula ? cells[i].formula : cells[i].value\n            });\n            if (args && args.action === 'wrap' && args.eventArgs.wrap) {\n                this.parent.notify(wrapEvent, {\n                    range: [cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                        cells[i].colIndex], wrap: false, sheet: sheet\n                });\n            }\n            if (args && cells[i].hyperlink && args.action === 'clear') {\n                args.eventArgs.range = sheet.name + '!' + getRangeAddress([cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                    cells[i].colIndex]);\n                cellElem = this.parent.getCell(cells[i].rowIndex, cells[i].colIndex);\n                if (args.eventArgs.type === 'Clear All' || args.eventArgs.type === 'Clear Hyperlinks') {\n                    this.parent.addHyperlink(cells[i].hyperlink, args.eventArgs.range);\n                }\n                else if (args.eventArgs.type === 'Clear Formats') {\n                    addClass(cellElem.querySelectorAll('.e-hyperlink'), 'e-hyperlink-style');\n                }\n            }\n        }\n        if (isRefresh) {\n            this.parent.serviceLocator.getService('cell').refreshRange(range);\n        }\n    };\n    UndoRedo.prototype.checkRefreshNeeded = function (sheetIndex) {\n        var isRefresh = true;\n        if (sheetIndex !== this.parent.activeSheetIndex) {\n            this.parent.activeSheetIndex = sheetIndex;\n            this.parent.dataBind();\n            isRefresh = false;\n        }\n        return isRefresh;\n    };\n    UndoRedo.prototype.addEventListener = function () {\n        this.parent.on(performUndoRedo, this.performUndoRedo, this);\n        this.parent.on(updateUndoRedoCollection, this.updateUndoRedoCollection, this);\n        this.parent.on(setActionData, this.setActionData, this);\n        this.parent.on(getBeforeActionData, this.getBeforeActionData, this);\n        this.parent.on(clearUndoRedoCollection, this.clearUndoRedoCollection, this);\n        this.parent.on(setUndoRedo, this.updateUndoRedoIcons, this);\n    };\n    UndoRedo.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(performUndoRedo, this.performUndoRedo);\n            this.parent.off(updateUndoRedoCollection, this.updateUndoRedoCollection);\n            this.parent.off(setActionData, this.setActionData);\n            this.parent.off(getBeforeActionData, this.getBeforeActionData);\n            this.parent.off(clearUndoRedoCollection, this.clearUndoRedoCollection);\n            this.parent.off(setUndoRedo, this.updateUndoRedoIcons);\n        }\n    };\n    /**\n     * Destroy undo redo module.\n     *\n     * @returns {void} - Destroy undo redo module.\n     */\n    UndoRedo.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the undo redo module name.\n     *\n     * @returns {string} - Get the undo redo module name.\n     */\n    UndoRedo.prototype.getModuleName = function () {\n        return 'undoredo';\n    };\n    return UndoRedo;\n}());\nexport { UndoRedo };\n","import { closest, Browser } from '@syncfusion/ej2-base';\nimport { ribbonClick, inView, setMaxHgt, getMaxHgt, WRAPTEXT, setRowEleHeight, rowHeightChanged, beginAction } from '../common/index';\nimport { completeAction, getLines, getExcludedColumnWidth, getTextHeightWithBorder } from '../common/index';\nimport { getCell, wrap as wrapText, wrapEvent, getRow, getRowsHeight } from '../../workbook/index';\nimport { getRowHeight, getAddressFromSelectedRange } from '../../workbook/index';\n/**\n * Represents Wrap Text support for Spreadsheet.\n */\nvar WrapText = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Wrap Text module.\n     *\n     * @param {Spreadsheet} parent - Specifies the Spreadsheet.\n     * @private\n     */\n    function WrapText(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WrapText.prototype.addEventListener = function () {\n        this.parent.on(ribbonClick, this.ribbonClickHandler, this);\n        this.parent.on(wrapEvent, this.wrapTextHandler, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChangedHandler, this);\n    };\n    WrapText.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(ribbonClick, this.ribbonClickHandler);\n            this.parent.off(wrapEvent, this.wrapTextHandler);\n            this.parent.off(rowHeightChanged, this.rowHeightChangedHandler);\n        }\n    };\n    WrapText.prototype.wrapTextHandler = function (args) {\n        if (inView(this.parent, args.range, true)) {\n            var ele = void 0;\n            var cell = void 0;\n            var colwidth = void 0;\n            var isCustomHgt = void 0;\n            var maxHgt = void 0;\n            var hgt = void 0;\n            for (var i = args.range[0]; i <= args.range[2]; i++) {\n                maxHgt = 0;\n                isCustomHgt = getRow(args.sheet, i).customHeight || args.isCustomHgt;\n                for (var j = args.range[1]; j <= args.range[3]; j++) {\n                    cell = getCell(i, j, args.sheet, null, true);\n                    if (cell.rowSpan < 0 || cell.colSpan < 0) {\n                        continue;\n                    }\n                    var isMerge = (cell.rowSpan > 1 || cell.colSpan > 1);\n                    ele = args.initial ? args.td : this.parent.getCell(i, j);\n                    if (ele) {\n                        if (args.wrap) {\n                            ele.classList.add(WRAPTEXT);\n                        }\n                        else {\n                            ele.classList.remove(WRAPTEXT);\n                        }\n                        if (isCustomHgt || isMerge) {\n                            if (ele.children.length === 0 || !ele.querySelector('.e-wrap-content')) {\n                                var styleText = ele.style.cssText;\n                                if (styleText) {\n                                    styleText = styleText.split(';').filter(function (text) { return !text.includes('border'); }).join(';');\n                                }\n                                ele.innerHTML\n                                    = this.parent.createElement('span', {\n                                        className: 'e-wrap-content',\n                                        innerHTML: ele.innerHTML,\n                                        styles: styleText\n                                    }).outerHTML;\n                            }\n                        }\n                    }\n                    if (Browser.isIE) {\n                        ele.classList.add('e-ie-wrap');\n                    }\n                    if (!(isCustomHgt || isMerge)) {\n                        colwidth = getExcludedColumnWidth(args.sheet, i, j, cell.colSpan > 1 ? j + cell.colSpan - 1 : j);\n                        var displayText = this.parent.getDisplayText(cell).toString();\n                        if (displayText.indexOf('\\n') < 0) {\n                            var editElem = this.parent.element.querySelector('.e-spreadsheet-edit');\n                            if (editElem) {\n                                if (editElem.textContent.indexOf('\\n') > -1) {\n                                    displayText = editElem.textContent;\n                                }\n                            }\n                        }\n                        if (displayText) {\n                            if (args.wrap) {\n                                if (ele && ele.classList.contains('e-alt-unwrap')) {\n                                    ele.classList.remove('e-alt-unwrap');\n                                }\n                                var lines = void 0;\n                                var n = 0;\n                                var p = void 0;\n                                if (displayText.indexOf('\\n') > -1) {\n                                    var splitVal = displayText.split('\\n');\n                                    var valLength = splitVal.length;\n                                    for (p = 0; p < valLength; p++) {\n                                        lines = getLines(splitVal[p], colwidth, cell.style, this.parent.cellStyle);\n                                        if (lines === 0) {\n                                            lines = 1; // for empty new line\n                                        }\n                                        n = n + lines;\n                                    }\n                                    lines = n;\n                                }\n                                else {\n                                    lines = getLines(displayText, colwidth, cell.style, this.parent.cellStyle);\n                                }\n                                hgt = getTextHeightWithBorder(this.parent, i, j, args.sheet, cell.style || this.parent.cellStyle, lines);\n                                maxHgt = Math.max(maxHgt, hgt);\n                                if (cell.rowSpan > 1) {\n                                    var prevHeight = getRowsHeight(args.sheet, i, i + (cell.rowSpan - 1));\n                                    if (prevHeight >= maxHgt) {\n                                        return;\n                                    }\n                                    hgt = maxHgt = getRowHeight(args.sheet, i) + (maxHgt - prevHeight);\n                                }\n                                setMaxHgt(args.sheet, i, j, hgt);\n                            }\n                            else {\n                                if (displayText.indexOf('\\n') > -1) {\n                                    ele.classList.add('e-alt-unwrap');\n                                }\n                                hgt = getTextHeightWithBorder(this.parent, i, j, args.sheet, cell.style || this.parent.cellStyle, 1);\n                                setMaxHgt(args.sheet, i, j, hgt);\n                                maxHgt = Math.max(getMaxHgt(args.sheet, i), 20);\n                            }\n                        }\n                        else if (!args.wrap || !displayText) {\n                            setMaxHgt(args.sheet, i, j, 20);\n                            maxHgt = Math.max(getMaxHgt(args.sheet, i), 20);\n                        }\n                        if (j === args.range[3] && ((args.wrap && maxHgt > 20 && getMaxHgt(args.sheet, i) <= maxHgt) || ((!args.wrap ||\n                            !displayText) && getMaxHgt(args.sheet, i) < getRowHeight(args.sheet, i) && getRowHeight(args.sheet, i) > 20))) {\n                            setRowEleHeight(this.parent, args.sheet, maxHgt, i, args.row, args.hRow);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    WrapText.prototype.ribbonClickHandler = function (args) {\n        var target = closest(args.originalEvent.target, '.e-btn');\n        if (target && target.id === this.parent.element.id + '_wrap') {\n            var wrap = target.classList.contains('e-active');\n            var address = getAddressFromSelectedRange(this.parent.getActiveSheet());\n            var eventArgs = { address: address, wrap: wrap, cancel: false };\n            this.parent.notify(beginAction, { action: 'beforeWrap', eventArgs: eventArgs });\n            if (!eventArgs.cancel) {\n                wrapText(this.parent.getActiveSheet().selectedRange, wrap, this.parent);\n                this.parent.notify(completeAction, { action: 'wrap', eventArgs: { address: address, wrap: wrap } });\n            }\n        }\n    };\n    WrapText.prototype.rowHeightChangedHandler = function (args) {\n        if (args.isCustomHgt) {\n            var sheet = this.parent.getActiveSheet();\n            var leftIdx = this.parent.viewport.leftIndex;\n            var rightIdx = leftIdx + this.parent.viewport.colCount + this.parent.getThreshold('col') * 2;\n            for (var i = leftIdx; i < rightIdx; i++) {\n                var cell = getCell(args.rowIdx, i, sheet);\n                if (cell && cell.wrap) {\n                    var ele = this.parent.getCell(args.rowIdx, i);\n                    var styleText = ele.style.cssText;\n                    if (ele.children.length === 0 || !ele.querySelector('.e-wrap-content')) {\n                        ele.innerHTML = this.parent.createElement('span', {\n                            className: 'e-wrap-content',\n                            innerHTML: ele.innerHTML,\n                            styles: styleText\n                        }).outerHTML;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} - Get the module name.\n     * @private\n     */\n    WrapText.prototype.getModuleName = function () {\n        return 'wrapText';\n    };\n    WrapText.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return WrapText;\n}());\nexport { WrapText };\n","import { beginAction, completeAction, insertSheetTab, skipHiddenIdx, refreshImagePosition, focus } from '../common/index';\nimport { beforeInsert, insert } from '../../workbook/common/index';\nimport { getCell } from '../../workbook/index';\n/**\n * The `Insert` module is used to insert cells, rows, columns and sheets in to the spreadsheet.\n */\nvar Insert = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet insert module.\n     *\n     * @param {Spreadsheet} parent - Specify the spreadsheet instance.\n     * @private\n     */\n    function Insert(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Insert.prototype.insert = function (args) {\n        var isAction;\n        if (args.isAction) {\n            isAction = true;\n            delete args.isAction;\n        }\n        if (isAction) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'insert' });\n        }\n        this.parent.notify(beforeInsert, args);\n        switch (args.modelType) {\n            case 'Sheet':\n                this.parent.notify(insertSheetTab, { startIdx: args.index, endIdx: args.index + (args.model.length - 1), preventUpdate: !isAction });\n                this.parent.renderModule.refreshSheet();\n                focus(this.parent.element);\n                break;\n            case 'Row':\n                if (!this.parent.scrollSettings.enableVirtualization || args.index <= this.parent.viewport.bottomIndex) {\n                    if (this.parent.scrollSettings.enableVirtualization) {\n                        if (args.freezePane) {\n                            this.parent.renderModule.refreshSheet();\n                            break;\n                        }\n                        if (args.index < this.parent.viewport.topIndex) {\n                            this.parent.viewport.topIndex += args.model.length;\n                        }\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: this.parent.viewport.topIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                        });\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, rowIndex: args.index, colIndex: 0, refresh: 'Row' });\n                    }\n                    this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n                }\n                break;\n            case 'Column':\n                if (!this.parent.scrollSettings.enableVirtualization || args.index <= this.parent.viewport.rightIndex) {\n                    if (args.freezePane) {\n                        this.parent.renderModule.refreshSheet();\n                        break;\n                    }\n                    if (this.parent.scrollSettings.enableVirtualization) {\n                        if (args.index < this.parent.viewport.leftIndex) {\n                            this.parent.viewport.leftIndex += args.model.length;\n                        }\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column'\n                        });\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: true, rowIndex: 0, colIndex: args.index, refresh: 'Column'\n                        });\n                    }\n                    this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n                }\n                break;\n        }\n        this.refreshImgElement(args.model.length, this.parent.activeSheetIndex, args.modelType, args.index);\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'insert' });\n        }\n    };\n    Insert.prototype.refreshImgElement = function (count, sheetIdx, modelType, index) {\n        var sheet = this.parent.sheets[sheetIdx];\n        var cellObj;\n        var indexes = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n        for (var i = 0; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                cellObj = getCell(i, j, sheet);\n                if (cellObj && cellObj.image && cellObj.image.length > 0) {\n                    if ((modelType === 'Row' && i >= index) || (modelType === 'Column' && j >= index)) {\n                        this.parent.notify(refreshImagePosition, {\n                            rowIdx: i, colIdx: j, sheetIdx: sheetIdx, type: modelType, count: count, status: 'insert'\n                        });\n                    }\n                }\n            }\n        }\n    };\n    Insert.prototype.addEventListener = function () {\n        this.parent.on(insert, this.insert, this);\n    };\n    /**\n     * Destroy insert module.\n     *\n     * @returns {void} - Destroy insert module.\n     */\n    Insert.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Insert.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insert, this.insert);\n        }\n    };\n    /**\n     * Get the insert module name.\n     *\n     * @returns {string} - Get the insert module name.\n     */\n    Insert.prototype.getModuleName = function () {\n        return 'insert';\n    };\n    return Insert;\n}());\nexport { Insert };\n","import { beginAction, completeAction, skipHiddenIdx, refreshSheetTabs, refreshImagePosition, focus } from '../common/index';\nimport { deleteAction } from '../../workbook/common/index';\nimport { getCell } from '../../workbook/index';\n/**\n * The `Delete` module is used to delete cells, rows, columns and sheets from the spreadsheet.\n */\nvar Delete = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet insert module.\n     *\n     * @param {Spreadsheet} parent - Constructor for the Spreadsheet insert module.\n     * @private\n     */\n    function Delete(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Delete.prototype.delete = function (args) {\n        var isAction;\n        if (args.isAction) {\n            isAction = true;\n            delete args.isAction;\n        }\n        if (isAction) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'delete' });\n        }\n        if (args.modelType === 'Sheet') {\n            var activeSheetDeleted = args.activeSheetIndex >= args.startIndex && args.activeSheetIndex <= args.endIndex;\n            if (activeSheetDeleted) {\n                this.parent.setProperties({ activeSheetIndex: this.parent.skipHiddenSheets(args.startIndex < this.parent.sheets.length ? args.startIndex :\n                        (args.startIndex ? args.startIndex - 1 : 0)) }, true);\n            }\n            this.parent.notify(refreshSheetTabs, null);\n            if (activeSheetDeleted) {\n                this.parent.renderModule.refreshSheet();\n            }\n            focus(this.parent.element);\n        }\n        else if (args.modelType === 'Row') {\n            if (!this.parent.scrollSettings.enableVirtualization || args.startIndex <= this.parent.viewport.bottomIndex) {\n                if (args.freezePane) {\n                    this.parent.renderModule.refreshSheet();\n                }\n                else if (this.parent.scrollSettings.enableVirtualization) {\n                    if (args.startIndex < this.parent.viewport.topIndex) {\n                        this.parent.viewport.topIndex -= args.model.length;\n                    }\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: this.parent.viewport.topIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true), rowIndex: this.parent.viewport.topIndex, refresh: 'Row',\n                        colIndex: this.parent.viewport.leftIndex\n                    });\n                    this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n                }\n                else {\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, refresh: 'Row', rowIndex: args.startIndex, colIndex: 0 });\n                    this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n                }\n            }\n        }\n        else {\n            if (!this.parent.scrollSettings.enableVirtualization || args.startIndex <= this.parent.viewport.rightIndex) {\n                if (args.freezePane) {\n                    this.parent.renderModule.refreshSheet();\n                }\n                else if (this.parent.scrollSettings.enableVirtualization) {\n                    if (args.startIndex < this.parent.viewport.leftIndex) {\n                        this.parent.viewport.leftIndex -= args.model.length;\n                    }\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, refresh: 'Column',\n                        colIndex: this.parent.viewport.leftIndex\n                    });\n                    this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n                }\n                else {\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: true, refresh: 'Column', rowIndex: 0,\n                        colIndex: args.startIndex\n                    });\n                    this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n                }\n            }\n        }\n        this.refreshImgElement(args.deletedModel.length, this.parent.activeSheetIndex, args.modelType, args.startIndex);\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'delete' });\n        }\n    };\n    Delete.prototype.refreshImgElement = function (count, sheetIdx, modelType, index) {\n        var sheet = this.parent.sheets[sheetIdx];\n        var cell;\n        var address = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n        for (var i = 0; i <= address[2]; i++) {\n            for (var j = address[1]; j <= address[3]; j++) {\n                cell = getCell(i, j, sheet);\n                if (cell && cell.image && cell.image.length > 0) {\n                    if ((modelType === 'Row' && i >= index) || (modelType === 'Column' && j >= index)) {\n                        this.parent.notify(refreshImagePosition, {\n                            rowIdx: i, colIdx: j, sheetIdx: sheetIdx, type: modelType, count: count, status: 'delete'\n                        });\n                    }\n                }\n            }\n        }\n    };\n    Delete.prototype.addEventListener = function () {\n        this.parent.on(deleteAction, this.delete, this);\n    };\n    /**\n     * Destroy delete module.\n     *\n     * @returns {void} - Destroy delete module.\n     */\n    Delete.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Delete.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(deleteAction, this.delete);\n        }\n    };\n    /**\n     * Get the delete module name.\n     *\n     * @returns {string} - Get the delete module name.\n     */\n    Delete.prototype.getModuleName = function () {\n        return 'delete';\n    };\n    return Delete;\n}());\nexport { Delete };\n","import { editAlert } from '../index';\nimport { isValidation, checkDateFormat, applyCellFormat, workbookEditOperation, activeCellChanged } from '../../workbook/common/event';\nimport { getCell, setCell } from '../../workbook/base/cell';\nimport { FormValidator, NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { EventHandler, remove, closest, isNullOrUndefined, select, Browser } from '@syncfusion/ej2-base';\nimport { dialog, locale, initiateDataValidation, invalidData, editOperation, keyUp, focus } from '../common/index';\nimport { formulaBarOperation, removeDataValidation } from '../common/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { setRow } from '../../workbook/base/row';\nimport { getRangeIndexes, getIndexesFromAddress, getCellIndexes } from '../../workbook/common/address';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { getSheet, getSheetIndex } from '../../workbook/index';\nimport { getColumn, isLocked, getRowsHeight, getColumnsWidth, validationHighlight } from '../../workbook/index';\n/**\n * Represents Data Validation support for Spreadsheet.\n */\nvar DataValidation = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Data Validation module.\n     *\n     * @param {Spreadsheet} parent - Constructor for the Spreadsheet Data Validation module.\n     */\n    function DataValidation(parent) {\n        this.data = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Data Validation module.\n     *\n     * @returns {void}\n     */\n    DataValidation.prototype.destroy = function () {\n        this.removeEventListener();\n        var dataValPopup = select('#' + this.parent.element.id + '_datavalidation-popup');\n        if (dataValPopup) {\n            dataValPopup.remove();\n        }\n        this.parent = null;\n    };\n    DataValidation.prototype.addEventListener = function () {\n        EventHandler.add(this.parent.element, 'dblclick', this.listOpen, this);\n        EventHandler.add(document, 'mousedown', this.mouseDownHandler, this);\n        this.parent.on(initiateDataValidation, this.initiateDataValidationHandler, this);\n        this.parent.on(invalidData, this.invalidDataHandler, this);\n        this.parent.on(isValidation, this.checkDataValidation, this);\n        this.parent.on(activeCellChanged, this.listHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(removeDataValidation, this.removeValidationHandler, this);\n        this.parent.on(validationHighlight, this.InvalidElementHandler, this);\n    };\n    DataValidation.prototype.removeEventListener = function () {\n        EventHandler.remove(this.parent.element, 'dblclick', this.listOpen);\n        EventHandler.remove(document, 'mousedown', this.mouseDownHandler);\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateDataValidation, this.initiateDataValidationHandler);\n            this.parent.off(invalidData, this.invalidDataHandler);\n            this.parent.off(isValidation, this.checkDataValidation);\n            this.parent.off(activeCellChanged, this.listHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(removeDataValidation, this.removeValidationHandler);\n            this.parent.off(validationHighlight, this.InvalidElementHandler);\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    DataValidation.prototype.removeValidationHandler = function (e) {\n        var range = this.getRange(this.parent.getActiveSheet().selectedRange);\n        this.parent.removeDataValidation(range);\n    };\n    DataValidation.prototype.mouseDownHandler = function (e) {\n        var target = e.target;\n        var parEle = closest(target, '.e-ddl');\n        if (parEle && parEle.getAttribute('id') === this.parent.element.id + 'listValid_popup') {\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: target.innerText });\n        }\n    };\n    DataValidation.prototype.keyUpHandler = function (e) {\n        var target = e.target;\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        if (closest(target, '.e-values') && dlgEle && e.keyCode !== 13) {\n            var valuesCont = dlgEle.querySelector('.e-values');\n            var errorEle = valuesCont.querySelector('.e-dlg-error');\n            var footerCont = dlgEle.querySelector('.e-footer-content');\n            var primaryBut = footerCont.querySelector('.e-primary');\n            if (primaryBut.hasAttribute('disabled')) {\n                primaryBut.removeAttribute('disabled');\n            }\n            if (errorEle) {\n                valuesCont.removeChild(errorEle);\n            }\n        }\n    };\n    DataValidation.prototype.listOpen = function (e) {\n        var target = e.target;\n        if (this.listObj && target.classList.contains('e-cell') && target.querySelector('.e-validation-list')) {\n            this.listObj.showPopup();\n        }\n    };\n    DataValidation.prototype.invalidDataHandler = function (args) {\n        if (args.isRemoveHighlight) {\n            this.parent.removeInvalidHighlight();\n        }\n        else {\n            this.parent.addInvalidHighlight();\n        }\n    };\n    DataValidation.prototype.listHandler = function () {\n        var _this = this;\n        if (this.parent.allowDataValidation) {\n            var sheet_1 = this.parent.getActiveSheet();\n            var indexes = getCellIndexes(sheet_1.activeCell);\n            var cell = getCell(indexes[0], indexes[1], sheet_1);\n            var column = getColumn(sheet_1, indexes[1]);\n            var tdEle_1 = this.parent.getCell(indexes[0], indexes[1]);\n            if (!tdEle_1) {\n                return;\n            }\n            if (document.getElementsByClassName('e-validation-list')[0]) {\n                remove(document.getElementsByClassName('e-validation-list')[0]);\n                this.data = [];\n            }\n            var validation = void 0;\n            if (cell && cell.validation) {\n                validation = cell.validation;\n            }\n            else if (column && column.validation) {\n                validation = column.validation;\n            }\n            if (validation && validation.type === 'List') {\n                validation.ignoreBlank = !isNullOrUndefined(validation.ignoreBlank) ? validation.ignoreBlank : true;\n                validation.inCellDropDown = !isNullOrUndefined(validation.inCellDropDown) ?\n                    validation.inCellDropDown : true;\n                if (validation.inCellDropDown) {\n                    var ddlCont = this.parent.createElement('div', { className: 'e-validation-list' });\n                    var ddlEle = this.parent.createElement('input', { id: this.parent.element.id + 'listValid' });\n                    ddlCont.appendChild(ddlEle);\n                    if (!validation.inCellDropDown) {\n                        ddlCont.style.display = 'none';\n                    }\n                    tdEle_1.insertBefore(ddlCont, tdEle_1.firstChild);\n                    var dataSource = this.updateDataSource(cell, validation);\n                    this.listObj = new DropDownList({\n                        index: this.setDropDownListIndex(dataSource, cell, validation),\n                        dataSource: dataSource,\n                        fields: { text: 'text', value: 'id' },\n                        width: '0px',\n                        popupHeight: '200px',\n                        change: function () { return _this.listValueChange(_this.listObj.text); },\n                        open: function (args) {\n                            args.popup.offsetX = -(tdEle_1.offsetWidth - 20) + 4;\n                            args.popup.offsetY = -13;\n                            args.popup.element.style.width = tdEle_1.offsetWidth - 1 + 'px';\n                            // Positioning popup in mobile device based on transform css applied on virtual element as suggested by dropdown team\n                            if (Browser.isDevice && _this.parent.scrollModule) {\n                                var offset = _this.parent.scrollModule.offset;\n                                var viewport = _this.parent.viewport;\n                                args.popup.offsetY += viewport.topIndex ? offset.top.size -\n                                    getRowsHeight(sheet_1, viewport.topIndex + 1, offset.top.idx, true) : 0;\n                                args.popup.offsetX += viewport.leftIndex ? offset.left.size -\n                                    getColumnsWidth(sheet_1, viewport.leftIndex + 1, offset.left.idx, true) : 0;\n                                args.popup.refresh();\n                            }\n                        }\n                    });\n                    this.listObj.appendTo('#' + this.parent.element.id + 'listValid');\n                }\n            }\n            if (cell && cell.validation) {\n                cell.validation = validation;\n            }\n        }\n    };\n    DataValidation.prototype.setDropDownListIndex = function (dataSource, cell, validation) {\n        if (cell && cell.value) {\n            for (var dataIdx = 0, len = dataSource.length; dataIdx < len; dataIdx++) {\n                if (dataSource[dataIdx].text === cell.value.toString()) {\n                    return dataIdx;\n                }\n            }\n        }\n        return null;\n    };\n    DataValidation.prototype.updateDataSource = function (cell, validation) {\n        this.data = [];\n        var count = 0;\n        var value = validation.value1;\n        var isRange = value.indexOf('=') !== -1;\n        if (isRange) {\n            var sheet = value.indexOf('!') > -1 ?\n                getSheet(this.parent, getSheetIndex(this.parent, value.split('=')[1].split('!')[0])) : this.parent.getActiveSheet();\n            var address = value.indexOf('!') > -1 ? value.split('!')[1] : value.split('=')[1];\n            var indexes = void 0;\n            var range = address.split(':');\n            if ((range[0].match(/[a-z]+$/ig) && range[1].match(/[a-z]+$/ig)) || (range[0].match(/^[0-9]/g) && range[1].match(/^[0-9]/g))) {\n                var addressInfo = this.parent.getIndexes(address);\n                if (addressInfo.isCol) {\n                    indexes = [0, addressInfo.startIdx, sheet.usedRange.rowIndex, addressInfo.startIdx];\n                }\n                else {\n                    indexes = [addressInfo.startIdx, 0, addressInfo.startIdx, sheet.usedRange.colIndex];\n                }\n            }\n            else {\n                indexes = getRangeIndexes(address);\n            }\n            for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n                if (!sheet.rows[rowIdx]) {\n                    setRow(sheet, rowIdx, {});\n                }\n                for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                    if (!sheet.rows[rowIdx].cells) {\n                        setCell(rowIdx, colIdx, sheet, {});\n                    }\n                    count += 1;\n                    cell = sheet.rows[rowIdx].cells[colIdx];\n                    var data = this.parent.getDisplayText(cell) || '';\n                    if (validation.ignoreBlank && data === '') {\n                        continue;\n                    }\n                    this.data.push({ text: data, id: 'list-' + count });\n                }\n            }\n        }\n        else {\n            var listValues = value.split(',');\n            for (var idx = 0; idx < listValues.length; idx++) {\n                count += 1;\n                this.data.push({ text: listValues[idx], id: 'list-' + count });\n            }\n        }\n        return this.data;\n    };\n    DataValidation.prototype.listValueChange = function (value) {\n        var sheet = this.parent.getActiveSheet();\n        var cellIdx = getIndexesFromAddress(sheet.activeCell);\n        var cellObj = Object.assign({}, getCell(cellIdx[0], cellIdx[1], sheet));\n        if (sheet.isProtected && isLocked(cellObj, getColumn(sheet, cellIdx[1]))) {\n            this.parent.notify(editAlert, null);\n        }\n        else {\n            this.parent.notify(workbookEditOperation, { action: 'updateCellValue', address: sheet.activeCell, value: value });\n            this.parent.serviceLocator.getService('cell').refreshRange(cellIdx);\n            this.parent.trigger('cellSave', {\n                value: value, oldValue: cellObj && cellObj.value, address: sheet.name + '!' + sheet.activeCell,\n                displayText: this.parent.getDisplayText(getCell(cellIdx[0], cellIdx[1], sheet))\n            });\n        }\n    };\n    DataValidation.prototype.getRange = function (range) {\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getRangeIndexes(range);\n        var maxRowCount = sheet.rowCount;\n        var maxColCount = sheet.colCount;\n        if (indexes[2] === maxRowCount - 1 && indexes[0] === 0) {\n            range = range.replace(/[0-9]/g, '');\n        }\n        else if (indexes[3] === maxColCount - 1 && indexes[2] === 0) {\n            range = range.replace(/\\D/g, '');\n        }\n        return range;\n    };\n    DataValidation.prototype.initiateDataValidationHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var type;\n        var operator;\n        var value1;\n        var value2;\n        var ignoreBlank = true;\n        var inCellDropDown = true;\n        var isNew = true;\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var range = sheet.selectedRange;\n        var indexes = getRangeIndexes(range);\n        range = this.getRange(range);\n        for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n            if (sheet.rows[rowIdx]) {\n                for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                    if (sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[colIdx]) {\n                        cell = sheet.rows[rowIdx].cells[colIdx];\n                        if (cell.validation) {\n                            isNew = false;\n                            type = cell.validation.type;\n                            operator = cell.validation.operator;\n                            value1 = cell.validation.value1;\n                            value2 = cell.validation.value2;\n                            ignoreBlank = !isNullOrUndefined(cell.validation.ignoreBlank) ?\n                                cell.validation.ignoreBlank : ignoreBlank;\n                            inCellDropDown = !isNullOrUndefined(cell.validation.inCellDropDown) ?\n                                cell.validation.inCellDropDown : inCellDropDown;\n                        }\n                    }\n                }\n            }\n        }\n        if (!this.parent.element.querySelector('.e-datavalidation-dlg')) {\n            var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            dialogInst_1.show({\n                width: 375, showCloseIcon: true, isModal: true, cssClass: 'e-datavalidation-dlg',\n                header: l10n.getConstant('DataValidation'),\n                target: document.querySelector('.e-control.e-spreadsheet'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'ValidationDialog', element: args.element,\n                        target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst_1.dialogInstance.content =\n                        _this.dataValidationContent(isNew, type, operator, value1, value2, ignoreBlank, inCellDropDown, range);\n                    dialogInst_1.dialogInstance.dataBind();\n                    focus(_this.parent.element);\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('CLEARALL'),\n                            cssClass: 'e-btn e-clearall-btn e-flat'\n                        },\n                        click: function () {\n                            dialogInst_1.dialogInstance.content =\n                                _this.dataValidationContent(true, type, operator, value1, value2, ignoreBlank, inCellDropDown, range);\n                            dialogInst_1.dialogInstance.dataBind();\n                            focus(_this.parent.element);\n                        }\n                    },\n                    {\n                        buttonModel: {\n                            content: l10n.getConstant('APPLY'), isPrimary: true\n                        },\n                        click: function () {\n                            _this.dlgClickHandler(dialogInst_1);\n                        }\n                    }]\n            });\n            dialogInst_1.dialogInstance.refresh();\n        }\n    };\n    DataValidation.prototype.dataValidationContent = function (isNew, type, operator, val1, val2, ignoreBlank, inCellDropDown, range) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var value1 = isNew ? '0' : val1;\n        var value2 = isNew ? '0' : val2;\n        var dlgContent = this.parent.createElement('div', { className: 'e-validation-dlg' });\n        var cellRangeCont = this.parent.createElement('div', { className: 'e-cellrange' });\n        var allowDataCont = this.parent.createElement('div', { className: 'e-allowdata' });\n        var valuesCont = this.parent.createElement('div', { className: 'e-values' });\n        var ignoreBlankCont = this.parent.createElement('div', { className: 'e-ignoreblank' });\n        dlgContent.appendChild(cellRangeCont);\n        dlgContent.appendChild(allowDataCont);\n        dlgContent.appendChild(valuesCont);\n        dlgContent.appendChild(ignoreBlankCont);\n        var cellRangeText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('CellRange') });\n        var cellRangeEle = this.parent.createElement('input', {\n            className: 'e-input',\n            attrs: { value: range }\n        });\n        cellRangeCont.appendChild(cellRangeText);\n        cellRangeCont.appendChild(cellRangeEle);\n        var allowCont = this.parent.createElement('div', { className: 'e-allow' });\n        var dataCont = this.parent.createElement('div', { className: 'e-data' });\n        allowDataCont.appendChild(allowCont);\n        allowDataCont.appendChild(dataCont);\n        var allowText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Allow') });\n        this.typeData = [\n            { text: l10n.getConstant('WholeNumber'), id: 'type-1' },\n            { text: l10n.getConstant('Decimal'), id: 'type-2' },\n            { text: l10n.getConstant('Date'), id: 'type-3' },\n            { text: l10n.getConstant('Time'), id: 'type-4' },\n            { text: l10n.getConstant('TextLength'), id: 'type-5' },\n            { text: l10n.getConstant('List'), id: 'type-6' }\n        ];\n        this.operatorData = [\n            { text: l10n.getConstant('Between'), id: 'operator-1' },\n            { text: l10n.getConstant('NotBetween'), id: 'operator-2' },\n            { text: l10n.getConstant('EqualTo'), id: 'operator-3' },\n            { text: l10n.getConstant('NotEqualTo'), id: 'operator-4' },\n            { text: l10n.getConstant('Greaterthan'), id: 'operator-5' },\n            { text: l10n.getConstant('Lessthan'), id: 'operator-6' },\n            { text: l10n.getConstant('GreaterThanOrEqualTo'), id: 'operator-7' },\n            { text: l10n.getConstant('LessThanOrEqualTo'), id: 'operator-8' }\n        ];\n        var allowSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        var allowIdx = 0;\n        if (!isNew) {\n            for (var idx = 0; idx < this.typeData.length; idx++) {\n                if (type === this.typeData[idx].text.replace(' ', '')) {\n                    allowIdx = idx;\n                    break;\n                }\n            }\n        }\n        if (isNew || type !== 'List') {\n            var dataIdx = 0;\n            var dataText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Data') });\n            var dataSelectEle = this.parent.createElement('input', { className: 'e-select' });\n            if (!isNew) {\n                for (var idx = 0; idx < this.operatorData.length; idx++) {\n                    if (operator === this.FormattedValue(this.operatorData[idx].text)) {\n                        dataIdx = idx;\n                        break;\n                    }\n                }\n            }\n            dataCont.appendChild(dataText);\n            dataCont.appendChild(dataSelectEle);\n            this.dataList = new DropDownList({\n                dataSource: this.operatorData,\n                index: dataIdx,\n                popupHeight: '200px',\n                change: function () { _this.userInput(listObj, _this.dataList); }\n            });\n            this.dataList.appendTo(dataSelectEle);\n        }\n        else {\n            var ignoreBlankEle_1 = this.parent.createElement('input', { className: 'e-checkbox' });\n            dataCont.appendChild(ignoreBlankEle_1);\n            var ignoreBlankObj_1 = new CheckBox({ label: l10n.getConstant('InCellDropDown'), checked: inCellDropDown });\n            ignoreBlankObj_1.appendTo(ignoreBlankEle_1);\n        }\n        allowCont.appendChild(allowText);\n        allowCont.appendChild(allowSelectEle);\n        var listObj = new DropDownList({\n            dataSource: this.typeData,\n            index: allowIdx,\n            popupHeight: '200px',\n            change: function () { _this.userInput(listObj, _this.dataList); }\n        });\n        listObj.appendTo(allowSelectEle);\n        if (isNew || (listObj.value !== 'List' && (this.dataList.value === 'Between' || this.dataList.value === 'Not between'))) {\n            var minimumCont = this.parent.createElement('div', { className: 'e-minimum' });\n            var maximumCont = this.parent.createElement('div', { className: 'e-maximum' });\n            valuesCont.appendChild(minimumCont);\n            valuesCont.appendChild(maximumCont);\n            var minimumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Minimum') });\n            var maximumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Maximum') });\n            var minimumInp = this.parent.createElement('input', {\n                id: 'minvalue',\n                className: 'e-input', attrs: { value: value1 }\n            });\n            var maximumInp = this.parent.createElement('input', {\n                id: 'maxvalue',\n                className: 'e-input', attrs: { value: value2 }\n            });\n            minimumCont.appendChild(minimumText);\n            minimumCont.appendChild(minimumInp);\n            maximumCont.appendChild(maximumText);\n            maximumCont.appendChild(maximumInp);\n            var numericMin = new NumericTextBox({\n                value: 0\n            });\n            numericMin.appendTo('#minvalue');\n            var numericMax = new NumericTextBox({\n                value: 0\n            });\n            numericMax.appendTo('#maxvalue');\n        }\n        else if (!isNew || type === ' List') {\n            var valueText = this.parent.createElement('span', {\n                className: 'e-header', innerHTML: l10n.getConstant('Sources')\n            });\n            var valueEle = this.parent.createElement('input', { className: 'e-input', attrs: { value: value1 } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n        else {\n            var valueText = this.parent.createElement('span', {\n                className: 'e-header', innerHTML: l10n.getConstant('Value')\n            });\n            var valueEle = this.parent.createElement('input', { className: 'e-input', attrs: { value: value1 } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n        var isChecked = ignoreBlank;\n        var ignoreBlankEle = this.parent.createElement('input', { className: 'e-checkbox' });\n        ignoreBlankCont.appendChild(ignoreBlankEle);\n        var ignoreBlankObj = new CheckBox({ label: l10n.getConstant('IgnoreBlank'), checked: isChecked });\n        ignoreBlankObj.appendTo(ignoreBlankEle);\n        return dlgContent;\n    };\n    DataValidation.prototype.userInput = function (listObj, listObj1) {\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        var dlgCont = dlgEle.querySelector('.e-validation-dlg');\n        var allowDataCont = dlgCont.querySelector('.e-allowdata');\n        var valuesCont = dlgCont.querySelector('.e-values');\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dataCont = allowDataCont.querySelector('.e-data');\n        while (valuesCont.lastChild) {\n            valuesCont.removeChild(valuesCont.lastChild);\n        }\n        if (listObj.value === 'List') {\n            while (dataCont.lastChild) {\n                dataCont.removeChild(dataCont.lastChild);\n            }\n            var ignoreBlankEle = this.parent.createElement('input', { className: 'e-checkbox' });\n            dataCont.appendChild(ignoreBlankEle);\n            var ignoreBlankObj = new CheckBox({ label: l10n.getConstant('InCellDropDown'), checked: true });\n            ignoreBlankObj.appendTo(ignoreBlankEle);\n        }\n        else {\n            if (dataCont.getElementsByClassName('e-checkbox-wrapper')[0]) {\n                while (dataCont.lastChild) {\n                    dataCont.removeChild(dataCont.lastChild);\n                }\n                var dataText = this.parent.createElement('span', { className: 'e-header', innerHTML: 'Data' });\n                var dataSelectEle = this.parent.createElement('input', { className: 'e-select' });\n                dataCont.appendChild(dataText);\n                dataCont.appendChild(dataSelectEle);\n                listObj1.appendTo(dataSelectEle);\n            }\n        }\n        if (listObj.value !== 'List' && (listObj1.value === 'Between' || listObj1.value === 'Not between')) {\n            var minimumCont = this.parent.createElement('div', { className: 'e-minimum' });\n            var maximumCont = this.parent.createElement('div', { className: 'e-maximum' });\n            valuesCont.appendChild(minimumCont);\n            valuesCont.appendChild(maximumCont);\n            var minimumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Minimum') });\n            var maximumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Maximum') });\n            var minimumInp = this.parent.createElement('input', { id: 'min', className: 'e-input', attrs: { value: '0' } });\n            var maximumInp = this.parent.createElement('input', { id: 'max', className: 'e-input', attrs: { value: '0' } });\n            var numericMin = new NumericTextBox({\n                value: 0\n            });\n            numericMin.appendTo('min');\n            var numericMax = new NumericTextBox({\n                value: 0\n            });\n            numericMax.appendTo('max');\n            minimumCont.appendChild(minimumText);\n            minimumCont.appendChild(minimumInp);\n            maximumCont.appendChild(maximumText);\n            maximumCont.appendChild(maximumInp);\n        }\n        else {\n            var text = listObj.value === 'List' ? l10n.getConstant('Sources') : l10n.getConstant('Value');\n            var valueText = this.parent.createElement('span', { className: 'e-header', innerHTML: text });\n            var valueEle = listObj.value === 'List' ? this.parent.createElement('input', {\n                className: 'e-input',\n                attrs: { placeholder: 'Enter value' }\n            }) :\n                this.parent.createElement('input', { className: 'e-input', attrs: { value: '0' } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n    };\n    DataValidation.prototype.dlgClickHandler = function (dialogInst) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var isValidList = true;\n        var errorMsg;\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        var dlgFooter = dlgEle.querySelector('.e-footer-content');\n        var dlgContEle = dlgEle.getElementsByClassName('e-dlg-content')[0].\n            getElementsByClassName('e-validation-dlg')[0];\n        var allowData = dlgContEle.getElementsByClassName('e-allowdata')[0];\n        var allowEle = allowData.getElementsByClassName('e-allow')[0].getElementsByTagName('input')[0];\n        var dataEle = allowData.getElementsByClassName('e-data')[0].getElementsByTagName('input')[0];\n        var values = dlgContEle.getElementsByClassName('e-values')[0];\n        var value1 = values.getElementsByTagName('input')[0].value;\n        var value2 = values.getElementsByTagName('input')[1] ? values.getElementsByTagName('input')[1].value : '';\n        var ignoreBlank = dlgContEle.querySelector('.e-ignoreblank').querySelector('.e-checkbox-wrapper').\n            getAttribute('aria-checked') === 'true' ? true : false;\n        var inCellDropDown = allowData.querySelector('.e-data').querySelector('.e-checkbox-wrapper') ?\n            allowData.querySelector('.e-data').querySelector('.e-checkbox-wrapper').querySelector('.e-check') ? true : false : null;\n        var range = dlgContEle.querySelector('.e-cellrange').getElementsByTagName('input')[0].value;\n        var operator;\n        var type = allowEle.value;\n        if (dataEle) {\n            operator = dataEle.value;\n            operator = this.FormattedValue(operator);\n        }\n        if (type) {\n            type = type.replace(' ', '');\n        }\n        var rangeAdd = [];\n        var valArr = [];\n        if (value1 !== '') {\n            valArr.push(value1);\n        }\n        if (value2 !== '') {\n            valArr.push(value2);\n        }\n        if (type === 'List') {\n            if (value1.indexOf('=') !== -1) {\n                if (value1.indexOf(':') !== -1) {\n                    var address = value1.indexOf('!') > -1 ? value1.split('!')[1] : value1.split('=')[1];\n                    var isSheetNameValid = value1.indexOf('!') > -1 ?\n                        getSheetIndex(this.parent, value1.split('=')[1].split('!')[0]) > -1 : true;\n                    rangeAdd = address.split(':');\n                    var isSingleCol = address.match(/[a-z]/gi) ?\n                        rangeAdd[0].replace(/[0-9]/g, '') === rangeAdd[1].replace(/[0-9]/g, '') : false;\n                    var isSingleRow = address.match(/\\d/g) ?\n                        rangeAdd[0].replace(/\\D/g, '') === rangeAdd[1].replace(/\\D/g, '') : false;\n                    isValidList = isSheetNameValid ? (isSingleCol ? true : isSingleRow ? true : false) : false;\n                    if (!isValidList) {\n                        errorMsg = l10n.getConstant('DialogError');\n                    }\n                }\n            }\n            else if (value1.length > 256) {\n                isValidList = false;\n                errorMsg = l10n.getConstant('ListLengthError');\n            }\n        }\n        if (type !== 'List' || isValidList) {\n            var sheet = this.parent.getActiveSheet();\n            var format = type;\n            var validDlg = this.isDialogValidator(valArr, format, operator);\n            errorMsg = validDlg.errorMsg;\n            isValidList = validDlg.isValidate;\n            if (isValidList) {\n                var indexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n                if (sheet && sheet.rows[indexes[0]] && sheet.rows[indexes[0]].cells[indexes[1]] &&\n                    sheet.rows[indexes[0]].cells[indexes[1]].validation &&\n                    sheet.rows[indexes[0]].cells[indexes[1]].validation.type === 'List') {\n                    var tdEle = this.parent.getMainContent().\n                        getElementsByTagName('tr')[indexes[0]].getElementsByClassName('e-cell')[indexes[1]];\n                    if (tdEle && tdEle.getElementsByClassName('e-validation-list')[0]) {\n                        tdEle.removeChild(tdEle.getElementsByClassName('e-validation-list')[0]);\n                        this.listObj.destroy();\n                    }\n                }\n                var rules = {\n                    type: type, operator: operator,\n                    value1: value1, value2: value2, ignoreBlank: ignoreBlank, inCellDropDown: inCellDropDown\n                };\n                this.parent.addDataValidation(rules, range);\n                if (type === 'List' && isValidList) {\n                    this.listHandler();\n                }\n                if (!document.getElementsByClassName('e-validationerror-dlg')[0]) {\n                    if (dialogInst.dialogInstance) {\n                        dialogInst.dialogInstance.hide();\n                    }\n                    else {\n                        dialogInst.hide();\n                    }\n                }\n            }\n        }\n        if (!isValidList) {\n            var errorEle = this.parent.createElement('div', {\n                className: 'e-dlg-error', id: 'e-invalid', innerHTML: errorMsg\n            });\n            values.appendChild(errorEle);\n            dlgFooter.querySelector('.e-primary').setAttribute('disabled', 'true');\n        }\n    };\n    DataValidation.prototype.FormattedValue = function (value) {\n        switch (value) {\n            case 'Between':\n                value = 'Between';\n                break;\n            case 'Not between':\n                value = 'NotBetween';\n                break;\n            case 'Equal to':\n                value = 'EqualTo';\n                break;\n            case 'Not equal to':\n                value = 'NotEqualTo';\n                break;\n            case 'Greater than':\n                value = 'GreaterThan';\n                break;\n            case 'Less than':\n                value = 'LessThan';\n                break;\n            case 'Greater than or equal to':\n                value = 'GreaterThanOrEqualTo';\n                break;\n            case 'Less than or equal to':\n                value = 'LessThanOrEqualTo';\n                break;\n            default:\n                value = 'Between';\n                break;\n        }\n        return value;\n    };\n    DataValidation.prototype.isDialogValidator = function (values, type, operator) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var count = 0;\n        var isEmpty = false;\n        var formValidation;\n        if (type === 'List') {\n            isEmpty = values.length > 0 ? false : true;\n        }\n        else {\n            if (operator === 'Between' || operator === 'NotBetween') {\n                isEmpty = values.length === 2 ? false : true;\n            }\n            else {\n                isEmpty = values.length > 0 ? false : true;\n            }\n        }\n        if (!isEmpty) {\n            for (var idx = 0; idx < values.length; idx++) {\n                formValidation = this.formatValidation(values[idx], type);\n                if (formValidation.isValidate) {\n                    count = count + 1;\n                }\n                else {\n                    break;\n                }\n            }\n            formValidation.isValidate = count === values.length ? true : false;\n        }\n        else {\n            formValidation = { isValidate: false, errorMsg: l10n.getConstant('EmptyError') };\n        }\n        return { isValidate: formValidation.isValidate, errorMsg: formValidation.errorMsg };\n    };\n    DataValidation.prototype.isValidationHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.value = args.value ? args.value : '';\n        var isValidate;\n        var errorMsg;\n        var enterValue = args.value;\n        var sheet = this.parent.sheets[args.sheetIdx];\n        var validation;\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var column = getColumn(sheet, args.range[1]);\n        if (cell && cell.validation) {\n            validation = cell.validation;\n        }\n        else if (column && column.validation) {\n            validation = column.validation;\n        }\n        if (validation) {\n            var value = args.value;\n            var value1 = validation.value1;\n            var value2 = validation.value2;\n            var opt = validation.operator;\n            var type = validation.type;\n            var ignoreBlank = !isNullOrUndefined(validation.ignoreBlank) ? validation.ignoreBlank : true;\n            var formValidation = this.formatValidation(args.value, type);\n            isValidate = formValidation.isValidate;\n            errorMsg = formValidation.errorMsg;\n            if (isValidate) {\n                isValidate = false;\n                if (type === 'Date' || type === 'Time') {\n                    args.value = args.value.slice(args.value.indexOf(' ') + 1, args.value.length);\n                    for (var idx = 0; idx <= 3; idx++) {\n                        args.value = idx === 0 ? args.value : idx === 1 ? validation.value1 : validation.value2;\n                        var dateEventArgs = {\n                            value: args.value,\n                            rowIndex: args.range[0],\n                            colIndex: args.range[1],\n                            sheetIndex: args.sheetIdx,\n                            updatedVal: ''\n                        };\n                        if (args.value !== '') {\n                            this.parent.notify(checkDateFormat, dateEventArgs);\n                        }\n                        var updatedVal = dateEventArgs.updatedVal;\n                        if (idx == 0 && updatedVal == '') {\n                            value = args.value;\n                        }\n                        else if (idx == 0) {\n                            value = updatedVal;\n                        }\n                        else if (idx == 1) {\n                            value1 = updatedVal;\n                        }\n                        else {\n                            value2 = updatedVal;\n                        }\n                    }\n                }\n                else if (validation.type === 'TextLength') {\n                    value = args.value.toString().length.toString();\n                }\n                if (type === 'List') {\n                    if (value1.indexOf('=') !== -1) {\n                        for (var idx = 0; idx < this.data.length; idx++) {\n                            if (args.value.toString() === this.data[idx].text) {\n                                isValidate = true;\n                            }\n                        }\n                    }\n                    else {\n                        var values = value1.split(',');\n                        for (var idx = 0; idx < values.length; idx++) {\n                            if (args.value.toString() === values[idx]) {\n                                isValidate = true;\n                            }\n                        }\n                    }\n                }\n                else {\n                    if (type === 'Decimal' || type === 'Time') {\n                        value = parseFloat(value.toString());\n                        value1 = parseFloat(value1.toString());\n                        value2 = value2 ? parseFloat(value2.toString()) : null;\n                    }\n                    else {\n                        value = parseInt(value.toString(), 10);\n                        value1 = parseInt(value1.toString(), 10);\n                        value2 = value2 ? parseInt(value2.toString(), 10) : null;\n                    }\n                    switch (opt) {\n                        case 'EqualTo':\n                            if (value === value1) {\n                                isValidate = true;\n                            }\n                            else if (ignoreBlank && enterValue === '') {\n                                isValidate = true;\n                            }\n                            else {\n                                isValidate = false;\n                            }\n                            break;\n                        case 'NotEqualTo':\n                            if (value !== value1) {\n                                isValidate = true;\n                            }\n                            else if (ignoreBlank && enterValue === '') {\n                                isValidate = true;\n                            }\n                            else {\n                                isValidate = false;\n                            }\n                            break;\n                        case 'Between':\n                            if (value >= value1 && value <= value2) {\n                                isValidate = true;\n                            }\n                            else if (ignoreBlank && enterValue === '') {\n                                isValidate = true;\n                            }\n                            else {\n                                isValidate = false;\n                            }\n                            break;\n                        case 'NotBetween':\n                            if (value >= value1 && value <= value2) {\n                                isValidate = false;\n                            }\n                            else if (ignoreBlank && enterValue === '') {\n                                isValidate = true;\n                            }\n                            else {\n                                isValidate = true;\n                            }\n                            break;\n                        case 'GreaterThan':\n                            if (value > value1) {\n                                isValidate = true;\n                            }\n                            else if (ignoreBlank && enterValue === '') {\n                                isValidate = true;\n                            }\n                            else {\n                                isValidate = false;\n                            }\n                            break;\n                        case 'LessThan':\n                            if (value < value1) {\n                                isValidate = true;\n                            }\n                            else if (ignoreBlank && enterValue === '') {\n                                isValidate = true;\n                            }\n                            else {\n                                isValidate = false;\n                            }\n                            break;\n                        case 'GreaterThanOrEqualTo':\n                            if (value >= value1) {\n                                isValidate = true;\n                            }\n                            else if (ignoreBlank && enterValue === '') {\n                                isValidate = true;\n                            }\n                            else {\n                                isValidate = false;\n                            }\n                            break;\n                        case 'LessThanOrEqualTo':\n                            if (value <= value1) {\n                                isValidate = true;\n                            }\n                            else if (ignoreBlank && enterValue === '') {\n                                isValidate = true;\n                            }\n                            else {\n                                isValidate = false;\n                            }\n                            break;\n                        default:\n                            break;\n                    }\n                }\n            }\n        }\n        errorMsg = l10n.getConstant('ValidationError');\n        if (isValidate) {\n            var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [args.range[0], args.range[1]]);\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: args.range[0],\n                colIdx: args.range[1], isHeightCheckNeeded: true, manualUpdate: true,\n                onActionUpdate: true\n            });\n        }\n        return { isValidate: isValidate, errorMsg: errorMsg };\n    };\n    DataValidation.prototype.checkDataValidation = function (args) {\n        var isValid = this.isValidationHandler({\n            value: args.value, range: args.range, sheetIdx: args.sheetIdx\n        });\n        if (!isValid.isValidate && args.isCell) {\n            this.validationErrorHandler(isValid.errorMsg);\n        }\n        this.parent.allowDataValidation = isValid.isValidate;\n    };\n    DataValidation.prototype.formatValidation = function (value, type) {\n        var sheetPanel = this.parent.element.getElementsByClassName('e-sheet-panel')[0];\n        var errorMsg;\n        var formEle = this.parent.createElement('form', {\n            id: 'formId',\n            className: 'form-horizontal'\n        });\n        var inputEle = this.parent.createElement('input', {\n            id: 'e-validation', innerHTML: value\n        });\n        inputEle.setAttribute('name', 'validation');\n        inputEle.setAttribute('type', 'text');\n        inputEle.setAttribute('value', value);\n        formEle.appendChild(inputEle);\n        sheetPanel.appendChild(formEle);\n        var options;\n        switch (type) {\n            case 'Date':\n                options = {\n                    rules: {\n                        'validation': { date: true }\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            case 'Decimal':\n                options = {\n                    rules: {\n                        'validation': { number: true }\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            case 'WholeNumber':\n                options = {\n                    rules: {\n                        'validation': { regex: /^\\d*\\.?[0]*$/ }\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            default:\n                break;\n        }\n        var formObj = new FormValidator('#formId', options);\n        var isValidate = formObj.validate();\n        sheetPanel.removeChild(sheetPanel.getElementsByClassName('form-horizontal')[0]);\n        return { isValidate: isValidate, errorMsg: errorMsg };\n    };\n    DataValidation.prototype.InvalidElementHandler = function (args) {\n        var rowIdx = args.rowIdx;\n        var colIdx = args.colIdx;\n        var isRemoveHighlightedData = args.isRemoveHighlightedData;\n        if (!isRemoveHighlightedData) {\n            this.parent.notify(applyCellFormat, {\n                style: { backgroundColor: '#ffff00', color: '#ff0000' }, rowIdx: rowIdx, colIdx: colIdx, cell: args.td\n            });\n        }\n        else if (isRemoveHighlightedData) {\n            var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rowIdx, colIdx]);\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rowIdx, colIdx: colIdx, cell: args.td\n            });\n        }\n    };\n    DataValidation.prototype.validationErrorHandler = function (error) {\n        var _this = this;\n        var el = document.getElementsByClassName('e-spreadsheet-edit')[0];\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.parent.element.querySelector('.e-validationerror-dlg')) {\n            var erroDialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            var disableCancel = false;\n            var dlgModel = {\n                width: 400, height: 200, isModal: true, showCloseIcon: true, cssClass: 'e-validationerror-dlg',\n                target: document.querySelector('.e-control.e-spreadsheet'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'ValidationErrorDialog',\n                        element: args.element, target: args.target, cancel: args.cancel, content: error\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        _this.errorDlgHandler(erroDialogInst_1, 'Cancel');\n                        args.cancel = true;\n                    }\n                    el.focus();\n                    erroDialogInst_1.dialogInstance.content = dlgArgs.content;\n                    erroDialogInst_1.dialogInstance.dataBind();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Retry'), isPrimary: true\n                        },\n                        click: function () {\n                            _this.errorDlgHandler(erroDialogInst_1, 'Retry');\n                        }\n                    },\n                    {\n                        buttonModel: {\n                            content: l10n.getConstant('Cancel')\n                        },\n                        click: function () {\n                            _this.errorDlgHandler(erroDialogInst_1, 'Cancel');\n                        }\n                    }]\n            };\n            erroDialogInst_1.show(dlgModel, disableCancel);\n        }\n    };\n    DataValidation.prototype.errorDlgHandler = function (errorDialogInst, buttonName) {\n        if (buttonName === 'Retry') {\n            var el = document.getElementsByClassName('e-spreadsheet-edit')[0];\n            errorDialogInst.hide();\n            if (el.innerText) {\n                var range = document.createRange();\n                range.setStart(el.childNodes[0], 0);\n                range.setEnd(el.childNodes[0], el.innerText.length);\n                var selection = window.getSelection();\n                selection.removeAllRanges();\n                selection.addRange(range);\n                if (this.listObj) {\n                    this.listObj.showPopup();\n                }\n            }\n        }\n        else {\n            var indexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n            var cell = getCell(indexes[0], indexes[1], this.parent.getActiveSheet());\n            var value = cell ? this.parent.getDisplayText(cell) : '';\n            this.parent.notify(editOperation, {\n                action: 'cancelEdit', value: value, refreshFormulaBar: true,\n                refreshEditorElem: true, isAppend: false, trigEvent: true\n            });\n            errorDialogInst.hide();\n        }\n    };\n    /**\n     * Gets the module name.\n     *\n     * @returns {string} - Gets the module name.\n     */\n    DataValidation.prototype.getModuleName = function () {\n        return 'dataValidation';\n    };\n    return DataValidation;\n}());\nexport { DataValidation };\n","import { getUpdateUsingRaf } from '../index';\nimport { applyProtect, protectSheet, protectCellFormat, editAlert, enableFormulaInput, protectWorkbook, keyUp } from '../common/event';\nimport { unProtectWorkbook, getPassWord, importProtectWorkbook } from '../common/event';\nimport { clearCopy, protectSelection, clearUndoRedoCollection, focus } from '../common/index';\nimport { ListView } from '@syncfusion/ej2-lists';\nimport { EventHandler, closest } from '@syncfusion/ej2-base';\nimport { locale, updateToggleItem, dialog } from '../common/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { applyLockCells, setCell } from '../../workbook/index';\n/**\n * The `Protect-sheet` module is used to handle the Protecting functionalities in Spreadsheet.\n */\nvar ProtectSheet = /** @class */ (function () {\n    /**\n     * Constructor for protectSheet module in Spreadsheet.\n     *\n     * @param {Spreadsheet} parent - Specify the spreadsheet.\n     * @private\n     */\n    function ProtectSheet(parent) {\n        this.password = '';\n        this.parent = parent;\n        this.init();\n    }\n    ProtectSheet.prototype.init = function () {\n        this.addEventListener();\n    };\n    /**\n     * To destroy the protectSheet module.\n     *\n     * @returns {void} - To destroy the protectSheet module.\n     * @hidden\n     */\n    ProtectSheet.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    ProtectSheet.prototype.addEventListener = function () {\n        this.parent.on(applyProtect, this.protect, this);\n        this.parent.on(protectSheet, this.protectSheetHandler, this);\n        this.parent.on(editAlert, this.editProtectedAlert, this);\n        this.parent.on(applyLockCells, this.lockCellsHandler, this);\n        this.parent.on(protectWorkbook, this.protectWorkbook, this);\n        this.parent.on(keyUp, this.KeyUpHandler, this);\n        this.parent.on(unProtectWorkbook, this.unProtectWorkbook, this);\n        this.parent.on(getPassWord, this.getPassWord, this);\n        this.parent.on(importProtectWorkbook, this.importProtectWorkbook, this);\n    };\n    ProtectSheet.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyProtect, this.protect);\n            this.parent.off(protectSheet, this.protectSheetHandler);\n            this.parent.off(editAlert, this.editProtectedAlert);\n            this.parent.off(applyLockCells, this.lockCellsHandler);\n            this.parent.off(protectWorkbook, this.protectWorkbook);\n            this.parent.off(keyUp, this.KeyUpHandler);\n            this.parent.off(unProtectWorkbook, this.unProtectWorkbook);\n            this.parent.off(getPassWord, this.getPassWord);\n            this.parent.off(importProtectWorkbook, this.importProtectWorkbook);\n        }\n    };\n    ProtectSheet.prototype.protect = function (args) {\n        this.parent.notify(clearCopy, null);\n        if (!args.isActive) {\n            this.createDialogue();\n        }\n        else {\n            this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', false);\n            this.parent.notify(updateToggleItem, { props: 'Protect' });\n            this.parent.notify(protectSheet, { isActive: args.isActive });\n            this.parent.notify(protectSelection, null);\n        }\n    };\n    ProtectSheet.prototype.createDialogue = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var listData = [\n            { text: l10n.getConstant('SelectCells'), id: '1' },\n            { text: l10n.getConstant('FormatCells'), id: '2' },\n            { text: l10n.getConstant('FormatRows'), id: '3' },\n            { text: l10n.getConstant('FormatColumns'), id: '4' },\n            { text: l10n.getConstant('InsertLinks'), id: '5' }\n        ];\n        this.optionList = new ListView({\n            width: '250px',\n            dataSource: listData,\n            showCheckBox: true,\n            select: this.dialogOpen.bind(this)\n        });\n        var protectHeaderCntent = this.parent.createElement('div', { className: 'e-protect-content',\n            innerHTML: l10n.getConstant('ProtectAllowUser') });\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', false);\n        var checkbox = new CheckBox({ checked: true, label: l10n.getConstant('ProtectContent'), cssClass: 'e-protect-checkbox' });\n        var listViewElement = this.parent.createElement('div', { className: 'e-protect-option-list',\n            id: this.parent.element.id + '_option_list' });\n        var headerContent = this.parent.createElement('div', { className: 'e-header-content', innerHTML: l10n.getConstant('ProtectSheet') });\n        var checkBoxElement = this.parent.createElement('input', { id: this.parent.element.id + '_protect_check', attrs: { type: 'checkbox' } });\n        this.dialog = this.parent.serviceLocator.getService('dialog');\n        this.dialog.show({\n            header: headerContent.outerHTML,\n            content: checkBoxElement.outerHTML + protectHeaderCntent.outerHTML + listViewElement.outerHTML,\n            showCloseIcon: true, isModal: true,\n            cssClass: 'e-protect-dlg',\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'ProtectSheetDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                focus(_this.parent.element);\n            },\n            open: function () {\n                _this.okBtnFocus();\n            },\n            beforeClose: function () {\n                var checkboxElement = document.getElementById(_this.parent.element.id + '_protect_check');\n                EventHandler.remove(checkboxElement, 'focus', _this.okBtnFocus);\n                EventHandler.remove(checkbox.element, 'click', _this.checkBoxClickHandler);\n                focus(_this.parent.element);\n            },\n            buttons: [{ click: (this.selectOption.bind(this, this.dialog, this)),\n                    buttonModel: { content: l10n.getConstant('Ok'), isPrimary: true } }]\n        });\n        checkbox.appendTo('#' + this.parent.element.id + '_protect_check');\n        this.optionList.appendTo('#' + this.parent.element.id + '_option_list');\n        this.optionList.selectMultipleItems([{ id: '1' }]);\n        EventHandler.add(checkbox.element, 'click', this.checkBoxClickHandler, this);\n    };\n    ProtectSheet.prototype.okBtnFocus = function () {\n        var _this = this;\n        var checkboxElement = document.getElementById(this.parent.element.id + '_protect_check');\n        checkboxElement.addEventListener('focus', function () {\n            _this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n        });\n    };\n    ProtectSheet.prototype.checkBoxClickHandler = function () {\n        var ch = document.getElementById(this.parent.element.id + '_protect_check');\n        if (ch.checked === false) {\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').disabled = true;\n        }\n        else {\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').disabled = false;\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n        }\n    };\n    ProtectSheet.prototype.dialogOpen = function () {\n        this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n    };\n    ProtectSheet.prototype.selectOption = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var selectedItems = this.optionList.getSelectedItems();\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', true);\n        var protectSettings = { selectCells: selectedItems.text.indexOf(l10n.getConstant('SelectCells')) > -1,\n            formatCells: selectedItems.text.indexOf(l10n.getConstant('FormatCells')) > -1,\n            formatRows: selectedItems.text.indexOf(l10n.getConstant('FormatRows')) > -1,\n            formatColumns: selectedItems.text.indexOf(l10n.getConstant('FormatColumns')) > -1,\n            insertLink: selectedItems.text.indexOf(l10n.getConstant('InsertLinks')) > -1 };\n        this.parent.protectSheet(null, protectSettings);\n        this.parent.notify(protectSelection, null);\n        this.parent.notify(clearUndoRedoCollection, null);\n        this.dialog.hide();\n    };\n    ProtectSheet.prototype.protectSheetHandler = function () {\n        var sheet = this.parent.getActiveSheet();\n        var id = this.parent.element.id;\n        var disableHomeBtnId = [id + '_undo', id + '_redo', id + '_cut', id + '_copy', id + '_paste', id + '_number_format',\n            id + '_font_name', id + '_font_size', id + '_bold', id + '_italic', id + '_line-through', id + '_underline',\n            id + '_font_color_picker', id + '_fill_color_picker', id + '_borders', id + '_merge_cells', id + '_text_align',\n            id + '_vertical_align', id + '_wrap', id + '_sorting', id + '_clear', id + '_conditionalformatting'];\n        var enableHomeBtnId = [id + '_cut', id + '_copy', id + '_number_format', id + '_font_name', id + '_font_size',\n            id + '_bold', id + '_italic', id + '_line-through', id + '_underline', id + '_font_color_picker', id + '_fill_color_picker',\n            id + '_borders', id + '_text_align', id + '_vertical_align', id + '_wrap', id + '_sorting',\n            id + '_clear', id + '_conditionalformatting'];\n        var enableFrmlaBtnId = [id + '_insert_function'];\n        var enableInsertBtnId = [id + '_hyperlink', id + '_', id + '_chart'];\n        var imageBtnId = [id + '_'];\n        var findBtnId = [id + '_find'];\n        var dataValidationBtnId = [id + '_datavalidation'];\n        var chartBtnId = [id + '_chart'];\n        var sheetElement = document.getElementById(this.parent.element.id + '_sheet_panel');\n        if (sheetElement) {\n            if ((sheet.isProtected && sheet.protectSettings.selectCells)) {\n                {\n                    sheetElement.classList.remove('e-protected');\n                }\n            }\n            else {\n                sheetElement.classList.add('e-protected');\n            }\n            if (!sheet.isProtected) {\n                sheetElement.classList.remove('e-protected');\n            }\n        }\n        this.parent.dataBind();\n        this.parent.notify(protectCellFormat, { disableHomeBtnId: disableHomeBtnId,\n            enableHomeBtnId: enableHomeBtnId, enableFrmlaBtnId: enableFrmlaBtnId, enableInsertBtnId: enableInsertBtnId,\n            findBtnId: findBtnId, dataValidationBtnId: dataValidationBtnId, imageBtnId: imageBtnId, chartBtnId: chartBtnId });\n        this.parent.notify(enableFormulaInput, null);\n        if (sheet.isProtected) {\n            this.parent.notify(updateToggleItem, { props: 'Protect' });\n        }\n    };\n    ProtectSheet.prototype.editProtectedAlert = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.dialog = this.parent.serviceLocator.getService('dialog');\n        this.dialog.show({\n            content: l10n.getConstant('EditAlert'),\n            isModal: true,\n            closeOnEscape: true,\n            showCloseIcon: true,\n            width: '400px',\n            cssClass: 'e-editAlert-dlg',\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'EditAlertDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                    getUpdateUsingRaf(function () { return _this.dialog.destroyDialog(); });\n                }\n                focus(_this.parent.element);\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n    };\n    ProtectSheet.prototype.lockCellsHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cellObj = { isLocked: args.isLocked ? args.isLocked : false };\n        setCell(args.rowIdx, args.colIdx, sheet, cellObj, true);\n    };\n    ProtectSheet.prototype.protectWorkbook = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-protectworkbook-dlg',\n            header: l10n.getConstant('ProtectWorkbook'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'ProtectWorkbook',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                dialogInst.dialogInstance.content = _this.passwordProtectContent();\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'), isPrimary: true\n                    },\n                    click: function () {\n                        _this.alertMessage();\n                        _this.dlgClickHandler(dialogInst);\n                    }\n                }]\n        });\n    };\n    ProtectSheet.prototype.passwordProtectContent = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogElem = this.parent.createElement('div', { className: 'e-password-dialog' });\n        var pwdCont = this.parent.createElement('div', { className: 'e-password-content' });\n        var cnfrmPwdCont = this.parent.createElement('div', { className: 'e-password-content' });\n        var textH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('Password') });\n        var urlH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('ConfirmPassword') });\n        var pwdInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'password' } });\n        var cnfrmPwdInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'password' } });\n        pwdInput.setAttribute('placeholder', l10n.getConstant('EnterThePassword'));\n        cnfrmPwdInput.setAttribute('placeholder', l10n.getConstant('EnterTheConfirmPassword'));\n        pwdCont.appendChild(pwdInput);\n        pwdCont.insertBefore(textH, pwdInput);\n        cnfrmPwdCont.appendChild(cnfrmPwdInput);\n        cnfrmPwdCont.insertBefore(urlH, cnfrmPwdInput);\n        dialogElem.appendChild(cnfrmPwdCont);\n        dialogElem.insertBefore(pwdCont, cnfrmPwdCont);\n        return dialogElem;\n    };\n    ProtectSheet.prototype.KeyUpHandler = function (e) {\n        var trgt = e.target;\n        if (trgt.classList.contains('e-text') && closest(trgt, '.e-password-content')) {\n            if (closest(trgt, '.e-password-dialog') && closest(trgt, '.e-password-dialog').\n                getElementsByClassName('e-password-content')[1] === trgt.parentElement) {\n                var dlgEle = closest(trgt, '.e-protectworkbook-dlg');\n                var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n                var okBtn = ftrEle.firstChild;\n                if (trgt.value !== '') {\n                    okBtn.removeAttribute('disabled');\n                }\n                else {\n                    okBtn.setAttribute('disabled', 'true');\n                }\n            }\n        }\n        if (trgt.classList.contains('e-text') && closest(trgt, '.e-unprotectpwd-content')) {\n            if (closest(trgt, '.e-unprotectpwd-dialog') && closest(trgt, '.e-unprotectpwd-dialog').\n                getElementsByClassName('e-unprotectpwd-content')[0] === trgt.parentElement) {\n                var dlgElement = closest(trgt, '.e-unprotectworkbook-dlg');\n                var ftrElement = dlgElement.getElementsByClassName('e-footer-content')[0];\n                var okButton = ftrElement.firstChild;\n                if (trgt.value !== '') {\n                    okButton.removeAttribute('disabled');\n                }\n                else {\n                    okButton.setAttribute('disabled', 'true');\n                }\n            }\n        }\n        if (trgt.classList.contains('e-text') && closest(trgt, '.e-importprotectpwd-content')) {\n            if (closest(trgt, '.e-importprotectpwd-dialog') && closest(trgt, '.e-importprotectpwd-dialog').\n                getElementsByClassName('e-importprotectpwd-content')[0] === trgt.parentElement) {\n                var dlgElem = closest(trgt, '.e-importprotectworkbook-dlg');\n                var ftrElem = dlgElem.getElementsByClassName('e-footer-content')[0];\n                var btn = ftrElem.firstChild;\n                if (trgt.value !== '') {\n                    btn.removeAttribute('disabled');\n                }\n                else {\n                    btn.setAttribute('disabled', 'true');\n                }\n            }\n        }\n    };\n    ProtectSheet.prototype.alertMessage = function () {\n        var spanElem = this.parent.element.querySelector('.e-pwd-alert-span');\n        var unpotectSpanElem = this.parent.element.querySelector('.e-unprotectpwd-alert-span');\n        var importpotectSpanElem = this.parent.element.querySelector('.e-importprotectpwd-alert-span');\n        if (spanElem) {\n            spanElem.remove();\n        }\n        if (unpotectSpanElem) {\n            unpotectSpanElem.remove();\n        }\n        if (importpotectSpanElem) {\n            importpotectSpanElem.remove();\n        }\n    };\n    ProtectSheet.prototype.dlgClickHandler = function (dialogInst) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var pwd = this.parent.element.querySelector('.e-password-dialog').\n            getElementsByClassName('e-password-content')[0].querySelector('.e-input');\n        var cnfrmPwd = this.parent.element.querySelector('.e-password-dialog').\n            getElementsByClassName('e-password-content')[1].querySelector('.e-input');\n        var pwdSpan = this.parent.createElement('span', {\n            className: 'e-pwd-alert-span'\n        });\n        if (pwd.value === cnfrmPwd.value) {\n            this.parent.password = pwd.value;\n            this.parent.isProtected = true;\n            dialogInst.hide();\n            if (this.parent.showSheetTabs) {\n                this.parent.element.querySelector('.e-add-sheet-tab').setAttribute('disabled', 'true');\n                this.parent.element.querySelector('.e-add-sheet-tab').classList.add('e-disabled');\n            }\n            this.parent.notify(updateToggleItem, { props: 'Protectworkbook' });\n        }\n        else if (pwd.value === '') {\n            pwdSpan.textContent = l10n.getConstant('PasswordAlertMsg');\n        }\n        else if (cnfrmPwd.value === '') {\n            pwdSpan.textContent = l10n.getConstant('ConfirmPasswordAlertMsg');\n        }\n        else if (pwd.value !== cnfrmPwd.value) {\n            pwdSpan.textContent = l10n.getConstant('PasswordAlert');\n        }\n        (this.parent.element.querySelector('.e-protectworkbook-dlg').querySelector('.e-dlg-content')).appendChild(pwdSpan);\n    };\n    ProtectSheet.prototype.unProtectWorkbook = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-unprotectworkbook-dlg',\n            header: l10n.getConstant('UnProtectWorkbook'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'UnProtectWorkbook',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                dialogInst.dialogInstance.content = _this.unProtectPasswordContent();\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'), isPrimary: true, disabled: true\n                    },\n                    click: function () {\n                        _this.alertMessage();\n                        _this.unprotectdlgOkClick(dialogInst);\n                    }\n                }]\n        });\n    };\n    ProtectSheet.prototype.unProtectPasswordContent = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogElem = this.parent.createElement('div', { className: 'e-unprotectpwd-dialog' });\n        var pwdCont = this.parent.createElement('div', { className: 'e-unprotectpwd-content' });\n        var textH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('EnterThePassword') });\n        var pwdInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'password' } });\n        pwdCont.appendChild(pwdInput);\n        pwdCont.insertBefore(textH, pwdInput);\n        dialogElem.appendChild(pwdCont);\n        return dialogElem;\n    };\n    ProtectSheet.prototype.unprotectdlgOkClick = function (dialogInst) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var pwd = this.parent.element.querySelector('.e-unprotectpwd-dialog').\n            getElementsByClassName('e-unprotectpwd-content')[0].querySelector('.e-input');\n        if (this.parent.password === pwd.value) {\n            dialogInst.hide();\n            this.parent.password = '';\n            this.parent.isProtected = false;\n            if (this.parent.showSheetTabs) {\n                this.parent.element.querySelector('.e-add-sheet-tab').removeAttribute('disabled');\n                this.parent.element.querySelector('.e-add-sheet-tab').classList.remove('e-disabled');\n            }\n            document.getElementById(this.parent.element.id + '_protectworkbook').classList.remove('e-active');\n            this.parent.notify(updateToggleItem, { props: 'Protectworkbook' });\n        }\n        else {\n            var pwdSpan = this.parent.createElement('span', {\n                className: 'e-unprotectpwd-alert-span',\n                innerHTML: l10n.getConstant('UnProtectPasswordAlert')\n            });\n            (this.parent.element.querySelector('.e-unprotectworkbook-dlg').querySelector('.e-dlg-content')).appendChild(pwdSpan);\n        }\n    };\n    ProtectSheet.prototype.getPassWord = function (args) {\n        args.passWord = this.password;\n    };\n    ProtectSheet.prototype.importProtectWorkbook = function (fileArgs) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-importprotectworkbook-dlg',\n            header: l10n.getConstant('UnProtectWorkbook'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'ImportProtectWorkbook',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                dialogInst.dialogInstance.content = _this.importProtectPasswordContent(fileArgs);\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'), isPrimary: true, disabled: true\n                    },\n                    click: function () {\n                        _this.alertMessage();\n                        _this.importOkClick(fileArgs);\n                    }\n                }]\n        });\n    };\n    ProtectSheet.prototype.importProtectPasswordContent = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogElem = this.parent.createElement('div', { className: 'e-importprotectpwd-dialog' });\n        var pwdCont = this.parent.createElement('div', { className: 'e-importprotectpwd-content' });\n        var textSpan = this.parent.createElement('span', { className: 'e-header',\n            innerHTML: '\"' + args.file.name + '\"' + ' ' + l10n.getConstant('IsProtected') });\n        var pwdInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'password' } });\n        pwdInput.setAttribute('placeholder', l10n.getConstant('EnterThePassword'));\n        pwdCont.appendChild(textSpan);\n        pwdCont.appendChild(pwdInput);\n        dialogElem.appendChild(pwdCont);\n        return dialogElem;\n    };\n    ProtectSheet.prototype.importOkClick = function (args) {\n        var pwd = this.parent.element.querySelector('.e-importprotectpwd-dialog').\n            getElementsByClassName('e-importprotectpwd-content')[0].querySelector('.e-input');\n        this.parent.password = pwd.value;\n        var impArgs = {\n            file: args.file,\n            password: pwd.value\n        };\n        this.parent.open(impArgs);\n    };\n    /**\n     * Get the module name.\n     *\n     * @returns {string} - Get the module name.\n     *\n     * @private\n     */\n    ProtectSheet.prototype.getModuleName = function () {\n        return 'protectSheet';\n    };\n    return ProtectSheet;\n}());\nexport { ProtectSheet };\n","import { findDlg, locale, dialog, gotoDlg, replace, findHandler, beginAction, focus } from '../common/index';\nimport { completeAction } from '../common/index';\nimport { getComponent, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { goto, showDialog, findUndoRedo, count, replaceAllDialog, findKeyUp } from '../../workbook/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { TextBox } from '@syncfusion/ej2-inputs';\n/**\n * `FindAndReplace` module is used to handle the search action in Spreadsheet.\n */\nvar FindAndReplace = /** @class */ (function () {\n    /**\n     * Constructor for FindAndReplace module.\n     *\n     * @param {Spreadsheet} parent - Constructor for FindAndReplace module.\n     */\n    function FindAndReplace(parent) {\n        this.shortValue = '';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FindAndReplace.prototype.addEventListener = function () {\n        this.parent.on(findDlg, this.renderFindDlg, this);\n        this.parent.on(gotoDlg, this.renderGotoDlg, this);\n        this.parent.on(goto, this.gotoHandler, this);\n        this.parent.on(findHandler, this.findHandler, this);\n        this.parent.on(replace, this.replaceHandler, this);\n        this.parent.on(showDialog, this.showDialog, this);\n        this.parent.on(replaceAllDialog, this.replaceAllDialog, this);\n        this.parent.on(findUndoRedo, this.findUndoRedo, this);\n        this.parent.on(findKeyUp, this.findKeyUp, this);\n    };\n    FindAndReplace.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(findDlg, this.renderFindDlg);\n            this.parent.off(gotoDlg, this.renderGotoDlg);\n            this.parent.off(goto, this.gotoHandler);\n            this.parent.off(findHandler, this.findHandler);\n            this.parent.off(replace, this.replaceHandler);\n            this.parent.off(showDialog, this.showDialog);\n            this.parent.off(replaceAllDialog, this.replaceAllDialog);\n            this.parent.off(findUndoRedo, this.findUndoRedo);\n            this.parent.off(findKeyUp, this.findKeyUp);\n        }\n    };\n    FindAndReplace.prototype.findUndoRedo = function (options) {\n        var eventArgs = { address: options.address, compareVal: options.compareVal, cancel: false };\n        if (options.undoRedoOpt === 'before') {\n            this.parent.notify(beginAction, { action: 'beforeReplace', eventArgs: eventArgs });\n        }\n        else if (options.undoRedoOpt === 'after') {\n            if (!eventArgs.cancel) {\n                var eventArgs_1 = { address: options.address, compareVal: options.compareVal };\n                this.parent.notify(completeAction, { action: 'replace', eventArgs: eventArgs_1 });\n            }\n        }\n        else if (options.undoRedoOpt === 'beforeReplaceAll') {\n            if (!eventArgs.cancel) {\n                var eventArgs_2 = { replaceValue: options.replaceValue, addressCollection: options.Collection };\n                this.parent.notify(beginAction, { action: 'beforeReplaceAll', eventArgs: eventArgs_2 });\n            }\n        }\n        else if (options.undoRedoOpt === 'afterReplaceAll') {\n            if (!eventArgs.cancel) {\n                var eventArgs_3 = { replaceValue: options.replaceValue, addressCollection: options.Collection };\n                this.parent.notify(completeAction, { action: 'replaceAll', eventArgs: eventArgs_3 });\n            }\n        }\n    };\n    FindAndReplace.prototype.renderFindDlg = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        var cancelButton = false;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-find-dlg'))) {\n            var dlg = {\n                isModal: false, showCloseIcon: true, cssClass: 'e-find-dlg', allowDragging: true,\n                header: l10n.getConstant('FindAndReplace'), closeOnEscape: false,\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'FindAndReplaceDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst.dialogInstance.content = _this.findandreplaceContent();\n                    dialogInst.dialogInstance.dataBind();\n                    focus(_this.parent.element);\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('FindPreviousBtn'), isPrimary: true, cssClass: 'e-btn-findPrevious', disabled: true\n                        },\n                        click: function (e) {\n                            _this.dialogMessage();\n                            if (e && e.keyCode === 13) {\n                                _this.findDlgClick('next');\n                                return;\n                            }\n                            _this.findDlgClick('prev');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('FindNextBtn'), isPrimary: true, cssClass: 'e-btn-findNext', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('next');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('ReplaceBtn'), isPrimary: true, cssClass: 'e-btn-replace', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('replace');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('ReplaceAllBtn'), isPrimary: true, cssClass: 'e-btn-replaceAll', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('replaceAll');\n                        }\n                    }], open: function () {\n                    var findInput = _this.parent.element.querySelector('.e-text-findNext').value;\n                    if (findInput) {\n                        var prevButton = _this.parent.element.querySelector('.e-btn-findPrevious');\n                        var prevButtonObj = getComponent(prevButton, 'btn');\n                        prevButtonObj.disabled = false;\n                        getComponent(_this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = false;\n                    }\n                }, close: function () {\n                    dialogInst.hide();\n                }\n            };\n            dialogInst.show(dlg, cancelButton);\n        }\n        else {\n            dialogInst.hide();\n        }\n    };\n    FindAndReplace.prototype.dialogMessage = function () {\n        if (this.parent.element.querySelector('.e-replace-alert-span')) {\n            this.parent.element.querySelector('.e-replace-alert-span').remove();\n        }\n        else if (this.parent.element.querySelector('.e-find-alert-span')) {\n            this.parent.element.querySelector('.e-find-alert-span').remove();\n        }\n    };\n    FindAndReplace.prototype.renderGotoDlg = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        var cancelBtn = false;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-find-dlg'))) {\n            var dlg = {\n                width: 300, isModal: false, showCloseIcon: true, cssClass: 'e-goto-dlg', allowDragging: true,\n                header: l10n.getConstant('GotoHeader'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'GoToDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst.dialogInstance.content = _this.GotoContent();\n                    dialogInst.dialogInstance.dataBind();\n                    focus(_this.parent.element);\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Ok'), isPrimary: true, cssClass: 'e-btn-goto-ok'\n                        },\n                        click: function () {\n                            _this.gotoHandler();\n                        }\n                    }], close: function () {\n                    dialogInst.hide();\n                }, open: function () {\n                    _this.textFocus();\n                }\n            };\n            dialogInst.show(dlg, cancelBtn);\n        }\n        else {\n            dialogInst.hide();\n        }\n    };\n    FindAndReplace.prototype.textFocus = function () {\n        var _this = this;\n        var element = this.parent.element.querySelector('.e-text-goto');\n        element.addEventListener('focus', function () {\n            if (_this.parent.element.querySelector('.e-goto-alert-span')) {\n                _this.parent.element.querySelector('.e-goto-alert-span').remove();\n            }\n        });\n    };\n    FindAndReplace.prototype.findDlgClick = function (findDlgArgs) {\n        if (findDlgArgs === 'prev') {\n            this.findHandler({ findOption: findDlgArgs });\n        }\n        else if (findDlgArgs === 'next') {\n            this.findHandler({ findOption: findDlgArgs });\n        }\n        else {\n            this.replaceHandler({ findDlgArgs: findDlgArgs });\n        }\n    };\n    FindAndReplace.prototype.findHandler = function (findOpt) {\n        var findInput = this.parent.element.querySelector('.e-text-findNext');\n        if (!findInput) {\n            findInput = this.parent.element.querySelector('.e-text-findNext-short');\n            if (!findInput) {\n                this.gotoAlert();\n            }\n        }\n        var value = findInput.value;\n        if (findInput.value !== '') {\n            var sheetIndex = this.parent.activeSheetIndex;\n            var checkCase = this.parent.element.querySelector('.e-findnreplace-checkcase');\n            var isCSen = void 0;\n            if (!checkCase) {\n                isCSen = false;\n            }\n            else {\n                var caseCheckbox = getComponent(checkCase, 'checkbox');\n                isCSen = caseCheckbox.checked;\n            }\n            var checkmatch = this.parent.element.querySelector('.e-findnreplace-checkmatch');\n            var isEMatch = void 0;\n            if (!checkmatch) {\n                isEMatch = false;\n            }\n            else {\n                var entireMatchCheckbox = getComponent(checkmatch, 'checkbox');\n                isEMatch = entireMatchCheckbox.checked;\n            }\n            var searchitem = this.parent.element.querySelector('.e-findnreplace-searchby');\n            var searchBy = void 0;\n            if (!searchitem) {\n                searchBy = 'By Row';\n            }\n            else {\n                var searchDDL = getComponent(searchitem, 'dropdownlist');\n                searchBy = searchDDL.value.toString();\n            }\n            var modeitem = this.parent.element.querySelector('.e-findnreplace-searchwithin');\n            var mode = void 0;\n            if (!modeitem) {\n                mode = 'Sheet';\n            }\n            else {\n                var modeDDL = getComponent(modeitem, 'dropdownlist');\n                mode = modeDDL.value.toString();\n            }\n            var args = {\n                value: value, sheetIndex: sheetIndex, findOpt: findOpt.findOption, mode: mode, isCSen: isCSen,\n                isEMatch: isEMatch, searchBy: searchBy, isAction: true\n            };\n            if (findOpt.findOption === 'next' || findOpt.findOption === 'prev') {\n                this.parent.find(args);\n            }\n            else if (findOpt.countArgs.countOpt === 'count') {\n                this.parent.notify(count, args);\n                findOpt.countArgs.findCount = args.findCount;\n            }\n        }\n    };\n    FindAndReplace.prototype.replaceHandler = function (replace) {\n        var sheetIndex = this.parent.activeSheetIndex;\n        var findInput = this.parent.element.querySelector('.e-text-findNext');\n        var replaceWith = this.parent.element.querySelector('.e-text-replaceInp');\n        var checkCase = this.parent.element.querySelector('.e-findnreplace-checkcase');\n        var caseCheckbox = getComponent(checkCase, 'checkbox');\n        var checkmatch = this.parent.element.querySelector('.e-findnreplace-checkmatch');\n        var eMatchCheckbox = getComponent(checkmatch, 'checkbox');\n        var searchitem = this.parent.element.querySelector('.e-findnreplace-searchby');\n        var searchDDL = getComponent(searchitem, 'dropdownlist');\n        var modeitem = this.parent.element.querySelector('.e-findnreplace-searchwithin');\n        var modeDDL = getComponent(modeitem, 'dropdownlist');\n        var findOption = 'next';\n        var args = {\n            value: findInput.value, mode: modeDDL.value.toString(), isCSen: caseCheckbox.checked,\n            isEMatch: eMatchCheckbox.checked, searchBy: searchDDL.value.toString(), findOpt: findOption, replaceValue: replaceWith.value,\n            replaceBy: replace.findDlgArgs ? replace.findDlgArgs : replace.replaceMode, sheetIndex: sheetIndex\n        };\n        this.parent.replace(args);\n    };\n    FindAndReplace.prototype.gotoHandler = function (address) {\n        if (address) {\n            this.parent.goTo(address.address);\n        }\n        else {\n            var item = this.parent.element.querySelector('.e-text-goto');\n            var gotoaddress = item.value;\n            var splitAddress = gotoaddress.split('');\n            if ((gotoaddress === '') || isNaN(parseInt(splitAddress[1], 10))) {\n                this.gotoAlert();\n                return;\n            }\n            else {\n                var address_1 = gotoaddress.toString().toUpperCase();\n                this.parent.goTo(address_1);\n            }\n        }\n    };\n    FindAndReplace.prototype.gotoAlert = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var gotoSpan = this.parent.createElement('span', {\n            className: 'e-goto-alert-span',\n            innerHTML: l10n.getConstant('InsertingEmptyValue')\n        });\n        if (this.parent.element.querySelector('.e-goto-alert-span')) {\n            this.parent.element.querySelector('.e-goto-alert-span').remove();\n        }\n        (this.parent.element.querySelector('.e-goto-dlg').querySelector('.e-dlg-content')).appendChild(gotoSpan);\n    };\n    FindAndReplace.prototype.showDialog = function () {\n        if (this.parent.element.querySelector('.e-replace-alert-span')) {\n            this.parent.element.querySelector('.e-replace-alert-span').remove();\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var findSpan = this.parent.createElement('span', {\n            className: 'e-find-alert-span',\n            innerHTML: l10n.getConstant('NoElements')\n        });\n        if (this.parent.element.querySelector('.e-find-dlg')) {\n            (this.parent.element.querySelector('.e-find-dlg').querySelector('.e-dlg-content')).appendChild(findSpan);\n        }\n    };\n    FindAndReplace.prototype.replaceAllDialog = function (options) {\n        if (this.parent.element.querySelector('.e-find-alert-span')) {\n            this.parent.element.querySelector('.e-find-alert-span').remove();\n        }\n        var l10n = (this.parent.serviceLocator.getService(locale));\n        var replaceSpan = this.parent.createElement('span', {\n            className: 'e-replace-alert-span',\n            innerHTML: options.count + l10n.getConstant('ReplaceAllEnd') + options.replaceValue\n        });\n        if (this.parent.element.querySelector('.e-find-dlg')) {\n            (this.parent.element.querySelector('.e-find-dlg').querySelector('.e-dlg-content')).appendChild(replaceSpan);\n        }\n    };\n    FindAndReplace.prototype.findKeyUp = function (e) {\n        if (e.target.classList.contains('e-text-findNext')) {\n            var findValue_1 = this.parent.element.querySelector('.e-text-findNext').value;\n            if (!isNullOrUndefined(findValue_1) && findValue_1 !== '') {\n                var prevButton = this.parent.element.querySelector('.e-btn-findPrevious');\n                var prevButtonObj = getComponent(prevButton, 'btn');\n                prevButtonObj.disabled = false;\n                getComponent(this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = false;\n            }\n            else {\n                getComponent(this.parent.element.querySelector('.e-btn-findPrevious'), 'btn').disabled = true;\n                getComponent(this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = true;\n                this.dialogMessage();\n            }\n        }\n        var findValue = this.parent.element.querySelector('.e-text-findNext').value;\n        var replaceValue = this.parent.element.querySelector('.e-text-replaceInp').value;\n        if (!isNullOrUndefined(findValue) && !isNullOrUndefined(replaceValue) && (findValue !== '') && (replaceValue !== '')) {\n            if (this.parent.getActiveSheet().isProtected === false) {\n                getComponent(this.parent.element.querySelector('.e-btn-replace'), 'btn').disabled = false;\n                getComponent(this.parent.element.querySelector('.e-btn-replaceAll'), 'btn').disabled = false;\n            }\n        }\n        else {\n            getComponent(this.parent.element.querySelector('.e-btn-replace'), 'btn').disabled = true;\n            getComponent(this.parent.element.querySelector('.e-btn-replaceAll'), 'btn').disabled = true;\n        }\n    };\n    FindAndReplace.prototype.findandreplaceContent = function () {\n        if (this.parent.element.querySelector('.e-text-findNext-short')) {\n            this.shortValue = this.parent.element.querySelector('.e-text-findNext-short').value;\n        }\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var findElem = this.parent.createElement('div', { className: 'e-find' });\n        var findCheck = this.parent.createElement('div', { className: 'e-findCheck' });\n        var l10n = this.parent.serviceLocator.getService(locale);\n        dialogElem.appendChild(findElem);\n        var findTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var findTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('FindWhat') });\n        var findTextIp = this.parent.createElement('input', {\n            className: 'e-input e-text-findNext', attrs: {\n                'type': 'Text', 'placeholder': l10n.getConstant('FindValue'),\n                'value': this.shortValue\n            }\n        });\n        findTextE.appendChild(findTextIp);\n        findTextE.insertBefore(findTextH, findTextIp);\n        findElem.appendChild(findTextE);\n        var findTextBox = new TextBox({ width: '70%' });\n        findTextBox.createElement = this.parent.createElement;\n        findTextBox.appendTo(findTextIp);\n        var replaceTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var replaceTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('ReplaceWith') });\n        var replaceTextIp = this.parent.createElement('input', {\n            className: 'e-input e-text-replaceInp', attrs: { 'type': 'Text', 'placeholder': l10n.getConstant('ReplaceValue') }\n        });\n        replaceTextE.appendChild(replaceTextIp);\n        replaceTextE.insertBefore(replaceTextH, replaceTextIp);\n        findElem.appendChild(replaceTextE);\n        var replaceTextBox = new TextBox({ width: '70%' });\n        replaceTextBox.createElement = this.parent.createElement;\n        replaceTextBox.appendTo(replaceTextIp);\n        var withinData = [\n            { Id: 'Sheet', Within: l10n.getConstant('Sheet') },\n            { Id: 'Workbook', Within: l10n.getConstant('Workbook') }\n        ];\n        var withInDDL = new DropDownList({\n            dataSource: withinData,\n            cssClass: 'e-searchby',\n            fields: { value: 'Id', text: 'Within' }, width: '50%', index: 0\n        });\n        var withIn = this.parent.createElement('input', {\n            className: 'e-findnreplace-searchwithin', attrs: { type: 'select', label: l10n.getConstant('SearchBy') }\n        });\n        var withinTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('SearchWithin') });\n        findElem.appendChild(withinTextH);\n        findElem.appendChild(withIn);\n        withInDDL.createElement = this.parent.createElement;\n        withInDDL.appendTo(withIn);\n        var searchData = [\n            { Id: 'By Row', Search: l10n.getConstant('ByRow') },\n            { Id: 'By Column', Search: l10n.getConstant('ByColumn') }\n        ];\n        var searchDDL = new DropDownList({\n            dataSource: searchData,\n            cssClass: 'e-searchby',\n            fields: { value: 'Id', text: 'Search' }, width: '50%', index: 0\n        });\n        var searchIn = this.parent.createElement('input', {\n            className: 'e-findnreplace-searchby', attrs: { type: 'select', label: l10n.getConstant('SearchBy') }\n        });\n        var searchTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('SearchBy') });\n        findElem.appendChild(searchTextH);\n        findElem.appendChild(searchIn);\n        searchDDL.createElement = this.parent.createElement;\n        searchDDL.appendTo(searchIn);\n        var isCSen = new CheckBox({\n            label: l10n.getConstant('MatchCase'), checked: false,\n            cssClass: 'e-findnreplace-casecheckbox'\n        });\n        var caaseCheckbox = this.parent.createElement('input', {\n            className: 'e-findnreplace-checkcase', attrs: { type: 'checkbox' }\n        });\n        findCheck.appendChild(caaseCheckbox);\n        isCSen.createElement = this.parent.createElement;\n        isCSen.appendTo(caaseCheckbox);\n        var isEMatch = new CheckBox({\n            label: l10n.getConstant('MatchExactCellElements'), checked: false,\n            cssClass: 'e-findnreplace-exactmatchcheckbox'\n        });\n        var entirematchCheckbox = this.parent.createElement('input', {\n            className: 'e-findnreplace-checkmatch', attrs: { type: 'checkbox' }\n        });\n        findCheck.appendChild(entirematchCheckbox);\n        isEMatch.createElement = this.parent.createElement;\n        isEMatch.appendTo(entirematchCheckbox);\n        findElem.appendChild(findCheck);\n        return dialogElem;\n    };\n    FindAndReplace.prototype.GotoContent = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var gotoElem = this.parent.createElement('div', { className: 'e-goto' });\n        dialogElem.appendChild(gotoElem);\n        var gotoTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var gotoTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('Reference') });\n        var gotoTextBox = new TextBox({\n            placeholder: l10n.getConstant('EntercellAddress')\n        });\n        var gotoTextIp = this.parent.createElement('input', { className: 'e-text-goto', attrs: { 'type': 'Text' } });\n        gotoTextE.appendChild(gotoTextIp);\n        gotoTextE.insertBefore(gotoTextH, gotoTextIp);\n        gotoElem.appendChild(gotoTextE);\n        gotoTextBox.createElement = this.parent.createElement;\n        gotoTextBox.appendTo(gotoTextIp);\n        return dialogElem;\n    };\n    /**\n     * To destroy the find-and-replace module.\n     *\n     * @returns {void} - To destroy the find-and-replace module.\n     */\n    FindAndReplace.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Gets the module name.\n     *\n     * @returns {string} - Gets the module name.\n     */\n    FindAndReplace.prototype.getModuleName = function () {\n        return 'findAndReplace';\n    };\n    return FindAndReplace;\n}());\nexport { FindAndReplace };\n","import { applyMerge, activeCellMergedRange } from '../../workbook/common/index';\nimport { hiddenMerge, dialog, locale, focus } from '../common/index';\nimport { checkPrevMerge, checkMerge } from '../common/index';\nimport { getCell, isHiddenCol, isHiddenRow } from '../../workbook/index';\n/**\n * The `Merge` module is used to to merge the range of cells.\n */\nvar Merge = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet merge module.\n     *\n     * @param {Spreadsheet} parent - Specify the spreadsheet.\n     * @private\n     */\n    function Merge(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Merge.prototype.merge = function (args) {\n        var _this = this;\n        if (args.showDialog) {\n            this.parent.serviceLocator.getService(dialog).show({\n                target: this.parent.element,\n                height: 180, width: 400, isModal: true, showCloseIcon: true,\n                content: this.parent.serviceLocator.getService(locale).getConstant('PasteMergeAlert'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'MergeDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    focus(_this.parent.element);\n                }\n            });\n            return;\n        }\n        this.parent.serviceLocator.getService('cell').refresh(args.rowIdx, args.colIdx, args.lastCell, args.element);\n    };\n    Merge.prototype.hideHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        mergeArgs.range = mergeArgs.range;\n        var cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n        var startIdx = args.model === 'row' ? mergeArgs.range[0] : mergeArgs.range[1];\n        var endIdx = startIdx + ((cell[args.model + \"Span\"] || 1) - 1);\n        if ((!args.isEnd && (args.start === startIdx || isHiddenCol(sheet, startIdx))) || (args.isEnd && (args.start > startIdx &&\n            !isHiddenCol(sheet, startIdx)))) {\n            return;\n        }\n        if (cell[args.model + \"Span\"] > 1 && endIdx >= args.start) {\n            if (args.model === 'row' ? isHiddenRow(sheet, startIdx) : isHiddenCol(sheet, startIdx)) {\n                if (args.end < endIdx && (endIdx - args.end > 1 || cell.rowSpan > 1)) {\n                    var cellEle = this.parent.getCell(args.rowIdx, args.end + 1);\n                    if (cellEle) {\n                        if (endIdx - args.end > 1) {\n                            cellEle.colSpan = endIdx - args.end;\n                        }\n                        cellEle.style.display = '';\n                    }\n                    if (cell.rowSpan > 1) {\n                        var rowSpan = cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (cell.rowSpan - 1));\n                        if (rowSpan > 1) {\n                            cellEle.rowSpan = rowSpan;\n                        }\n                    }\n                }\n            }\n            else {\n                this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1] });\n            }\n        }\n    };\n    Merge.prototype.checkPrevMerge = function (args) {\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        var mergeArgs;\n        var mergeCount;\n        if (args.isRow) {\n            if (args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1)) {\n                cell = getCell(args.rowIdx - 1, args.colIdx, sheet) || {};\n                if ((cell.rowSpan !== undefined || cell.colSpan !== undefined) && (cell.colSpan === undefined || cell.colSpan > 1 ||\n                    (args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1)))) {\n                    mergeArgs = { range: [args.rowIdx - 1, args.colIdx, args.rowIdx - 1, args.colIdx] };\n                    this.parent.notify(activeCellMergedRange, mergeArgs);\n                    mergeArgs.range = mergeArgs.range;\n                    if (isHiddenRow(sheet, mergeArgs.range[0]) && mergeArgs.range[2] >= args.rowIdx) {\n                        cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n                        if (cell.rowSpan > 1) {\n                            mergeCount = (mergeArgs.range[2] - args.rowIdx) + 1 - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (mergeArgs.range[2] - args.rowIdx));\n                            if (mergeCount > 1) {\n                                args.td.rowSpan = mergeCount;\n                                args.td.style.display = '';\n                            }\n                            if (cell.colSpan > 1 && !(args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1))) {\n                                mergeCount = cell.colSpan - this.parent.hiddenCount(args.colIdx, args.colIdx + (cell.colSpan - 1), 'columns');\n                                if (mergeCount > 1) {\n                                    args.td.colSpan = mergeCount;\n                                    args.td.style.display = '';\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            return;\n        }\n        if (args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1)) {\n            cell = getCell(args.rowIdx, args.colIdx - 1, sheet) || {};\n            if ((cell.colSpan !== undefined || cell.rowSpan !== undefined) && (cell.rowSpan === undefined || cell.rowSpan > 1 ||\n                (args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1)))) {\n                mergeArgs = { range: [args.rowIdx, args.colIdx - 1, args.rowIdx, args.colIdx - 1] };\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                mergeArgs.range = mergeArgs.range;\n                if (isHiddenCol(sheet, mergeArgs.range[1]) && mergeArgs.range[3] >= args.colIdx) {\n                    cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n                    if (cell.colSpan > 1) {\n                        mergeCount = (mergeArgs.range[3] - args.colIdx) + 1 - this.parent.hiddenCount(args.colIdx, args.colIdx + (cell.colSpan - 1), 'columns');\n                        if (mergeCount > 1) {\n                            args.td.colSpan = mergeCount;\n                            args.td.style.display = '';\n                        }\n                        if (cell.rowSpan > 1 && !(args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1))) {\n                            mergeCount = cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (cell.rowSpan - 1));\n                            if (mergeCount > 1) {\n                                args.td.rowSpan = mergeCount;\n                                args.td.style.display = '';\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Merge.prototype.checkMerge = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(args.rowIdx, args.colIdx, sheet) || {};\n        if (args.isRow) {\n            if (cell.colSpan === undefined || isHiddenCol(sheet, args.colIdx - 1)) {\n                var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n                mergeArgs.range = mergeArgs.range;\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                if ((isHiddenCol(sheet, args.colIdx - 1) && !isHiddenCol(sheet, mergeArgs.range[1])) || (args.isFreezePane &&\n                    mergeArgs.range[0] < this.parent.frozenRowCount(sheet))) {\n                    args.insideFreezePane = mergeArgs.range[0] < this.parent.frozenRowCount(sheet);\n                    return;\n                }\n                cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet);\n                var mergeCount = (mergeArgs.range[2] - args.rowIdx) + 1 -\n                    this.parent.hiddenCount(args.rowIdx, mergeArgs.range[2]);\n                if (mergeCount > 1) {\n                    this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1], element: args.td });\n                    args.td.rowSpan = mergeCount;\n                    args.td.style.display = '';\n                }\n            }\n        }\n        else {\n            if (cell.rowSpan === undefined || isHiddenRow(sheet, args.rowIdx - 1)) {\n                var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n                mergeArgs.range = mergeArgs.range;\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                if ((isHiddenRow(sheet, args.rowIdx - 1) && !isHiddenRow(sheet, mergeArgs.range[0])) || (args.isFreezePane &&\n                    mergeArgs.range[1] < this.parent.frozenColCount(sheet))) {\n                    args.insideFreezePane = mergeArgs.range[1] < this.parent.frozenColCount(sheet);\n                    return;\n                }\n                cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet);\n                var mergeCount = (mergeArgs.range[3] - args.colIdx) + 1 - this.parent.hiddenCount(args.colIdx, mergeArgs.range[3], 'columns');\n                if (mergeCount > 1) {\n                    this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1], element: args.td });\n                    args.td.colSpan = mergeCount;\n                    args.td.style.display = '';\n                }\n            }\n        }\n    };\n    Merge.prototype.addEventListener = function () {\n        this.parent.on(applyMerge, this.merge, this);\n        this.parent.on(hiddenMerge, this.hideHandler, this);\n        this.parent.on(checkPrevMerge, this.checkPrevMerge, this);\n        this.parent.on(checkMerge, this.checkMerge, this);\n    };\n    /**\n     * Destroy merge module.\n     *\n     * @returns {void} - Destroy merge module.\n     */\n    Merge.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Merge.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyMerge, this.merge);\n            this.parent.off(hiddenMerge, this.hideHandler);\n            this.parent.off(checkPrevMerge, this.checkPrevMerge);\n            this.parent.off(checkMerge, this.checkMerge);\n        }\n    };\n    /**\n     * Get the merge module name.\n     *\n     * @returns {string} - Get the merge module name.\n     */\n    Merge.prototype.getModuleName = function () {\n        return 'merge';\n    };\n    return Merge;\n}());\nexport { Merge };\n","import { checkConditionalFormat, initiateConditionalFormat, locale, dialog, setCF, focus } from '../common/index';\nimport { beginAction, completeAction } from '../common/index';\nimport { getCell, setRow, setCell } from '../../workbook/base/index';\nimport { getRangeIndexes, checkDateFormat, cFInitialCheck, isNumber, cFRender, cFDelete } from '../../workbook/common/index';\nimport { isDateTime, dateToInt, applyCellFormat, clearCF } from '../../workbook/common/index';\nimport { setCFRule, clearCells, getCellAddress } from '../../workbook/common/index';\nimport { extend, getNumberDependable, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\n/**\n * Represents Conditional Formatting support for Spreadsheet.\n */\nvar ConditionalFormatting = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Conditional Formatting module.\n     *\n     * @param {Spreadsheet} parent - Constructor for the Spreadsheet Conditional Formatting module.\n     */\n    function ConditionalFormatting(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Conditional Formatting module.\n     *\n     * @returns {void} - To destroy the Conditional Formatting module.\n     */\n    ConditionalFormatting.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    ConditionalFormatting.prototype.addEventListener = function () {\n        this.parent.on(cFRender, this.cFInitialRender, this);\n        this.parent.on(cFInitialCheck, this.cFInitialCheckHandler, this);\n        this.parent.on(checkConditionalFormat, this.checkConditionalFormatHandler, this);\n        this.parent.on(initiateConditionalFormat, this.initiateCFHandler, this);\n        this.parent.on(setCF, this.setCFHandler, this);\n        this.parent.on(cFDelete, this.cFDeleteHandler, this);\n        this.parent.on(clearCF, this.clearCFHandler, this);\n        this.parent.on(clearCells, this.addClearCFHandler, this);\n    };\n    ConditionalFormatting.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(cFRender, this.cFInitialRender);\n            this.parent.off(cFInitialCheck, this.cFInitialCheckHandler);\n            this.parent.off(checkConditionalFormat, this.checkConditionalFormatHandler);\n            this.parent.off(initiateConditionalFormat, this.initiateCFHandler);\n            this.parent.off(setCF, this.setCFHandler);\n            this.parent.off(cFDelete, this.cFDeleteHandler);\n            this.parent.off(clearCF, this.clearCFHandler);\n        }\n    };\n    ConditionalFormatting.prototype.setCF = function (conditionalFormat) {\n        conditionalFormat.range = conditionalFormat.range || this.parent.getActiveSheet().selectedRange;\n        var eventArgs = {\n            range: conditionalFormat.range, type: conditionalFormat.type, cFColor: conditionalFormat.cFColor,\n            value: conditionalFormat.value, sheetIdx: this.parent.activeSheetIndex, cancel: false\n        };\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'conditionalFormat' });\n        if (!eventArgs.cancel) {\n            conditionalFormat.type = eventArgs.type;\n            conditionalFormat.cFColor = eventArgs.cFColor;\n            conditionalFormat.value = eventArgs.value;\n            conditionalFormat.range = eventArgs.range;\n            this.parent.notify(setCFRule, { conditionalFormat: conditionalFormat, isAction: true });\n            delete eventArgs.cancel;\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'conditionalFormat' });\n        }\n    };\n    ConditionalFormatting.prototype.addClearCFHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var clearCFormats = args.conditionalFormats;\n        var oldRange = args.oldRange;\n        var selectedRange = args.selectedRange;\n        var conditionalFormats = sheet.conditionalFormats;\n        for (var cCFIdx = clearCFormats.length - 1; cCFIdx >= 0; cCFIdx--) {\n            var isApply = false;\n            for (var cFIdx = 0; cFIdx < conditionalFormats.length; cFIdx++) {\n                if (conditionalFormats[cFIdx].type === clearCFormats[cCFIdx].type &&\n                    conditionalFormats[cFIdx].range === clearCFormats[cCFIdx].range) {\n                    isApply = true;\n                    conditionalFormats[cFIdx].range = oldRange[cCFIdx];\n                    sheet.conditionalFormats[cFIdx].range = oldRange[cCFIdx];\n                    var sRangeIdx = getRangeIndexes(selectedRange);\n                    var cFRanges = oldRange[cCFIdx].split(',');\n                    for (var cFRangeIdx = 0; cFRangeIdx < cFRanges.length; cFRangeIdx++) {\n                        var newRangeIdxs = getRangeIndexes(cFRanges[cFRangeIdx]);\n                        for (var cFRowIdx = newRangeIdxs[0]; cFRowIdx <= newRangeIdxs[2]; cFRowIdx++) {\n                            for (var cFColIdx = newRangeIdxs[1]; cFColIdx <= newRangeIdxs[3]; cFColIdx++) {\n                                for (var sRRowIdx = sRangeIdx[0]; sRRowIdx <= sRangeIdx[2]; sRRowIdx++) {\n                                    for (var sRColIdx = sRangeIdx[1]; sRColIdx <= sRangeIdx[3]; sRColIdx++) {\n                                        if (sRRowIdx === cFRowIdx && sRColIdx === cFColIdx) {\n                                            var td = this.parent.getCell(cFRowIdx, cFColIdx);\n                                            var cell = sheet.rows[cFRowIdx] ? sheet.rows[cFRowIdx].cells[cFColIdx] ?\n                                                sheet.rows[cFRowIdx].cells[cFColIdx] : null : null;\n                                            if (cell) {\n                                                this.cFInitialCheckHandler({\n                                                    rowIdx: cFRowIdx, colIdx: cFColIdx,\n                                                    cell: cell, td: td, conditionalFormat: conditionalFormats[cFIdx]\n                                                });\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            if (!isApply) {\n                var conditionalFormat = clearCFormats[cCFIdx];\n                conditionalFormat.range = oldRange[cCFIdx];\n                this.parent.notify(setCFRule, { conditionalFormat: conditionalFormat });\n            }\n        }\n    };\n    ConditionalFormatting.prototype.cFDeleteHandler = function (args) {\n        var td = this.parent.getCell(args.rowIdx, args.colIdx);\n        if (td) {\n            if (td.querySelector('.e-cf-databar')) {\n                td.removeChild(td.querySelector('.e-cf-databar'));\n            }\n            if (td.querySelector('.e-iconsetspan')) {\n                td.removeChild(td.querySelector('.e-iconsetspan'));\n            }\n        }\n    };\n    ConditionalFormatting.prototype.clearCFHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var tdEle = this.parent.getCell(args.rIdx, args.cIdx);\n        var cell = getCell(args.rIdx, args.cIdx, sheet);\n        if (!tdEle) {\n            return;\n        }\n        tdEle.classList.remove('e-redft');\n        tdEle.classList.remove('e-yellowft');\n        tdEle.classList.remove('e-greenft');\n        tdEle.classList.remove('e-redf');\n        tdEle.classList.remove('e-redt');\n        tdEle.classList.remove('e-iconset');\n        if (tdEle.style) {\n            if (tdEle.style.backgroundColor) {\n                tdEle.style.backgroundColor = '';\n                var style = this.parent.getCellStyleValue(['backgroundColor'], [args.rIdx, args.cIdx]);\n                this.parent.notify(applyCellFormat, {\n                    style: style, rowIdx: args.rIdx, colIdx: args.cIdx\n                });\n            }\n            if (tdEle.style.color) {\n                tdEle.style.color = '';\n                var style = this.parent.getCellStyleValue(['color'], [args.rIdx, args.cIdx]);\n                this.parent.notify(applyCellFormat, {\n                    style: style, rowIdx: args.rIdx, colIdx: args.cIdx\n                });\n            }\n        }\n        if (tdEle.querySelector('.e-cf-databar')) {\n            tdEle.removeChild(tdEle.querySelector('.e-cf-databar'));\n            tdEle.textContent = this.parent.getDisplayText(cell);\n        }\n        if (tdEle.querySelector('.e-iconsetspan')) {\n            tdEle.removeChild(tdEle.querySelector('.e-iconsetspan'));\n            tdEle.textContent = this.parent.getDisplayText(cell);\n        }\n    };\n    ConditionalFormatting.prototype.setCFHandler = function (args) {\n        if (args.action === 'cf_databars') {\n            this.setCF({ type: args.id });\n        }\n        else if (args.action === 'cf_colorscales') {\n            this.setCF({ type: args.id });\n        }\n        else if (args.action === 'cf_iconsets') {\n            this.setCF({ type: args.id });\n        }\n    };\n    ConditionalFormatting.prototype.initiateCFHandler = function (args) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 375, showCloseIcon: true, isModal: true, cssClass: 'e-conditionalformatting-dlg',\n            header: args.action.replace('...', ''),\n            target: document.querySelector('.e-control.e-spreadsheet'),\n            beforeOpen: function () {\n                dialogInst.dialogInstance.content = _this.cFDlgContent(args.action);\n                dialogInst.dialogInstance.dataBind();\n                focus(_this.parent.element);\n            },\n            buttons: [{\n                    buttonModel: { content: l10n.getConstant('Ok'), isPrimary: true, cssClass: 'e-btn e-clearall-btn e-flat' },\n                    click: function () {\n                        if (!dialogInst.dialogInstance.element.getElementsByClassName('e-clearall-btn')[0].disabled) {\n                            _this.dlgClickHandler(args.action);\n                            dialogInst.hide();\n                        }\n                    }\n                }]\n        });\n        dialogInst.dialogInstance.refresh();\n    };\n    ConditionalFormatting.prototype.dlgClickHandler = function (action) {\n        var value1 = '';\n        var value2 = '';\n        var dlgCont = this.parent.element.querySelector('.e-conditionalformatting-dlg').\n            getElementsByClassName('e-dlg-content')[0].querySelector('.e-cf-dlg');\n        var mainCont = dlgCont.querySelector('.e-cfmain');\n        if (mainCont) {\n            var inpEle = mainCont.getElementsByTagName('input')[0];\n            if (inpEle && inpEle.parentElement.classList.contains('e-cfmain')) {\n                value1 = mainCont.getElementsByTagName('input')[0].value;\n            }\n            value2 = mainCont.getElementsByTagName('input')[1] ?\n                dlgCont.querySelector('.e-cfmain').getElementsByTagName('input')[1].value : '';\n            var currencySymbol = getNumberDependable(this.parent.locale, '');\n            value1 = value1.split(currencySymbol).join('').split(',').join('');\n            value2 = value2.split(currencySymbol).join('').split(',').join('');\n        }\n        var cFColor = this.getCFColor(dlgCont.querySelector('.e-cfsub').getElementsByTagName('input')[0].value);\n        var cFType = action === 'Duplicate Values...' ?\n            dlgCont.querySelector('.e-cfmain').getElementsByTagName('input')[0].value : this.getType(action);\n        if (value1 !== '' && value2 !== '') {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value1 + ',' + value2\n            });\n        }\n        else if (value1 !== '') {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value1\n            });\n        }\n        else {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value2\n            });\n        }\n    };\n    ConditionalFormatting.prototype.getType = function (action) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = '';\n        switch (action) {\n            case l10n.getConstant('GreaterThan') + '...':\n                result = 'GreaterThan';\n                break;\n            case l10n.getConstant('LessThan') + '...':\n                result = 'LessThan';\n                break;\n            case l10n.getConstant('Between') + '...':\n                result = 'Between';\n                break;\n            case l10n.getConstant('CFEqualTo') + '...':\n                result = 'EqualTo';\n                break;\n            case l10n.getConstant('TextThatContains') + '...':\n                result = 'ContainsText';\n                break;\n            case l10n.getConstant('ADateOccuring') + '...':\n                result = 'DateOccur';\n                break;\n            case l10n.getConstant('Top10Items') + '...':\n                result = 'Top10Items';\n                break;\n            case l10n.getConstant('Bottom10Items') + '...':\n                result = 'Bottom10Items';\n                break;\n            case l10n.getConstant('Top10') + ' %...':\n                result = 'Top10Percentage';\n                break;\n            case l10n.getConstant('Bottom10') + ' %...':\n                result = 'Bottom10Percentage';\n                break;\n            case l10n.getConstant('AboveAverage') + '...':\n                result = 'AboveAverage';\n                break;\n            case l10n.getConstant('BelowAverage') + '...':\n                result = 'BelowAverage';\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.getCFColor = function (value) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = 'RedFT';\n        switch (value) {\n            case l10n.getConstant('LightRedFillWithDarkRedText'):\n                result = 'RedFT';\n                break;\n            case l10n.getConstant('YellowFillWithDarkYellowText'):\n                result = 'YellowFT';\n                break;\n            case l10n.getConstant('GreenFillWithDarkGreenText'):\n                result = 'GreenFT';\n                break;\n            case l10n.getConstant('RedFill'):\n                result = 'RedF';\n                break;\n            case l10n.getConstant('RedText'):\n                result = 'RedT';\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.cFDlgContent = function (action) {\n        var dlgText = this.getDlgText(action);\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dlgContent = this.parent.createElement('div', { className: 'e-cf-dlg' });\n        var mainDiv = this.parent.createElement('div', { className: 'e-cfmain' });\n        var subDiv = this.parent.createElement('div', { className: 'e-cfsub' });\n        var value1Text = this.parent.createElement('span', { className: 'e-header e-top-header', innerHTML: dlgText });\n        var value1Inp = this.parent.createElement('input', { className: 'e-input', id: 'valueInput', attrs: { type: 'text' } });\n        var duplicateSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        var subDivText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('With') });\n        var colorSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        dlgContent.appendChild(mainDiv);\n        dlgContent.appendChild(subDiv);\n        mainDiv.appendChild(value1Text);\n        var setValidation;\n        if (action !== l10n.getConstant('DuplicateValues') + '...') {\n            if (action !== l10n.getConstant('AboveAverage') + '...' && action !== l10n.getConstant('BelowAverage') + '...') {\n                mainDiv.appendChild(value1Inp);\n                setValidation = true;\n                var percent = action === l10n.getConstant('Top10') + ' %...' || action === l10n.getConstant('Bottom10') + ' %...';\n                if (action === l10n.getConstant('Top10Items') + '...' || action === l10n.getConstant('Bottom10Items') + '...' || percent) {\n                    value1Inp.maxLength = percent ? 3 : 4;\n                    var numeric = new NumericTextBox({ value: 10, min: 1, max: percent ? 100 : 1000, format: '###' });\n                    numeric.appendTo(value1Inp);\n                }\n            }\n        }\n        else {\n            mainDiv.appendChild(duplicateSelectEle);\n            var dupData = [\n                { text: l10n.getConstant('Duplicate'), id: 'duplicate' },\n                { text: l10n.getConstant('Unique'), id: 'unique' }\n            ];\n            var dupList = new DropDownList({\n                dataSource: dupData,\n                index: 0,\n                popupHeight: '200px'\n            });\n            dupList.appendTo(duplicateSelectEle);\n        }\n        if (action === l10n.getConstant('Between') + '...') {\n            var value2Text = this.parent.createElement('span', { className: 'e-header e-header-2', innerHTML: l10n.getConstant('And') });\n            var value2Inp = this.parent.createElement('input', { className: 'e-input e-between' });\n            mainDiv.appendChild(value2Text);\n            mainDiv.appendChild(value2Inp);\n            value2Inp.addEventListener('input', this.validateCfInput.bind(this));\n        }\n        if (setValidation) {\n            this.validateCfInput({ target: value1Inp });\n            value1Inp.addEventListener('input', this.validateCfInput.bind(this));\n        }\n        subDiv.appendChild(subDivText);\n        subDiv.appendChild(colorSelectEle);\n        var colorData = [\n            { text: l10n.getConstant('LightRedFillWithDarkRedText'), value: 'redft', id: 'redft' },\n            { text: l10n.getConstant('YellowFillWithDarkYellowText'), id: 'yellowft' },\n            { text: l10n.getConstant('GreenFillWithDarkGreenText'), id: 'greenft' },\n            { text: l10n.getConstant('RedFill'), id: 'redf' },\n            { text: l10n.getConstant('RedText'), id: 'redt' }\n        ];\n        var colorList = new DropDownList({\n            dataSource: colorData,\n            index: 0,\n            popupHeight: '200px'\n        });\n        colorList.appendTo(colorSelectEle);\n        return dlgContent;\n    };\n    ConditionalFormatting.prototype.validateCfInput = function (e) {\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        var text = e.target.value;\n        var btn = dialogInst.dialogInstance.element.getElementsByClassName('e-clearall-btn')[0];\n        if (text && (e.target.classList.contains('e-between') || e.target.parentElement.querySelector('.e-between'))) {\n            text = e.target.parentElement.querySelector((e.target.classList.contains('e-between') ? '.e-input' : '.e-between')).value;\n        }\n        btn.disabled = !text;\n    };\n    ConditionalFormatting.prototype.checkCellHandler = function (rowIdx, colIdx, conditionalFormat) {\n        var isApply = false;\n        var ranges = conditionalFormat.range.trim().split(',');\n        for (var rangeIdx = 0; rangeIdx < ranges.length; rangeIdx++) {\n            var cFrange = ranges[rangeIdx];\n            cFrange = cFrange.indexOf(':') > -1 ? cFrange : cFrange + ':' + cFrange;\n            var indexes = getRangeIndexes(cFrange);\n            if (rowIdx >= indexes[0] && rowIdx <= indexes[2] && colIdx >= indexes[1] && colIdx <= indexes[3]) {\n                isApply = true;\n                break;\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.getDlgText = function (action) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = '';\n        switch (action) {\n            case l10n.getConstant('GreaterThan') + '...':\n                result = l10n.getConstant('FormatCellsGreaterThan');\n                break;\n            case l10n.getConstant('LessThan') + '...':\n                result = l10n.getConstant('FormatCellsLessThan');\n                break;\n            case l10n.getConstant('Between') + '...':\n                result = l10n.getConstant('FormatCellsBetween');\n                break;\n            case l10n.getConstant('CFEqualTo') + '...':\n                result = l10n.getConstant('FormatCellsEqualTo');\n                break;\n            case l10n.getConstant('TextThatContains') + '...':\n                result = l10n.getConstant('FormatCellsThatContainTheText');\n                break;\n            case l10n.getConstant('ADateOccuring') + '...':\n                result = l10n.getConstant('FormatCellsThatContainADateOccurring');\n                break;\n            case l10n.getConstant('DuplicateValues') + '...':\n                result = l10n.getConstant('FormatCellsDuplicate');\n                break;\n            case l10n.getConstant('Top10Items') + '...':\n                result = l10n.getConstant('FormatCellsTop');\n                break;\n            case l10n.getConstant('Top10') + ' %...':\n                result = l10n.getConstant('FormatCellsTop');\n                break;\n            case l10n.getConstant('Bottom10Items') + '...':\n                result = l10n.getConstant('FormatCellsBottom');\n                break;\n            case l10n.getConstant('Bottom10') + ' %...':\n                result = l10n.getConstant('FormatCellsBottom');\n                break;\n            case l10n.getConstant('AboveAverage') + '...':\n                result = l10n.getConstant('FormatCellsAbove');\n                break;\n            case l10n.getConstant('BelowAverage') + '...':\n                result = l10n.getConstant('FormatCellsBelow');\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.cFInitialRender = function (args) {\n        var cFRules = this.parent.getActiveSheet().conditionalFormats;\n        if (cFRules) {\n            for (var cFRIdx = 0; cFRIdx < cFRules.length; cFRIdx++) {\n                var isApply = false;\n                isApply = this.checkCellHandler(args.rowIdx, args.colIdx, cFRules[cFRIdx]);\n                if (isApply) {\n                    this.cFInitialCheckHandler({\n                        rowIdx: args.rowIdx, colIdx: args.colIdx,\n                        cell: args.cell, td: args.td, conditionalFormat: cFRules[cFRIdx]\n                    });\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.triggetConditionalFormatEvent = function (args, isAction) {\n        if (isAction && (args.conditionalFormat.value || args.conditionalFormat.type === 'AboveAverage' || args.conditionalFormat.type ===\n            'BelowAverage' || args.conditionalFormat.type === 'Duplicate')) {\n            this.parent.trigger('beforeConditionalFormat', args);\n        }\n    };\n    ConditionalFormatting.prototype.cFInitialCheckHandler = function (args) {\n        var formatStyle;\n        var isApply = false;\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        var value = args.cell.value || '';\n        var td = args.td || this.parent.getCell(args.rowIdx, args.colIdx);\n        if (!td) {\n            return;\n        }\n        var cFRule = args.conditionalFormat;\n        cFRule.type = cFRule.type || 'GreaterThan';\n        cFRule.cFColor = cFRule.cFColor ? cFRule.cFColor : cFRule.format ? cFRule.cFColor : 'RedFT';\n        isApply = this.cFRCheck(cFRule, value, td, args.rowIdx, args.colIdx, true);\n        this.triggetConditionalFormatEvent({ conditionalFormat: cFRule, cell: args.cell, element: td, address: getCellAddress(args.rowIdx, args.colIdx), apply: isApply }, args.isAction);\n        if (isApply) {\n            for (var idx = 0; idx < cFColors.length; idx++) {\n                if (td.classList.contains(cFColors[idx])) {\n                    td.classList.remove(cFColors[idx]);\n                    break;\n                }\n            }\n            if (cFRule.format && cFRule.format.style) {\n                formatStyle = cFRule.format.style;\n            }\n            var style = {};\n            if (cFRule.cFColor) {\n                td.classList.add('e-' + cFRule.cFColor.toLowerCase());\n                style = this.setFormat(style, cFRule);\n            }\n            else {\n                style = formatStyle;\n            }\n            if (style.backgroundColor) {\n                td.style.setProperty('background-color', style.backgroundColor);\n            }\n            if (style.color) {\n                td.style.setProperty('color', style.color);\n            }\n            if (style.fontWeight) {\n                td.style.setProperty('font-weight', style.fontWeight);\n            }\n            if (style.fontStyle) {\n                td.style.setProperty('font-style', style.fontStyle);\n            }\n            if (style.textDecoration) {\n                td.style.setProperty('text-decoration', style.textDecoration);\n            }\n        }\n    };\n    ConditionalFormatting.prototype.checkConditionalFormatHandler = function (args) {\n        var indexes;\n        var isApply = false;\n        var result = false;\n        var sheet = this.parent.getActiveSheet();\n        var cell = args.cell;\n        var td;\n        var cFRules = sheet.conditionalFormats;\n        var value = !cell ? '' : !isNullOrUndefined(cell.value) ? cell.value : '';\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        td = this.parent.getCell(args.rowIdx, args.colIdx);\n        if (!cFRules || cFRules.length < 1) {\n            return;\n        }\n        for (var cFRuleIdx = cFRules.length - 1; cFRuleIdx >= 0; cFRuleIdx--) {\n            var cFRanges = cFRules[cFRuleIdx].range.trim().split(',');\n            for (var rangeIdx = 0; rangeIdx < cFRanges.length; rangeIdx++) {\n                var range = cFRanges[rangeIdx];\n                range = range.indexOf(':') > -1 ? range : range + ':' + range;\n                indexes = getRangeIndexes(range);\n                if (args.rowIdx >= indexes[0] && args.colIdx >= indexes[1] && args.rowIdx <= indexes[2] && args.colIdx <= indexes[3]) {\n                    result = true;\n                    break;\n                }\n            }\n            if (result) {\n                if (('GreaterThan' + 'LessThan' + 'EqualTo' + 'Between' + 'ContainsText' +\n                    'DateOccur').includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    var cellVal = getCell(args.rowIdx, args.colIdx, sheet) && getCell(args.rowIdx, args.colIdx, sheet).value ?\n                        getCell(args.rowIdx, args.colIdx, sheet).value : '';\n                    if (isNullOrUndefined(cellVal) && cellVal === '') {\n                        isApply = false;\n                    }\n                    else {\n                        isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], cellVal, td);\n                    }\n                    this.setColor(td, args.rowIdx, args.colIdx, cFRuleIdx, isApply, args.isAction);\n                }\n                else if (('Top10Items' + 'Bottom10Items' + 'Top10%' + 'Bottom10%' + 'AboveAverage' +\n                    'BelowAverage' + 'Duplicate' + 'Unique').includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    for (var rangeIdx = 0; rangeIdx < cFRanges.length; rangeIdx++) {\n                        var range = cFRanges[rangeIdx];\n                        range = range.indexOf(':') > -1 ? range : range + ':' + range;\n                        indexes = getRangeIndexes(range);\n                        for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n                            if (!sheet.rows[rowIdx]) {\n                                setRow(sheet, rowIdx, {});\n                            }\n                            for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                                if (!sheet.rows[rowIdx].cells || !sheet.rows[rowIdx].cells[colIdx]) {\n                                    setCell(rowIdx, colIdx, sheet, {});\n                                }\n                                var cellVal = getCell(rowIdx, colIdx, sheet) && getCell(rowIdx, colIdx, sheet).value ?\n                                    getCell(rowIdx, colIdx, sheet).value : '';\n                                isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], cellVal, td, rowIdx, colIdx, false);\n                                td = this.parent.getCell(rowIdx, colIdx);\n                                this.setColor(td, rowIdx, colIdx, cFRuleIdx, isApply, args.isAction);\n                            }\n                        }\n                    }\n                }\n                else if (('BlueDataBar' + 'GreenDataBar' + 'RedDataBar' + 'OrangeDataBar' + 'LightBlueDataBar' + 'PurpleColorScale' +\n                    'GYRColorScale' + 'RYGColorScale' + 'GWRColorScale' + 'RWGColorScale' + 'BWRColorScale' + 'RWBColorScale' +\n                    'WRColorScale' + 'RWColorScale' + 'GWColorScale' + 'WGColorScale' + 'GYColorScale' + 'YGColorScale' + 'ThreeArrows' +\n                    'ThreeArrowsGray' + 'FourArrowsGray' + 'FourArrows' + 'FiveArrowsGray' + 'FiveArrows' + 'ThreeTrafficLights1' +\n                    'ThreeTrafficLights2' + 'ThreeSigns' + 'FourTrafficLights' + 'FourRedToBlack' + 'ThreeSymbols' + 'ThreeSymbols2' +\n                    'ThreeFlags' + 'FourRating' + 'FiveQuarters' + 'FiveRating' + 'ThreeTriangles' + 'ThreeStars' + 'FiveBoxes').\n                    includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    for (var idx = 0; idx < cFColors.length; idx++) {\n                        if (td.classList.contains(cFColors[idx])) {\n                            td.classList.remove(cFColors[idx]);\n                        }\n                    }\n                    isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], value, td, args.rowIdx, args.colIdx, false);\n                }\n                result = false;\n            }\n            if (isApply) {\n                break;\n            }\n        }\n    };\n    ConditionalFormatting.prototype.setColor = function (td, rIdx, cIdx, cFRuleIdx, isApply, isAction) {\n        var sheet = this.parent.getActiveSheet();\n        var cFRules = sheet.conditionalFormats;\n        this.triggetConditionalFormatEvent({ conditionalFormat: cFRules[cFRuleIdx], cell: getCell(rIdx, cIdx, sheet), element: td, address: getCellAddress(rIdx, cIdx),\n            apply: isApply }, isAction);\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        var isActiveCF = false;\n        if (cFRules[cFRuleIdx].cFColor) {\n            if (td && td.classList.contains('e-' + cFRules[cFRuleIdx].cFColor.toLowerCase())) {\n                isActiveCF = true;\n            }\n        }\n        else if (cFRules[cFRuleIdx].format.style.backgroundColor && td.style.backgroundColor) {\n            var rgb = this.hexToRgb(cFRules[cFRuleIdx].format.style.backgroundColor);\n            if ('rgb(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ')' === td.style.backgroundColor) {\n                isActiveCF = true;\n            }\n        }\n        if (isApply) {\n            if (isActiveCF) {\n                for (var idx = 0; idx < cFColors.length; idx++) {\n                    if (td.classList.contains(cFColors[idx])) {\n                        td.classList.remove(cFColors[idx]);\n                        break;\n                    }\n                }\n            }\n            var style = {};\n            if (cFRules[cFRuleIdx].cFColor) {\n                td.classList.add('e-' + cFRules[cFRuleIdx].cFColor.toLowerCase());\n                style = this.setFormat(style, cFRules[cFRuleIdx]);\n            }\n            else {\n                style = cFRules[cFRuleIdx].format.style;\n            }\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rIdx, colIdx: cIdx,\n                lastCell: true, isHeightCheckNeeded: true, manualUpdate: true\n            });\n        }\n        else {\n            if (isActiveCF) {\n                for (var idx = 0; idx < cFColors.length; idx++) {\n                    if (td.classList.contains(cFColors[idx])) {\n                        td.classList.remove(cFColors[idx]);\n                        break;\n                    }\n                }\n                td.removeAttribute('style');\n            }\n            var cell = getCell(rIdx, cIdx, this.parent.getActiveSheet(), null, true);\n            var style = extend({}, this.parent.commonCellStyle, cell.style);\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rIdx, colIdx: cIdx\n            });\n        }\n    };\n    ConditionalFormatting.prototype.hexToRgb = function (hex) {\n        var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n        return result ? {\n            r: parseInt(result[1], 16),\n            g: parseInt(result[2], 16),\n            b: parseInt(result[3], 16)\n        } : null;\n    };\n    ConditionalFormatting.prototype.cFRCheck = function (cFRule, value, td, rIdx, cIdx, isInitial) {\n        var cFRuleValue1 = '';\n        var cFRuleValue2 = '';\n        var cellValue = value.toString();\n        if (cFRule.value) {\n            var valueArr = cFRule.value.split(',');\n            if (valueArr.length > 1) {\n                if (valueArr[0].split('(').length > 1) {\n                    var valueStr = '';\n                    for (var idx = 0; idx < valueArr.length; idx++) {\n                        valueStr += valueArr[idx] + ',';\n                        if (valueStr.split('(').length === valueStr.split(')').length && cFRuleValue1 === '') {\n                            cFRuleValue1 = valueStr.substring(0, valueStr.length - 1);\n                            valueStr = '';\n                        }\n                    }\n                    cFRuleValue2 = valueStr.substring(0, valueStr.length - 1);\n                }\n                else {\n                    cFRuleValue1 = valueArr[0];\n                    for (var idx = 1; idx < valueArr.length; idx++) {\n                        cFRuleValue2 += idx + 1 === valueArr.length ? valueArr[idx] : valueArr[idx] + ',';\n                    }\n                }\n            }\n            else {\n                cFRuleValue1 = cFRule.value;\n            }\n        }\n        var isApply = false;\n        var type = cFRule.type;\n        if (('BlueDataBar' + 'GreenDataBar' + 'RedDataBar' + 'OrangeDataBar' + 'LightBlueDataBar' + 'PurpleDataBar').includes(type)) {\n            type = 'DataBar';\n        }\n        if (('GYRColorScale' + 'RYGColorScale' + 'GWRColorScale' + 'RWGColorScale' + 'BWRColorScale' + 'RWBColorScale' + 'WRColorScale' +\n            'RWColorScale' + 'GWColorScale' + 'WGColorScale' + 'GYColorScale' + 'YGColorScale').includes(type)) {\n            type = 'ColorScale';\n        }\n        if (('ThreeArrows' + 'ThreeArrowsGray' + 'FourArrowsGray' + 'FourArrows' + 'FiveArrowsGray' +\n            'FiveArrows' + 'ThreeTrafficLights1' + 'ThreeTrafficLights2' + 'ThreeSigns' + 'FourTrafficLights' +\n            'FourRedToBlack' + 'ThreeSymbols' + 'ThreeSymbols2' + 'ThreeFlags' + 'FourRating' + 'FiveQuarters' +\n            'FiveRating' + 'ThreeTriangles' + 'ThreeStars' + 'FiveBoxes').includes(type)) {\n            type = 'IconSet';\n        }\n        var dateEventArgs = {};\n        switch (type) {\n            case 'GreaterThan':\n                isApply = this.isGreaterThanLessThan(cFRule, cellValue, cFRuleValue1, true);\n                break;\n            case 'LessThan':\n                isApply = this.isGreaterThanLessThan(cFRule, cellValue, cFRuleValue1, false);\n                break;\n            case 'Between':\n                isApply = this.isBetWeen(cFRule, cellValue, cFRuleValue1, cFRuleValue2);\n                break;\n            case 'EqualTo':\n                isApply = this.isEqualTo(cFRule, cellValue, cFRuleValue1);\n                break;\n            case 'ContainsText':\n                isApply = this.isContainsText(cellValue, cFRuleValue1);\n                break;\n            case 'DateOccur':\n                dateEventArgs = {\n                    value: cFRuleValue1,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    updatedVal: ''\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (cellValue === dateEventArgs.updatedVal) {\n                    isApply = true;\n                }\n                break;\n            case 'Unique':\n            case 'Duplicate':\n                isApply = this.isDuplicateUnique(cellValue, cFRule);\n                break;\n            case 'Top10Items':\n                isApply = this.isTopBottomTenValue(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'Bottom10Items':\n                isApply = this.isTopBottomTenValue(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'Top10Percentage':\n                isApply = this.isTopBottomTenPercentage(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'Bottom10Percentage':\n                isApply = this.isTopBottomTenPercentage(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'AboveAverage':\n                isApply = this.isAboveBelowAverage(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'BelowAverage':\n                isApply = this.isAboveBelowAverage(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'DataBar':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n            case 'ColorScale':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n            case 'IconSet':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isDataBarColorScalesIconSets = function (type, cellValue, cFRule, td, rIdx, cIdx, isInitial) {\n        var sheet = this.parent.getActiveSheet();\n        if (isInitial) {\n            if (type === 'DataBar') {\n                this.applyDataBars(cellValue, cFRule, td, rIdx, cIdx);\n            }\n            else if (type === 'ColorScale') {\n                this.applyColorScale(cellValue, cFRule, td, rIdx, cIdx);\n            }\n            else {\n                this.applyIconSet(cellValue, cFRule, td, rIdx, cIdx);\n            }\n        }\n        else {\n            td = null;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var selIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rIdx_1 = selIndexes[0]; rIdx_1 <= selIndexes[2]; rIdx_1++) {\n                    for (var cIdx_1 = selIndexes[1]; cIdx_1 <= selIndexes[3]; cIdx_1++) {\n                        if (getCell(rIdx_1, cIdx_1, sheet)) {\n                            var cellVal = getCell(rIdx_1, cIdx_1, sheet).value;\n                            td = this.parent.getCell(rIdx_1, cIdx_1);\n                            if (type === 'DataBar') {\n                                this.applyDataBars(cellVal, cFRule, td, rIdx_1, cIdx_1);\n                            }\n                            else if (type === 'ColorScale') {\n                                this.applyColorScale(cellVal, cFRule, td, rIdx_1, cIdx_1);\n                            }\n                            else {\n                                this.applyIconSet(cellVal, cFRule, td, rIdx_1, cIdx_1);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.applyIconSet = function (val, cFRule, tdEle, rIdx, cIdx) {\n        var value = parseInt(val, 10);\n        var iconList = this.getIconList(cFRule.type).split(',');\n        var valArr = [];\n        var sheet = this.parent.getActiveSheet();\n        var actCell = sheet.rows[rIdx] && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        var rangeArr = cFRule.range.split(',');\n        for (var rIdx_2 = 0; rIdx_2 < rangeArr.length; rIdx_2++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_2]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        valArr = valArr.sort(function (n1, n2) { return n1 - n2; });\n        var min = valArr[0];\n        var max = valArr[valArr.length - 1];\n        var currentSymbol;\n        if (iconList.length === 3) {\n            var maxPercent = min + (0.67 * ((max) - (min)));\n            var minPercent = min + (0.33 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= maxPercent ? iconList[0].trim() : value >= minPercent ? iconList[1].trim() : iconList[2].trim());\n        }\n        else if (iconList.length === 4) {\n            var percent1 = min + (0.25 * ((max) - (min)));\n            var percent2 = min + (0.50 * ((max) - (min)));\n            var percent3 = min + (0.75 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= percent3 ? iconList[0].trim() : value >= percent2 ? iconList[1].trim() : value >= percent1 ?\n                    iconList[2].trim() : iconList[3].trim());\n        }\n        else if (iconList.length === 5) {\n            var percent1 = min + (0.20 * ((max) - (min)));\n            var percent2 = min + (0.40 * ((max) - (min)));\n            var percent3 = min + (0.60 * ((max) - (min)));\n            var percent4 = min + (0.80 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= percent4 ? iconList[0].trim() : value >= percent3 ? iconList[1].trim() : value >= percent2 ?\n                    iconList[2].trim() : value >= percent1 ? iconList[3].trim() : iconList[4].trim());\n        }\n        if (!isNullOrUndefined(actCell)) {\n            var cfIcon = this.parent.createElement('span', { className: 'e-icon' });\n            cfIcon.classList.add('e-iconsetspan');\n            cfIcon.classList.add(currentSymbol);\n            this.applyIconSetIcon({ rowIndex: rIdx, colIndex: cIdx }, cfIcon, td);\n        }\n    };\n    ConditionalFormatting.prototype.applyIconSetIcon = function (activeObj, cfIcon, td) {\n        var sheet = this.parent.getActiveSheet();\n        var rowIdx = activeObj.rowIndex;\n        var colIdx = activeObj.colIndex;\n        var cellVal = getCell(rowIdx, colIdx, sheet).value;\n        var activeEle = td;\n        if (activeEle.classList.contains('e-iconset') && activeEle.querySelector('.e-iconsetspan')) {\n            activeEle.removeChild(activeEle.querySelector('.e-iconsetspan'));\n        }\n        if (isNumber(cellVal)) {\n            activeEle.insertBefore(cfIcon, activeEle.childNodes[0]);\n            activeEle.classList.add('e-iconset');\n        }\n    };\n    ConditionalFormatting.prototype.getIconList = function (iconName) {\n        var result = '3arrows-1,3arrows-2,3arrows-3';\n        switch (iconName) {\n            case 'ThreeArrows':\n                return '3arrows-1,3arrows-2,3arrows-3';\n            case 'ThreeArrowsGray':\n                return '3arrowsgray-1,3arrowsgray-2,3arrowsgray-3';\n            case 'FourArrowsGray':\n                return '4arrowsgray-1,4arrowsgray-2,4arrowsgray-3,4arrowsgray-4';\n            case 'FourArrows':\n                return '4arrows-1,4arrows-2,4arrows-3,4arrows-4';\n            case 'FiveArrowsGray':\n                return '5arrowsgray-1,5arrowsgray-2,5arrowsgray-3,5arrowsgray-4,5arrowsgray-5';\n            case 'FiveArrows':\n                return '5arrows-1,5arrows-2,5arrows-3,5arrows-4,5arrows-5';\n            case 'ThreeTrafficLights1':\n                return '3trafficlights-1,3trafficlights-2,3trafficlights-3';\n            case 'ThreeTrafficLights2':\n                return '3rafficlights2-1,3rafficlights2-2,3rafficlights2-3';\n            case 'ThreeSigns':\n                return '3signs-1,3signs-2,3signs-3';\n            case 'FourTrafficLights':\n                return '4trafficlights-1,4trafficlights-2,4trafficlights-3,4trafficlights-4';\n            case 'FourRedToBlack':\n                return '4redtoblack-1,4redtoblack-2,4redtoblack-3,4redtoblack-4';\n            case 'ThreeSymbols':\n                return '3symbols-1,3symbols-2,3symbols-3';\n            case 'ThreeSymbols2':\n                return '3symbols2-1,3symbols2-2,3symbols2-3';\n            case 'ThreeFlags':\n                return '3flags-1,3flags-2,3flags-3';\n            case 'FourRating':\n                return '4rating-1,4rating-2,4rating-3,4rating-4';\n            case 'FiveQuarters':\n                return '5quarters-1,5quarters-2,5quarters-3,5quarters-4,5quarters-5';\n            case 'FiveRating':\n                return '5rating-1,5rating-2,5rating-3,5rating-4,5rating-5';\n            case 'ThreeTriangles':\n                return '3triangles-1,3triangles-2,3triangles-3';\n            case 'ThreeStars':\n                return '3stars-1,3stars-2,3stars-3';\n            case 'FiveBoxes':\n                return '5boxes-1,5boxes-2,5boxes-3,5boxes-4,5boxes-5';\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.applyColorScale = function (val, cFRule, tdEle, rIdx, cIdx) {\n        var sheet = this.parent.getActiveSheet();\n        var value = parseInt(val, 10);\n        var id;\n        var valArr = [];\n        var colors = this.getColor(cFRule.type);\n        var actCell = sheet.rows[rIdx] && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var rangeArr = cFRule.range.split(',');\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        for (var rIdx_3 = 0; rIdx_3 < rangeArr.length; rIdx_3++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_3]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        valArr = valArr.sort(function (n1, n2) { return n1 - n2; }).reverse();\n        for (var i = 0; i < valArr.length; i++) {\n            if (valArr[i] === value) {\n                id = i;\n                break;\n            }\n        }\n        var hexcode = (id === 0) ? colors[0] : (id === valArr.length - 1) ? colors[colors.length - 1] :\n            (valArr.length === 3 && id === 1) ? colors[1] : this.getGradient(id, colors[0], colors[1], colors[2], valArr.length);\n        if (!isNullOrUndefined(actCell)) {\n            var style = {};\n            if (!isNullOrUndefined(id)) {\n                style = { backgroundColor: hexcode };\n                td.style.backgroundColor = hexcode;\n            }\n            else {\n                style = this.parent.getCellStyleValue(['backgroundColor'], [rIdx, cIdx]);\n                td.style.backgroundColor = style.backgroundColor;\n            }\n        }\n    };\n    ConditionalFormatting.prototype.applyDataBars = function (val, cFRule, tdEle, rIdx, cIdx) {\n        var sheet = this.parent.getActiveSheet();\n        var left = {};\n        var right = {};\n        var posColor = '';\n        var negColor = '';\n        var cFColor = cFRule.type;\n        var actCell = sheet.rows[rIdx].cells && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var valArr = [];\n        var row = this.parent.getMainContent().getElementsByClassName('e-row')[rIdx];\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        var rowHeight = !row ? 20 : row.style ? parseInt(row.style.height, 10) : 20;\n        var posArr = [];\n        var negArr = [];\n        var topVal;\n        var leftStandardWidth = 0;\n        var value = parseInt(val, 10);\n        var rangeArr = cFRule.range.split(',');\n        for (var rIdx_4 = 0; rIdx_4 < rangeArr.length; rIdx_4++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_4]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        for (var idx = 0; idx < valArr.length; idx++) {\n            for (var idx_1 = 0; idx_1 < valArr.length; idx_1++) {\n                if (valArr[idx_1] > 0) {\n                    posArr.push(valArr[idx_1]);\n                }\n                else {\n                    negArr.push(valArr[idx_1]);\n                }\n            }\n        }\n        cFColor = cFColor === 'BlueDataBar' ? 'B' : cFColor === 'GreenDataBar' ? 'G' : cFColor === 'RedDataBar' ? 'R' :\n            cFColor === 'OrangeDataBar' ? 'O' : cFColor === 'LightBlueDataBar' ? 'LB' : cFColor === 'PurpleDataBar' ? 'P' : '';\n        posColor = this.getColor(cFColor)[0];\n        negColor = this.getColor('R')[0];\n        posArr = posArr.sort(function (n1, n2) { return n1 - n2; }).reverse();\n        negArr = negArr.sort(function (n1, n2) { return n1 - n2; });\n        if (negArr.length && posArr.length) {\n            topVal = posArr[0] + Math.abs(negArr[0]);\n            leftStandardWidth = (Math.abs((negArr[0] / topVal) * 100));\n        }\n        else if (negArr.length || posArr.length) {\n            topVal = negArr.length ? negArr[0] : posArr[0];\n        }\n        else {\n            return;\n        }\n        if (td) {\n            if (isNullOrUndefined(value) || val === '') {\n                if (td.getElementsByClassName('e-cf-databar')[0]) {\n                    td.removeChild(td.getElementsByClassName('e-cf-databar')[0]);\n                }\n            }\n        }\n        if (isNumber(value)) {\n            var databar = this.parent.createElement('div', { id: 'spreadsheet-databar', className: 'e-cf-databar' });\n            var leftSpan = this.parent.createElement('span', { id: 'spreadsheet-leftspan', className: 'e-databar' });\n            var rightSpan = this.parent.createElement('span', { id: 'spreadsheet-rightspan', className: 'e-databar' });\n            var dataSpan = this.parent.createElement('span', { id: 'spreadsheet-dataspan', className: 'e-databar-value' });\n            var iconSetSpan = void 0;\n            left = leftSpan.style;\n            right = rightSpan.style;\n            databar.appendChild(dataSpan);\n            databar.insertBefore(rightSpan, dataSpan);\n            databar.insertBefore(leftSpan, rightSpan);\n            if (td.querySelector('.e-iconsetspan')) {\n                iconSetSpan = td.querySelector('.e-iconsetspan');\n            }\n            td.textContent = '';\n            td.appendChild(databar);\n            if (iconSetSpan) {\n                td.insertBefore(iconSetSpan, td.firstElementChild);\n            }\n            dataSpan.innerHTML = this.parent.getDisplayText(actCell);\n            databar.style.height = rowHeight - 1 + 'px';\n            dataSpan.style.fontSize = '11pt';\n            if (!negArr.length) {\n                right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                right.height = rowHeight - 3 + 'px';\n                right.backgroundColor = cFColor = posColor;\n                right.left = '0px';\n            }\n            else if (!posArr.length) {\n                right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                right.height = rowHeight - 3 + 'px';\n                right.backgroundColor = cFColor = negColor;\n                right.left = '0px';\n            }\n            else {\n                if (value > -1) {\n                    left.width = leftStandardWidth + '%';\n                    left.height = rowHeight - 3 + 'px'; // -3 buffer of data bar.\n                    left.backgroundColor = 'transparent';\n                    left.left = '0px';\n                    right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                    right.height = rowHeight - 3 + 'px';\n                    right.backgroundColor = cFColor = posColor;\n                    right.left = leftStandardWidth + '%';\n                }\n                else if (value < 0) {\n                    left.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                    left.height = rowHeight - 3 + 'px';\n                    left.backgroundColor = negColor;\n                    if (left.width === leftStandardWidth + '%') {\n                        left.left = '0px';\n                    }\n                    else {\n                        left.right = (100 - leftStandardWidth) + '%';\n                    }\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.getNumericArray = function (selIndexes, valArr) {\n        var sheet = this.parent.getActiveSheet();\n        for (var rIdx = selIndexes[0]; rIdx <= selIndexes[2]; rIdx++) {\n            for (var cIdx = selIndexes[1]; cIdx <= selIndexes[3]; cIdx++) {\n                var cellVal = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                if (!isNullOrUndefined(cellVal) && !isNumber(cellVal) && !isDateTime(cellVal)) {\n                    continue;\n                }\n                else {\n                    var cellValue = parseInt(cellVal, 10);\n                    if (!isNullOrUndefined(cellVal) && cellVal !== '') {\n                        valArr.push(cellValue);\n                    }\n                }\n            }\n        }\n        return valArr;\n    };\n    ConditionalFormatting.prototype.getColor = function (cfColor) {\n        if (cfColor === 'LB') {\n            return ['#008aef'];\n        }\n        var colorCodeArr = cfColor.split('');\n        var colorArr = [];\n        for (var i = 0; i < colorCodeArr.length; i++) {\n            switch (colorCodeArr[i]) {\n                case 'G':\n                    colorArr.push('#63be7b');\n                    break;\n                case 'Y':\n                    colorArr.push('#ffeb84');\n                    break;\n                case 'R':\n                    colorArr.push('#f8696b');\n                    break;\n                case 'W':\n                    colorArr.push('#ffffff');\n                    break;\n                case 'B':\n                    colorArr.push('#5a8ac6');\n                    break;\n                case 'O':\n                    colorArr.push('#ffb628');\n                    break;\n                case 'LB':\n                    colorArr.push('#008aef');\n                    break;\n                case 'P':\n                    colorArr.push('#d6007b');\n                    break;\n            }\n        }\n        return colorArr;\n    };\n    ConditionalFormatting.prototype.getGradient = function (t, start, middle, end, large) {\n        if (isNullOrUndefined(end)) {\n            return this.getLinear(start, middle, t / large);\n        }\n        else {\n            var center = large / 2;\n            return t >= center ? this.getLinear(middle, end, Math.abs((t - center) / center)) : this.getLinear(start, middle, t / center);\n        }\n    };\n    ConditionalFormatting.prototype.getLinear = function (s, e, x) {\n        var r = this.byteLinear(s[1] + s[2], e[1] + e[2], x);\n        var g = this.byteLinear(s[3] + s[4], e[3] + e[4], x);\n        var b = this.byteLinear(s[5] + s[6], e[5] + e[6], x);\n        return '#' + r + g + b;\n    };\n    ConditionalFormatting.prototype.byteLinear = function (a, b, x) {\n        var y = (parseInt(a, 16) * (1 - x) + parseInt(b, 16) * x) | 0;\n        return Math.abs(y).toString(16);\n    };\n    ConditionalFormatting.prototype.isGreaterThanLessThan = function (cFRule, value, input, isGrearThan) {\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNumber(value)) {\n            if (isNumber(input)) {\n                isApply = isGrearThan ? parseFloat(value) > parseFloat(input.replace(txtRegx, '')) :\n                    parseFloat(value) < parseFloat(input.replace(txtRegx, ''));\n            }\n            else {\n                var dateEventArgs = {\n                    value: input,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    isDate: false,\n                    updatedVal: '',\n                    isTime: false\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (dateEventArgs.isDate || dateEventArgs.isTime) {\n                    isApply = isGrearThan ? value > dateEventArgs.updatedVal : value < dateEventArgs.updatedVal;\n                    cFRule.value = dateEventArgs.updatedVal.toString();\n                }\n                else {\n                    isApply = isGrearThan ? value.toLowerCase() > input.toLowerCase() : value.toLowerCase() < input.toLowerCase();\n                }\n            }\n        }\n        else if (value === '' && !isGrearThan) {\n            isApply = true;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isBetWeen = function (cFRule, value, input1, input2) {\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        input1 = input1.replace(txtRegx, '');\n        input2 = input2.replace(txtRegx, '');\n        if (isNumber(value)) {\n            if (isNumber(input1)) {\n                isApply = parseFloat(value) >= parseFloat(input1) && parseFloat(value) <= parseFloat(input2);\n            }\n            else {\n                if (input1 && input2) {\n                    var dateEventArgs1 = {\n                        value: input1,\n                        rowIndex: 0,\n                        colIndex: 0,\n                        sheetIndex: 0,\n                        isDate: false,\n                        updatedVal: '',\n                        isTime: false\n                    };\n                    var dateEventArgs2 = {\n                        value: input2,\n                        rowIndex: 0,\n                        colIndex: 0,\n                        sheetIndex: 0,\n                        isDate: false,\n                        updatedVal: '',\n                        isTime: false\n                    };\n                    this.parent.notify(checkDateFormat, dateEventArgs1);\n                    this.parent.notify(checkDateFormat, dateEventArgs2);\n                    if ((dateEventArgs1.isDate || dateEventArgs1.isTime) && (dateEventArgs2.isDate || dateEventArgs2.isTime)) {\n                        isApply = value >= dateEventArgs1.updatedVal && value <= dateEventArgs2.updatedVal;\n                        cFRule.value = dateEventArgs1.updatedVal.toString() + ',' + dateEventArgs2.updatedVal.toString();\n                    }\n                    else {\n                        isApply = value.toLowerCase() >= input1.toLowerCase() && value.toLowerCase() <= input2.toLowerCase();\n                    }\n                }\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isEqualTo = function (cFRule, value, input) {\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNumber(value)) {\n            if (isNumber(input)) {\n                isApply = parseFloat(value) === parseFloat(input.replace(txtRegx, ''));\n            }\n            else {\n                var dateTimeArgs = {\n                    value: input,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    isDate: false,\n                    updatedVal: '',\n                    isTime: false\n                };\n                this.parent.notify(checkDateFormat, dateTimeArgs);\n                if (dateTimeArgs.isTime || dateTimeArgs.isDate) {\n                    isApply = value === dateTimeArgs.updatedVal;\n                    cFRule.value = dateTimeArgs.updatedVal.toString();\n                }\n                else {\n                    isApply = value.toLowerCase() === input.toLowerCase();\n                }\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isContainsText = function (value, input) {\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNullOrUndefined(value) || !value.length) {\n            isApply = false;\n        }\n        else if (isNumber(input.replace(txtRegx, ''))) {\n            input = input.replace(txtRegx, '');\n            if (isDateTime(value)) {\n                value = ((dateToInt(value))).toString();\n            }\n            isApply = value.indexOf(input) > -1;\n        }\n        else if (isDateTime(input)) {\n            if (isDateTime(value)) {\n                value = dateToInt(value).toString();\n            }\n            isApply = value.indexOf(dateToInt(input).toString()) > -1;\n        }\n        else {\n            isApply = value.toLowerCase().indexOf(input.toLowerCase()) > -1;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isTopBottomTenValue = function (cellValue, inp, cFRule, isTop) {\n        var sheet = this.parent.getActiveSheet();\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var value = parseInt(cellValue, 10);\n        var input = parseInt(inp, 10);\n        var result = false;\n        if (isNumber(inp)) {\n            if (isNumber(cellValue)) {\n                value = parseFloat(cellValue);\n                input = parseFloat(inp.replace(txtRegx, ''));\n            }\n            else if (isDateTime(cellValue)) {\n                value = dateToInt(cellValue);\n                input = parseFloat(inp);\n            }\n            var dataArray = [];\n            var cellVal = void 0;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var cFRuleIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rowIdx = cFRuleIndexes[0]; rowIdx <= cFRuleIndexes[2]; rowIdx++) {\n                    for (var colIdx = cFRuleIndexes[1]; colIdx <= cFRuleIndexes[3]; colIdx++) {\n                        cellVal = getCell(rowIdx, colIdx, sheet) && getCell(rowIdx, colIdx, sheet).value ?\n                            getCell(rowIdx, colIdx, sheet).value : '';\n                        if (cellVal && isNumber(cellVal)) {\n                            cellVal = parseFloat(cellVal);\n                            dataArray.push(cellVal);\n                        }\n                    }\n                }\n            }\n            dataArray =\n                isTop ? dataArray.sort(function (n1, n2) { return n1 - n2; }).reverse() : dataArray.sort(function (n1, n2) { return n1 - n2; });\n            dataArray = dataArray.slice(0, input);\n            result = (dataArray.indexOf(value) > -1);\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.isTopBottomTenPercentage = function (val, inp, cFRule, isTop) {\n        var sheet = this.parent.getActiveSheet();\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var value = parseInt(val, 10);\n        var input = parseInt(inp, 10);\n        var result = false;\n        if (isNumber(inp)) {\n            if (isNumber(val)) {\n                value = parseFloat(val);\n                input = parseFloat(inp.replace(txtRegx, ''));\n            }\n            else if (isDateTime(val)) {\n                value = dateToInt(val);\n                input = parseFloat(inp);\n            }\n            var dataArr = [];\n            var cellVal = void 0;\n            var count = 0;\n            var considerCount = void 0;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var cFRuleIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rIdx = cFRuleIndexes[0]; rIdx <= cFRuleIndexes[2]; rIdx++) {\n                    for (var cIdx = cFRuleIndexes[1]; cIdx <= cFRuleIndexes[3]; cIdx++) {\n                        cellVal = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                        if (cellVal && isNumber(cellVal)) {\n                            cellVal = parseFloat(cellVal);\n                            dataArr.push(cellVal);\n                        }\n                        count++;\n                    }\n                }\n            }\n            var diff = 100 / count;\n            considerCount = input / diff;\n            considerCount = Math.ceil(considerCount);\n            dataArr =\n                isTop ? dataArr.sort(function (n1, n2) { return n1 - n2; }).reverse() : dataArr.sort(function (n1, n2) { return n1 - n2; });\n            dataArr = dataArr.slice(0, considerCount ? considerCount : 1);\n            result = (dataArr.indexOf(value) > -1);\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.isAboveBelowAverage = function (val, inp, cFRule, isAbove) {\n        var sheet = this.parent.getActiveSheet();\n        var value = parseFloat(val);\n        var rangeColl = cFRule.range.split(',');\n        var result = false;\n        var dataArr = [];\n        var cellValue;\n        var average = 0;\n        for (var rangeIdx = 0; rangeIdx < rangeColl.length; rangeIdx++) {\n            var cFRuleIndexes = getRangeIndexes(rangeColl[rangeIdx]);\n            for (var rIdx = cFRuleIndexes[0]; rIdx <= cFRuleIndexes[2]; rIdx++) {\n                for (var cIdx = cFRuleIndexes[1]; cIdx <= cFRuleIndexes[3]; cIdx++) {\n                    cellValue = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                    if (cellValue && isNumber(cellValue)) {\n                        cellValue = parseFloat(cellValue);\n                        dataArr.push(cellValue);\n                    }\n                }\n            }\n        }\n        for (var idx = 0; idx < dataArr.length; idx++) {\n            average += dataArr[idx];\n        }\n        average = average / dataArr.length;\n        result = isAbove ? (value > average) : (value < average);\n        return result;\n    };\n    ConditionalFormatting.prototype.isDuplicateUnique = function (val, cFRule) {\n        var type = cFRule.type;\n        var count = 0;\n        var sheet = this.parent.getActiveSheet();\n        var value = val;\n        var rangeColl = cFRule.range.split(',');\n        var cellValue;\n        if (isNullOrUndefined(value) || value === '') {\n            return false;\n        }\n        for (var rIdx = 0; rIdx < rangeColl.length; rIdx++) {\n            var cFRuleIndexes = getRangeIndexes(rangeColl[rIdx]);\n            for (var rowIdx = cFRuleIndexes[0]; rowIdx <= cFRuleIndexes[2]; rowIdx++) {\n                for (var colIdx = cFRuleIndexes[1]; colIdx <= cFRuleIndexes[3]; colIdx++) {\n                    cellValue = getCell(rowIdx, colIdx, sheet) && getCell(rowIdx, colIdx, sheet).value ?\n                        getCell(rowIdx, colIdx, sheet).value.toString() : '';\n                    if (cellValue && cellValue !== '') {\n                        count = value.toLowerCase() === cellValue.toLowerCase() ? count + 1 : count;\n                        if (count === 2) {\n                            return type === 'Duplicate' ? true : false;\n                        }\n                    }\n                }\n            }\n        }\n        return type === 'Duplicate' ? false : true;\n    };\n    ConditionalFormatting.prototype.setFormat = function (style, cFRule) {\n        switch (cFRule.cFColor) {\n            case 'RedFT':\n                style.backgroundColor = '#ffc7ce';\n                style.color = '#9c0055';\n                break;\n            case 'YellowFT':\n                style.backgroundColor = '#ffeb9c';\n                style.color = '#9c6500';\n                break;\n            case 'GreenFT':\n                style.backgroundColor = '#c6efce';\n                style.color = '#006100';\n                break;\n            case 'RedF':\n                style.backgroundColor = '#ffc7ce';\n                break;\n            case 'RedT':\n                style.color = '#9c0055';\n                break;\n        }\n        return style;\n    };\n    /**\n     * Gets the module name.\n     *\n     * @returns {string} - Gets the module name.\n     */\n    ConditionalFormatting.prototype.getModuleName = function () {\n        return 'conditionalFormatting';\n    };\n    return ConditionalFormatting;\n}());\nexport { ConditionalFormatting };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { Component, Property, NotifyPropertyChanges, Event, ChildProperty } from '@syncfusion/ej2-base';\nimport { getComponent, closest, EventHandler, getUniqueID, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Collection, Complex } from '@syncfusion/ej2-base';\nimport { Tab, Toolbar } from '@syncfusion/ej2-navigations';\nimport { Menu, Item, MenuItem } from '@syncfusion/ej2-navigations';\n/**\n * Objects used for configuring the Ribbon tab header properties.\n */\nvar RibbonHeader = /** @class */ (function (_super) {\n    __extends(RibbonHeader, _super);\n    function RibbonHeader() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], RibbonHeader.prototype, \"text\", void 0);\n    __decorate([\n        Property('')\n    ], RibbonHeader.prototype, \"iconCss\", void 0);\n    __decorate([\n        Property('left')\n    ], RibbonHeader.prototype, \"iconPosition\", void 0);\n    return RibbonHeader;\n}(ChildProperty));\nexport { RibbonHeader };\n/**\n * An array of object that is used to configure the Tab.\n */\nvar RibbonItem = /** @class */ (function (_super) {\n    __extends(RibbonItem, _super);\n    function RibbonItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Complex({}, RibbonHeader)\n    ], RibbonItem.prototype, \"header\", void 0);\n    __decorate([\n        Collection([], Item)\n    ], RibbonItem.prototype, \"content\", void 0);\n    __decorate([\n        Property('')\n    ], RibbonItem.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(false)\n    ], RibbonItem.prototype, \"disabled\", void 0);\n    return RibbonItem;\n}(ChildProperty));\nexport { RibbonItem };\n/**\n * Represents Ribbon component.\n */\nvar Ribbon = /** @class */ (function (_super) {\n    __extends(Ribbon, _super);\n    /**\n     * Constructor for creating the widget.\n     *\n     * @param {RibbonModel} options - Specify the options\n     * @param {string|HTMLDivElement} element -specify the element.\n     */\n    function Ribbon(options, element) {\n        return _super.call(this, options) || this;\n    }\n    /**\n     * For internal use only.\n     *\n     * @returns {void} - For internal use only.\n     * @private\n     */\n    Ribbon.prototype.preRender = function () {\n        /** */\n    };\n    /**\n     * For internal use only.\n     *\n     * @returns {void} - For internal use only.\n     * @private\n     */\n    Ribbon.prototype.render = function () {\n        if (!this.element.id) {\n            this.element.id = getUniqueID('ribbon');\n        }\n        this.renderRibbon();\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     *\n     * {% codeBlock src='spreadsheet/destroy/index.md' %}{% endcodeBlock %}\n     *\n     * @function destroy\n     * @returns {void} - Destroys the component\n     */\n    Ribbon.prototype.destroy = function () {\n        var expandCollapseElem = this.element.querySelector('.e-drop-icon');\n        if (expandCollapseElem) {\n            expandCollapseElem.removeEventListener('click', this.ribbonExpandCollapse.bind(this));\n        }\n        if (this.menuItems.length) {\n            var fileMenu = document.getElementById(this.element.id + \"_menu\");\n            if (fileMenu) {\n                getComponent(fileMenu, 'menu').destroy();\n            }\n        }\n        this.toolbarObj.destroy();\n        this.tabObj.destroy();\n        this.element.innerHTML = '';\n        this.toolbarObj = null;\n        this.tabObj = null;\n        _super.prototype.destroy.call(this);\n    };\n    Ribbon.prototype.getTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        if (this.menuItems.length) {\n            tabItems.push({\n                header: { text: this.initMenu(this.menuItems) },\n                content: this.toolbarObj.element,\n                cssClass: 'e-menu-tab'\n            });\n        }\n        this.items.forEach(function (item) {\n            tabItems.push({\n                header: item.header,\n                content: _this.toolbarObj.element\n            });\n        });\n        return tabItems;\n    };\n    Ribbon.prototype.initMenu = function (menuItems) {\n        var _this = this;\n        var menu = this.createElement('ul', { id: this.element.id + \"_menu\" });\n        this.element.appendChild(menu);\n        var menuObj = new Menu({\n            cssClass: 'e-file-menu',\n            items: menuItems,\n            showItemOnClick: true,\n            beforeOpen: function (args) {\n                if (args.parentItem.text === menuItems[0].text) {\n                    menuObj.showItemOnClick = false;\n                }\n                _this.trigger('beforeOpen', args);\n            },\n            select: function (args) {\n                _this.trigger('fileMenuItemSelect', args);\n            },\n            beforeClose: function (args) {\n                if (args.event.type === 'mouseover' && !closest(args.event.target, '.e-menu-popup')) {\n                    args.cancel = true;\n                    return;\n                }\n                _this.trigger('beforeClose', args);\n                if (!args.parentItem || args.parentItem.text === menuItems[0].text) {\n                    requestAnimationFrame(function () { return menuObj.setProperties({ showItemOnClick: true }, true); });\n                }\n            },\n            beforeItemRender: function (args) {\n                _this.trigger('beforeFileMenuItemRender', args);\n            }\n        });\n        menuObj.createElement = this.createElement;\n        menuObj.appendTo(menu);\n        return menu.parentElement;\n    };\n    Ribbon.prototype.renderRibbon = function () {\n        var _this = this;\n        var tabElement = this.createElement('div');\n        var tBarElement = this.createElement('div');\n        this.toolbarObj = new Toolbar({\n            items: this.items[this.selectedTab].content,\n            clicked: function (args) { return _this.trigger('clicked', args); }\n        });\n        this.toolbarObj.createElement = this.createElement;\n        this.toolbarObj.appendTo(tBarElement);\n        this.tabObj = new Tab({\n            selectedItem: this.getIndex(this.selectedTab),\n            animation: { next: { duration: 0 }, previous: { duration: 0 } },\n            items: this.getTabItems(),\n            selecting: function (args) {\n                if (_this.menuItems.length && args.selectingIndex === 0) {\n                    args.cancel = true;\n                }\n                else {\n                    if (args.selectingIndex === _this.getIndex(_this.selectedTab)) {\n                        return;\n                    }\n                    _this.updateToolbar(_this.getIndex(args.selectingIndex, true));\n                    _this.toolbarObj.dataBind();\n                    if (_this.element.classList.contains('e-collapsed')) {\n                        EventHandler.remove(args.selectedItem, 'click', _this.ribbonExpandCollapse);\n                    }\n                    var eventArgs = void 0;\n                    if (_this.menuItems.length) {\n                        eventArgs = __assign({}, args);\n                        eventArgs.selectingIndex -= 1;\n                        eventArgs.selectedIndex -= 1;\n                    }\n                    else {\n                        eventArgs = args;\n                    }\n                    _this.trigger('selecting', eventArgs);\n                }\n            },\n            selected: function (args) {\n                if (args.selectedIndex === _this.getIndex(_this.selectedTab)) {\n                    return;\n                }\n                _this.setProperties({ 'selectedTab': _this.getIndex(args.selectedIndex, true) }, true);\n                if (_this.element.classList.contains('e-collapsed')) {\n                    _this.element.classList.remove('e-collapsed');\n                    _this.trigger('expandCollapse', { element: _this.toolbarObj.element, expanded: true });\n                }\n            },\n            created: function () {\n                _this.toolbarObj.refreshOverflow();\n            }\n        });\n        this.element.appendChild(tabElement);\n        this.tabObj.createElement = this.createElement;\n        this.tabObj.appendTo(tabElement);\n        var collapseBtn = this.createElement('span', { className: 'e-drop-icon e-icons' });\n        collapseBtn.addEventListener('click', this.ribbonExpandCollapse.bind(this));\n        this.element.appendChild(collapseBtn);\n    };\n    Ribbon.prototype.ribbonExpandCollapse = function (e) {\n        var eventArgs = { element: this.toolbarObj.element, expanded: true };\n        var activeTab;\n        if (this.element.classList.contains('e-collapsed')) {\n            activeTab = this.tabObj.element.querySelector('.e-tab-header').getElementsByClassName('e-toolbar-item')[this.tabObj.selectedItem];\n            this.element.classList.remove('e-collapsed');\n            activeTab.classList.add('e-active');\n            EventHandler.remove(activeTab, 'click', this.ribbonExpandCollapse);\n            this.trigger('expandCollapse', eventArgs);\n        }\n        else {\n            activeTab = this.tabObj.element.querySelector('.e-tab-header .e-toolbar-item.e-active');\n            this.element.classList.add('e-collapsed');\n            eventArgs.expanded = false;\n            activeTab.classList.remove('e-active');\n            EventHandler.add(activeTab, 'click', this.ribbonExpandCollapse, this);\n            this.trigger('expandCollapse', eventArgs);\n        }\n    };\n    Ribbon.prototype.getIndex = function (index, decrement) {\n        return this.menuItems.length ? (decrement ? index - 1 : index + 1) : index;\n    };\n    Ribbon.prototype.updateToolbar = function (index) {\n        this.toolbarObj.items = this.items[index].content;\n        this.toolbarObj.dataBind();\n    };\n    /**\n     * To enable / disable the ribbon menu items.\n     *\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId - Set `true` if the given menu items `text` is a unique id.\n     * @returns {void} - To enable / disable the ribbon menu items.\n     */\n    Ribbon.prototype.enableMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu').enableItems(items, enable, isUniqueId);\n    };\n    /**\n     * To show/hide the menu items in Ribbon.\n     *\n     * @param {string[]} items - Specifies the menu items text which is to be show/hide.\n     * @param {boolean} hide - Set `true` / `false` to hide / show the menu items.\n     * @param {boolean} isUniqueId - Set `true` if the given menu items `text` is a unique id.\n     * @returns {void} - To show/hide the menu items in Ribbon.\n     */\n    Ribbon.prototype.hideMenuItems = function (items, hide, isUniqueId) {\n        if (hide === void 0) { hide = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        var menuInstance = getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu');\n        if (hide) {\n            menuInstance.hideItems(items, isUniqueId);\n        }\n        else {\n            menuInstance.showItems(items, isUniqueId);\n        }\n    };\n    /**\n     * To add custom menu items.\n     *\n     * @param {MenuItemModel[]} items - Specifies the Ribbon menu items to be inserted.\n     * @param {string} text - Specifies the existing file menu item text before / after which the new file menu items to be inserted.\n     * @param {boolean} insertAfter - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId - Set `true` if the given menu items `text` is a unique id.\n     * @returns {void} - To add custom menu items.\n     */\n    Ribbon.prototype.addMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        var menuInstance = getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu');\n        if (insertAfter) {\n            menuInstance.insertAfter(items.reverse(), text, isUniqueId);\n        }\n        else {\n            menuInstance.insertBefore(items, text, isUniqueId);\n        }\n    };\n    /**\n     * To show/hide the Ribbon tabs.\n     *\n     * @param {string[]} tabs - Specifies the tab header text which needs to be shown/hidden.\n     * @param {boolean} hide - Set `true` / `false` to hide / show the ribbon tabs.\n     * @returns {void} - To show/hide the Ribbon tabs.\n     */\n    Ribbon.prototype.hideTabs = function (tabs, hide) {\n        var _this = this;\n        if (hide === void 0) { hide = true; }\n        var idx;\n        var activeTab;\n        var stateChanged;\n        var isAllHidden;\n        if (!hide) {\n            isAllHidden = this.isAllHidden();\n        }\n        tabs.forEach(function (tab) {\n            idx = _this.getTabIndex(tab, -1);\n            if (idx > -1) {\n                if (hide) {\n                    if (!_this.items[idx].cssClass.includes(' e-hide')) {\n                        _this.items[idx].cssClass = _this.items[idx].cssClass + \" e-hide\";\n                        _this.tabObj.items[_this.getIndex(idx)].cssClass = _this.items[idx].cssClass;\n                        if (activeTab === undefined && idx === _this.selectedTab) {\n                            activeTab = true;\n                        }\n                        stateChanged = true;\n                    }\n                }\n                else {\n                    if (_this.items[idx].cssClass.includes(' e-hide')) {\n                        _this.items[idx].cssClass = _this.items[idx].cssClass.replace(' e-hide', '');\n                        _this.tabObj.items[_this.getIndex(idx)].cssClass = _this.items[idx].cssClass;\n                        if (activeTab === undefined && idx === _this.selectedTab) {\n                            activeTab = true;\n                        }\n                        stateChanged = true;\n                    }\n                }\n            }\n        });\n        this.setProperties({ 'items': this.items }, true);\n        // eslint-disable-next-line no-self-assign\n        this.tabObj.items = this.tabObj.items;\n        this.tabObj.dataBind();\n        if (hide) {\n            isAllHidden = this.isAllHidden();\n            if (isAllHidden) {\n                activeTab = false;\n            }\n        }\n        if (!hide && isAllHidden) {\n            activeTab = activeTab ? false : true;\n        }\n        if (stateChanged && isAllHidden) {\n            if (this.element.classList.contains('e-collapsed')) {\n                this.element.classList.remove('e-collapsed');\n                this.element.querySelector('.e-drop-icon').classList.remove('e-hide');\n            }\n            else {\n                this.element.classList.add('e-collapsed');\n                this.element.querySelector('.e-drop-icon').classList.add('e-hide');\n            }\n        }\n        if (activeTab) {\n            for (var i = 0; i < this.items.length; i++) {\n                if (!this.items[i].cssClass.includes(' e-hide')) {\n                    this.tabObj.selectedItem = this.getIndex(i);\n                    this.tabObj.dataBind();\n                    break;\n                }\n            }\n        }\n    };\n    Ribbon.prototype.isAllHidden = function () {\n        var allHidden = true;\n        for (var i = 0; i < this.items.length; i++) {\n            if (!this.items[i].cssClass.includes(' e-hide')) {\n                allHidden = false;\n                break;\n            }\n        }\n        return allHidden;\n    };\n    /**\n     * To enable / disable the Ribbon tabs.\n     *\n     * @param {string[]} tabs - Specifies the tab header text which needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the ribbon tabs.\n     * @returns {void} - To enable / disable the Ribbon tabs.\n     */\n    Ribbon.prototype.enableTabs = function (tabs, enable) {\n        var _this = this;\n        if (enable === void 0) { enable = true; }\n        tabs.forEach(function (tab) {\n            var idx = (_this.getTabIndex(tab, -1));\n            if (idx > -1) {\n                _this.items[idx].disabled = !enable;\n                idx = _this.getIndex(idx);\n                _this.tabObj.enableTab(idx, enable);\n            }\n        });\n        this.setProperties({ 'items': this.items }, true);\n    };\n    /**\n     * To add custom tabs.\n     *\n     * @param {RibbonItemModel[]} items - Specifies the Ribbon tab items to be inserted.\n     * @param {string} insertBefore - Specifies the existing Ribbon header text before which the new tabs will be inserted.\n     * If not specified, the new tabs will be inserted at the end.\n     * @returns {void} - To add custom tabs.\n     */\n    Ribbon.prototype.addTabs = function (items, insertBefore) {\n        var _this = this;\n        var idx = this.getTabIndex(insertBefore);\n        items.forEach(function (item) {\n            item = new RibbonItem(_this.items[0], 'items', item, true);\n            _this.items.splice(idx, 0, item);\n            _this.tabObj.addTab([{ header: item.header, content: _this.toolbarObj.element }], _this.getIndex(idx));\n            idx++;\n        });\n        this.setProperties({ 'items': this.items }, true);\n        this.setProperties({ 'selectedTab': this.getIndex(this.tabObj.selectedItem, true) }, true);\n    };\n    Ribbon.prototype.getTabIndex = function (headerText, idx) {\n        if (idx === void 0) { idx = this.items.length; }\n        if (headerText) {\n            for (var i = 0; i < this.items.length; i++) {\n                if (this.items[i].header.text === headerText) {\n                    idx = i;\n                    break;\n                }\n            }\n        }\n        return idx;\n    };\n    /**\n     * To add the custom items in Ribbon toolbar.\n     *\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items will be inserted..\n     * @param {ItemModel[]} items - Specifies the ribbon toolbar items that needs to be inserted.\n     * @param {number} index - Specifies the index text before which the new items will be inserted.\n     * @returns {void} - To add the custom items in Ribbon toolbar.\n     * If not specified, the new items will be inserted at the end of the toolbar.\n     */\n    Ribbon.prototype.addToolbarItems = function (tab, items, index) {\n        var _this = this;\n        var tabIdx = this.getTabIndex(tab);\n        if (isNullOrUndefined(index)) {\n            index = this.items[tabIdx].content.length;\n        }\n        items.forEach(function (item) {\n            item = new Item(_this.items[tabIdx].content[0], 'content', item, true);\n            _this.items[tabIdx].content.splice(index, 0, item);\n            index++;\n        });\n        this.setProperties({ 'items': this.items }, true);\n        if (tabIdx === this.selectedTab && items.length) {\n            this.updateToolbar(tabIdx);\n        }\n    };\n    /**\n     * Enables or disables the specified Ribbon toolbar items or all ribbon items.\n     *\n     * @param {string} tab - Specifies the ribbon tab header text under which the toolbar items need to be enabled / disabled.\n     * @param {number[]} items - Specifies the toolbar item indexes / unique id's which needs to be enabled / disabled.\n     * If it is not specified the entire toolbar items will be enabled / disabled.\n     * @param  {boolean} enable - Boolean value that determines whether the toolbar items should be enabled or disabled.\n     * @returns {void} - Enables or disables the specified Ribbon toolbar items or all ribbon items.\n     */\n    Ribbon.prototype.enableItems = function (tab, items, enable) {\n        if (enable === undefined) {\n            enable = true;\n        }\n        if (items) {\n            var tabIdx = this.getTabIndex(tab, -1);\n            if (tabIdx < 0) {\n                return;\n            }\n            for (var i = 0; i < items.length; i++) {\n                if (typeof (items[i]) === 'string') {\n                    for (var j = 0; j < this.items[tabIdx].content.length; j++) {\n                        if (this.items[tabIdx].content[j].id === items[i]) {\n                            items[i] = j;\n                            break;\n                        }\n                    }\n                }\n                if (typeof (items[i]) === 'string') {\n                    return;\n                }\n                this.items[tabIdx].content[items[i]].disabled = !enable;\n                if (tabIdx !== this.selectedTab) {\n                    this.setProperties({ 'items': this.items }, true);\n                }\n            }\n            if (tabIdx === this.selectedTab) {\n                this.updateToolbar(tabIdx);\n            }\n        }\n        else {\n            this.toolbarObj.disable(!enable);\n        }\n    };\n    /**\n     * To show/hide the existing Ribbon toolbar items.\n     *\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items need to be hidden / shown.\n     * @param {number[]} indexes - Specifies the toolbar indexes which needs to be shown/hidden from UI.\n     * @param {boolean} hide - Set `true` / `false` to hide / show the toolbar items.\n     * @returns {void} - To show/hide the existing Ribbon toolbar items.\n     */\n    Ribbon.prototype.hideToolbarItems = function (tab, indexes, hide) {\n        var _this = this;\n        if (hide === void 0) { hide = true; }\n        var tabIdx;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].header.text === tab) {\n                tabIdx = i;\n                indexes.forEach(function (idx) {\n                    if (_this.items[tabIdx].content[idx]) {\n                        if (hide) {\n                            if (!_this.items[tabIdx].content[idx].cssClass.includes(' e-hide')) {\n                                _this.items[tabIdx].content[idx].cssClass = _this.items[tabIdx].content[idx].cssClass + ' e-hide';\n                            }\n                        }\n                        else {\n                            if (_this.items[tabIdx].content[idx].cssClass.includes(' e-hide')) {\n                                _this.items[tabIdx].content[idx].cssClass = _this.items[tabIdx].content[idx].cssClass.replace(' e-hide', '');\n                            }\n                        }\n                    }\n                });\n                break;\n            }\n        }\n        this.setProperties({ 'items': this.items }, true);\n        if (tabIdx !== undefined && tabIdx === this.selectedTab) {\n            this.updateToolbar(tabIdx);\n        }\n    };\n    /**\n     * Get component name.\n     *\n     * @returns {string} - Get component name.\n     * @private\n     */\n    Ribbon.prototype.getModuleName = function () {\n        return 'ribbon';\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     *\n     * @returns {string} - Get the properties to be maintained in the persisted state.\n     * @private\n     */\n    Ribbon.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     *\n     * @param {RibbonModel} newProp - Specify the new properties\n     * @param {RibbonModel} oldProp - specify the old properties.\n     * @returns {void} - if any of the property value changed.\n     * @private\n     */\n    Ribbon.prototype.onPropertyChanged = function (newProp, oldProp) {\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'selectedTab':\n                    this.tabObj.selectedItem = this.getIndex(newProp.selectedTab);\n                    this.tabObj.dataBind();\n                    break;\n            }\n        }\n    };\n    __decorate([\n        Property('')\n    ], Ribbon.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(true)\n    ], Ribbon.prototype, \"menuType\", void 0);\n    __decorate([\n        Collection([], MenuItem)\n    ], Ribbon.prototype, \"menuItems\", void 0);\n    __decorate([\n        Property(0)\n    ], Ribbon.prototype, \"selectedTab\", void 0);\n    __decorate([\n        Collection([], RibbonItem)\n    ], Ribbon.prototype, \"items\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"selecting\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"fileMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeFileMenuItemRender\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"selectFormat\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"clicked\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"expandCollapse\", void 0);\n    Ribbon = __decorate([\n        NotifyPropertyChanges\n    ], Ribbon);\n    return Ribbon;\n}(Component));\nexport { Ribbon };\n","import { ColorPicker as ColorPickerComponent } from '@syncfusion/ej2-inputs';\nimport { addClass } from '@syncfusion/ej2-base';\nimport { spreadsheetDestroyed, fontColor, fillColor, beforeRibbonCreate, locale, focus } from '../common/index';\nimport { setCellFormat } from '../../workbook/common/index';\n/**\n * `Color Picker` module is used to handle ColorPicker functionality.\n *\n * @hidden\n */\nvar ColorPicker = /** @class */ (function () {\n    function ColorPicker(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    ColorPicker.prototype.render = function () {\n        var _this = this;\n        var id = this.parent.element.id;\n        var input = this.parent.createElement('input', { attrs: { 'type': 'color' } });\n        this.fontColorPicker = new ColorPickerComponent({\n            value: '#000000ff',\n            mode: 'Palette',\n            showButtons: false,\n            presetColors: fontColor,\n            enableOpacity: false,\n            beforeClose: function () { return _this.beforeCloseHandler(_this.fontColorPicker); },\n            open: this.openHandler.bind(this),\n            beforeModeSwitch: function (args) { return _this.beforeModeSwitch(_this.fontColorPicker, args); },\n            change: function (args) {\n                var color = _this.fontColorPicker.getValue(args.currentValue.rgba);\n                var eventArgs = { style: { color: color }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (eventArgs.cancel) {\n                    _this.fontColorPicker.setProperties({ 'value': _this.fontColorPicker.getValue(args.previousValue.rgba, 'HEXA') }, true);\n                }\n                else {\n                    _this.updateSelectedColor(eventArgs.style.color, _this.fontColorPicker.element);\n                }\n                focus(_this.parent.element);\n            },\n            created: function () { return _this.wireFocusEvent(_this.fontColorPicker.element, '#000000'); }\n        });\n        this.fontColorPicker.createElement = this.parent.createElement;\n        this.parent.element.appendChild(input);\n        this.fontColorPicker.appendTo(input);\n        input.parentElement.id = id + \"_font_color_picker\";\n        addClass([input.nextElementSibling.getElementsByClassName('e-selected-color')[0]], ['e-icons', 'e-font-color']);\n        input = this.parent.createElement('input', { attrs: { 'type': 'color' } });\n        this.filColorPicker = new ColorPickerComponent({\n            value: '#ffff00ff',\n            mode: 'Palette',\n            presetColors: fillColor,\n            showButtons: false,\n            enableOpacity: false,\n            open: this.openHandler.bind(this),\n            beforeClose: function () { return _this.beforeCloseHandler(_this.filColorPicker); },\n            beforeModeSwitch: function (args) { return _this.beforeModeSwitch(_this.filColorPicker, args); },\n            change: function (args) {\n                var color = _this.filColorPicker.getValue(args.currentValue.rgba);\n                var eventArgs = { style: { backgroundColor: color }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (eventArgs.cancel) {\n                    _this.filColorPicker.setProperties({ 'value': _this.filColorPicker.getValue(args.previousValue.rgba, 'HEXA') }, true);\n                }\n                else {\n                    _this.updateSelectedColor(eventArgs.style.backgroundColor, _this.filColorPicker.element);\n                }\n                focus(_this.parent.element);\n            },\n            created: function () { return _this.wireFocusEvent(_this.filColorPicker.element, '#ffff00'); }\n        });\n        this.filColorPicker.createElement = this.parent.createElement;\n        this.parent.element.appendChild(input);\n        this.filColorPicker.appendTo(input);\n        input.parentElement.id = id + \"_fill_color_picker\";\n        addClass([input.nextElementSibling.getElementsByClassName('e-selected-color')[0]], ['e-icons', 'e-fill-color']);\n    };\n    ColorPicker.prototype.updateSelectedColor = function (color, ele) {\n        ele.nextElementSibling.querySelector('.e-selected-color').style.borderBottomColor = color;\n    };\n    ColorPicker.prototype.wireFocusEvent = function (element, color) {\n        var _this = this;\n        this.updateSelectedColor(color, element);\n        element = element.parentElement.querySelector('.e-split-colorpicker');\n        element.addEventListener('focus', function () {\n            focus(_this.parent.element);\n        });\n    };\n    ColorPicker.prototype.openHandler = function (args) {\n        args.element.querySelector('.e-mode-switch-btn').title =\n            this.parent.serviceLocator.getService(locale).getConstant('MoreColors');\n    };\n    ColorPicker.prototype.beforeCloseHandler = function (inst) {\n        if (!inst.modeSwitcher) {\n            inst.setProperties({ modeSwitcher: true }, true);\n        }\n        if (inst.showButtons) {\n            inst.setProperties({ showButtons: false }, true);\n        }\n    };\n    ColorPicker.prototype.beforeModeSwitch = function (inst, args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.mode === 'Picker') {\n            inst.showButtons = true;\n            inst.dataBind();\n            args.element.querySelector('.e-apply').title = l10n.getConstant('Apply');\n            args.element.querySelector('.e-cancel').title = l10n.getConstant('Cancel');\n            args.element.querySelector('.e-mode-switch-btn').title = l10n.getConstant('StandardColors');\n        }\n        else {\n            inst.showButtons = false;\n            inst.dataBind();\n            args.element.querySelector('.e-mode-switch-btn').title = l10n.getConstant('MoreColors');\n        }\n    };\n    ColorPicker.prototype.destroy = function () {\n        if (this.parent) {\n            this.removeEventListener();\n            this.fontColorPicker.destroy();\n            this.fontColorPicker = null;\n            this.filColorPicker.destroy();\n            this.filColorPicker = null;\n            this.parent = null;\n        }\n    };\n    ColorPicker.prototype.addEventListener = function () {\n        this.parent.on(beforeRibbonCreate, this.render, this);\n        this.parent.on('destroyRibbonComponents', this.destroy, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    ColorPicker.prototype.removeEventListener = function () {\n        this.parent.off(beforeRibbonCreate, this.render);\n        this.parent.off('destroyRibbonComponents', this.destroy);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    return ColorPicker;\n}());\nexport { ColorPicker };\n","import { Ribbon as RibbonComponent } from '../../ribbon/index';\nimport { ribbon, selectionComplete, beforeRibbonCreate, removeDataValidation, clearViewer } from '../common/index';\nimport { initiateDataValidation, invalidData, setUndoRedo, initiateConditionalFormat, setCF, focus, freeze } from '../common/index';\nimport { dialog, reapplyFilter, enableFileMenuItems, applyProtect, protectCellFormat, protectWorkbook } from '../common/index';\nimport { findHandler, insertChart, chartDesignTab, unProtectWorkbook } from '../common/index';\nimport { destroyComponent, performUndoRedo, beginAction, completeAction, applySort, hideRibbonTabs } from '../common/index';\nimport { enableToolbarItems, ribbonClick, paste, locale, refreshSheetTabs, initiateCustomSort, getFilteredColumn } from '../common/index';\nimport { tabSwitch, getUpdateUsingRaf, updateToggleItem, initiateHyperlink, editHyperlink } from '../common/index';\nimport { addRibbonTabs, addToolbarItems, hideFileMenuItems, addFileMenuItems, hideToolbarItems, enableRibbonTabs } from '../common/index';\nimport { Toolbar, Menu } from '@syncfusion/ej2-navigations';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\nimport { extend, isNullOrUndefined, getComponent, closest, detach, selectAll, select, EventHandler } from '@syncfusion/ej2-base';\nimport { getCellIndexes, getFormatFromType, getTypeFromFormat, setCell } from '../../workbook/index';\nimport { DropDownButton, SplitButton } from '@syncfusion/ej2-splitbuttons';\nimport { calculatePosition } from '@syncfusion/ej2-popups';\nimport { applyNumberFormatting, getFormattedCellObject, getRangeIndexes, ribbonFind, setMerge } from '../../workbook/common/index';\nimport { activeCellChanged, textDecorationUpdate, isNumber } from '../../workbook/common/index';\nimport { sheetsDestroyed, getRangeAddress, clearCFRule } from '../../workbook/common/index';\nimport { getCell, setCellFormat } from '../../workbook/index';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { ColorPicker as RibbonColorPicker } from './color-picker';\nimport { Dialog as FindDialog } from '@syncfusion/ej2-popups';\nimport { findDlg, insertDesignChart, removeDesignChart, getScrollBarWidth } from '../common/index';\nimport { refreshRibbonIcons } from '../../workbook/common/index';\n/**\n * Represents Ribbon for Spreadsheet.\n */\nvar Ribbon = /** @class */ (function () {\n    function Ribbon(parent) {\n        this.border = '1px solid #000000';\n        this.fontNameIndex = 5;\n        this.numPopupWidth = 0;\n        this.findValue = '';\n        this.preTabIdx = 1;\n        this.chartThemeIndex = 5;\n        this.parent = parent;\n        this.addEventListener();\n        new RibbonColorPicker(parent);\n    }\n    Ribbon.prototype.getModuleName = function () {\n        return 'ribbon';\n    };\n    Ribbon.prototype.initRibbon = function (args) {\n        if (!this.parent.showRibbon && this.ribbon) {\n            this.destroy();\n            return;\n        }\n        this.parent.notify(beforeRibbonCreate, {});\n        if (this.parent.isMobileView()) {\n            this.createMobileView();\n        }\n        else {\n            this.createRibbon(args);\n        }\n    };\n    Ribbon.prototype.getRibbonMenuItems = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var id = this.parent.element.id;\n        return [{\n                text: this.parent.isMobileView() ? '' : l10n.getConstant('File'),\n                iconCss: this.parent.isMobileView() ? 'e-icons e-file-menu-icon' : null, id: id + \"_File\",\n                items: [\n                    { text: l10n.getConstant('New'), id: id + \"_New\", iconCss: 'e-new e-icons' },\n                    { text: l10n.getConstant('Open'), id: id + \"_Open\", iconCss: 'e-open e-icons' },\n                    {\n                        text: l10n.getConstant('SaveAs'), iconCss: 'e-save e-icons', id: id + \"_Save_As\",\n                        items: [\n                            { text: l10n.getConstant('ExcelXlsx'), id: id + \"_Xlsx\", iconCss: 'e-xlsx e-icons' },\n                            { text: l10n.getConstant('ExcelXls'), id: id + \"_Xls\", iconCss: 'e-xls e-icons' },\n                            { text: l10n.getConstant('CSV'), id: id + \"_Csv\", iconCss: 'e-csv e-icons' },\n                            { text: l10n.getConstant('PDF'), id: id + \"_Pdf\", iconCss: 'e-pdf e-icons' }\n                        ]\n                    }\n                ]\n            }];\n    };\n    Ribbon.prototype.getRibbonItems = function () {\n        var _this = this;\n        var id = this.parent.element.id;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var items = [{\n                header: { text: l10n.getConstant('Home') },\n                content: [\n                    { prefixIcon: 'e-undo-icon', tooltipText: l10n.getConstant('Undo') + \" (Ctrl+Z)\", id: id + '_undo', disabled: true },\n                    { prefixIcon: 'e-redo-icon', tooltipText: l10n.getConstant('Redo') + \" (Ctrl+Y)\", id: id + '_redo', disabled: true },\n                    { type: 'Separator', id: id + '_separator_1' },\n                    { prefixIcon: 'e-cut-icon', tooltipText: l10n.getConstant('Cut') + \" (Ctrl+X)\", id: id + '_cut' },\n                    { prefixIcon: 'e-copy-icon', tooltipText: l10n.getConstant('Copy') + \" (Ctrl+C)\", id: id + '_copy' },\n                    { tooltipText: l10n.getConstant('Paste') + \" (Ctrl+V)\", template: this.getPasteBtn(id), id: id + '_paste',\n                        disabled: true\n                    }, { type: 'Separator', id: id + '_separator_2' },\n                    { template: this.getNumFormatDDB(id), tooltipText: l10n.getConstant('NumberFormat'), id: id + '_number_format' },\n                    { type: 'Separator', id: id + '_separator_3' },\n                    { template: this.getFontNameDDB(id), tooltipText: l10n.getConstant('Font'), id: id + '_font_name' },\n                    { type: 'Separator', id: id + '_separator_4' },\n                    { template: this.getFontSizeDDB(id), tooltipText: l10n.getConstant('FontSize'), id: id + '_font_size' },\n                    { type: 'Separator', id: id + '_separator_5' },\n                    { template: this.getBtn(id, 'bold'), tooltipText: l10n.getConstant('Bold') + \" (Ctrl+B)\", id: id + '_bold' },\n                    { template: this.getBtn(id, 'italic'), tooltipText: l10n.getConstant('Italic') + \" (Ctrl+I)\", id: id + '_italic' },\n                    { template: this.getBtn(id, 'line-through'), tooltipText: l10n.getConstant('Strikethrough') + \" (Ctrl+5)\",\n                        id: id + '_line-through' },\n                    { template: this.getBtn(id, 'underline'), tooltipText: l10n.getConstant('Underline') + \" (Ctrl+U)\",\n                        id: id + '_underline' },\n                    { template: document.getElementById(id + \"_font_color_picker\"), tooltipText: l10n.getConstant('TextColor'),\n                        id: id + '_font_color_picker' }, { type: 'Separator', id: id + '_separator_6' },\n                    { template: document.getElementById(id + \"_fill_color_picker\"), tooltipText: l10n.getConstant('FillColor'),\n                        id: id + '_fill_color_picker' },\n                    { template: this.getBordersDBB(id), tooltipText: l10n.getConstant('Borders'), id: id + '_borders' }, {\n                        template: this.getMergeSplitBtn(id), tooltipText: l10n.getConstant('MergeCells'), id: id + '_merge_cells',\n                        disabled: true\n                    }, { type: 'Separator', id: id + '_separator_7' },\n                    { template: this.getTextAlignDDB(id), tooltipText: l10n.getConstant('HorizontalAlignment'), id: id + '_text_align' }, { template: this.getVerticalAlignDDB(id), tooltipText: l10n.getConstant('VerticalAlignment'), id: id + '_vertical_align' },\n                    { template: this.getBtn(id, 'wrap', false), tooltipText: \"\" + l10n.getConstant('WrapText'), id: id + '_wrap' }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('Insert') }, content: [\n                    {\n                        prefixIcon: 'e-hyperlink-icon', text: l10n.getConstant('Link'),\n                        id: id + '_hyperlink', tooltipText: l10n.getConstant('Link'), click: function () { _this.getHyperlinkDlg(); }\n                    },\n                    {\n                        prefixIcon: 'e-image-icon', text: l10n.getConstant('Image'),\n                        id: id + '_', tooltipText: l10n.getConstant('Image'), click: function () {\n                            select('#' + id + '_imageUpload', _this.parent.element).click();\n                        }\n                    }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('Formulas') }, content: [{\n                        prefixIcon: 'e-insert-function', tooltipText: l10n.getConstant('InsertFunction'),\n                        text: l10n.getConstant('InsertFunction'), id: id + '_insert_function'\n                    }]\n            },\n            {\n                header: { text: l10n.getConstant('Data') }, content: [\n                    {\n                        prefixIcon: 'e-protect-icon', text: l10n.getConstant('ProtectSheet'), id: id + '_protect',\n                        tooltipText: l10n.getConstant('ProtectSheet')\n                    },\n                    {\n                        prefixIcon: 'e-password-protect-icon', text: l10n.getConstant('ProtectWorkbook'), id: id + '_protectworkbook',\n                        tooltipText: l10n.getConstant('ProtectWorkbook')\n                    },\n                    { type: 'Separator', id: id + '_separator_8' },\n                    {\n                        template: this.datavalidationDDB(id), tooltipText: l10n.getConstant('DataValidation'),\n                        id: id + '_datavalidation'\n                    }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('View') }, content: [\n                    {\n                        prefixIcon: 'e-hide-headers', text: this.getLocaleText('Headers'), id: id + '_headers',\n                        tooltipText: this.getLocaleText('Headers')\n                    }, { type: 'Separator', id: id + '_separator_9' },\n                    {\n                        prefixIcon: 'e-hide-gridlines', text: this.getLocaleText('GridLines'), id: id + '_gridlines',\n                        tooltipText: this.getLocaleText('GridLines')\n                    },\n                    { type: 'Separator', id: id + '_separator_13' },\n                    { prefixIcon: 'e-freeze-pane', text: l10n.getConstant('FreezePanes'), id: id + '_freezepanes', tooltipText: l10n.getConstant('FreezePanes') },\n                    { prefixIcon: 'e-freeze-row', text: l10n.getConstant('FreezeRows'), id: id + '_freezerows', tooltipText: l10n.getConstant('FreezeRows') },\n                    { prefixIcon: 'e-freeze-column', text: l10n.getConstant('FreezeColumns'), id: id + '_freezecolumns', tooltipText: l10n.getConstant('FreezeColumns') }\n                ]\n            }];\n        if (this.parent.allowConditionalFormat) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ type: 'Separator', id: id + '_separator_10' }, { template: this.getCFDBB(id), tooltipText: l10n.getConstant('ConditionalFormatting'), id: id + '_conditionalformatting' });\n        }\n        if (this.parent.allowChart) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Insert'); }).content.push({ type: 'Separator', id: id + '_separator_11' }, {\n                template: this.getChartDDB(id, true), text: l10n.getConstant('Chart'),\n                tooltipText: l10n.getConstant('Chart'), id: id + '_chart'\n            });\n        }\n        if (this.parent.allowCellFormatting) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ type: 'Separator', id: id + '_separator_12' }, { template: this.getClearDDB(id), tooltipText: l10n.getConstant('Clear'), id: id + '_clear' });\n        }\n        if (this.parent.allowSorting || this.parent.allowFiltering) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ template: this.getSortFilterDDB(id), tooltipText: l10n.getConstant('SortAndFilter'), id: id + '_sorting' });\n        }\n        if (this.parent.allowFindAndReplace) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({\n                template: this.getFindDDb(id), prefixIcon: 'e-tbar-search-icon tb-icons',\n                tooltipText: l10n.getConstant('FindReplaceTooltip'), id: id + '_find'\n            });\n        }\n        return items;\n    };\n    Ribbon.prototype.getPasteBtn = function (id) {\n        var _this = this;\n        var btn = this.parent.element.appendChild(this.parent.createElement('button', { id: id + '_paste' }));\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.pasteSplitBtn = new SplitButton({\n            iconCss: 'e-icons e-paste-icon',\n            items: [\n                { text: l10n.getConstant('All'), id: 'All' },\n                { text: l10n.getConstant('Values'), id: 'Values' },\n                { text: l10n.getConstant('Formats'), id: 'Formats' }\n            ],\n            select: function (args) {\n                _this.parent.notify(paste, { type: args.item.id, isAction: true, isInternal: true });\n            },\n            click: function () {\n                _this.parent.notify(paste, { isAction: true, isInternal: true });\n            },\n            close: function () { focus(_this.parent.element); }\n        });\n        this.pasteSplitBtn.createElement = this.parent.createElement;\n        this.pasteSplitBtn.appendTo(btn);\n        return btn.parentElement;\n    };\n    Ribbon.prototype.getHyperlinkDlg = function () {\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var row = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]];\n        var cell;\n        if (!isNullOrUndefined(row)) {\n            cell = row.cells[indexes[1]];\n        }\n        if (isNullOrUndefined(cell)) {\n            setCell(indexes[0], indexes[1], this.parent.getActiveSheet(), cell, false);\n        }\n        if (cell && cell.hyperlink) {\n            this.parent.notify(editHyperlink, null);\n        }\n        else {\n            this.parent.notify(initiateHyperlink, null);\n        }\n    };\n    Ribbon.prototype.passwordProtectDlg = function () {\n        if (this.parent.password.length > 0) {\n            this.parent.notify(unProtectWorkbook, null);\n        }\n        else {\n            if (document.getElementById(this.parent.element.id + '_protectworkbook').classList.contains('e-active')) {\n                document.getElementById(this.parent.element.id + '_protectworkbook').classList.remove('e-active');\n                if (this.parent.showSheetTabs) {\n                    this.parent.element.querySelector('.e-add-sheet-tab').removeAttribute('disabled');\n                }\n            }\n            else {\n                this.parent.notify(protectWorkbook, null);\n            }\n        }\n    };\n    Ribbon.prototype.getLocaleText = function (str, setClass) {\n        var text;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet['show' + str]) {\n            if (setClass) {\n                document.getElementById(this.parent.element.id + '_sheet').classList.remove('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Hide' + str);\n        }\n        else {\n            if (setClass) {\n                document.getElementById(this.parent.element.id + '_sheet').classList.add('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Show' + str);\n        }\n        return text;\n    };\n    Ribbon.prototype.getLocaleProtectText = function (str, setClass) {\n        var text;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected) {\n            if (setClass) {\n                this.parent.getMainContent().classList.remove('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Unprotect' + str);\n        }\n        else {\n            if (setClass) {\n                this.parent.getMainContent().classList.add('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Protect' + str);\n        }\n        return text;\n    };\n    Ribbon.prototype.getLocaleProtectWorkbook = function (str, setClass) {\n        var text;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.parent.isProtected) {\n            if (setClass) {\n                this.parent.getMainContent().classList.remove('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant(str);\n        }\n        else {\n            if (setClass) {\n                this.parent.getMainContent().classList.add('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant(str);\n        }\n        return text;\n    };\n    Ribbon.prototype.insertDesignChart = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var tabIdx = this.ribbon.items.length - 1;\n        this.preTabIdx = this.ribbon.selectedTab;\n        if (this.parent.allowChart && this.ribbon.items[tabIdx] && this.ribbon.items[tabIdx].header.text !==\n            l10n.getConstant('ChartDesign')) {\n            var id = this.parent.element.id;\n            var items = [{\n                    header: { text: l10n.getConstant('ChartDesign') },\n                    content: [\n                        {\n                            template: this.getAddChartEleDBB(id),\n                            tooltipText: l10n.getConstant('AddChartElement'), id: id + 'add_chart_ element_chart'\n                        },\n                        { type: 'Separator' },\n                        {\n                            prefixIcon: 'e-switch-row-column-icon', text: l10n.getConstant('SwitchRowColumn'),\n                            tooltipText: l10n.getConstant('SwitchRowColumn'),\n                            id: id + 'switch_row_column_chart', click: function () {\n                                _this.parent.notify(chartDesignTab, { switchRowColumn: true });\n                            }\n                        },\n                        { type: 'Separator' },\n                        { template: this.getChartThemeDDB(id), tooltipText: l10n.getConstant('ChartTheme'), id: id + '_chart_theme' },\n                        { type: 'Separator' },\n                        { template: this.getChartDDB(id, false), tooltipText: l10n.getConstant('ChartType'), id: id + '_chart_type' }\n                    ]\n                }];\n            this.parent.addRibbonTabs(items);\n            tabIdx = this.ribbon.items.length;\n            this.ribbon.tabObj.select(tabIdx);\n        }\n    };\n    Ribbon.prototype.removeDesignChart = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var tabIdx = this.ribbon.items.length - 1;\n        if (this.parent.allowChart && this.ribbon.items[tabIdx] && this.ribbon.items[tabIdx].header.text ===\n            l10n.getConstant('ChartDesign')) {\n            this.ribbon.tabObj.select(this.preTabIdx + 1);\n            this.parent.hideRibbonTabs([l10n.getConstant('ChartDesign')], true);\n            if (document.getElementsByClassName('e-addchart-ddb').length > 0) {\n                document.getElementsByClassName('e-addchart-ddb')[0].remove();\n            }\n            if (document.getElementsByClassName('e-chart-type-ddb').length > 0) {\n                document.getElementsByClassName('e-chart-type-ddb')[0].remove();\n            }\n            if (document.getElementsByClassName('e-charttheme-ddb').length > 0) {\n                document.getElementsByClassName('e-charttheme-ddb')[0].remove();\n            }\n            delete this.ribbon.items[tabIdx].content[0];\n            this.ribbon.items.length = this.ribbon.items.length - 1;\n        }\n    };\n    Ribbon.prototype.createRibbon = function (args) {\n        var ribbonElement = this.parent.createElement('div', { id: this.parent.element.id + \"_ribbon\" });\n        this.ribbon = new RibbonComponent({\n            selectedTab: 0,\n            menuItems: this.getRibbonMenuItems(),\n            items: this.getRibbonItems(),\n            fileMenuItemSelect: this.fileMenuItemSelect.bind(this),\n            beforeOpen: this.fileMenuBeforeOpen.bind(this),\n            beforeClose: this.fileMenuBeforeClose.bind(this),\n            clicked: this.toolbarClicked.bind(this),\n            created: this.ribbonCreated.bind(this),\n            selecting: this.tabSelecting.bind(this),\n            expandCollapse: this.expandCollapseHandler.bind(this),\n            beforeFileMenuItemRender: this.beforeRenderHandler.bind(this)\n        });\n        this.ribbon.createElement = this.parent.createElement;\n        if (args && args.uiUpdate) {\n            var refEle = this.parent.element.querySelector('.e-formula-bar-panel') ||\n                document.getElementById(this.parent.element.id + '_sheet_panel');\n            this.parent.element.insertBefore(ribbonElement, refEle);\n        }\n        else {\n            this.parent.element.appendChild(ribbonElement);\n        }\n        this.ribbon.appendTo(ribbonElement);\n    };\n    Ribbon.prototype.tabSelecting = function (args) {\n        if (args.selectingIndex !== this.ribbon.selectedTab) {\n            this.refreshRibbonContent(args.selectingIndex);\n            this.parent.notify(tabSwitch, { activeTab: args.selectingIndex });\n        }\n    };\n    Ribbon.prototype.beforeRenderHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.item.text === l10n.getConstant('Open') && (!this.parent.openUrl || !this.parent.allowOpen)) {\n            args.element.classList.add('e-disabled');\n        }\n        if (args.item.text === l10n.getConstant('SaveAs') && (!this.parent.saveUrl || !this.parent.allowSave)) {\n            args.element.classList.add('e-disabled');\n        }\n    };\n    Ribbon.prototype.getChartThemeDDB = function (id) {\n        var _this = this;\n        var chartThemeBtn = this.parent.createElement('button', { id: id + '_chart_theme' });\n        chartThemeBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'Material' }));\n        this.chartThemeDDB = new DropDownButton({\n            items: this.getChartThemeDdbItems(),\n            content: '',\n            select: function (args) { return _this.chartThemeDDBSelect(args); },\n            close: function () { return _this.parent.element.focus(); },\n            cssClass: 'e-flat e-charttheme-ddb',\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element, args.items); }\n        });\n        this.chartThemeDDB.createElement = this.parent.createElement;\n        this.chartThemeDDB.appendTo(chartThemeBtn);\n        return chartThemeBtn;\n    };\n    Ribbon.prototype.getNumFormatDDB = function (id) {\n        var _this = this;\n        var numFormatBtn = this.parent.createElement('button', { id: id + '_number_format' });\n        numFormatBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'General' }));\n        this.numFormatDDB = new DropDownButton({\n            items: this.getNumFormatDdbItems(id),\n            content: '',\n            select: function (args) { return _this.numDDBSelect(args); },\n            open: function (args) { return _this.numDDBOpen(args); },\n            beforeItemRender: function (args) { return _this.previewNumFormat(args); },\n            close: function () { return focus(_this.parent.element); },\n            cssClass: 'e-flat e-numformat-ddb',\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element, args.items); }\n        });\n        this.numFormatDDB.createElement = this.parent.createElement;\n        this.numFormatDDB.appendTo(numFormatBtn);\n        return numFormatBtn;\n    };\n    Ribbon.prototype.getFontSizeDDB = function (id) {\n        var _this = this;\n        this.fontSizeDdb = new DropDownButton({\n            cssClass: 'e-font-size-ddb',\n            content: '11',\n            items: [{ text: '8' }, { text: '9' }, { text: '10' }, { text: '11' }, { text: '12' }, { text: '14' }, { text: '16' },\n                { text: '18' }, { text: '20' }, { text: '22' }, { text: '24' }, { text: '26' }, { text: '28' }, { text: '36' },\n                { text: '48' }, { text: '72' }],\n            beforeOpen: function (args) {\n                _this.tBarDdbBeforeOpen(args.element, args.items);\n                _this.refreshSelected(_this.fontSizeDdb, args.element, 'content', 'text');\n            },\n            select: function (args) {\n                var eventArgs = { style: { fontSize: args.item.text + \"pt\" }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.fontSizeDdb.content = eventArgs.style.fontSize.split('pt')[0];\n                    _this.fontSizeDdb.dataBind();\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.fontSizeDdb.createElement = this.parent.createElement;\n        this.fontSizeDdb.appendTo(this.parent.createElement('button', { id: id + '_font_size' }));\n        return this.fontSizeDdb.element;\n    };\n    Ribbon.prototype.getChartDDB = function (id, isChart) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var menuClass = isChart ? 'e-chart-menu' : 'e-chart-type-menu';\n        this.chartMenu = new Menu({\n            cssClass: menuClass,\n            items: [\n                {\n                    iconCss: 'e-icons e-column', text: l10n.getConstant('Column'),\n                    items: [{ id: 'column_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-bar', text: l10n.getConstant('Bar'),\n                    items: [{ id: 'bar_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-area', text: l10n.getConstant('Area'),\n                    items: [{ id: 'area_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-pie-doughnut', text: l10n.getConstant('PieAndDoughnut'),\n                    items: [{ id: 'pie_doughnut_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-line', text: l10n.getConstant('Line'),\n                    items: [{ id: 'line_chart' }]\n                },\n                // {\n                //     iconCss: 'e-icons e-radar', text: l10n.getConstant('Radar'),\n                //     items: [{ id: 'radar_chart' }]\n                // },\n                {\n                    iconCss: 'e-icons e-scatter', text: l10n.getConstant('Scatter'),\n                    items: [{ id: 'scatter_chart' }]\n                }\n            ],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === l10n.getConstant('Column')) {\n                    args.element.firstChild.appendChild(column);\n                    args.element.parentElement.classList.add('e-column-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Bar')) {\n                    args.element.firstChild.appendChild(bar);\n                    args.element.parentElement.classList.add('e-bar-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Area')) {\n                    args.element.firstChild.appendChild(area);\n                    args.element.parentElement.classList.add('e-area-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Line')) {\n                    args.element.firstChild.appendChild(line);\n                    args.element.parentElement.classList.add('e-line-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('PieAndDoughnut')) {\n                    args.element.firstChild.appendChild(pie);\n                    args.element.parentElement.classList.add('e-pie-doughnut-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Radar')) {\n                    args.element.firstChild.appendChild(radar);\n                    args.element.parentElement.classList.add('e-radar-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Scatter')) {\n                    args.element.firstChild.appendChild(scatter);\n                    args.element.parentElement.classList.add('e-scatter-chart');\n                }\n            },\n            select: this.chartSelected.bind(this)\n        });\n        this.chartMenu.createElement = this.parent.createElement;\n        var column = this.parent.createElement('div', { id: 'column_main', className: 'e-column-main' });\n        var column1Text = this.parent.createElement('div', { id: 'column1_text', className: 'e-column1-text', innerHTML: l10n.getConstant('Column') });\n        var column1Cont = this.parent.createElement('div', { id: 'column1_cont', className: 'e-column1-cont' });\n        var column2Cont = this.parent.createElement('div', { id: 'column2_cont', className: 'e-column2-cont' });\n        column.appendChild(column1Text);\n        column.appendChild(column1Cont);\n        //column.appendChild(column2Text);\n        //column.appendChild(column2Cont);\n        var clusteredColumn = this.parent.createElement('span', { id: 'clusteredColumn', className: 'e-clusteredcolumn e-column-icon e-menu-icon e-icons' });\n        var stackedColumn = this.parent.createElement('span', {\n            id: 'stackedColumn', className: 'e-stackedcolumn e-column-icon e-menu-icon e-icons'\n        });\n        var stackedColumn100 = this.parent.createElement('span', {\n            id: 'stackedColumn100', className: 'e-stackedcolumn100 e-column-icon e-menu-icon e-icons'\n        });\n        var clusteredColumn3D = this.parent.createElement('span', {\n            id: 'clusteredColumn3D', className: 'e-clusteredColumn3D e-column-icon'\n        });\n        var stackedColumn3D = this.parent.createElement('span', { id: 'stackedColumn3D', className: 'e-stackedColumn3D e-column-icon' });\n        var stackedColumn1003D = this.parent.createElement('span', { id: 'stackedColumn1003D', className: 'e-stackedColumn1003D e-column-icon' });\n        clusteredColumn.title = l10n.getConstant('ClusteredColumn');\n        stackedColumn.title = l10n.getConstant('StackedColumn');\n        stackedColumn100.title = l10n.getConstant('StackedColumn100');\n        stackedColumn1003D.title = l10n.getConstant('OrangeDataBar');\n        stackedColumn3D.title = l10n.getConstant('LightblueDataBar');\n        clusteredColumn3D.title = l10n.getConstant('PurpleDataBar');\n        column1Cont.appendChild(clusteredColumn);\n        column1Cont.appendChild(stackedColumn);\n        column1Cont.appendChild(stackedColumn100);\n        column2Cont.appendChild(clusteredColumn3D);\n        column2Cont.appendChild(stackedColumn3D);\n        column2Cont.appendChild(stackedColumn1003D);\n        var bar = this.parent.createElement('div', { id: 'bar_main', className: 'e-bar-main' });\n        var bar1Text = this.parent.createElement('div', { id: 'bar1_text', className: 'e-bar1-text', innerHTML: l10n.getConstant('Bar') });\n        var bar1Cont = this.parent.createElement('div', { id: 'bar1_cont', className: 'e-bar1-cont' });\n        var bar2Cont = this.parent.createElement('div', { id: 'bar2_cont', className: 'e-bar2-cont' });\n        bar.appendChild(bar1Text);\n        bar.appendChild(bar1Cont);\n        //bar.appendChild(bar2Text);\n        //bar.appendChild(bar2Cont);\n        var clusteredBar = this.parent.createElement('span', { id: 'clusteredBar', className: 'e-clusteredbar e-bar-icon e-menu-icon e-icons' });\n        var stackedBar = this.parent.createElement('span', { id: 'stackedBar', className: 'e-stackedbar e-bar-icon e-menu-icon e-icons' });\n        var stackedBar100 = this.parent.createElement('span', { id: 'stackedBar100', className: 'e-stackedbar100 e-bar-icon e-menu-icon e-icons' });\n        var clusteredBar3D = this.parent.createElement('span', { id: 'clusteredBar3D', className: 'e-clusteredBar3D e-bar-icon' });\n        var stackedBar3D = this.parent.createElement('span', { id: 'stackedBar3D', className: 'e-stackedBar3D e-bar-icon' });\n        var stackedBar1003D = this.parent.createElement('span', { id: 'stackedBar1003D', className: 'e-stackedBar1003D e-bar-icon' });\n        clusteredBar.title = l10n.getConstant('ClusteredBar');\n        stackedBar.title = l10n.getConstant('StackedBar');\n        stackedBar100.title = l10n.getConstant('StackedBar100');\n        stackedBar1003D.title = l10n.getConstant('OrangeDataBar');\n        stackedBar3D.title = l10n.getConstant('LightblueDataBar');\n        clusteredBar3D.title = l10n.getConstant('PurpleDataBar');\n        bar1Cont.appendChild(clusteredBar);\n        bar1Cont.appendChild(stackedBar);\n        bar1Cont.appendChild(stackedBar100);\n        bar2Cont.appendChild(clusteredBar3D);\n        bar2Cont.appendChild(stackedBar3D);\n        bar2Cont.appendChild(stackedBar1003D);\n        var area = this.parent.createElement('div', { id: 'area_main', className: 'e-area-main' });\n        var areaText = this.parent.createElement('div', { id: 'area_text', className: 'e-area-text', innerHTML: l10n.getConstant('Area') });\n        var areaCont = this.parent.createElement('div', { id: 'area_cont', className: 'e-area-cont' });\n        area.appendChild(areaText);\n        area.appendChild(areaCont);\n        var defArea = this.parent.createElement('span', { id: 'area', className: 'e-area e-area-icon e-menu-icon e-icons' });\n        var stackedArea = this.parent.createElement('span', { id: 'stackedArea', className: 'e-stackedarea e-area-icon e-menu-icon e-icons' });\n        var stackedArea100 = this.parent.createElement('span', { id: 'stackedArea100', className: 'e-stackedarea100 e-area-icon e-menu-icon e-icons' });\n        defArea.title = l10n.getConstant('Area');\n        stackedArea.title = l10n.getConstant('StackedArea');\n        stackedArea100.title = l10n.getConstant('StackedArea100');\n        areaCont.appendChild(defArea);\n        areaCont.appendChild(stackedArea);\n        areaCont.appendChild(stackedArea100);\n        var line = this.parent.createElement('div', { id: 'line_main', className: 'e-line-main' });\n        var lineText = this.parent.createElement('div', { id: 'line_text', className: 'e-line-text', innerHTML: l10n.getConstant('Line') });\n        var lineCont = this.parent.createElement('div', { id: 'line_cont', className: 'e-line-cont' });\n        line.appendChild(lineText);\n        line.appendChild(lineCont);\n        var defLine = this.parent.createElement('span', { id: 'line', className: 'e-line e-line-icon e-menu-icon e-icons' });\n        var stackedLine = this.parent.createElement('span', { id: 'stackedLine', className: 'e-stackedline e-line-icon e-menu-icon e-icons' });\n        var stackedLine100 = this.parent.createElement('span', {\n            id: 'stackedline100', className: 'e-stackedline100 e-line-icon e-menu-icon e-icons'\n        });\n        defLine.title = l10n.getConstant('Line');\n        stackedLine.title = l10n.getConstant('StackedLine');\n        stackedLine100.title = l10n.getConstant('StackedLine100');\n        lineCont.appendChild(defLine);\n        lineCont.appendChild(stackedLine);\n        lineCont.appendChild(stackedLine100);\n        var pie = this.parent.createElement('div', { id: 'pie_main', className: 'e-pie-main' });\n        var pieText = this.parent.createElement('div', { id: 'pie_text', className: 'e-pie-text', innerHTML: l10n.getConstant('Pie') });\n        var pieCont = this.parent.createElement('div', { id: 'pie_cont', className: 'e-pie-cont' });\n        pie.appendChild(pieText);\n        pie.appendChild(pieCont);\n        var defPie = this.parent.createElement('span', { id: 'pie', className: 'e-pie e-pie-icon e-menu-icon e-icons' });\n        var doughnut = this.parent.createElement('span', { id: 'doughnut', className: 'e-doughnut e-pie-icon e-menu-icon e-icons' });\n        defPie.title = l10n.getConstant('Pie');\n        doughnut.title = l10n.getConstant('Doughnut');\n        pieCont.appendChild(defPie);\n        pieCont.appendChild(doughnut);\n        var radar = this.parent.createElement('div', { id: 'radar_main', className: 'e-radar-main' });\n        var radarText = this.parent.createElement('div', { id: 'radar_text', className: 'e-radar-text', innerHTML: 'Radar' });\n        var radarCont = this.parent.createElement('div', { id: 'radar_cont', className: 'e-radar-cont' });\n        radar.appendChild(radarText);\n        radar.appendChild(radarCont);\n        var defradar = this.parent.createElement('span', { id: 'radar', className: 'e-radar e-radar-icon e-menu-icon e-icons' });\n        var radarMarkers = this.parent.createElement('span', { id: 'radar_markers', className: 'e-radar-markers e-radar-icon e-menu-icon e-icons' });\n        defradar.title = l10n.getConstant('BlueDataBar');\n        radarMarkers.title = l10n.getConstant('GreenDataBar');\n        radarCont.appendChild(defradar);\n        radarCont.appendChild(radarMarkers);\n        var scatter = this.parent.createElement('div', { id: 'scatter_main', className: 'e-scatter-main' });\n        var scatterText = this.parent.createElement('div', { id: 'scatter_text', className: 'e-scatter-text', innerHTML: l10n.getConstant('Scatter') });\n        var scatterCont = this.parent.createElement('div', { id: 'scatter_cont', className: 'e-scatter-cont' });\n        scatter.appendChild(scatterText);\n        scatter.appendChild(scatterCont);\n        var defscatter = this.parent.createElement('span', { id: 'scatter', className: 'e-scatter e-scatter-icon e-menu-icon e-icons' });\n        defscatter.title = l10n.getConstant('Scatter');\n        scatterCont.appendChild(defscatter);\n        var ulClass = isChart ? '_chart_menu' : '_chart_type_menu';\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + ulClass, styles: 'display: none;'\n        }));\n        this.chartMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        var ddbIconCss = isChart ? 'e-chart-icon' : 'e-chart-type-icon';\n        var ddbCssClass = isChart ? 'e-chart-ddb' : 'e-chart-type-ddb';\n        var chartBtnId = isChart ? id + '_chart-btn' : id + '_chart-type-btn';\n        this.chartDdb = new DropDownButton({\n            iconCss: 'e-icons' + ' ' + ddbIconCss,\n            cssClass: ddbCssClass,\n            target: this.chartMenu.element.parentElement,\n            created: function () { _this.chartMenu.element.style.display = ''; },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.' + ddbCssClass)) {\n                    if (closest(args.event.target, '.' + ddbCssClass).id !== chartBtnId) {\n                        args.cancel = true;\n                    }\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.chartDdb.createElement = this.parent.createElement;\n        var chartBtn;\n        if (isChart) {\n            chartBtn = this.parent.createElement('button', { id: chartBtnId });\n            chartBtn.appendChild(this.parent.createElement('span', { id: id + '_chart', innerHTML: l10n.getConstant('Chart') }));\n        }\n        else {\n            chartBtn = this.parent.createElement('button', { id: chartBtnId });\n            chartBtn.appendChild(this.parent.createElement('span', { id: id + '_chart_type', innerHTML: l10n.getConstant('ChartType') }));\n        }\n        this.chartDdb.appendTo(chartBtn);\n        return this.chartDdb.element;\n    };\n    Ribbon.prototype.getAddChartEleDBB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.addChartMenu = new Menu({\n            cssClass: 'e-addchart-menu', title: l10n.getConstant('AddChartElement'),\n            items: [{\n                    iconCss: 'e-icons e-axes', text: l10n.getConstant('Axes'),\n                    items: [{\n                            iconCss: 'e-icons e-ph-axes', id: 'PHAxes',\n                            text: l10n.getConstant('PrimaryHorizontal')\n                        },\n                        {\n                            iconCss: 'e-icons e-pv-axes', id: 'PVAxes',\n                            text: l10n.getConstant('PrimaryVertical')\n                        }]\n                },\n                {\n                    iconCss: 'e-icons e-axis-title', text: l10n.getConstant('AxisTitle'),\n                    items: [{\n                            iconCss: 'e-icons e-ph-axistitle', id: 'PHAxisTitle',\n                            text: l10n.getConstant('PrimaryHorizontal')\n                        },\n                        {\n                            iconCss: 'e-icons e-pv-axistitle', id: 'PVAxisTitle',\n                            text: l10n.getConstant('PrimaryVertical')\n                        }]\n                },\n                {\n                    iconCss: 'e-icons e-chart-title', text: l10n.getConstant('ChartTitle'),\n                    items: [{ iconCss: 'e-icons e-ct-none', id: 'ChartTitleNone', text: l10n.getConstant('None') },\n                        { iconCss: 'e-icons e-ct-abovechart', id: 'ChartTitleAbove', text: l10n.getConstant('AboveChart') }\n                        // { iconCss: 'e-icons e-ct-farchart', id: 'chart_farchart', text: l10n.getConstant('AboveChart') },\n                        // { iconCss: 'e-icons e-ct-nearchart', id: 'chart_nearchart', text: l10n.getConstant('AboveChart') }\n                    ]\n                },\n                {\n                    iconCss: 'e-icons e-data-labels', text: l10n.getConstant('DataLabels'),\n                    items: [{ iconCss: 'e-icons e-dl-none', id: 'DLNone', text: l10n.getConstant('None') },\n                        { iconCss: 'e-icons e-dl-center', id: 'DLCenter', text: l10n.getConstant('Center') },\n                        { iconCss: 'e-icons e-dl-insideend', id: 'DLInsideend', text: l10n.getConstant('InsideEnd') },\n                        { iconCss: 'e-icons e-dl-insidebase', id: 'DLInsidebase', text: l10n.getConstant('InsideBase') },\n                        { iconCss: 'e-icons e-dl-outsideend', id: 'DLOutsideend', text: l10n.getConstant('OutsideEnd') }]\n                },\n                {\n                    iconCss: 'e-icons e-gridlines', text: l10n.getConstant('Gridlines'),\n                    items: [{\n                            iconCss: 'e-icons e-gl-major-horizontal', id: 'GLMajorHorizontal',\n                            text: l10n.getConstant('PrimaryMajorHorizontal')\n                        },\n                        {\n                            iconCss: 'e-icons e-gl-major-vertical', id: 'GLMajorVertical',\n                            text: l10n.getConstant('PrimaryMajorVertical')\n                        },\n                        {\n                            iconCss: 'e-icons e-gl-minor-horizontal', id: 'GLMinorHorizontal',\n                            text: l10n.getConstant('PrimaryMinorHorizontal')\n                        },\n                        {\n                            iconCss: 'e-icons e-gl-minor-vertical', id: 'GLMinorVertical',\n                            text: l10n.getConstant('PrimaryMinorVertical')\n                        }]\n                },\n                {\n                    iconCss: 'e-icons e-legends', text: l10n.getConstant('Legends'),\n                    items: [{ iconCss: 'e-icons e-legends-none', id: 'LegendNone', text: l10n.getConstant('None') },\n                        { iconCss: 'e-icons e-legends-right', id: 'LegendsRight', text: l10n.getConstant('Right') },\n                        { iconCss: 'e-icons e-legends-left', id: 'LegendsLeft', text: l10n.getConstant('Left') },\n                        { iconCss: 'e-icons e-legends-bottom', id: 'LegendsBottom', text: l10n.getConstant('Bottom') },\n                        { iconCss: 'e-icons e-legends-top', id: 'LegendsTop', text: l10n.getConstant('Top') }]\n                }],\n            orientation: 'Vertical',\n            select: this.addChartEleSelected.bind(this)\n        });\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_add_chart_menu', styles: 'display: none;'\n        }));\n        this.addChartMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        this.addChartDdb = new DropDownButton({\n            iconCss: 'e-icons e-addchart-icon',\n            cssClass: 'e-addchart-ddb',\n            target: this.addChartMenu.element.parentElement,\n            created: function () { _this.addChartMenu.element.style.display = ''; },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.e-addchart-ddb')) {\n                    if (closest(args.event.target, '.e-addchart-ddb').id !== id + '_addchart') {\n                        args.cancel = true;\n                    }\n                }\n            },\n            close: function () { return _this.parent.element.focus(); }\n        });\n        this.addChartDdb.createElement = this.parent.createElement;\n        var addChartBtn = this.parent.createElement('button', { id: id + '_addchart' });\n        addChartBtn.appendChild(this.parent.createElement('span', { id: id + '_chart', innerHTML: l10n.getConstant('AddChartElement') }));\n        this.addChartDdb.appendTo(addChartBtn);\n        return this.addChartDdb.element;\n    };\n    Ribbon.prototype.getCFDBB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.cFMenu = new Menu({\n            cssClass: 'e-cf-menu',\n            items: [{\n                    iconCss: 'e-icons e-hlcellrules', text: l10n.getConstant('HighlightCellsRules'),\n                    items: [{ iconCss: 'e-icons e-greaterthan', id: 'cf_greaterthan', text: l10n.getConstant('GreaterThan') + '...' },\n                        { iconCss: 'e-icons e-lessthan', id: 'cf_lessthan', text: l10n.getConstant('LessThan') + '...' },\n                        { iconCss: 'e-icons e-between', id: 'cf_between', text: l10n.getConstant('Between') + '...' },\n                        { iconCss: 'e-icons e-equalto', id: 'cf_eqaulto', text: l10n.getConstant('CFEqualTo') + '...' }, {\n                            iconCss: 'e-icons e-textcontains', id: 'cf_textthatcontains',\n                            text: l10n.getConstant('TextThatContains') + '...'\n                        }, { iconCss: 'e-icons e-adateoccuring', id: 'cf_adateoccuring', text: l10n.getConstant('ADateOccuring') + '...' }, {\n                            iconCss: 'e-icons e-duplicate', id: 'cf_duplicatevalues',\n                            text: l10n.getConstant('DuplicateValues') + '...'\n                        }]\n                },\n                {\n                    iconCss: 'e-icons e-topbottomrules', text: l10n.getConstant('TopBottomRules'),\n                    items: [{ iconCss: 'e-icons e-top10items', id: 'cf_top10items', text: l10n.getConstant('Top10Items') + '...' },\n                        { iconCss: 'e-icons e-top10', id: 'cf_top10', text: l10n.getConstant('Top10') + ' %...' },\n                        { iconCss: 'e-icons e-bottom10items', id: 'cf_bottom10items', text: l10n.getConstant('Bottom10Items') + '...' },\n                        { iconCss: 'e-icons e-bottom10', id: 'cf_bottom10', text: l10n.getConstant('Bottom10') + ' %...' },\n                        { iconCss: 'e-icons e-aboveaverage', id: 'cf_aboveaverage', text: l10n.getConstant('AboveAverage') + '...' },\n                        { iconCss: 'e-icons e-belowaverage', id: 'cf_belowaverage', text: l10n.getConstant('BelowAverage') + '...' }]\n                },\n                {\n                    iconCss: 'e-icons e-databars', text: l10n.getConstant('DataBars'),\n                    items: [{ id: 'cf_databars' }]\n                },\n                {\n                    iconCss: 'e-icons e-colorscales', text: l10n.getConstant('ColorScales'),\n                    items: [{ id: 'cf_colorscales' }]\n                },\n                {\n                    iconCss: 'e-icons e-iconsets', text: l10n.getConstant('IconSets'),\n                    items: [{ id: 'cf_iconsets' }]\n                },\n                {\n                    iconCss: 'e-icons e-clearrules', text: l10n.getConstant('ClearRules'),\n                    items: [{ id: 'cf_cr_cells', text: l10n.getConstant('SelectedCells') },\n                        { id: 'cf_cr_sheet', text: l10n.getConstant('EntireSheet') }]\n                }],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === l10n.getConstant('DataBars')) {\n                    args.element.firstChild.appendChild(dataBars);\n                    args.element.parentElement.classList.add('e-databars');\n                }\n                else if (args.parentItem.text === l10n.getConstant('ColorScales')) {\n                    args.element.firstChild.appendChild(colorScales);\n                    args.element.parentElement.classList.add('e-colorscales');\n                }\n                else if (args.parentItem.text === l10n.getConstant('IconSets')) {\n                    args.element.firstChild.appendChild(iconSets);\n                    args.element.parentElement.classList.add('e-iconsets');\n                }\n            },\n            select: this.cFSelected.bind(this)\n        });\n        var dataBars = this.parent.createElement('div', { id: 'db', className: 'e-db' });\n        var db1 = this.parent.createElement('div', { id: 'db1', className: 'e-db1' });\n        var db2 = this.parent.createElement('div', { id: 'db2', className: 'e-db2' });\n        dataBars.appendChild(db1);\n        dataBars.appendChild(db2);\n        var bBar = this.parent.createElement('span', { id: 'BlueDataBar', className: 'e-bdatabar e-databar-icon' });\n        var gBar = this.parent.createElement('span', { id: 'GreenDataBar', className: 'e-gdatabar e-databar-icon' });\n        var rBar = this.parent.createElement('span', { id: 'RedDataBar', className: 'e-rdatabar e-databar-icon' });\n        var oBar = this.parent.createElement('span', { id: 'OrangeDataBar', className: 'e-odatabar e-databar-icon' });\n        var lBBar = this.parent.createElement('span', { id: 'LightBlueDataBar', className: 'e-lbdatabar e-databar-icon' });\n        var pBar = this.parent.createElement('span', { id: 'PurpleDataBar', className: 'e-pdatabar e-databar-icon' });\n        bBar.title = l10n.getConstant('BlueDataBar');\n        gBar.title = l10n.getConstant('GreenDataBar');\n        rBar.title = l10n.getConstant('RedDataBar');\n        oBar.title = l10n.getConstant('OrangeDataBar');\n        lBBar.title = l10n.getConstant('LightblueDataBar');\n        pBar.title = l10n.getConstant('PurpleDataBar');\n        db1.appendChild(bBar);\n        db1.appendChild(gBar);\n        db1.appendChild(rBar);\n        db2.appendChild(oBar);\n        db2.appendChild(lBBar);\n        db2.appendChild(pBar);\n        this.cFMenu.createElement = this.parent.createElement;\n        var colorScales = this.parent.createElement('div', { id: 'db', className: 'e-cs' });\n        var cs1 = this.parent.createElement('div', { id: 'cs1', className: 'e-cs1' });\n        var cs2 = this.parent.createElement('div', { id: 'cs2', className: 'e-cs2' });\n        var cs3 = this.parent.createElement('div', { id: 'cs3', className: 'e-cs3' });\n        colorScales.appendChild(cs1);\n        colorScales.appendChild(cs2);\n        colorScales.appendChild(cs3);\n        var gyr = this.parent.createElement('span', { id: 'GYRColorScale', className: 'e-gyr e-colorscale-icon' });\n        var ryg = this.parent.createElement('span', { id: 'RYGColorScale', className: 'e-ryg e-colorscale-icon' });\n        var gwr = this.parent.createElement('span', { id: 'GWRColorScale', className: 'e-gwr e-colorscale-icon' });\n        var rwg = this.parent.createElement('span', { id: 'RWGColorScale', className: 'e-rwg e-colorscale-icon' });\n        var bwr = this.parent.createElement('span', { id: 'BWRColorScale', className: 'e-bwr e-colorscale-icon' });\n        var rwb = this.parent.createElement('span', { id: 'RWBColorScale', className: 'e-rwb e-colorscale-icon' });\n        var wr = this.parent.createElement('span', { id: 'WRColorScale', className: 'e-wr e-colorscale-icon' });\n        var rw = this.parent.createElement('span', { id: 'RWColorScale', className: 'e-rw e-colorscale-icon' });\n        var gw = this.parent.createElement('span', { id: 'GWColorScale', className: 'e-gw e-colorscale-icon' });\n        var wg = this.parent.createElement('span', { id: 'WGColorScale', className: 'e-wg e-colorscale-icon' });\n        var gy = this.parent.createElement('span', { id: 'GYColorScale', className: 'e-gy e-colorscale-icon' });\n        var yg = this.parent.createElement('span', { id: 'YGColorScale', className: 'e-yg e-colorscale-icon' });\n        gyr.title = l10n.getConstant('GYRColorScale');\n        ryg.title = l10n.getConstant('RYGColorScale');\n        gwr.title = l10n.getConstant('GWRColorScale');\n        rwg.title = l10n.getConstant('RWGColorScale');\n        bwr.title = l10n.getConstant('BWRColorScale');\n        rwb.title = l10n.getConstant('RWBColorScale');\n        wr.title = l10n.getConstant('WRColorScale');\n        rw.title = l10n.getConstant('RWColorScale');\n        gw.title = l10n.getConstant('GWColorScale');\n        wg.title = l10n.getConstant('WGColorScale');\n        gy.title = l10n.getConstant('GYColorScale');\n        yg.title = l10n.getConstant('YGColorScale');\n        cs1.appendChild(gyr);\n        cs1.appendChild(ryg);\n        cs1.appendChild(gwr);\n        cs1.appendChild(rwg);\n        cs2.appendChild(bwr);\n        cs2.appendChild(rwb);\n        cs2.appendChild(wr);\n        cs2.appendChild(rw);\n        cs3.appendChild(gw);\n        cs3.appendChild(wg);\n        cs3.appendChild(gy);\n        cs3.appendChild(yg);\n        var iconSets = this.parent.createElement('div', { id: 'is', className: 'e-is' });\n        var is1 = this.parent.createElement('div', { id: 'is1', className: 'e-is1', innerHTML: 'Directional' });\n        var is2 = this.parent.createElement('div', { id: 'is2', className: 'e-is2' });\n        var is3 = this.parent.createElement('div', { id: 'is3', className: 'e-is3', innerHTML: 'Shapes' });\n        var is4 = this.parent.createElement('div', { id: 'is4', className: 'e-is4' });\n        var is5 = this.parent.createElement('div', { id: 'is5', className: 'e-is5', innerHTML: 'Indicators' });\n        var is6 = this.parent.createElement('div', { id: 'is6', className: 'e-is6' });\n        var is7 = this.parent.createElement('div', { id: 'is7', className: 'e-is7', innerHTML: 'Ratings' });\n        var is8 = this.parent.createElement('div', { id: 'is8', className: 'e-is8' });\n        is1.title = l10n.getConstant('GYColorScale');\n        is2.title = l10n.getConstant('YGColorScale');\n        is3.title = l10n.getConstant('GYColorScale');\n        is4.title = l10n.getConstant('YGColorScale');\n        is5.title = l10n.getConstant('GYColorScale');\n        is6.title = l10n.getConstant('YGColorScale');\n        is7.title = l10n.getConstant('GYColorScale');\n        is8.title = l10n.getConstant('YGColorScale');\n        iconSets.appendChild(is1);\n        iconSets.appendChild(is2);\n        iconSets.appendChild(is3);\n        iconSets.appendChild(is4);\n        iconSets.appendChild(is5);\n        iconSets.appendChild(is6);\n        iconSets.appendChild(is7);\n        iconSets.appendChild(is8);\n        var directional1 = this.parent.createElement('div', { id: 'ThreeArrows', className: 'e-3arrows e-is-wrapper' });\n        var directional2 = this.parent.createElement('div', { id: 'ThreeArrowsGray', className: 'e-3arrowsgray e-is-wrapper' });\n        var directional3 = this.parent.createElement('div', { id: 'ThreeTriangles', className: 'e-3triangles e-is-wrapper' });\n        var directional4 = this.parent.createElement('div', { id: 'FourArrowsGray', className: 'e-4arrowsgray e-is-wrapper' });\n        var directional5 = this.parent.createElement('div', { id: 'FourArrows', className: 'e-4arrows e-is-wrapper' });\n        var directional6 = this.parent.createElement('div', { id: 'FiveArrowsGray', className: 'e-5arrowsgray e-is-wrapper' });\n        var directional7 = this.parent.createElement('div', { id: 'FiveArrows', className: 'e-5arrows e-is-wrapper' });\n        directional1.title = l10n.getConstant('ThreeArrowsColor');\n        directional2.title = l10n.getConstant('ThreeArrowsGray');\n        directional3.title = l10n.getConstant('ThreeTriangles');\n        directional4.title = l10n.getConstant('FourArrowsColor');\n        directional5.title = l10n.getConstant('FourArrowsGray');\n        directional6.title = l10n.getConstant('FiveArrowsColor');\n        directional7.title = l10n.getConstant('FiveArrowsGray');\n        is2.appendChild(directional1);\n        is2.appendChild(directional2);\n        is2.appendChild(directional3);\n        is2.appendChild(directional4);\n        is2.appendChild(directional5);\n        is2.appendChild(directional6);\n        is2.appendChild(directional7);\n        var shapes1 = this.parent.createElement('div', { id: 'ThreeTrafficLights1', className: 'e-3trafficlights e-is-wrapper' });\n        var shapes2 = this.parent.createElement('div', { id: 'ThreeTrafficLights2', className: 'e-3rafficlights2 e-is-wrapper' });\n        var shapes3 = this.parent.createElement('div', { id: 'ThreeSigns', className: 'e-3signs e-is-wrapper' });\n        var shapes4 = this.parent.createElement('div', { id: 'FourTrafficLights', className: 'e-4trafficlights e-is-wrapper' });\n        var shapes5 = this.parent.createElement('div', { id: 'FourRedToBlack', className: 'e-4redtoblack e-is-wrapper' });\n        shapes1.title = l10n.getConstant('ThreeTrafficLights1');\n        shapes2.title = l10n.getConstant('ThreeTrafficLights2');\n        shapes3.title = l10n.getConstant('ThreeSigns');\n        shapes4.title = l10n.getConstant('FourTrafficLights');\n        shapes5.title = l10n.getConstant('RedToBlack');\n        is4.appendChild(shapes1);\n        is4.appendChild(shapes2);\n        is4.appendChild(shapes3);\n        is4.appendChild(shapes4);\n        is4.appendChild(shapes5);\n        var indicators1 = this.parent.createElement('div', { id: 'ThreeSymbols', className: 'e-3symbols e-is-wrapper' });\n        var indicators2 = this.parent.createElement('div', { id: 'ThreeSymbols2', className: 'e-3symbols2 e-is-wrapper' });\n        var indicators3 = this.parent.createElement('div', { id: 'ThreeFlags', className: 'e-3flags e-is-wrapper' });\n        indicators1.title = l10n.getConstant('ThreeSymbols1');\n        indicators2.title = l10n.getConstant('ThreeSymbols2');\n        indicators3.title = l10n.getConstant('ThreeFlags');\n        is6.appendChild(indicators1);\n        is6.appendChild(indicators2);\n        is6.appendChild(indicators3);\n        var ratings1 = this.parent.createElement('div', { id: 'ThreeStars', className: 'e-3stars e-is-wrapper' });\n        var ratings2 = this.parent.createElement('div', { id: 'FourRating', className: 'e-4rating e-is-wrapper' });\n        var ratings3 = this.parent.createElement('div', { id: 'FiveQuarters', className: 'e-5quarters e-is-wrapper' });\n        var ratings4 = this.parent.createElement('div', { id: 'FiveRating', className: 'e-5rating e-is-wrapper' });\n        var ratings5 = this.parent.createElement('div', { id: 'FiveBoxes', className: 'e-5boxes e-is-wrapper' });\n        ratings1.title = l10n.getConstant('ThreeStars');\n        ratings2.title = l10n.getConstant('FourRatings');\n        ratings3.title = l10n.getConstant('FiveQuarters');\n        ratings4.title = l10n.getConstant('FiveRatings');\n        ratings5.title = l10n.getConstant('FiveBoxes');\n        is8.appendChild(ratings1);\n        is8.appendChild(ratings2);\n        is8.appendChild(ratings3);\n        is8.appendChild(ratings4);\n        is8.appendChild(ratings5);\n        directional1.appendChild(this.createElement('span', 'e-3arrows-1 e-iconsetspan'));\n        directional1.appendChild(this.createElement('span', 'e-3arrows-2 e-iconsetspan'));\n        directional1.appendChild(this.createElement('span', 'e-3arrows-3 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-1 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-2 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-3 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-1 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-2 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-3 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-1 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-2 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-3 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-4 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-1 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-2 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-3 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-4 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-1 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-2 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-3 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-4 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-5 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-1 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-2 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-3 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-4 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-5 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-1 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-2 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-3 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-1 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-2 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-3 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-1 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-2 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-3 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-1 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-2 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-3 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-4 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-1 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-2 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-3 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-4 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-1 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-2 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-3 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-1 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-2 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-3 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-1 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-2 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-3 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-1 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-2 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-3 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-1 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-2 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-3 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-4 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-1 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-2 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-3 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-4 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-5 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-1 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-2 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-3 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-4 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-5 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-1 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-2 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-3 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-4 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-5 e-iconsetspan'));\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_cf_menu', styles: 'display: none;'\n        }));\n        this.cFMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        this.cFDdb = new DropDownButton({\n            iconCss: 'e-icons e-conditionalformatting-icon',\n            cssClass: 'e-cf-ddb',\n            target: this.cFMenu.element.parentElement,\n            created: function () { _this.cFMenu.element.style.display = ''; },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.cFDdb.createElement = this.parent.createElement;\n        this.cFDdb.appendTo(this.parent.createElement('button', { id: id + '_conditionalformatting' }));\n        return this.cFDdb.element;\n    };\n    Ribbon.prototype.createElement = function (tag, className) {\n        return this.parent.createElement(tag, { className: className });\n    };\n    Ribbon.prototype.getBordersDBB = function (id) {\n        var _this = this;\n        var cPickerWrapper;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.bordersMenu = new Menu({\n            cssClass: 'e-borders-menu',\n            items: [{ iconCss: 'e-icons e-top-borders', text: l10n.getConstant('TopBorders') }, {\n                    iconCss: 'e-icons e-left-borders',\n                    text: l10n.getConstant('LeftBorders')\n                }, { iconCss: 'e-icons e-right-borders', text: l10n.getConstant('RightBorders') }, {\n                    iconCss: 'e-icons e-bottom-borders', text: l10n.getConstant('BottomBorders')\n                }, {\n                    iconCss: 'e-icons e-all-borders', text: l10n.getConstant('AllBorders')\n                }, { iconCss: 'e-icons e-horizontal-borders', text: l10n.getConstant('HorizontalBorders') }, {\n                    iconCss: 'e-icons e-vertical-borders', text: l10n.getConstant('VerticalBorders')\n                }, {\n                    iconCss: 'e-icons e-outside-borders',\n                    text: l10n.getConstant('OutsideBorders')\n                }, { iconCss: 'e-icons e-inside-borders', text: l10n.getConstant('InsideBorders') },\n                { iconCss: 'e-icons e-no-borders', text: l10n.getConstant('NoBorders') }, { separator: true }, {\n                    text: l10n.getConstant('BorderColor'), items: [{ id: id + \"_border_colors\" }]\n                }, {\n                    text: l10n.getConstant('BorderStyle'), items: [\n                        { iconCss: 'e-icons e-selected-icon', id: id + \"_1px\" }, { id: id + \"_2px\" },\n                        { id: id + \"_3px\" }, { id: id + \"_dashed\" },\n                        { id: id + \"_dotted\" }, { id: id + \"_double\" }\n                    ]\n                }],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    _this.colorPicker.refresh();\n                    cPickerWrapper = _this.colorPicker.element.parentElement;\n                    args.element.firstElementChild.appendChild(cPickerWrapper);\n                    cPickerWrapper.style.display = 'inline-block';\n                    args.element.parentElement.classList.add('e-border-color');\n                }\n                else {\n                    args.element.classList.add('e-border-style');\n                }\n            },\n            beforeClose: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    if (!closest(args.event.target, '.e-border-colorpicker') ||\n                        closest(args.event.target, '.e-apply') || closest(args.event.target, '.e-cancel')) {\n                        _this.colorPicker = getComponent(_this.cPickerEle, 'colorpicker');\n                        if (_this.colorPicker.mode === 'Picker') {\n                            _this.colorPicker.mode = 'Palette';\n                            _this.colorPicker.dataBind();\n                        }\n                        cPickerWrapper.style.display = '';\n                        _this.parent.element.appendChild(cPickerWrapper);\n                    }\n                    else {\n                        args.cancel = true;\n                    }\n                }\n            },\n            onOpen: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    args.element.parentElement.style.overflow = 'visible';\n                }\n            },\n            select: this.borderSelected.bind(this)\n        });\n        this.bordersMenu.createElement = this.parent.createElement;\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_borders_menu', styles: 'display: none;'\n        }));\n        this.bordersMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        this.cPickerEle = this.parent.createElement('input', { id: id + \"_cell_border_color\", attrs: { 'type': 'color' } });\n        this.parent.element.appendChild(this.cPickerEle);\n        this.colorPicker = new ColorPicker({\n            cssClass: 'e-border-colorpicker',\n            mode: 'Palette',\n            inline: true,\n            change: function (args) {\n                var border = _this.border.split(' ');\n                border[2] = args.currentValue.hex;\n                _this.border = border.join(' ');\n            },\n            created: function () { cPickerWrapper = _this.colorPicker.element.parentElement; }\n        });\n        this.colorPicker.createElement = this.parent.createElement;\n        this.colorPicker.appendTo(this.cPickerEle);\n        this.bordersDdb = new DropDownButton({\n            iconCss: 'e-icons e-bottom-borders',\n            cssClass: 'e-borders-ddb',\n            target: this.bordersMenu.element.parentElement,\n            created: function () { _this.bordersMenu.element.style.display = ''; },\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element.firstElementChild, _this.bordersMenu.items, 1); },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.e-borders-menu')) {\n                    args.cancel = true;\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.bordersDdb.createElement = this.parent.createElement;\n        this.bordersDdb.appendTo(this.parent.createElement('button', { id: id + '_borders' }));\n        return this.bordersDdb.element;\n    };\n    Ribbon.prototype.chartSelected = function (args) {\n        var isChart = !isNullOrUndefined(closest(args.element, '.e-chart-menu'));\n        var eleId = args.element.id;\n        if (('column_chart' + 'bar_chart' + 'area_chart' + 'pie_doughnut_chart' +\n            'line_chart' + 'radar_chart' + 'scatter_chart').includes(eleId)) {\n            var id = args.event.target.id;\n            this.parent.notify(insertChart, { action: eleId, id: id, isChart: isChart });\n        }\n    };\n    Ribbon.prototype.addChartEleSelected = function (args) {\n        var eleId = args.element.id;\n        this.parent.notify(chartDesignTab, { addChartEle: eleId });\n    };\n    Ribbon.prototype.cFSelected = function (args) {\n        var eleId = args.element.id;\n        if (('cf_greaterthan' + 'cf_lessthan' + 'cf_between' + 'cf_eqaulto' + 'cf_textthatcontains' +\n            'cf_adateoccuring' + 'cf_duplicatevalues' + 'cf_top10items' + 'cf_top10' + 'cf_bottom10items' +\n            'cf_bottom10' + 'cf_aboveaverage' + 'cf_belowaverage').includes(eleId)) {\n            this.parent.notify(initiateConditionalFormat, { action: args.item.text });\n        }\n        else if (('cf_databars' + 'cf_colorscales').includes(eleId)) {\n            var id = args.event.target.id;\n            this.parent.notify(setCF, { action: eleId, id: id });\n        }\n        else if ('cf_iconsets' === args.element.id) {\n            var target = args.event.target;\n            var iconName = (target.id === '') ? target.parentElement.id : target.id;\n            this.parent.notify(setCF, { action: eleId, id: iconName });\n        }\n        if (eleId === 'cf_cr_cells') {\n            this.parent.notify(clearCFRule, { range: this.parent.getActiveSheet().selectedRange, isPublic: false });\n        }\n        else if (eleId === 'cf_cr_sheet') {\n            var sheet = this.parent.getActiveSheet();\n            var range = getRangeAddress([0, 0, sheet.rowCount - 1, sheet.colCount - 1]);\n            this.parent.conditionalFormat = null;\n            this.parent.notify(clearCFRule, { range: range, isPublic: false });\n        }\n    };\n    Ribbon.prototype.borderSelected = function (args) {\n        if (args.item.items.length || args.item.id === this.parent.element.id + \"_border_colors\") {\n            return;\n        }\n        if (!args.item.text) {\n            var id = this.parent.element.id;\n            var border = this.border.split(' ');\n            var prevStyleId_1 = border[1] === 'solid' ? id + \"_\" + border[0] : id + \"_\" + border[1];\n            if (prevStyleId_1 === args.item.id) {\n                return;\n            }\n            if (args.item.id === id + \"_1px\" || args.item.id === id + \"_2px\" || args.item.id === id + \"_3px\") {\n                border[0] = args.item.id.split(id + \"_\")[1];\n                border[1] = 'solid';\n            }\n            else {\n                border[1] = args.item.id.split(id + \"_\")[1];\n                border[0] = border[1] === 'double' ? '3px' : '1px';\n            }\n            this.border = border.join(' ');\n            this.bordersMenu.items[12].items.forEach(function (item) {\n                if (item.id === prevStyleId_1) {\n                    item.iconCss = null;\n                }\n                if (item.id === args.item.id) {\n                    item.iconCss = 'e-icons e-selected-icon';\n                }\n            });\n            this.bordersMenu.setProperties({ 'items': this.bordersMenu.items }, true);\n            return;\n        }\n        this.bordersDdb.toggle();\n        this.parent.showSpinner();\n        switch (args.item.text) {\n            case 'Top Borders':\n                this.parent.notify(setCellFormat, { style: { borderTop: this.border }, onActionUpdate: true });\n                break;\n            case 'Left Borders':\n                this.parent.notify(setCellFormat, { style: { borderLeft: this.border }, onActionUpdate: true });\n                break;\n            case 'Right Borders':\n                this.parent.notify(setCellFormat, { style: { borderRight: this.border }, onActionUpdate: true });\n                break;\n            case 'Bottom Borders':\n                this.parent.notify(setCellFormat, { style: { borderBottom: this.border }, onActionUpdate: true });\n                break;\n            case 'All Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true });\n                break;\n            case 'Horizontal Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Horizontal' });\n                break;\n            case 'Vertical Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Vertical' });\n                break;\n            case 'Outside Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Outer' });\n                break;\n            case 'Inside Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Inner' });\n                break;\n            case 'No Borders':\n                this.parent.notify(setCellFormat, { style: { border: '' }, onActionUpdate: true });\n                break;\n        }\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.getFontNameDDB = function (id) {\n        var _this = this;\n        var fontNameBtn = this.parent.createElement('button', { id: id + '_font_name' });\n        fontNameBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'Calibri' }));\n        this.fontNameDdb = new DropDownButton({\n            cssClass: 'e-font-family',\n            items: this.getFontFamilyItems(),\n            select: function (args) {\n                var eventArgs = { style: { fontFamily: args.item.text }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.refreshFontNameSelection(eventArgs.style.fontFamily);\n                }\n            },\n            close: function () { return focus(_this.parent.element); },\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element, args.items); }\n        });\n        this.fontNameDdb.createElement = this.parent.createElement;\n        this.fontNameDdb.appendTo(fontNameBtn);\n        return fontNameBtn;\n    };\n    Ribbon.prototype.getBtn = function (id, name, bindEvent) {\n        if (bindEvent === void 0) { bindEvent = true; }\n        var btnObj = new Button({ iconCss: \"e-icons e-\" + name + \"-icon\", isToggle: true });\n        btnObj.createElement = this.parent.createElement;\n        btnObj.appendTo(this.parent.createElement('button', { id: id + \"_\" + name }));\n        if (bindEvent) {\n            btnObj.element.addEventListener('click', this.toggleBtnClicked.bind(this));\n        }\n        return btnObj.element;\n    };\n    Ribbon.prototype.datavalidationDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var direction;\n        this.datavalidationDdb = new DropDownButton({\n            cssClass: 'e-datavalidation-ddb',\n            iconCss: 'e-datavalidation-icon e-icons',\n            items: [\n                { text: l10n.getConstant('DataValidation') },\n                { text: l10n.getConstant('HighlightInvalidData') },\n                { text: l10n.getConstant('ClearHighlight') },\n                { text: l10n.getConstant('ClearValidation') }\n            ],\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.datavalidationDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                switch (args.item.text) {\n                    case l10n.getConstant('DataValidation'):\n                        _this.parent.notify(initiateDataValidation, null);\n                        break;\n                    case l10n.getConstant('HighlightInvalidData'):\n                        _this.parent.notify(invalidData, { isRemoveHighlight: false });\n                        break;\n                    case l10n.getConstant('ClearHighlight'):\n                        _this.parent.notify(invalidData, { isRemoveHighlight: true });\n                        break;\n                    case l10n.getConstant('ClearValidation'):\n                        _this.parent.notify(removeDataValidation, null);\n                        break;\n                    default:\n                        direction = args.item.text === l10n.getConstant('SortAscending') ? 'Ascending' : 'Descending';\n                        _this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: direction } } });\n                        break;\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.datavalidationDdb.createElement = this.parent.createElement;\n        this.datavalidationDdb.appendTo(this.parent.createElement('button', { id: id + '_datavalidation' }));\n        return this.datavalidationDdb.element;\n    };\n    Ribbon.prototype.getTextAlignDDB = function (id) {\n        var _this = this;\n        this.textAlignDdb = new DropDownButton({\n            cssClass: 'e-align-ddb',\n            iconCss: 'e-icons e-left-icon',\n            items: [{ iconCss: 'e-icons e-left-icon' }, { iconCss: 'e-icons e-center-icon' }, { iconCss: 'e-icons e-right-icon' }],\n            beforeItemRender: this.alignItemRender.bind(this),\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.textAlignDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                var eventArgs = {\n                    style: { textAlign: args.item.iconCss.split(' e-')[1].split('-icon')[0] }, onActionUpdate: true\n                };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.textAlignDdb.iconCss = \"e-icons e-\" + eventArgs.style.textAlign + \"-icon\";\n                    _this.textAlignDdb.dataBind();\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.textAlignDdb.createElement = this.parent.createElement;\n        this.textAlignDdb.appendTo(this.parent.createElement('button', { id: id + '_text_align' }));\n        return this.textAlignDdb.element;\n    };\n    Ribbon.prototype.getVerticalAlignDDB = function (id) {\n        var _this = this;\n        this.verticalAlignDdb = new DropDownButton({\n            cssClass: 'e-align-ddb',\n            iconCss: 'e-icons e-bottom-icon',\n            items: [{ iconCss: 'e-icons e-top-icon' }, { iconCss: 'e-icons e-middle-icon' }, { iconCss: 'e-icons e-bottom-icon' }],\n            beforeItemRender: this.alignItemRender.bind(this),\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.verticalAlignDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                var eventArgs = {\n                    style: { verticalAlign: args.item.iconCss.split(' e-')[1].split('-icon')[0] }, onActionUpdate: true\n                };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.verticalAlignDdb.iconCss = \"e-icons e-\" + eventArgs.style.verticalAlign + \"-icon\";\n                    _this.verticalAlignDdb.dataBind();\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.verticalAlignDdb.createElement = this.parent.createElement;\n        this.verticalAlignDdb.appendTo(this.parent.createElement('button', { id: id + '_vertical_align' }));\n        return this.verticalAlignDdb.element;\n    };\n    Ribbon.prototype.getMergeSplitBtn = function (id) {\n        var _this = this;\n        this.parent.element.appendChild(this.parent.createElement('button', { id: id + '_merge' }));\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.mergeSplitBtn = new SplitButton({\n            cssClass: 'e-merge-ddb',\n            iconCss: 'e-icons e-merge-icon',\n            items: [{ text: l10n.getConstant('MergeAll'), id: id + \"_merge_all\" }, { text: l10n.getConstant('MergeHorizontally'), id: id + \"_merge_horizontally\" }, { text: l10n.getConstant('MergeVertically'), id: id + \"_merge_vertically\" },\n                { separator: true, id: id + \"_merge_separator\" }, { text: l10n.getConstant('Unmerge'), id: id + \"_unmerge\" }],\n            select: this.mergeSelectHandler.bind(this),\n            close: function () { return focus(_this.parent.element); },\n            click: function (args) {\n                if (args.element.classList.contains('e-active')) {\n                    _this.toggleActiveState(false);\n                    _this.unMerge();\n                }\n                else {\n                    _this.toggleActiveState(true);\n                    _this.merge(_this.parent.element.id + \"_merge_all\");\n                }\n            },\n            created: function () {\n                _this.mergeSplitBtn.element.title = l10n.getConstant('MergeCells');\n                _this.mergeSplitBtn.element.nextElementSibling.title = l10n.getConstant('SelectMergeType');\n            }\n        });\n        this.mergeSplitBtn.createElement = this.parent.createElement;\n        this.mergeSplitBtn.appendTo('#' + id + '_merge');\n        return this.mergeSplitBtn.element.parentElement;\n    };\n    Ribbon.prototype.mergeSelectHandler = function (args) {\n        if (args.item.id === this.parent.element.id + \"_unmerge\") {\n            this.unMerge();\n        }\n        else {\n            this.merge(args.item.id);\n        }\n    };\n    Ribbon.prototype.unMerge = function () {\n        this.parent.showSpinner();\n        this.parent.notify(setMerge, { merge: false, range: this.parent.getActiveSheet().selectedRange,\n            isAction: true, refreshRibbon: true, type: 'All' });\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.merge = function (itemId) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        var cell;\n        var isDataPresent;\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (i === indexes[0] && j === indexes[1] && itemId.includes('merge_all')) {\n                    continue;\n                }\n                if (i === indexes[0] && itemId.includes('merge_vertically')) {\n                    continue;\n                }\n                if (j === indexes[1] && itemId.includes('_merge_horizontally')) {\n                    continue;\n                }\n                cell = getCell(i, j, sheet) || {};\n                if (cell.value || cell.formula) {\n                    isDataPresent = true;\n                }\n            }\n        }\n        if (!isDataPresent) {\n            this.performMerge(itemId);\n            return;\n        }\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            target: this.parent.element, height: 200, width: 400, isModal: true, showCloseIcon: true,\n            content: this.parent.serviceLocator.getService(locale).getConstant('MergeCellsAlert'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'MergeAlertDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                focus(_this.parent.element);\n            },\n            buttons: [{\n                    buttonModel: { content: this.parent.serviceLocator.getService(locale).getConstant('Ok'), isPrimary: true },\n                    click: function () { dialogInst.hide(); _this.performMerge(itemId); }\n                }]\n        });\n    };\n    Ribbon.prototype.performMerge = function (itemId) {\n        var id = this.parent.element.id;\n        this.parent.showSpinner();\n        switch (itemId) {\n            case id + \"_merge_all\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'All', isAction: true, refreshRibbon: true });\n                break;\n            case id + \"_merge_horizontally\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'Horizontally', isAction: true });\n                break;\n            case id + \"_merge_vertically\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'Vertically', isAction: true });\n                break;\n        }\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.getSortFilterDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var direction;\n        this.sortingDdb = new DropDownButton({\n            cssClass: 'e-sort-filter-ddb',\n            iconCss: 'e-icons e-sort-filter-icon',\n            items: [\n                { text: l10n.getConstant('SortAscending'), iconCss: 'e-icons e-sort-asc' },\n                { text: l10n.getConstant('SortDescending'), iconCss: 'e-icons e-sort-desc' },\n                { text: l10n.getConstant('CustomSort') + '...', iconCss: 'e-icons e-sort-custom' },\n                { separator: true },\n                { text: l10n.getConstant('Filter'), iconCss: 'e-icons e-filter-apply', id: id + '_applyfilter' },\n                { text: l10n.getConstant('ClearAllFilter'), iconCss: 'e-icons e-filter-clear', id: id + '_clearfilter' },\n                { text: l10n.getConstant('ReapplyFilter'), iconCss: 'e-icons e-filter-reapply', id: id + '_reapplyfilter' }\n            ],\n            beforeItemRender: function (args) {\n                var eventArgs = { isFiltered: false, isClearAll: true };\n                _this.parent.notify(getFilteredColumn, eventArgs);\n                if (args.item.id === id + '_clearfilter' || args.item.id === id + '_reapplyfilter') {\n                    if (!eventArgs.isFiltered) {\n                        args.element.classList.add('e-disabled');\n                    }\n                    else {\n                        args.element.classList.remove('e-disabled');\n                    }\n                }\n                else if (args.item.id === id + '_applyfilter') {\n                    var sheet = _this.parent.getActiveSheet();\n                    if (sheet.frozenColumns || sheet.frozenRows) {\n                        args.element.classList.add('e-disabled');\n                    }\n                }\n            },\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.sortingDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                switch (args.item.text) {\n                    case l10n.getConstant('Filter'):\n                        _this.parent.applyFilter();\n                        break;\n                    case l10n.getConstant('ClearAllFilter'):\n                        _this.parent.clearFilter();\n                        break;\n                    case l10n.getConstant('ReapplyFilter'):\n                        _this.parent.notify(reapplyFilter, null);\n                        break;\n                    case l10n.getConstant('CustomSort') + '...':\n                        _this.parent.notify(initiateCustomSort, null);\n                        break;\n                    default:\n                        direction = args.item.text === l10n.getConstant('SortAscending') ? 'Ascending' : 'Descending';\n                        _this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: direction } } });\n                        break;\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.sortingDdb.createElement = this.parent.createElement;\n        this.sortingDdb.appendTo(this.parent.createElement('button', { id: id + '_sorting' }));\n        return this.sortingDdb.element;\n    };\n    Ribbon.prototype.getFindDDb = function (id) {\n        var _this = this;\n        var findToolbtn = this.parent.createElement('button', { id: id + '_findbtn' });\n        this.findDdb = new Button({\n            cssClass: 'e-spreadsheet-find-ddb e-caret-hide',\n            iconCss: 'e-icons e-search-icon'\n        });\n        this.findDdb.createElement = this.parent.createElement;\n        this.findDdb.appendTo(findToolbtn);\n        findToolbtn.onclick = function () {\n            _this.findToolDlg();\n        };\n        return this.findDdb.element;\n    };\n    Ribbon.prototype.findToolDlg = function () {\n        var _this = this;\n        var countArgs;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-findtool-dlg'))) {\n            // eslint-disable-next-line prefer-const\n            var toolbarObj_1;\n            var findTextElement = this.parent.createElement('div', { className: 'e-input-group' });\n            var findTextInput = this.parent.createElement('input', {\n                className: 'e-input e-text-findNext-short', attrs: { 'type': 'Text', value: this.findValue }\n            });\n            var l10n = this.parent.serviceLocator.getService(locale);\n            findTextInput.setAttribute('placeholder', l10n.getConstant('FindValue'));\n            var findSpan_1 = this.parent.createElement('span', { className: 'e-input-group-icon' });\n            findTextInput.onkeyup = function () {\n                countArgs = { countOpt: 'count', findCount: '' };\n                _this.parent.notify(findHandler, { countArgs: countArgs });\n                findSpan_1.textContent = countArgs.findCount;\n                var element = document.querySelector('.e-text-findNext-short');\n                var value = element.value;\n                var nextElement = document.querySelector('.e-findRib-next');\n                var prevElement = document.querySelector('.e-findRib-prev');\n                if (isNullOrUndefined(value) || (value === '') || (countArgs.findCount === '0 of 0')) {\n                    toolbarObj_1.enableItems(nextElement, false);\n                    toolbarObj_1.enableItems(prevElement, false);\n                    findSpan_1.textContent = '0 of 0';\n                }\n                else if (!isNullOrUndefined(value) || (countArgs.findCount !== '0 of 0')) {\n                    toolbarObj_1.enableItems(nextElement, true);\n                    toolbarObj_1.enableItems(prevElement, true);\n                }\n            };\n            findTextInput.onkeydown = function (e) {\n                countArgs = { countOpt: 'count', findCount: '' };\n                _this.parent.notify(findHandler, { countArgs: countArgs });\n                var count = countArgs.findCount;\n                _this.findOnKeyDown(e, count);\n            };\n            findTextElement.appendChild(findTextInput);\n            findTextElement.appendChild(findSpan_1);\n            var toolItemModel = [\n                { type: 'Input', template: findTextElement },\n                {\n                    prefixIcon: 'e-icons e-prev-icon', tooltipText: 'Find Previous', type: 'Button', cssClass: 'e-findRib-prev',\n                    disabled: true\n                },\n                { prefixIcon: 'e-icons e-next-icon', tooltipText: 'Find Next', type: 'Button', cssClass: 'e-findRib-next', disabled: true },\n                { type: 'Separator' },\n                { prefixIcon: 'e-icons e-option-icon', tooltipText: 'More Options', type: 'Button', cssClass: 'e-findRib-more' },\n                { prefixIcon: 'e-icons e-close', tooltipText: 'Close', type: 'Button', cssClass: 'e-findRib-close' }\n            ];\n            toolbarObj_1 = new Toolbar({\n                clicked: function (args) {\n                    if (args.item.cssClass === 'e-findRib-next') {\n                        _this.parent.notify(findHandler, { findOption: 'next' });\n                        countArgs = { countOpt: 'count', findCount: '' };\n                        _this.parent.notify(findHandler, { countArgs: countArgs });\n                        findSpan_1.textContent = countArgs.findCount;\n                    }\n                    else if (args.item.cssClass === 'e-findRib-prev') {\n                        _this.parent.notify(findHandler, { findOption: 'prev' });\n                        countArgs = { countOpt: 'count', findCount: '' };\n                        _this.parent.notify(findHandler, { countArgs: countArgs });\n                        findSpan_1.textContent = countArgs.findCount;\n                    }\n                    else if (args.item.cssClass === 'e-findRib-more') {\n                        _this.parent.notify(findDlg, null);\n                        _this.findDialog.hide();\n                    }\n                }, width: 'auto', height: 'auto', items: toolItemModel, cssClass: 'e-find-toolObj'\n            });\n            var toolbarElement_1 = this.parent.createElement('div', { className: 'e-find-toolbar' });\n            var dialogDiv = this.parent.createElement('div', { className: 'e-dlg-div' });\n            this.findDialog = new FindDialog({\n                isModal: false, showCloseIcon: false, cssClass: 'e-findtool-dlg', content: toolbarElement_1, visible: false,\n                allowDragging: true, target: this.parent.element.querySelector('.e-sheet'),\n                beforeOpen: function () {\n                    EventHandler.add(document, 'click', _this.closeDialog, _this);\n                },\n                open: function () {\n                    _this.textFocus(toolbarObj_1.element);\n                },\n                beforeClose: function () {\n                    _this.findValue = _this.parent.element.querySelector('.e-text-findNext-short').value;\n                    toolbarObj_1.destroy();\n                    var element = document.querySelector('.e-find-toolbar');\n                    EventHandler.remove(element, 'focus', _this.textFocus);\n                    EventHandler.remove(document, 'click', _this.closeDialog);\n                    focus(_this.parent.element);\n                },\n                created: function () {\n                    toolbarObj_1.createElement = _this.parent.createElement;\n                    toolbarObj_1.appendTo(toolbarElement_1);\n                    _this.findDialog.width = getComputedStyle(document.querySelector('.e-findtool-dlg')).width;\n                    var offset = _this.parent.element.querySelector('.e-main-panel').getBoundingClientRect();\n                    var width = _this.findDialog.width.toString();\n                    _this.findDialog.position = { X: offset.width - parseInt(width, 10) - (_this.parent.allowScrolling ? getScrollBarWidth() :\n                            0), Y: _this.parent.getActiveSheet().showHeaders ? 31 : 0 };\n                    _this.findDialog.dataBind();\n                    _this.findDialog.show();\n                }\n            });\n            this.findDialog.createElement = this.parent.createElement;\n            this.findDialog.appendTo(dialogDiv);\n        }\n        else {\n            if (!isNullOrUndefined(this.parent.element.querySelector('.e-findtool-dlg'))) {\n                this.findDialog.hide();\n                detach(this.parent.element.querySelector('.e-findtool-dlg'));\n                this.findDialog = null;\n                focus(this.parent.element);\n            }\n        }\n    };\n    Ribbon.prototype.findOnKeyDown = function (e, count) {\n        if (document.querySelector('.e-text-findNext-short').value) {\n            if (count !== '0 of 0') {\n                if (e.shiftKey) {\n                    if (e.keyCode === 13) {\n                        var buttonArgs = { findOption: 'prev' };\n                        this.parent.notify(findHandler, buttonArgs);\n                    }\n                }\n                else if (e.keyCode === 13) {\n                    var buttonArg = { findOption: 'next' };\n                    this.parent.notify(findHandler, buttonArg);\n                }\n            }\n        }\n    };\n    Ribbon.prototype.closeDialog = function (e) {\n        if ((closest(e.target, '.e-findRib-close')) || (!closest(e.target, '.e-spreadsheet'))) {\n            if (!isNullOrUndefined(this.findDialog)) {\n                this.findDialog.hide();\n                var findToolDlg = this.parent.element.querySelector('.e-findtool-dlg');\n                if (findToolDlg) {\n                    detach(findToolDlg);\n                }\n                this.findDialog = null;\n            }\n        }\n    };\n    Ribbon.prototype.textFocus = function (element) {\n        element = document.querySelector('.e-find-toolbar');\n        element.addEventListener('focus', function () {\n            var elements = document.querySelector('.e-text-findNext-short');\n            elements.focus();\n            elements.classList.add('e-input-focus');\n            (elements).setSelectionRange(0, elements.value.length);\n        });\n    };\n    Ribbon.prototype.getClearDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.clearDdb = new DropDownButton({\n            cssClass: 'e-clear-ddb',\n            iconCss: 'e-icons e-clear-icon',\n            items: [\n                { text: l10n.getConstant('ClearAll') },\n                { text: l10n.getConstant('ClearFormats') },\n                { text: l10n.getConstant('ClearContents') },\n                { text: l10n.getConstant('ClearHyperlinks') }\n            ],\n            select: function (args) {\n                _this.parent.notify(clearViewer, { options: { type: args.item.text } });\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.clearDdb.createElement = this.parent.createElement;\n        this.clearDdb.appendTo(this.parent.createElement('button', { id: id + '_clear' }));\n        return this.clearDdb.element;\n    };\n    Ribbon.prototype.ribbonCreated = function () {\n        this.ribbon.element.querySelector('.e-drop-icon').title\n            = this.parent.serviceLocator.getService(locale).getConstant('CollapseToolbar');\n    };\n    Ribbon.prototype.alignItemRender = function (args) {\n        var text = args.item.iconCss.split(' e-')[1].split('-icon')[0];\n        text = text[0].toUpperCase() + text.slice(1, text.length);\n        args.element.title = this.parent.serviceLocator.getService(locale).getConstant('Align' + text);\n    };\n    Ribbon.prototype.toggleBtnClicked = function (e) {\n        var target = closest(e.target, '.e-btn');\n        var parentId = this.parent.element.id;\n        var id = target.id;\n        var property = setCellFormat;\n        var value;\n        var defaultModel;\n        var activeModel;\n        var eventArgs;\n        var key;\n        switch (id) {\n            case parentId + \"_bold\":\n                defaultModel = { fontWeight: 'normal' };\n                activeModel = { fontWeight: 'bold' };\n                key = 'fontWeight';\n                break;\n            case parentId + \"_italic\":\n                defaultModel = { fontStyle: 'normal' };\n                activeModel = { fontStyle: 'italic' };\n                key = 'fontStyle';\n                break;\n            case parentId + \"_line-through\":\n                property = textDecorationUpdate;\n                defaultModel = { textDecoration: 'line-through' };\n                activeModel = defaultModel;\n                key = 'textDecoration';\n                break;\n            case parentId + \"_underline\":\n                property = textDecorationUpdate;\n                defaultModel = { textDecoration: 'underline' };\n                activeModel = defaultModel;\n                key = 'textDecoration';\n                break;\n        }\n        if (target.classList.contains('e-active')) {\n            value = activeModel[key];\n            eventArgs = { style: activeModel, onActionUpdate: true };\n            this.parent.notify(property, eventArgs);\n            if (eventArgs.cancel) {\n                target.classList.remove('e-active');\n            }\n        }\n        else {\n            value = defaultModel[key];\n            eventArgs = { style: defaultModel, onActionUpdate: true };\n            this.parent.notify(property, eventArgs);\n            if (eventArgs.cancel) {\n                target.classList.add('e-active');\n            }\n        }\n        if (!eventArgs.cancel && value !== eventArgs.style[key]) {\n            this.refreshToggleBtn(getCellIndexes(this.parent.getActiveSheet().activeCell));\n        }\n        focus(this.parent.element);\n    };\n    Ribbon.prototype.getCellStyleValue = function (cssProp, indexes) {\n        var cell = getCell(indexes[0], indexes[1], this.parent.getActiveSheet());\n        var value = this.parent.cellStyle[cssProp];\n        if (cell && cell.style && cell.style[cssProp]) {\n            value = cell.style[cssProp];\n        }\n        return value;\n    };\n    Ribbon.prototype.refreshSelected = function (inst, element, key, itemKey) {\n        if (itemKey === void 0) { itemKey = key; }\n        for (var i = 0; i < inst.items.length; i++) {\n            if (inst.items[i][itemKey] === inst[key]) {\n                element.children[i].classList.add('e-selected');\n                break;\n            }\n        }\n    };\n    Ribbon.prototype.expandCollapseHandler = function (args) {\n        var target = this.ribbon.element.querySelector('.e-drop-icon');\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.expanded) {\n            target.title = l10n.getConstant('CollapseToolbar');\n        }\n        else {\n            target.title = l10n.getConstant('ExpandToolbar');\n        }\n        this.parent.setPanelSize();\n    };\n    Ribbon.prototype.getChartThemeDdbItems = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        return [\n            { id: 'Material', text: l10n.getConstant('Material') },\n            { id: 'Fabric', text: l10n.getConstant('Fabric') },\n            { id: 'Bootstrap', text: l10n.getConstant('Bootstrap') },\n            { id: 'HighContrastLight', text: l10n.getConstant('HighContrastLight') },\n            { id: 'MaterialDark', text: l10n.getConstant('MaterialDark') },\n            { id: 'FabricDark', text: l10n.getConstant('FabricDark') },\n            { id: 'HighContrast', text: l10n.getConstant('HighContrast') },\n            { id: 'BootstrapDark', text: l10n.getConstant('BootstrapDark') },\n            { id: 'Bootstrap4', text: l10n.getConstant('Bootstrap4') }\n        ];\n    };\n    Ribbon.prototype.getNumFormatDdbItems = function (id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        return [\n            { id: id + '_General', text: l10n.getConstant('General') },\n            { id: id + '_Number', text: l10n.getConstant('Number') },\n            { id: id + '_Currency', text: l10n.getConstant('Currency') },\n            { id: id + '_Accounting', text: l10n.getConstant('Accounting') },\n            { id: id + '_ShortDate', text: l10n.getConstant('ShortDate') },\n            { id: id + '_LongDate', text: l10n.getConstant('LongDate') },\n            { id: id + '_Time', text: l10n.getConstant('Time') },\n            { id: id + '_Percentage', text: l10n.getConstant('Percentage') },\n            { id: id + '_Fraction', text: l10n.getConstant('Fraction') },\n            { id: id + '_Scientific', text: l10n.getConstant('Scientific') },\n            { id: id + '_Text', text: l10n.getConstant('Text') }\n        ];\n    };\n    Ribbon.prototype.getFontFamilyItems = function () {\n        return [{ text: 'Arial' }, { text: 'Arial Black' }, { text: 'Axettac Demo' }, { text: 'Batang' }, { text: 'Book Antiqua' },\n            { text: 'Calibri', iconCss: 'e-icons e-selected-icon' }, { text: 'Courier' }, { text: 'Courier New' },\n            { text: 'Din Condensed' }, { text: 'Georgia' }, { text: 'Helvetica' }, { text: 'Helvetica New' }, { text: 'Roboto' },\n            { text: 'Tahoma' }, { text: 'Times New Roman' }, { text: 'Verdana' }];\n    };\n    Ribbon.prototype.numDDBSelect = function (args) {\n        var eventArgs = {\n            format: getFormatFromType(args.item.id.split(this.parent.element.id + '_')[1]),\n            range: this.parent.getActiveSheet().selectedRange, cancel: false, requestType: 'NumberFormat'\n        };\n        var actionArgs = {\n            range: this.parent.getActiveSheet().name + '!' + eventArgs.range,\n            format: eventArgs.format, requestType: 'NumberFormat'\n        };\n        this.parent.trigger('beforeCellFormat', eventArgs);\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'format' });\n        if (eventArgs.cancel) {\n            return;\n        }\n        this.parent.notify(applyNumberFormatting, eventArgs);\n        this.parent.notify(selectionComplete, { type: 'mousedown' });\n        this.refreshNumFormatSelection(args.item.text);\n        this.parent.notify(completeAction, { eventArgs: actionArgs, action: 'format' });\n    };\n    Ribbon.prototype.chartThemeDDBSelect = function (args) {\n        this.parent.notify(selectionComplete, { type: 'mousedown' });\n        this.refreshChartThemeSelection(args.item.id);\n        this.parent.notify(chartDesignTab, { chartTheme: args.item.id });\n    };\n    Ribbon.prototype.tBarDdbBeforeOpen = function (element, items, separatorCount) {\n        if (separatorCount === void 0) { separatorCount = 0; }\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(element.firstElementChild).height, 10) * (items.length - separatorCount)) +\n            (parseInt(getComputedStyle(element).paddingTop, 10) * 2);\n        if (separatorCount) {\n            var separatorStyle = getComputedStyle(element.querySelector('.e-separator'));\n            actualHeight += (separatorCount * (parseInt(separatorStyle.borderBottomWidth, 10) + (parseInt(separatorStyle.marginTop, 10) * 2)));\n        }\n        if (actualHeight > viewportHeight) {\n            element.style.height = viewportHeight + \"px\";\n            element.style.overflowY = 'auto';\n        }\n        else {\n            if (element.style.height) {\n                element.style.height = '';\n                element.style.overflowY = '';\n            }\n        }\n    };\n    Ribbon.prototype.numDDBOpen = function (args) {\n        this.numPopupWidth = 0;\n        var elemList = args.element.querySelectorAll('span.e-numformat-preview-text');\n        for (var i = 0, len = elemList.length; i < len; i++) {\n            if (this.numPopupWidth < elemList[i].offsetWidth) {\n                this.numPopupWidth = elemList[i].offsetWidth;\n            }\n        }\n        var popWidth = this.numPopupWidth + 160;\n        document.querySelector('.e-numformat-ddb.e-dropdown-popup').style.width = popWidth + \"px\";\n    };\n    Ribbon.prototype.previewNumFormat = function (args) {\n        var cellIndex = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var cell = getCell(cellIndex[0], cellIndex[1], this.parent.getActiveSheet());\n        var eventArgs = {\n            type: args.item.text,\n            formattedText: '',\n            value: cell && cell.value ? cell.value : '',\n            format: getFormatFromType(args.item.id.split(this.parent.element.id + '_')[1]),\n            sheetIndex: this.parent.activeSheetIndex,\n            onLoad: true\n        };\n        var numElem = this.parent.createElement('div', {\n            className: 'e-numformat-text',\n            styles: 'width:100%',\n            innerHTML: args.element.innerHTML\n        });\n        args.element.innerHTML = '';\n        this.parent.notify(getFormattedCellObject, eventArgs);\n        var previewElem = this.parent.createElement('span', {\n            className: 'e-numformat-preview-text',\n            styles: 'float:right;',\n            innerHTML: eventArgs.formattedText.toString()\n        });\n        numElem.appendChild(previewElem);\n        args.element.appendChild(numElem);\n    };\n    Ribbon.prototype.refreshRibbonContent = function (activeTab) {\n        if (!this.ribbon) {\n            return;\n        }\n        if (isNullOrUndefined(activeTab)) {\n            activeTab = this.ribbon.selectedTab;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        switch (this.ribbon.items[activeTab].header.text) {\n            case l10n.getConstant('Home'):\n                this.refreshHomeTabContent(getCellIndexes(sheet.activeCell));\n                break;\n            case l10n.getConstant('Insert'):\n                // Second tab functionality comes here\n                break;\n            case l10n.getConstant('Formulas'):\n                // Third tab functionality comes here\n                break;\n            case l10n.getConstant('Data'):\n                this.refreshDataTabContent(activeTab);\n                break;\n            case l10n.getConstant('View'):\n                this.refreshViewTabContent(activeTab);\n                break;\n        }\n    };\n    Ribbon.prototype.refreshHomeTabContent = function (indexes) {\n        if (!isNullOrUndefined(document.getElementById(this.parent.element.id + '_number_format'))) {\n            this.numFormatDDB = getComponent(document.getElementById(this.parent.element.id + '_number_format'), DropDownButton);\n        }\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var cell = getCell(actCell[0], actCell[1], this.parent.getActiveSheet()) || {};\n        var type = getTypeFromFormat(cell.format ? cell.format : 'General');\n        if (this.numFormatDDB) {\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                type = 'General';\n                this.refreshNumFormatSelection(type);\n            }\n            else {\n                this.refreshNumFormatSelection(l10n.getConstant(type));\n            }\n        }\n        if (this.fontNameDdb) {\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.refreshFontNameSelection('Calibri');\n            }\n            else {\n                this.refreshFontNameSelection(this.getCellStyleValue('fontFamily', indexes));\n            }\n        }\n        if (this.fontSizeDdb) {\n            var value = this.getCellStyleValue('fontSize', indexes);\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.fontSizeDdb.content = '11';\n            }\n            else {\n                value = value.includes('pt') ? value.split('pt')[0] : '11';\n                if (value !== this.fontSizeDdb.content) {\n                    this.fontSizeDdb.content = value;\n                    this.fontSizeDdb.dataBind();\n                }\n            }\n        }\n        if (this.textAlignDdb) {\n            var style = this.getCellStyleValue('textAlign', indexes);\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.textAlignDdb.iconCss = 'e-icons e-left-icon';\n            }\n            else {\n                if (cell.value !== undefined && style === 'left' && (type === 'Accounting' || isNumber(cell.value))) {\n                    style = 'right';\n                }\n                var value = \"e-icons e-\" + style.toLowerCase() + \"-icon\";\n                if (value !== this.textAlignDdb.iconCss) {\n                    this.textAlignDdb.iconCss = value;\n                    this.textAlignDdb.dataBind();\n                }\n            }\n        }\n        if (this.verticalAlignDdb) {\n            var value = \"e-icons e-\" + this.getCellStyleValue('verticalAlign', indexes).toLowerCase() + \"-icon\";\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.verticalAlignDdb.iconCss = 'e-icons e-bottom-icon';\n            }\n            else {\n                if (value !== this.verticalAlignDdb.iconCss) {\n                    this.verticalAlignDdb.iconCss = value;\n                    this.verticalAlignDdb.dataBind();\n                }\n            }\n        }\n        this.refreshToggleBtn(indexes);\n        if (!sheet.isProtected && (cell.rowSpan > 1 || cell.colSpan > 1)) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: [this.parent.element.id + \"_merge_cells\"],\n                    enable: true }]);\n            this.toggleActiveState(true);\n        }\n        else {\n            var indexes_1 = getRangeIndexes(sheet.selectedRange);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: [this.parent.element.id + \"_merge_cells\"],\n                    enable: indexes_1[0] !== indexes_1[2] || indexes_1[1] !== indexes_1[3] ? true : false }]);\n            this.toggleActiveState(false);\n        }\n    };\n    Ribbon.prototype.toggleActiveState = function (active) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.parent.getActiveSheet().isProtected) {\n            if (active) {\n                this.mergeSplitBtn.element.classList.add('e-active');\n                this.mergeSplitBtn.element.title = l10n.getConstant('UnmergeCells');\n            }\n            else {\n                if (this.mergeSplitBtn.element.classList.contains('e-active')) {\n                    this.mergeSplitBtn.element.classList.remove('e-active');\n                }\n                this.mergeSplitBtn.element.title = l10n.getConstant('MergeCells');\n            }\n        }\n    };\n    Ribbon.prototype.refreshToggleBtn = function (indexes) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var btn;\n        var id = this.parent.element.id;\n        var value;\n        var isActive;\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var fontProps = ['fontWeight', 'fontStyle', 'textDecoration', 'textDecoration'];\n        ['bold', 'italic', 'line-through', 'underline', 'wrap'].forEach(function (name, index) {\n            btn = document.getElementById(id + \"_\" + name);\n            if (btn) {\n                if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                    btn.classList.remove('e-active');\n                }\n                else if (name === 'wrap') {\n                    isActive = cell && cell.wrap;\n                }\n                else {\n                    value = _this.getCellStyleValue(fontProps[index], indexes).toLowerCase();\n                    isActive = value.indexOf(name) > -1;\n                }\n                if (isActive) {\n                    btn.classList.add('e-active');\n                }\n                else {\n                    if (btn.classList.contains('e-active')) {\n                        btn.classList.remove('e-active');\n                    }\n                }\n            }\n        });\n    };\n    Ribbon.prototype.refreshFontNameSelection = function (fontFamily) {\n        fontFamily = fontFamily.split('\"').join('');\n        this.fontNameDdb.element.firstElementChild.textContent = fontFamily;\n        for (var i = 0; i < this.fontNameDdb.items.length; i++) {\n            if (this.fontNameDdb.items[i].text === fontFamily) {\n                this.fontNameDdb.items[i].iconCss = 'e-icons e-selected-icon';\n                if (i !== this.fontNameIndex) {\n                    this.fontNameDdb.items[this.fontNameIndex].iconCss = '';\n                }\n                this.fontNameDdb.setProperties({ 'items': this.fontNameDdb.items }, true);\n                this.fontNameIndex = i;\n                break;\n            }\n        }\n        if (['Arial', 'Arial Black', 'Axettac Demo', 'Batang', 'Book Antiqua', 'Calibri', 'Courier',\n            'Courier New', 'Din Condensed', 'Georgia', 'Helvetica', 'Helvetica New', 'Roboto',\n            'Tahoma', 'Times New Roman', 'Verdana'].indexOf(fontFamily) < 0) {\n            this.fontNameDdb.items[this.fontNameIndex].iconCss = '';\n        }\n    };\n    Ribbon.prototype.refreshNumFormatSelection = function (type) {\n        for (var i = 0; i < this.numFormatDDB.items.length; i++) {\n            if (this.numFormatDDB.items[i].iconCss !== '') {\n                this.numFormatDDB.items[i].iconCss = '';\n            }\n            if (this.numFormatDDB.items[i].text === type) {\n                this.numFormatDDB.items[i].iconCss = 'e-icons e-selected-icon';\n            }\n        }\n        this.numFormatDDB.element.firstElementChild.textContent = type;\n        this.numFormatDDB.setProperties({ 'items': this.numFormatDDB.items }, true);\n    };\n    Ribbon.prototype.refreshChartThemeSelection = function (chartTheme) {\n        if (chartTheme !== this.chartThemeDDB.items[this.chartThemeIndex].text) {\n            this.chartThemeDDB.element.firstElementChild.textContent = this.getChartThemeText(chartTheme);\n            for (var i = 0; i < this.chartThemeDDB.items.length; i++) {\n                if (this.chartThemeDDB.items[i].id === chartTheme) {\n                    this.chartThemeDDB.items[i].iconCss = 'e-icons e-selected-icon';\n                    this.chartThemeDDB.items[this.chartThemeIndex].iconCss = '';\n                    this.chartThemeDDB.setProperties({ 'items': this.chartThemeDDB.items }, true);\n                    this.chartThemeIndex = i;\n                    break;\n                }\n            }\n        }\n    };\n    Ribbon.prototype.getChartThemeText = function (theme) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var selectedTheme = '';\n        switch (theme) {\n            case 'Material':\n                selectedTheme = l10n.getConstant('Material');\n                break;\n            case 'Fabric':\n                selectedTheme = l10n.getConstant('Fabric');\n                break;\n            case 'Bootstrap':\n                selectedTheme = l10n.getConstant('Bootstrap');\n                break;\n            case 'HighContrastLight':\n                selectedTheme = l10n.getConstant('HighContrastLight');\n                break;\n            case 'MaterialDark':\n                selectedTheme = l10n.getConstant('MaterialDark');\n                break;\n            case 'FabricDark':\n                selectedTheme = l10n.getConstant('FabricDark');\n                break;\n            case 'HighContrast':\n                selectedTheme = l10n.getConstant('HighContrast');\n                break;\n            case 'BootstrapDark':\n                selectedTheme = l10n.getConstant('BootstrapDark');\n                break;\n            case 'Bootstrap4':\n                selectedTheme = l10n.getConstant('Bootstrap4');\n                break;\n        }\n        return selectedTheme;\n    };\n    Ribbon.prototype.fileMenuItemSelect = function (args) {\n        var _this = this;\n        var selectArgs = extend({ cancel: false }, args);\n        this.parent.trigger('fileMenuItemSelect', selectArgs);\n        var id = this.parent.element.id;\n        var dialogInst;\n        if (!selectArgs.cancel) {\n            switch (args.item.id) {\n                case id + \"_Open\":\n                    select('#' + id + '_fileUpload', this.parent.element).click();\n                    break;\n                case id + \"_Xlsx\":\n                case id + \"_Xls\":\n                case id + \"_Csv\":\n                case id + \"_Pdf\":\n                    this.parent.save({ saveType: args.item.id.split(id + \"_\")[1] });\n                    break;\n                case id + \"_New\":\n                    dialogInst = this.parent.serviceLocator.getService(dialog);\n                    dialogInst.show({\n                        height: 200, width: 400, isModal: true, showCloseIcon: true,\n                        content: this.parent.serviceLocator.getService(locale).getConstant('DestroyAlert'),\n                        beforeOpen: function (args) {\n                            var dlgArgs = {\n                                dialogName: 'DestroySheetDialog',\n                                element: args.element, target: args.target, cancel: args.cancel\n                            };\n                            _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                            if (dlgArgs.cancel) {\n                                args.cancel = true;\n                            }\n                            focus(_this.parent.element);\n                        },\n                        buttons: [{\n                                buttonModel: {\n                                    content: this.parent.serviceLocator.getService(locale).getConstant('Ok'), isPrimary: true\n                                },\n                                click: function () {\n                                    _this.parent.sheets.length = 0;\n                                    _this.parent.createSheet();\n                                    dialogInst.hide();\n                                    _this.parent.activeSheetIndex = _this.parent.sheets.length - 1;\n                                    _this.parent.notify(refreshSheetTabs, {});\n                                    _this.parent.notify(sheetsDestroyed, {});\n                                    _this.parent.renderModule.refreshSheet();\n                                }\n                            }]\n                    });\n                    break;\n            }\n        }\n    };\n    Ribbon.prototype.toolbarClicked = function (args) {\n        if (!(args.item.id === 'spreadsheet_find')) {\n            var parentId = this.parent.element.id;\n            var sheet = this.parent.getActiveSheet();\n            var evtHArgs = void 0;\n            var evtglArgs = void 0;\n            var isActive = void 0;\n            var indexes = void 0;\n            var selectCell = void 0;\n            switch (args.item.id) {\n                case parentId + '_headers':\n                    evtHArgs = {\n                        isShow: !sheet.showHeaders,\n                        sheetIdx: this.parent.activeSheetIndex,\n                        cancel: false\n                    };\n                    this.parent.notify(completeAction, { eventArgs: evtHArgs, action: 'headers' });\n                    if (evtHArgs.cancel) {\n                        return;\n                    }\n                    this.parent.setSheetPropertyOnMute(sheet, 'showHeaders', !sheet.showHeaders);\n                    this.parent.serviceLocator.getService('sheet').showHideHeaders();\n                    this.toggleRibbonItems({ props: 'Headers', activeTab: this.ribbon.selectedTab });\n                    focus(this.parent.element);\n                    break;\n                case parentId + '_gridlines':\n                    evtglArgs = {\n                        isShow: !sheet.showGridLines,\n                        sheetIdx: this.parent.activeSheetIndex,\n                        cancel: false\n                    };\n                    this.parent.notify(completeAction, { eventArgs: evtglArgs, action: 'gridLines' });\n                    if (evtglArgs.cancel) {\n                        return;\n                    }\n                    this.parent.setSheetPropertyOnMute(sheet, 'showGridLines', !sheet.showGridLines);\n                    this.toggleRibbonItems({ props: 'GridLines', activeTab: this.ribbon.selectedTab });\n                    focus(this.parent.element);\n                    break;\n                case parentId + '_protect':\n                    this.parent.setSheetPropertyOnMute(sheet, 'isProtected', !sheet.isProtected);\n                    isActive = sheet.isProtected ? false : true;\n                    this.parent.notify(applyProtect, { isActive: isActive, id: parentId + '_protect' });\n                    break;\n                case parentId + '_undo':\n                    this.parent.notify(performUndoRedo, { isUndo: true });\n                    break;\n                case parentId + '_redo':\n                    this.parent.notify(performUndoRedo, { isUndo: false });\n                    break;\n                case parentId + '_freezepanes':\n                    indexes = getCellIndexes(sheet.topLeftCell);\n                    selectCell = sheet.frozenRows || sheet.frozenColumns ? indexes : getCellIndexes(sheet.activeCell);\n                    this.parent.notify(freeze, { row: selectCell[0] - indexes[0], column: selectCell[1] - indexes[1], isAction: true });\n                    break;\n                case parentId + '_freezerows':\n                    this.parent.notify(freeze, { row: sheet.frozenRows ? 0 : getCellIndexes(sheet.activeCell)[0] - getCellIndexes(sheet.topLeftCell)[0], column: sheet.frozenColumns, isAction: true });\n                    break;\n                case parentId + '_freezecolumns':\n                    this.parent.notify(freeze, { row: sheet.frozenRows, column: sheet.frozenColumns ? 0 : getCellIndexes(sheet.activeCell)[1] - getCellIndexes(sheet.topLeftCell)[1], isAction: true });\n                    break;\n                case parentId + '_protectworkbook':\n                    if (this.parent.password.length > 0) {\n                        this.parent.notify(unProtectWorkbook, null);\n                    }\n                    else {\n                        if (this.parent.isProtected) {\n                            this.parent.isProtected = false;\n                            if (this.parent.showSheetTabs) {\n                                this.parent.element.querySelector('.e-add-sheet-tab').removeAttribute('disabled');\n                                this.parent.element.querySelector('.e-add-sheet-tab').classList.remove('e-disabled');\n                            }\n                            this.toggleRibbonItems({ props: 'Protectworkbook', activeTab: this.ribbon.selectedTab });\n                        }\n                        else if (this.parent.element.querySelector('.e-add-sheet-tab').classList.contains('e-disabled')) {\n                            this.toggleRibbonItems({ props: 'Protectworkbook', activeTab: this.ribbon.selectedTab });\n                        }\n                        else {\n                            this.parent.notify(protectWorkbook, null);\n                        }\n                    }\n                    break;\n            }\n            this.parent.notify(ribbonClick, args);\n        }\n    };\n    Ribbon.prototype.toggleRibbonItems = function (args) {\n        var text = '';\n        var viewtabHeader = this.parent.serviceLocator.getService(locale).getConstant('View');\n        var datatabHeader = this.parent.serviceLocator.getService(locale).getConstant('Data');\n        if (this.ribbon.items[this.ribbon.selectedTab].header.text === viewtabHeader) {\n            if (isNullOrUndefined(args.activeTab)) {\n                for (var i = 0, len_1 = this.ribbon.items.length; i < len_1; i++) {\n                    if (this.ribbon.items[i].header.text === viewtabHeader) {\n                        args.activeTab = i;\n                        break;\n                    }\n                }\n            }\n            var text_1 = this.getLocaleText(args.props, args.props === 'GridLines');\n            var id = this.parent.element.id + \"_\" + args.props.toLowerCase();\n            var len = this.ribbon.items[args.activeTab].content.length;\n            for (var i = void 0; i < len; i++) {\n                if (this.ribbon.items[args.activeTab].content[i].type === 'Separator') {\n                    continue;\n                }\n                if (this.ribbon.items[args.activeTab].content[i].id === id) {\n                    this.ribbon.items[args.activeTab].content[i].text = text_1;\n                    this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n                }\n            }\n            if (this.ribbon.items[this.ribbon.selectedTab].header.text === viewtabHeader) {\n                this.updateToggleText(args.props.toLowerCase(), text_1);\n            }\n        }\n        if (this.ribbon.items[this.ribbon.selectedTab].header.text === datatabHeader) {\n            if (isNullOrUndefined(args.activeTab)) {\n                for (var i = 0, len_2 = this.ribbon.items.length; i < len_2; i++) {\n                    if (this.ribbon.items[i].header.text === datatabHeader) {\n                        args.activeTab = i;\n                        break;\n                    }\n                }\n            }\n            var id = this.parent.element.id + \"_\" + args.props.toLowerCase();\n            if (id === this.parent.element.id + '_protect') {\n                var len_3 = this.ribbon.items[this.ribbon.selectedTab].content.length;\n                var j = void 0;\n                for (j = 0; j < len_3; j++) {\n                    if (this.ribbon.items[this.ribbon.selectedTab].content[j].id === this.parent.element.id + '_protect') {\n                        break;\n                    }\n                }\n                text = this.getLocaleProtectText('Sheet', true);\n            }\n            else if (id === this.parent.element.id + '_protectworkbook') {\n                var len_4 = this.ribbon.items[this.ribbon.selectedTab].content.length;\n                var j = void 0;\n                for (j = 0; j < len_4; j++) {\n                    if (this.ribbon.items[this.ribbon.selectedTab].content[j].id === this.parent.element.id + '_protectworkbook') {\n                        break;\n                    }\n                }\n                if (this.parent.isProtected || this.parent.password.length > 0) {\n                    text = this.getLocaleProtectWorkbook('UnProtectWorkbook');\n                }\n                else if (!this.parent.isProtected) {\n                    text = this.getLocaleProtectWorkbook('ProtectWorkbook');\n                }\n            }\n            var len = this.ribbon.items[args.activeTab].content.length;\n            for (var i = void 0; i < len; i++) {\n                if (this.ribbon.items[args.activeTab].content[i].type === 'Separator') {\n                    continue;\n                }\n                if (this.ribbon.items[args.activeTab].content[i].id === id) {\n                    this.ribbon.items[args.activeTab].content[i].text = text;\n                    this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n                }\n            }\n            if (this.ribbon.items[this.ribbon.selectedTab].header.text === datatabHeader) {\n                this.updateToggleText(args.props.toLowerCase(), text);\n            }\n        }\n    };\n    Ribbon.prototype.enableFileMenuItems = function (args) {\n        this.ribbon.enableMenuItems(args.items, args.enable, args.isUniqueId);\n    };\n    Ribbon.prototype.hideRibbonTabs = function (args) {\n        this.ribbon.hideTabs(args.tabs, args.hide);\n    };\n    Ribbon.prototype.addRibbonTabs = function (args) {\n        this.ribbon.addTabs(args.items, args.insertBefore);\n        var nextTab = select('.e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab).e-hide', this.parent.element);\n        if (nextTab) {\n            this.parent.updateActiveBorder(selectAll('.e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab)', this.parent.element)[this.ribbon.selectedTab]);\n        }\n    };\n    Ribbon.prototype.updateToggleText = function (item, text) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var ele = select(\"#\" + _this.parent.element.id + \"_\" + item + \" .e-tbar-btn-text\", _this.ribbon.element);\n            if (ele) {\n                ele.textContent = text;\n            }\n        });\n        if (item === 'headers' && this.findDialog) {\n            this.findDialog.position.Y = this.parent.getActiveSheet().showHeaders ? 31 : 0;\n            this.findDialog.dataBind();\n        }\n    };\n    Ribbon.prototype.refreshViewTabContent = function (activeTab) {\n        var id = this.parent.element.id;\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        for (var i = 0; i < this.ribbon.items[activeTab].content.length; i++) {\n            if (this.ribbon.items[activeTab].content[i].type === 'Separator') {\n                continue;\n            }\n            if (this.ribbon.items[activeTab].content[i].id === id + \"_headers\") {\n                this.updateViewTabContent(activeTab, 'Headers', i);\n            }\n            if (this.ribbon.items[activeTab].content[i].id === id + \"_gridlines\") {\n                this.updateViewTabContent(activeTab, 'GridLines', i);\n            }\n            if (this.ribbon.items[activeTab].content[i].id === (id + \"_freezepanes\")) {\n                if (sheet.frozenRows || sheet.frozenColumns) {\n                    if (this.ribbon.items[activeTab].content[i].text === l10n.getConstant('FreezePanes')) {\n                        this.updateToggleText('freezepanes', this.updateRibbonItemText('Unfreeze', 'Panes', i, activeTab));\n                    }\n                }\n                else {\n                    if (this.ribbon.items[activeTab].content[i].text === l10n.getConstant('UnfreezePanes')) {\n                        this.updateToggleText('freezepanes', this.updateRibbonItemText('Freeze', 'Panes', i, activeTab));\n                    }\n                }\n            }\n            if (this.ribbon.items[activeTab].content[i].id === (id + \"_freezerows\")) {\n                if (sheet.frozenRows) {\n                    if (this.ribbon.items[activeTab].content[i].text === l10n.getConstant('FreezeRows')) {\n                        this.updateToggleText('freezerows', this.updateRibbonItemText('Unfreeze', 'Rows', i, activeTab));\n                    }\n                }\n                else {\n                    if (this.ribbon.items[activeTab].content[i].text === l10n.getConstant('UnfreezeRows')) {\n                        this.updateToggleText('freezerows', this.updateRibbonItemText('Freeze', 'Rows', i, activeTab));\n                    }\n                }\n            }\n            if (this.ribbon.items[activeTab].content[i].id === (id + \"_freezecolumns\")) {\n                if (sheet.frozenColumns) {\n                    if (this.ribbon.items[activeTab].content[i].text === l10n.getConstant('FreezeColumns')) {\n                        this.updateToggleText('freezecolumns', this.updateRibbonItemText('Unfreeze', 'Columns', i, activeTab));\n                    }\n                }\n                else {\n                    if (this.ribbon.items[activeTab].content[i].text === l10n.getConstant('UnfreezeColumns')) {\n                        this.updateToggleText('freezecolumns', this.updateRibbonItemText('Freeze', 'Columns', i, activeTab));\n                    }\n                }\n            }\n        }\n    };\n    Ribbon.prototype.updateViewTabContent = function (activeTab, item, idx) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (sheet['show' + item]) {\n            if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Show' + item)) {\n                this.updateToggleText(item.toLowerCase(), this.updateRibbonItemText('Hide', item, idx, activeTab));\n            }\n        }\n        else {\n            if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Hide' + item)) {\n                this.updateToggleText(item.toLowerCase(), this.updateRibbonItemText('Show', item, idx, activeTab));\n            }\n        }\n    };\n    Ribbon.prototype.updateRibbonItemText = function (showHideText, item, idx, activeTab) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var text = l10n.getConstant(showHideText + item);\n        this.ribbon.items[activeTab].content[idx].text = text;\n        this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n        return text;\n    };\n    Ribbon.prototype.refreshDataTabContent = function (activeTab) {\n        var id = this.parent.element.id;\n        var updated;\n        for (var j = 0; j < this.ribbon.items[activeTab].content.length; j++) {\n            if (this.ribbon.items[activeTab].content[j].type === 'Separator') {\n                continue;\n            }\n            if (this.ribbon.items[activeTab].content[j].id === id + \"_protect\") {\n                this.updateDataTabContent(activeTab, 'Sheet', j);\n                if (updated) {\n                    break;\n                }\n                updated = true;\n            }\n            if (this.ribbon.items[activeTab].content[j].id === id + \"_protectworkbook\") {\n                this.updateDataTabContent(activeTab, 'Workbook', j);\n            }\n        }\n    };\n    Ribbon.prototype.updateDataTabContent = function (activeTab, item, idx) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (item === 'Sheet') {\n            if (sheet.isProtected) {\n                if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Protect' + item)) {\n                    this.ribbon.items[activeTab].content[idx].cssClass = 'e-active';\n                    this.updateProtectBtn('Unprotect', item, idx, activeTab);\n                }\n            }\n            else {\n                this.updateProtectBtn('Protect', item, idx, activeTab);\n            }\n        }\n        else if (item === 'Workbook') {\n            var l10n_1 = this.parent.serviceLocator.getService(locale);\n            if (this.parent.isProtected) {\n                if (this.ribbon.items[activeTab].content[idx].text === l10n_1.getConstant('Protect' + item)) {\n                    this.updateToggleText('protectworkbook', this.updateRibbonItemText('UnProtect', item, idx, activeTab));\n                }\n            }\n            else {\n                if (this.ribbon.items[activeTab].content[idx].text === l10n_1.getConstant('UnProtect' + item)) {\n                    this.updateToggleText('protectworkbook', this.updateRibbonItemText('Protect', item, idx, activeTab));\n                }\n            }\n        }\n    };\n    Ribbon.prototype.updateProtectBtn = function (protectText, item, idx, activeTab) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var text = l10n.getConstant(protectText + item);\n        this.ribbon.items[activeTab].content[idx].text = text;\n        this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n        this.updateToggleText('protect', text);\n    };\n    Ribbon.prototype.updateProtectWorkbookBtn = function (protectText, item, idx, activeTab) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var text = l10n.getConstant(protectText);\n        this.ribbon.items[activeTab].content[idx].text = text;\n        this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n        this.updateToggleText('protectworkbook', text);\n    };\n    Ribbon.prototype.addToolbarItems = function (args) {\n        this.ribbon.addToolbarItems(args.tab, args.items, args.index);\n    };\n    Ribbon.prototype.enableToolbarItems = function (args) {\n        var _this = this;\n        args.forEach(function (arg) {\n            _this.ribbon.enableItems(arg.tab || _this.ribbon.items[_this.ribbon.selectedTab].header.text, arg.items, arg.enable);\n        });\n    };\n    Ribbon.prototype.createMobileView = function () {\n        var _this = this;\n        var parentId = this.parent.element.id;\n        var toobar = this.parent.createElement('div', { className: 'e-header-toolbar' });\n        var menu = this.parent.createElement('ul');\n        toobar.appendChild(menu);\n        var toolbarObj = new Toolbar({\n            items: [\n                { prefixIcon: 'e-tick-icon', align: 'Left', id: parentId + 'focused_tick', cssClass: 'e-focused-tick' },\n                { template: menu, align: 'Right', id: parentId + 'file_menu' }\n            ],\n            clicked: function (args) {\n                switch (args.item.id) {\n                    case parentId + 'focused_tick':\n                        _this.parent.element.classList.remove('e-mobile-focused');\n                        _this.parent.renderModule.setSheetPanelSize();\n                        break;\n                }\n            },\n            created: function () {\n                var menuObj = new Menu({\n                    cssClass: 'e-mobile e-file-menu',\n                    enableRtl: true,\n                    showItemOnClick: true,\n                    items: _this.getRibbonMenuItems(),\n                    select: _this.fileMenuItemSelect.bind(_this),\n                    beforeOpen: function (args) {\n                        args.element.parentElement.classList.remove('e-rtl');\n                        _this.fileMenuBeforeOpen(args);\n                    },\n                    beforeClose: _this.fileMenuBeforeClose.bind(_this)\n                });\n                menuObj.createElement = _this.parent.createElement;\n                menuObj.appendTo(menu);\n            }\n        });\n        toolbarObj.createElement = this.parent.createElement;\n        toolbarObj.appendTo(toobar);\n        this.parent.element.insertBefore(toobar, this.parent.element.firstElementChild);\n        this.renderMobileToolbar();\n    };\n    Ribbon.prototype.renderMobileToolbar = function () {\n        var _this = this;\n        var toolbarPanel = this.parent.createElement('div', { className: 'e-toolbar-panel e-ribbon' });\n        var toolbar = this.parent.createElement('div');\n        var ddb = this.parent.createElement('button');\n        toolbarPanel.appendChild(toolbar);\n        toolbarPanel.appendChild(ddb);\n        toolbarPanel.style.display = 'block';\n        this.parent.element.appendChild(toolbarPanel);\n        var ddbObj = new DropDownButton({\n            cssClass: 'e-caret-hide',\n            content: this.ribbon.items[0].header.text,\n            items: [\n                { text: this.ribbon.items[0].header.text },\n                { text: this.ribbon.items[1].header.text },\n                { text: this.ribbon.items[2].header.text },\n                { text: this.ribbon.items[3].header.text }\n            ],\n            select: function (args) {\n                if (args.item.text !== ddbObj.content) {\n                    toolbarObj.element.style.display = 'none';\n                    ddbObj.content = args.item.text;\n                    ddbObj.dataBind();\n                    toolbarObj.items = _this.ribbon.items[ddbObj.items.indexOf(args.item) + 1].content;\n                    toolbarObj.width = \"calc(100% - \" + ddb.getBoundingClientRect().width + \"px)\";\n                    toolbarObj.element.style.display = '';\n                    toolbarObj.dataBind();\n                    toolbarObj.items[0].text = args.item.text;\n                    toolbarObj.dataBind();\n                }\n            },\n            open: function (args) {\n                var element = args.element.parentElement;\n                var clientRect = element.getBoundingClientRect();\n                var offset = calculatePosition(ddbObj.element, 'right', 'bottom');\n                element.style.left = offset.left - clientRect.width + \"px\";\n                element.style.top = offset.top - clientRect.height + \"px\";\n                for (var i = 0; i < ddbObj.items.length; i++) {\n                    if (ddbObj.content === ddbObj.items[i].text) {\n                        args.element.children[i].classList.add('e-selected');\n                        break;\n                    }\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        ddbObj.createElement = this.parent.createElement;\n        ddbObj.appendTo(ddb);\n        var toolbarObj = new Toolbar({\n            width: \"calc(100% - \" + ddb.getBoundingClientRect().width + \"px)\",\n            items: this.ribbon.items[0].content,\n            clicked: this.toolbarClicked.bind(this)\n        });\n        toolbarObj.createElement = this.parent.createElement;\n        toolbarObj.appendTo(toolbar);\n        toolbarPanel.style.display = '';\n    };\n    Ribbon.prototype.fileMenuBeforeOpen = function (args) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var wrapper;\n        var contents = ['.xlsx', '.xls', '.csv', '.pdf'];\n        if (args.parentItem.text === l10n.getConstant('SaveAs')) {\n            [].slice.call(args.element.children).forEach(function (li, index) {\n                wrapper = _this.parent.createElement('div', { innerHTML: li.innerHTML });\n                li.innerHTML = '';\n                wrapper.appendChild(_this.parent.createElement('span', { className: 'e-extension', innerHTML: contents[index] }));\n                li.appendChild(wrapper);\n            });\n        }\n        this.parent.trigger('fileMenuBeforeOpen', args);\n    };\n    Ribbon.prototype.enableRibbonTabs = function (args) {\n        this.ribbon.enableTabs(args.tabs, args.enable);\n    };\n    Ribbon.prototype.fileMenuBeforeClose = function (args) {\n        this.parent.trigger('fileMenuBeforeClose', args);\n    };\n    Ribbon.prototype.hideFileMenuItems = function (args) {\n        this.ribbon.hideMenuItems(args.items, args.hide, args.isUniqueId);\n    };\n    Ribbon.prototype.addFileMenuItems = function (args) {\n        this.ribbon.addMenuItems(args.items, args.text, args.insertAfter, args.isUniqueId);\n    };\n    Ribbon.prototype.hideToolbarItems = function (args) {\n        this.ribbon.hideToolbarItems(args.tab, args.indexes, args.hide);\n    };\n    Ribbon.prototype.protectSheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if ((sheet.isProtected && sheet.protectSettings.formatCells) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.enableHomeBtnId, enable: true }]);\n            this.parent.notify(setUndoRedo, null);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.disableHomeBtnId, enable: false }]);\n        }\n        if ((sheet.isProtected && sheet.protectSettings.insertLink) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.enableInsertBtnId, enable: true }]);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.enableInsertBtnId, enable: false }]);\n        }\n        if ((sheet.isProtected && sheet.protectSettings.selectCells) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.findBtnId, enable: true }]);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.findBtnId, enable: false }]);\n        }\n        var len = this.ribbon.items[this.ribbon.selectedTab].content.length;\n        var i;\n        for (i = 0; i < len; i++) {\n            if (this.ribbon.items[this.ribbon.selectedTab].content[i].id === this.parent.element.id + '_protectworkbook') {\n                break;\n            }\n        }\n        if (sheet.isProtected) {\n            if (this.parent.isProtected && this.parent.element.querySelector('#' + this.parent.element.id + '_protectworkbook') &&\n                this.parent.element.querySelector('#' + this.parent.element.id + '_protectworkbook')\n                    .querySelector('.e-tbar-btn-text').textContent === l10n.getConstant('UnProtectWorkbook')) {\n                if (this.ribbon.items[this.ribbon.selectedTab].header.text === l10n.getConstant('Data')) {\n                    this.ribbon.items[this.ribbon.selectedTab].content[i].text = l10n.getConstant('UnProtectWorkbook');\n                }\n            }\n            else {\n                if (this.ribbon.items[this.ribbon.selectedTab].header.text === l10n.getConstant('Data')) {\n                    this.ribbon.items[this.ribbon.selectedTab].content[i].text = l10n.getConstant('ProtectWorkbook');\n                }\n            }\n            this.enableToolbarItems([{ tab: l10n.getConstant('Data'), items: args.dataValidationBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Formulas'), items: args.enableFrmlaBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.imageBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.chartBtnId, enable: false }]);\n        }\n        else {\n            if (this.parent.isProtected && this.parent.element.querySelector('#' + this.parent.element.id + '_protectworkbook') &&\n                this.parent.element.querySelector('#' + this.parent.element.id + '_protectworkbook')\n                    .querySelector('.e-tbar-btn-text').textContent === l10n.getConstant('UnProtectWorkbook')) {\n                if (this.ribbon.items[this.ribbon.selectedTab].header.text === l10n.getConstant('Data')) {\n                    this.ribbon.items[this.ribbon.selectedTab].content[i].text = l10n.getConstant('UnProtectWorkbook');\n                }\n            }\n            else {\n                if (this.ribbon.items[this.ribbon.selectedTab].header.text === l10n.getConstant('Data')) {\n                    this.ribbon.items[this.ribbon.selectedTab].content[i].text = l10n.getConstant('ProtectWorkbook');\n                }\n            }\n            this.enableToolbarItems([{ tab: l10n.getConstant('Data'), items: args.dataValidationBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Formulas'), items: args.enableFrmlaBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.imageBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.chartBtnId, enable: true }]);\n        }\n    };\n    Ribbon.prototype.updateMergeItem = function (e) {\n        if (e.type === 'mousemove' || e.type === 'pointermove' || (e.shiftKey && e.type === 'mousedown')) {\n            var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n            if ((indexes[1] !== indexes[3] || indexes[0] !== indexes[2]) && !this.parent.getActiveSheet().isProtected) {\n                this.enableToolbarItems([{ tab: this.parent.serviceLocator.getService(locale).getConstant('Home'),\n                        items: [this.parent.element.id + \"_merge_cells\"], enable: true }]);\n                this.toggleActiveState(false);\n            }\n        }\n    };\n    Ribbon.prototype.addEventListener = function () {\n        this.parent.on(ribbon, this.initRibbon, this);\n        this.parent.on(enableToolbarItems, this.enableToolbarItems, this);\n        this.parent.on(activeCellChanged, this.refreshRibbonContent, this);\n        this.parent.on(updateToggleItem, this.toggleRibbonItems, this);\n        this.parent.on(enableFileMenuItems, this.enableFileMenuItems, this);\n        this.parent.on(hideRibbonTabs, this.hideRibbonTabs, this);\n        this.parent.on(addRibbonTabs, this.addRibbonTabs, this);\n        this.parent.on(addToolbarItems, this.addToolbarItems, this);\n        this.parent.on(hideFileMenuItems, this.hideFileMenuItems, this);\n        this.parent.on(addFileMenuItems, this.addFileMenuItems, this);\n        this.parent.on(hideToolbarItems, this.hideToolbarItems, this);\n        this.parent.on(enableRibbonTabs, this.enableRibbonTabs, this);\n        this.parent.on(protectCellFormat, this.protectSheetHandler, this);\n        this.parent.on(selectionComplete, this.updateMergeItem, this);\n        this.parent.on(refreshRibbonIcons, this.refreshRibbonContent, this);\n        this.parent.on(insertDesignChart, this.insertDesignChart, this);\n        this.parent.on(removeDesignChart, this.removeDesignChart, this);\n        this.parent.on(ribbonFind, this.findToolDlg, this);\n    };\n    Ribbon.prototype.destroy = function () {\n        var parentElem = this.parent.element;\n        var ribbonEle = this.ribbon.element;\n        var cPickerEle = this.cPickerEle;\n        var id = parentElem.id;\n        ['bold', 'italic', 'line-through', 'underline'].forEach(function (name) {\n            destroyComponent(select('#' + (id + \"_\" + name), parentElem), Button);\n        });\n        this.pasteSplitBtn.destroy();\n        this.pasteSplitBtn = null;\n        this.mergeSplitBtn.destroy();\n        this.mergeSplitBtn = null;\n        this.numFormatDDB.destroy();\n        this.numFormatDDB = null;\n        this.fontSizeDdb.destroy();\n        this.fontSizeDdb = null;\n        this.fontNameDdb.destroy();\n        this.fontNameDdb = null;\n        this.textAlignDdb.destroy();\n        this.textAlignDdb = null;\n        this.verticalAlignDdb.destroy();\n        this.verticalAlignDdb = null;\n        this.sortingDdb.destroy();\n        this.sortingDdb = null;\n        this.clearDdb.destroy();\n        this.clearDdb = null;\n        this.colorPicker.destroy();\n        this.colorPicker = null;\n        this.bordersMenu.destroy();\n        this.bordersMenu = null;\n        this.bordersDdb.destroy();\n        this.bordersDdb = null;\n        this.findDdb.destroy();\n        this.findDdb = null;\n        this.chartDdb.destroy();\n        this.chartDdb = null;\n        this.chartMenu.destroy();\n        this.chartMenu = null;\n        this.cFDdb.destroy();\n        this.cFDdb = null;\n        this.parent.notify('destroyRibbonComponents', null);\n        this.ribbon.destroy();\n        if (ribbonEle) {\n            detach(ribbonEle);\n        }\n        this.ribbon = null;\n        if (cPickerEle) {\n            detach(cPickerEle);\n        }\n        this.cPickerEle = null;\n        if (this.findDialog) {\n            this.findDialog.destroy();\n        }\n        this.removeEventListener();\n    };\n    Ribbon.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(ribbon, this.initRibbon);\n            this.parent.off(enableToolbarItems, this.enableToolbarItems);\n            this.parent.off(activeCellChanged, this.refreshRibbonContent);\n            this.parent.off(updateToggleItem, this.toggleRibbonItems);\n            this.parent.off(enableFileMenuItems, this.enableFileMenuItems);\n            this.parent.off(hideRibbonTabs, this.hideRibbonTabs);\n            this.parent.off(addRibbonTabs, this.addRibbonTabs);\n            this.parent.off(addToolbarItems, this.addToolbarItems);\n            this.parent.off(hideFileMenuItems, this.hideFileMenuItems);\n            this.parent.off(addFileMenuItems, this.addFileMenuItems);\n            this.parent.off(hideToolbarItems, this.hideToolbarItems);\n            this.parent.off(enableRibbonTabs, this.enableRibbonTabs);\n            this.parent.off(protectCellFormat, this.protectSheetHandler);\n            this.parent.off(selectionComplete, this.updateMergeItem);\n            this.parent.off(refreshRibbonIcons, this.refreshRibbonContent);\n            this.parent.off(insertDesignChart, this.insertDesignChart);\n            this.parent.off(removeDesignChart, this.removeDesignChart);\n            this.parent.on(ribbonFind, this.findToolDlg, this);\n        }\n    };\n    return Ribbon;\n}());\nexport { Ribbon };\n","import { formulaBar, locale, selectionComplete, enableFormulaInput, focus } from '../common/index';\nimport { mouseUpAfterSelection, click } from '../common/index';\nimport { getRangeIndexes, getRangeFromAddress, getCellAddress, getCellIndexes } from './../../workbook/common/address';\nimport { getSheetName, getTypeFromFormat, getSheet, checkIsFormula, getCell } from '../../workbook/index';\nimport { updateSelectedRange, getSheetNameFromAddress, getSheetIndex, isLocked, getColumn } from '../../workbook/index';\nimport { ComboBox, DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { rippleEffect, EventHandler, detach, Internationalization, isNullOrUndefined, closest, select } from '@syncfusion/ej2-base';\nimport { isUndefined } from '@syncfusion/ej2-base';\nimport { editOperation, formulaBarOperation, keyDown, keyUp, formulaOperation, editAlert, editValue } from '../common/event';\nimport { intToDate } from '../../workbook/common/math';\nimport { ListView } from '@syncfusion/ej2-lists';\nimport { workbookFormulaOperation } from '../../workbook/common/event';\nimport { isFormulaBarEdit } from '../common/event';\n/**\n * Represents Formula bar for Spreadsheet.\n */\nvar FormulaBar = /** @class */ (function () {\n    function FormulaBar(parent) {\n        this.categoryCollection = [];\n        this.formulaCollection = [];\n        this.isGoto = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FormulaBar.prototype.getModuleName = function () {\n        return 'formulaBar';\n    };\n    FormulaBar.prototype.createFormulaBar = function (args) {\n        if (!this.parent.showFormulaBar && this.insertFnRipple) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var id = this.parent.element.id;\n        var fBarWrapper = this.parent.createElement('div', { className: 'e-formula-bar-panel' });\n        if (!this.parent.isMobileView()) {\n            var nameBox = this.parent.createElement('input', { id: id + '_name_box', attrs: { type: 'text' } });\n            fBarWrapper.appendChild(nameBox);\n            this.comboBoxInstance = new ComboBox({\n                value: 'A1',\n                cssClass: 'e-name-box',\n                width: '',\n                noRecordsTemplate: '',\n                fields: { text: 'name', value: 'refersTo' },\n                beforeOpen: this.nameBoxBeforeOpen.bind(this),\n                blur: this.nameBoxBlur.bind(this),\n                select: this.nameBoxSelect.bind(this),\n                change: function () {\n                    /** */\n                }\n            });\n            this.comboBoxInstance.createElement = this.parent.createElement;\n            this.comboBoxInstance.appendTo(nameBox);\n            this.comboBoxInstance.element.parentElement.title = l10n.getConstant('NameBox');\n        }\n        var insertFnBtn = fBarWrapper.appendChild(this.parent.createElement('button', {\n            className: 'e-btn e-css e-flat e-icon-btn e-insert-function', attrs: { 'title': l10n.getConstant('InsertFunction') }\n        }));\n        insertFnBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons' }));\n        this.insertFnRipple = rippleEffect(fBarWrapper, { selector: '.e-insert-function' });\n        fBarWrapper.appendChild(this.parent.createElement('div', { className: 'e-separator' }));\n        var textarea = fBarWrapper.appendChild(this.parent.createElement('textarea', {\n            className: 'e-formula-bar e-css', id: id + '_formula_input',\n            attrs: { 'title': l10n.getConstant('FormulaBar'), 'spellcheck': 'false' }\n        }));\n        textarea.rows = 1;\n        if (this.parent.isMobileView()) {\n            textarea.placeholder = l10n.getConstant('MobileFormulaBarPlaceHolder');\n            EventHandler.add(textarea, 'focus', this.textAreaFocusIn, this);\n            EventHandler.add(textarea, 'blur', this.textAreaFocusOut, this);\n        }\n        else {\n            fBarWrapper.appendChild(this.parent.createElement('span', {\n                className: 'e-drop-icon e-icons', attrs: { 'title': l10n.getConstant('ExpandFormulaBar') }\n            }));\n        }\n        if (args && args.uiUpdate) {\n            this.parent.element.insertBefore(fBarWrapper, document.getElementById(id + '_sheet_panel'));\n        }\n        else {\n            this.parent.element.appendChild(fBarWrapper);\n        }\n    };\n    FormulaBar.prototype.textAreaFocusIn = function () {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        var tickBtn = this.parent.createElement('button', { className: 'e-btn e-css e-flat e-icon-btn e-formula-submit' });\n        tickBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-tick-icon' }));\n        formulaPanel.classList.add('e-focused');\n        formulaPanel.appendChild(tickBtn);\n    };\n    FormulaBar.prototype.textAreaFocusOut = function () {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        formulaPanel.classList.remove('e-focused');\n        detach(formulaPanel.querySelector('.e-formula-submit'));\n    };\n    FormulaBar.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        if (this.parent.isEdit && !this.parent.getActiveSheet().isProtected) {\n            if ((checkIsFormula(trgtElem.value) || (trgtElem.validity && trgtElem.value.toString().indexOf('=') === 0)) &&\n                e.keyCode === 16) {\n                return;\n            }\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                this.parent.notify(editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n            }\n        }\n    };\n    FormulaBar.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                var eventArg = { action: 'getCurrentEditValue', editedValue: '' };\n                this.parent.notify(editOperation, eventArg);\n                if (eventArg.editedValue !== trgtElem.value && e.keyCode !== 16) {\n                    this.parent.notify(editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n                }\n            }\n        }\n    };\n    FormulaBar.prototype.nameBoxBeforeOpen = function (args) {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            args.cancel = true;\n        }\n        else {\n            this.comboBoxInstance.element.select();\n        }\n    };\n    FormulaBar.prototype.nameBoxBlur = function () {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            this.comboBoxInstance.element.classList.remove('e-name-editing');\n            this.UpdateValueAfterMouseUp();\n        }\n    };\n    FormulaBar.prototype.nameBoxSelect = function (args) {\n        if (args.isInteracted) {\n            var refersTo = args.itemData.refersTo.substr(1);\n            var sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(refersTo));\n            var range = getRangeFromAddress(refersTo);\n            var sheet = getSheet(this.parent, sheetIdx);\n            if (range.indexOf(':') !== -1) {\n                var colIndex = range.indexOf(':');\n                var left = range.substr(0, colIndex);\n                var right = range.substr(colIndex + 1, range.length);\n                left = left.replace('$', '');\n                right = right.replace('$', '');\n                if (right.match(/\\D/g) && !right.match(/[0-9]/g) && left.match(/\\D/g) && !left.match(/[0-9]/g)) {\n                    left = left + '1';\n                    right = right + sheet.rowCount;\n                    range = left + ':' + right;\n                }\n                else if (!right.match(/\\D/g) && right.match(/[0-9]/g) && !left.match(/\\D/g) && left.match(/[0-9]/g)) {\n                    left = getCellAddress(parseInt(left, 10) - 1, 0);\n                    right = getCellAddress(parseInt(right, 10) - 1, sheet.colCount - 1);\n                    range = left + ':' + right;\n                }\n            }\n            if ((sheetIdx) === this.parent.activeSheetIndex) {\n                this.parent.selectRange(range);\n                focus(this.parent.element);\n            }\n            else {\n                updateSelectedRange(this.parent, range, sheet);\n                this.parent.activeSheetIndex = sheetIdx;\n            }\n        }\n    };\n    FormulaBar.prototype.formulaBarUpdateHandler = function (e) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var range = sheet.selectedRange.split(':');\n        var address;\n        var editArgs = { action: 'getElement', element: null };\n        this.parent.notify(editOperation, editArgs);\n        var formulaBar = this.parent.element.querySelector('.e-formula-bar');\n        var intl = new Internationalization();\n        if (e.type === 'mousemove' || e.type === 'pointermove') {\n            var indexes1 = getRangeIndexes(range[0]);\n            var indexes2 = getRangeIndexes(range[1]);\n            address = Math.abs(indexes1[0] - indexes2[0]) + 1 + \"R x \" + (Math.abs(indexes1[1] - indexes2[1]) + 1) + \"C\";\n            if (this.parent.isEdit) {\n                if (e.target && !e.target.classList.contains('e-spreadsheet-edit')) {\n                    this.parent.notify(editValue, null);\n                }\n                else if (editArgs.element) {\n                    formulaBar.value = editArgs.element.textContent;\n                }\n            }\n        }\n        else {\n            address = range[0];\n            var data = this.parent.getData(getSheetName(this.parent) + \"!\" + address);\n            data.then(function (values) {\n                var value = '';\n                var intDate;\n                values.forEach(function (cell) {\n                    var type = cell && cell.format ? getTypeFromFormat(cell.format) : 'General';\n                    if (cell) {\n                        if (!isNullOrUndefined(cell.value)) {\n                            intDate = intToDate(Number(cell.value));\n                            if (intDate.toString() !== 'Invalid Date' && (type === 'ShortDate' || type === 'LongDate')) {\n                                value = intl.formatDate(intDate, {\n                                    type: 'date',\n                                    skeleton: 'yMd'\n                                });\n                            }\n                            else if (intDate.toString() !== 'Invalid Date' && type === 'Time') {\n                                value = intl.formatDate(intDate, {\n                                    type: 'dateTime',\n                                    skeleton: 'yMd'\n                                }) + ' ' + intl.formatDate(intDate, {\n                                    type: 'dateTime',\n                                    skeleton: 'hms'\n                                });\n                            }\n                            else {\n                                value = cell.value;\n                            }\n                        }\n                        if (cell.formula) {\n                            value = cell.formula;\n                        }\n                    }\n                    var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n                    _this.parent.notify(editOperation, eventArgs);\n                    var isFormulaEdit = (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0) ||\n                        checkIsFormula(eventArgs.editedValue);\n                    var formulaInp = document.getElementById(_this.parent.element.id + '_formula_input');\n                    var addressRange = getRangeIndexes(address);\n                    var cellEle = _this.parent.getCell(addressRange[0], addressRange[1]);\n                    if (cell && !cell.formula && cellEle && (!cell.validation || cell.validation.type !== 'List')) {\n                        formulaInp.value = cellEle.textContent;\n                    }\n                    else {\n                        formulaInp.value = value;\n                    }\n                    if (!isNullOrUndefined(value) && !isFormulaEdit) {\n                        _this.parent.notify(editOperation, { action: 'refreshEditor', value: formulaInp.value, refreshEditorElem: true });\n                    }\n                    if (_this.parent.isEdit) {\n                        if (e.target && !e.target.classList.contains('e-spreadsheet-edit')) {\n                            _this.parent.notify(editValue, null);\n                        }\n                        else if (editArgs.element) {\n                            formulaBar.value = editArgs.element.textContent;\n                        }\n                    }\n                });\n            });\n        }\n        this.updateComboBoxValue(address);\n    };\n    FormulaBar.prototype.UpdateValueAfterMouseUp = function () {\n        this.updateComboBoxValue(this.parent.getActiveSheet().selectedRange.split(':')[0]);\n    };\n    FormulaBar.prototype.updateComboBoxValue = function (value) {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSheetName(this.parent) + '!' + sheet.selectedRange;\n        var eventArgs = {\n            action: 'getNameFromRange', range: range, definedName: null\n        };\n        this.parent.notify(formulaOperation, eventArgs);\n        if (eventArgs.definedName) {\n            value = eventArgs.definedName.name;\n        }\n        if (!this.parent.isMobileView()) {\n            if (this.comboBoxInstance.text === value) {\n                return;\n            }\n            this.comboBoxInstance.text = value;\n            this.comboBoxInstance.dataBind();\n        }\n    };\n    FormulaBar.prototype.disabletextarea = function () {\n        var element = this.getFormulaBar();\n        if (this.parent.getActiveSheet().isProtected) {\n            element.disabled = true;\n        }\n        else {\n            element.disabled = false;\n        }\n    };\n    FormulaBar.prototype.formulaBarScrollEdit = function () {\n        var index = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var viewportIndexes = getCellIndexes(this.parent.getActiveSheet().topLeftCell);\n        if (index[0] < viewportIndexes[0]) {\n            this.parent.goTo(this.parent.getActiveSheet().selectedRange);\n            this.isGoto = true;\n        }\n        this.parent.notify(editOperation, { action: 'startEdit', refreshCurPos: false });\n    };\n    FormulaBar.prototype.formulaBarClickHandler = function (e) {\n        var _this = this;\n        var target = e.target;\n        var sheet = this.parent.getActiveSheet();\n        var isSheetProtected = sheet.isProtected;\n        var range = getCellIndexes(sheet.activeCell);\n        var cell = getCell(range[0], range[1], sheet);\n        var isCellLocked = isLocked(cell, getColumn(sheet, range[1]));\n        if (target.classList.contains('e-drop-icon') && closest(target, '.e-formula-bar-panel')) {\n            this.toggleFormulaBar(target);\n        }\n        else if (target.classList.contains('e-formula-bar')) {\n            if (!this.parent.isEdit && (!isSheetProtected || (isSheetProtected && !isCellLocked))) {\n                this.formulaBarScrollEdit();\n            }\n            else if (isSheetProtected && isCellLocked) {\n                this.parent.notify(editAlert, null);\n            }\n        }\n        else if (target.parentElement && target.parentElement.classList.contains('e-name-box')) {\n            if (target.classList.contains('e-ddl-icon')) {\n                var eventArgs = { action: 'getNames', names: [] };\n                this.parent.notify(formulaOperation, eventArgs);\n                this.comboBoxInstance.dataSource = eventArgs.names;\n            }\n            else {\n                this.comboBoxInstance.element.classList.add('e-name-editing');\n                this.comboBoxInstance.element.select();\n            }\n        }\n        if (!isNullOrUndefined(target.offsetParent) && ((target.offsetParent.classList.contains('e-insert-function')) ||\n            (target.classList.contains('e-insert-function')) || (this.parent.element.id + '_insert_function' === target.offsetParent.id)\n            || (this.parent.element.id + '_insert_function' === target.id) ||\n            target.parentElement.classList.contains('e-insert-function')\n            || (this.parent.element.id + '_insert_function' === target.parentElement.id))) {\n            if (isSheetProtected) {\n                this.parent.notify(editAlert, null);\n                return;\n            }\n            var isOpen = !this.parent.isEdit;\n            var args = { action: 'getCurrentEditValue', editedValue: '' };\n            if (!isOpen) {\n                var eventArgs = { action: 'isFormulaEditing', isFormulaEdit: false };\n                this.parent.notify(formulaOperation, eventArgs);\n                isOpen = eventArgs.isFormulaEdit;\n                this.parent.notify(editOperation, args);\n            }\n            if (isOpen || args.editedValue === '') {\n                if (args.editedValue === '') {\n                    this.parent.notify(editOperation, { action: 'refreshEditor', value: '=' });\n                }\n                var l10n = this.parent.serviceLocator.getService(locale);\n                var formulaDescription = this.parent.createElement('div', { className: 'e-formula-description', id: this.parent.element.id + '_description_content' });\n                var categoryContent = this.parent.createElement('div', {\n                    className: 'e-category-content', id: this.parent.element.id + '_category_content',\n                    innerHTML: l10n.getConstant('PickACategory')\n                });\n                var dropDownElement = this.parent.createElement('input', { className: 'e-formula-category', id: this.parent.element.id + '_formula_category' });\n                var listViewElement = this.parent.createElement('div', { className: 'e-formula-list', id: this.parent.element.id + '_formula_list' });\n                var descriptionContent = this.parent.createElement('div', { className: 'e-description-content', innerHTML: l10n.getConstant('Description') });\n                var headerContent = this.parent.createElement('div', { className: 'e-header-content', innerHTML: l10n.getConstant('InsertFunction') });\n                var categoryArgs = {\n                    action: 'getFormulaCategory', categoryCollection: []\n                };\n                this.parent.notify(workbookFormulaOperation, categoryArgs);\n                this.categoryCollection = categoryArgs.categoryCollection;\n                this.categoryList = new DropDownList({\n                    dataSource: this.categoryCollection, index: 0, width: '285px', popupHeight: '210px',\n                    select: this.dropDownSelect.bind(this)\n                });\n                var listArgs = {\n                    action: 'getLibraryFormulas', formulaCollection: []\n                };\n                this.parent.notify(workbookFormulaOperation, listArgs);\n                this.formulaCollection = listArgs.formulaCollection;\n                this.formulaList = new ListView({\n                    dataSource: this.formulaCollection.sort(),\n                    actionComplete: this.updateFormulaList.bind(this),\n                    select: this.listSelected.bind(this), width: '285px', height: '200px'\n                });\n                this.dialog = this.parent.serviceLocator.getService('dialog');\n                this.dialog.show({\n                    header: headerContent.outerHTML,\n                    content: categoryContent.outerHTML + dropDownElement.outerHTML + listViewElement.outerHTML +\n                        descriptionContent.outerHTML + formulaDescription.outerHTML,\n                    width: '320px', height: '485px', cssClass: 'e-spreadsheet-function-dlg',\n                    showCloseIcon: true, isModal: true,\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'InsertFunctionDialog', element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                        focus(_this.parent.element);\n                    },\n                    open: this.dialogOpen.bind(this), beforeClose: this.dialogBeforeClose.bind(this), close: this.dialogClose.bind(this),\n                    buttons: [\n                        {\n                            click: (this.selectFormula.bind(this, this.dialog, this)),\n                            buttonModel: { content: l10n.getConstant('Ok'), isPrimary: true }\n                        }\n                    ]\n                });\n                this.categoryList.appendTo('#' + this.parent.element.id + '_formula_category');\n                this.formulaList.appendTo('#' + this.parent.element.id + '_formula_list');\n                EventHandler.add(this.formulaList.element, 'dblclick', this.formulaClickHandler, this);\n            }\n        }\n    };\n    FormulaBar.prototype.toggleFormulaBar = function (target) {\n        var parent = target.parentElement;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (parent.classList.contains('e-expanded')) {\n            parent.classList.remove('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 1;\n            target.title = l10n.getConstant('ExpandFormulaBar');\n        }\n        else {\n            parent.classList.add('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 3;\n            target.title = l10n.getConstant('CollapseFormulaBar');\n        }\n        this.parent.setPanelSize();\n    };\n    FormulaBar.prototype.dialogOpen = function () {\n        this.focusOkButton();\n    };\n    FormulaBar.prototype.dialogClose = function () {\n        var args = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, args);\n        if (args.editedValue.toString().trim() === '=') {\n            this.parent.notify(editOperation, { action: 'refreshEditor', value: '' });\n        }\n    };\n    FormulaBar.prototype.dialogBeforeClose = function () {\n        EventHandler.remove(this.formulaList.element, 'dblclick', this.formulaClickHandler);\n        var dialogContentEle = document.getElementById('_dialog-content');\n        dialogContentEle.parentNode.removeChild(dialogContentEle);\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        this.dialog.dialogInstance.storeActiveElement = document.getElementById(this.parent.element.id + '_edit');\n    };\n    FormulaBar.prototype.selectFormula = function (dialog, formulaBarObj) {\n        var formulaText = formulaBarObj.formulaList.getSelectedItems().text;\n        var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n        if (this.parent.isEdit) {\n            this.parent.notify(editOperation, {\n                action: 'refreshEditor', value: formulaText + '(', refreshFormulaBar: true,\n                refreshEditorElem: true, isAppend: true\n            });\n        }\n        else {\n            this.parent.notify(editOperation, { action: 'startEdit', value: '=' + formulaText + '(', address: sheet.activeCell });\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: '=' + formulaText + '(' });\n        }\n        dialog.hide();\n    };\n    FormulaBar.prototype.listSelected = function () {\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.updateFormulaList = function () {\n        this.activeListFormula();\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.dropDownSelect = function (args) {\n        this.formulaCollection = [];\n        var listArgs = {\n            action: 'getLibraryFormulas',\n            formulaCollection: []\n        };\n        if (args.item.textContent === 'All') {\n            this.parent.notify(workbookFormulaOperation, listArgs);\n            this.formulaCollection = listArgs.formulaCollection;\n        }\n        else {\n            var category = args.item.textContent;\n            var selectArgs = {\n                action: 'dropDownSelectFormulas',\n                formulaCollection: [],\n                selectCategory: category\n            };\n            this.parent.notify(workbookFormulaOperation, selectArgs);\n            this.formulaCollection = selectArgs.formulaCollection;\n        }\n        this.formulaList.dataSource = this.formulaCollection.sort();\n    };\n    FormulaBar.prototype.focusOkButton = function () {\n        var focusEle = document.getElementById('_dialog-content');\n        (focusEle.nextElementSibling.firstElementChild).focus();\n    };\n    FormulaBar.prototype.activeListFormula = function () {\n        var acListEle = document.getElementById(this.parent.element.id + '_formula_list');\n        var firstElement = acListEle.children[0].children[0].firstElementChild;\n        this.formulaList.selectItem(firstElement);\n    };\n    FormulaBar.prototype.updateFormulaDescription = function () {\n        var selectedFormula = this.formulaList.getSelectedItems().text;\n        var descriptionArgs = {\n            action: 'getFormulaDescription',\n            description: '',\n            selectedList: selectedFormula\n        };\n        this.parent.notify(workbookFormulaOperation, descriptionArgs);\n        this.focusOkButton();\n        var descriptionArea = document.getElementById(this.parent.element.id + '_description_content');\n        selectedFormula = (selectedFormula === 'AND') ? 'CalculateAND' : (selectedFormula === 'OR') ? 'CalculateOR' : selectedFormula;\n        descriptionArea.innerHTML = this.parent.serviceLocator.getService(locale).getConstant(selectedFormula);\n    };\n    FormulaBar.prototype.formulaClickHandler = function (args) {\n        var trgtElem = args.target;\n        var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n        if (trgtElem.offsetParent.classList.contains('e-text-content') || trgtElem.classList.contains('e-list-item')) {\n            if (this.parent.isEdit) {\n                this.parent.notify(editOperation, {\n                    action: 'refreshEditor', value: trgtElem.innerText + '(', refreshFormulaBar: true,\n                    refreshEditorElem: true, isAppend: true\n                });\n            }\n            else {\n                this.parent.notify(editOperation, { action: 'startEdit', value: '=' + trgtElem.innerText + '(', address: sheet.activeCell });\n                this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: '=' + trgtElem.innerText + '(' });\n            }\n            this.dialog.hide();\n        }\n    };\n    FormulaBar.prototype.addEventListener = function () {\n        this.parent.on(formulaBar, this.createFormulaBar, this);\n        this.parent.on(click, this.formulaBarClickHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(selectionComplete, this.formulaBarUpdateHandler, this);\n        this.parent.on(mouseUpAfterSelection, this.UpdateValueAfterMouseUp, this);\n        this.parent.on(formulaBarOperation, this.editOperationHandler, this);\n        this.parent.on(enableFormulaInput, this.disabletextarea, this);\n        this.parent.on(isFormulaBarEdit, this.isFormulaBarEdit, this);\n    };\n    FormulaBar.prototype.destroy = function () {\n        this.removeEventListener();\n        this.comboBoxInstance.destroy();\n        this.comboBoxInstance = null;\n        this.insertFnRipple();\n        this.insertFnRipple = null;\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        if (formulaPanel) {\n            detach(formulaPanel);\n        }\n    };\n    FormulaBar.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(formulaBar, this.createFormulaBar);\n            this.parent.off(click, this.formulaBarClickHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(selectionComplete, this.formulaBarUpdateHandler);\n            this.parent.off(mouseUpAfterSelection, this.UpdateValueAfterMouseUp);\n            this.parent.off(formulaBarOperation, this.editOperationHandler);\n            this.parent.off(enableFormulaInput, this.disabletextarea);\n            this.parent.off(isFormulaBarEdit, this.isFormulaBarEdit);\n        }\n    };\n    FormulaBar.prototype.editOperationHandler = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'refreshFormulabar':\n                this.getFormulaBar().value = isUndefined(args.value) ? '' : args.value;\n                break;\n            case 'getElement':\n                args.element = this.getFormulaBar();\n                break;\n        }\n    };\n    FormulaBar.prototype.isFormulaBarEdit = function (args) {\n        var edit = this.parent.isEdit;\n        if (edit && this.isGoto) {\n            args.isEdit = true;\n        }\n        else {\n            args.isEdit = false;\n        }\n    };\n    FormulaBar.prototype.getFormulaBar = function () {\n        return select('#' + this.parent.element.id + '_formula_input', this.parent.element);\n    };\n    return FormulaBar;\n}());\nexport { FormulaBar };\n","import { formulaOperation, keyUp, keyDown, click, refreshFormulaDatasource } from '../common/event';\nimport { editOperation, formulaBarOperation } from '../common/event';\nimport { workbookFormulaOperation } from '../../workbook/common/event';\nimport { AutoComplete } from '@syncfusion/ej2-dropdowns';\nimport { detach, isNullOrUndefined, select } from '@syncfusion/ej2-base';\nimport { checkIsFormula, getSheet, getSheetName, getCellIndexes, isCellReference } from '../../workbook/index';\nimport { dialog, locale, focus } from '../common/index';\n/**\n * @hidden\n * The `Formula` module is used to handle the formulas and its functionalities in Spreadsheet.\n */\nvar Formula = /** @class */ (function () {\n    /**\n     * Constructor for formula module in Spreadsheet.\n     *\n     * @private\n     * @param {Spreadsheet} parent - Constructor for formula module in Spreadsheet.\n     */\n    function Formula(parent) {\n        this.isFormulaBar = false;\n        this.isFormula = false;\n        this.isPopupOpened = false;\n        this.isPreventClose = false;\n        this.isSubFormula = false;\n        this.keyCodes = {\n            UP: 38,\n            DOWN: 40,\n            LEFT: 37,\n            RIGHT: 39,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            SPACE: 32,\n            BACKSPACE: 8,\n            TAB: 9,\n            DELETE: 46,\n            ENTER: 13,\n            ESC: 27\n        };\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookFormula);\n    }\n    /**\n     * Get the module name.\n     *\n     * @returns {string} - Get the module name.\n     * @private\n     */\n    Formula.prototype.getModuleName = function () {\n        return 'formula';\n    };\n    /**\n     * To destroy the formula module.\n     *\n     * @returns {void} - To destroy the formula module.\n     * @hidden\n     */\n    Formula.prototype.destroy = function () {\n        this.removeEventListener();\n        if (this.autocompleteInstance) {\n            this.autocompleteInstance.destroy();\n            if (this.autocompleteInstance.element) {\n                this.autocompleteInstance.element.remove();\n            }\n        }\n        this.autocompleteInstance = null;\n        this.parent = null;\n    };\n    Formula.prototype.addEventListener = function () {\n        this.parent.on(formulaOperation, this.performFormulaOperation, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(click, this.formulaClick, this);\n        this.parent.on(refreshFormulaDatasource, this.refreshFormulaDatasource, this);\n    };\n    Formula.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(formulaOperation, this.performFormulaOperation);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(click, this.formulaClick);\n            this.parent.off(refreshFormulaDatasource, this.refreshFormulaDatasource);\n        }\n    };\n    Formula.prototype.performFormulaOperation = function (args) {\n        var _this = this;\n        var action = args.action;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst;\n        switch (action) {\n            case 'renderAutoComplete':\n                this.renderAutoComplete();\n                break;\n            case 'endEdit':\n                this.endEdit();\n                break;\n            case 'addDefinedName':\n                args.isAdded = this.addDefinedName(args.definedName);\n                break;\n            case 'getNames':\n                if (!args.sheetName) {\n                    args.sheetName = getSheetName(this.parent);\n                }\n                args.names = this.getNames(args.sheetName);\n                break;\n            case 'getNameFromRange':\n                args.definedName = this.getNameFromRange(args.range);\n                break;\n            case 'isFormulaEditing':\n                args.isFormulaEdit = this.isFormula;\n                break;\n            case 'isCircularReference':\n                dialogInst = this.parent.serviceLocator.getService(dialog);\n                dialogInst.show({\n                    height: 180, width: 400, isModal: true, showCloseIcon: true,\n                    content: l10n.getConstant('CircularReference'),\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'CircularReferenceDialog',\n                            element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                    }\n                });\n                args.argValue = '0';\n                break;\n        }\n    };\n    Formula.prototype.renderAutoComplete = function () {\n        if (!select('#' + this.parent.element.id + '_ac', this.parent.element)) {\n            var acElem = this.parent.createElement('input', { id: this.parent.element.id + '_ac', className: 'e-ss-ac' });\n            this.parent.element.appendChild(acElem);\n            var eventArgs = {\n                action: 'getLibraryFormulas',\n                formulaCollection: []\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            var autoCompleteOptions = {\n                dataSource: eventArgs.formulaCollection,\n                cssClass: 'e-ss-atc',\n                popupWidth: '130px',\n                allowFiltering: true,\n                filterType: 'StartsWith',\n                sortOrder: 'Ascending',\n                open: this.onSuggestionOpen.bind(this),\n                close: this.onSuggestionClose.bind(this),\n                select: this.onSelect.bind(this),\n                actionComplete: this.onSuggestionComplete.bind(this)\n            };\n            this.autocompleteInstance = new AutoComplete(autoCompleteOptions, acElem);\n            this.autocompleteInstance.createElement = this.parent.createElement;\n        }\n    };\n    Formula.prototype.onSuggestionOpen = function (e) {\n        var _this = this;\n        this.isPopupOpened = true;\n        e.popup.relateTo = this.getRelateToElem();\n        e.popup.element.firstChild.style.maxHeight = '180px';\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        new Promise(function (resolve, reject) {\n            setTimeout(function () { resolve(); }, 100);\n        }).then(function () {\n            _this.triggerKeyDownEvent(_this.keyCodes.DOWN);\n        });\n    };\n    Formula.prototype.onSuggestionClose = function (e) {\n        if (this.isPreventClose) {\n            e.cancel = true;\n        }\n        else {\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.onSelect = function (e) {\n        var updatedFormulaValue = '=' + e.itemData.value + '(';\n        if (this.isSubFormula) {\n            var editValue = this.getEditingValue();\n            var parseIndex = editValue.lastIndexOf(this.getArgumentSeparator());\n            if (parseIndex > -1) {\n                updatedFormulaValue = editValue.slice(0, parseIndex + 1);\n            }\n            else {\n                parseIndex = editValue.lastIndexOf('(');\n                if (parseIndex > -1) {\n                    updatedFormulaValue = editValue.slice(0, parseIndex + 1);\n                }\n            }\n            updatedFormulaValue += e.itemData.value + '(';\n        }\n        this.parent.notify(editOperation, {\n            action: 'refreshEditor', value: updatedFormulaValue,\n            refreshFormulaBar: true, refreshEditorElem: true, refreshCurPos: !this.isFormulaBar\n        });\n        if (this.isPopupOpened) {\n            this.hidePopUp();\n            var suggPopupElem = select('#' + this.parent.element.id + '_ac_popup');\n            if (suggPopupElem) {\n                detach(suggPopupElem);\n            }\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.onSuggestionComplete = function (args) {\n        this.isPreventClose = args.result.length > 0;\n        if (!this.isPreventClose) {\n            args.cancel = true;\n            this.hidePopUp();\n        }\n    };\n    Formula.prototype.refreshFormulaDatasource = function () {\n        var eventArgs = {\n            action: 'getLibraryFormulas',\n            formulaCollection: []\n        };\n        this.parent.notify(workbookFormulaOperation, eventArgs);\n        this.autocompleteInstance.dataSource = eventArgs.formulaCollection;\n    };\n    Formula.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var editValue = this.getEditingValue();\n            this.isFormula = checkIsFormula(editValue);\n            if (this.isFormula || this.isPopupOpened) {\n                if (e.keyCode !== this.keyCodes.TAB && this.isFormula) {\n                    editValue = this.getSuggestionKeyFromFormula(editValue);\n                }\n                this.refreshFormulaSuggestion(e, editValue);\n            }\n        }\n        else if (this.isPopupOpened) {\n            this.hidePopUp();\n        }\n    };\n    Formula.prototype.keyDownHandler = function (e) {\n        var keyCode = e.keyCode;\n        if (this.isFormula) {\n            if (this.isPopupOpened) {\n                switch (keyCode) {\n                    case this.keyCodes.UP:\n                    case this.keyCodes.DOWN:\n                        e.preventDefault();\n                        this.triggerKeyDownEvent(keyCode);\n                        break;\n                    case this.keyCodes.TAB:\n                        e.preventDefault();\n                        this.triggerKeyDownEvent(this.keyCodes.ENTER);\n                        break;\n                }\n            }\n        }\n        else {\n            var trgtElem = e.target;\n            if (trgtElem.id === this.parent.element.id + '_name_box') {\n                switch (keyCode) {\n                    case this.keyCodes.ENTER:\n                        this.addDefinedName({ name: trgtElem.value });\n                        focus(this.parent.element);\n                        break;\n                    case this.keyCodes.ESC:\n                        focus(this.parent.element);\n                        break;\n                }\n            }\n        }\n    };\n    Formula.prototype.formulaClick = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            this.isFormulaBar = trgtElem.classList.contains('e-formula-bar');\n        }\n    };\n    Formula.prototype.refreshFormulaSuggestion = function (e, formula) {\n        if (formula.length > 0) {\n            var autoCompleteElem = this.autocompleteInstance.element;\n            var keyCode = e.keyCode;\n            var isSuggestionAlreadyOpened = this.isPopupOpened;\n            if (!this.isNavigationKey(keyCode)) {\n                autoCompleteElem.value = formula;\n                autoCompleteElem.dispatchEvent(new Event('input'));\n                autoCompleteElem.dispatchEvent(new Event('keyup'));\n                if (isSuggestionAlreadyOpened) {\n                    this.triggerKeyDownEvent(this.keyCodes.DOWN);\n                }\n            }\n        }\n        else {\n            if (this.isPopupOpened) {\n                this.isPreventClose = false;\n                this.hidePopUp();\n            }\n        }\n    };\n    Formula.prototype.endEdit = function () {\n        this.isSubFormula = false;\n        this.isPreventClose = false;\n        this.isFormula = false;\n        this.isFormulaBar = false;\n        if (this.isPopupOpened) {\n            this.hidePopUp();\n            var suggPopupElem = select('#' + this.parent.element.id + '_ac_popup');\n            if (suggPopupElem) {\n                detach(suggPopupElem);\n            }\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.hidePopUp = function () {\n        this.autocompleteInstance.hidePopup();\n    };\n    Formula.prototype.getSuggestionKeyFromFormula = function (formula) {\n        var suggestValue = '';\n        formula = formula.substr(1); //remove = char.\n        if (formula) {\n            var bracketIndex = formula.lastIndexOf('(');\n            formula = formula.substr(bracketIndex + 1);\n            var fSplit = formula.split(this.getArgumentSeparator());\n            if (fSplit.length === 1) {\n                suggestValue = fSplit[0];\n                this.isSubFormula = bracketIndex > -1;\n            }\n            else {\n                suggestValue = fSplit[fSplit.length - 1];\n                this.isSubFormula = true;\n            }\n            var isAlphaNumeric = suggestValue.match(/\\w/);\n            if (!isAlphaNumeric || (isAlphaNumeric && isAlphaNumeric.index !== 0)) {\n                suggestValue = '';\n            }\n        }\n        return suggestValue;\n    };\n    Formula.prototype.getRelateToElem = function () {\n        var eventArgs = { action: 'getElement' };\n        if (this.isFormulaBar) {\n            this.parent.notify(formulaBarOperation, eventArgs);\n        }\n        else {\n            this.parent.notify(editOperation, eventArgs);\n        }\n        return eventArgs.element;\n    };\n    Formula.prototype.getEditingValue = function () {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        return eventArgs.editedValue;\n    };\n    Formula.prototype.isNavigationKey = function (keyCode) {\n        return (keyCode === this.keyCodes.UP) || (keyCode === this.keyCodes.DOWN) || (keyCode === this.keyCodes.LEFT)\n            || (keyCode === this.keyCodes.RIGHT);\n    };\n    Formula.prototype.triggerKeyDownEvent = function (keyCode) {\n        var autoCompleteElem = this.autocompleteInstance.element;\n        autoCompleteElem.dispatchEvent(new Event('input'));\n        var eventArg = new Event('keydown');\n        eventArg['keyCode'] = keyCode;\n        eventArg['which'] = keyCode;\n        eventArg['altKey'] = false;\n        eventArg['shiftKey'] = false;\n        eventArg['ctrlKey'] = false;\n        /* eslint-enable @typescript-eslint/dot-notation */\n        autoCompleteElem.dispatchEvent(eventArg);\n    };\n    Formula.prototype.getArgumentSeparator = function () {\n        if (this.argumentSeparator) {\n            return this.argumentSeparator;\n        }\n        else {\n            var eventArgs = {\n                action: 'getArgumentSeparator', argumentSeparator: ''\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            this.argumentSeparator = eventArgs.argumentSeparator;\n            return eventArgs.argumentSeparator;\n        }\n    };\n    Formula.prototype.getNames = function (sheetName) {\n        var names = this.parent.definedNames.filter(function (name) { return name.scope === 'Workbook' || name.scope === '' || name.scope === sheetName; });\n        return names;\n    };\n    Formula.prototype.getNameFromRange = function (range) {\n        var singleRange = range.slice(0, range.indexOf(':'));\n        var sRange = range.slice(range.indexOf('!') + 1).split(':');\n        var isSingleCell = sRange.length > 1 && sRange[0] === sRange[1];\n        var name = this.parent.definedNames.filter(function (name) {\n            if (isSingleCell && name.refersTo === '=' + singleRange) {\n                return true;\n            }\n            return name.refersTo === '=' + range;\n        });\n        return name && name[0];\n    };\n    Formula.prototype.addDefinedName = function (definedName) {\n        var _this = this;\n        var name = definedName.name;\n        var isAdded = false;\n        if (name && isCellReference(name.toUpperCase())) {\n            this.parent.goTo(name);\n            return isAdded;\n        }\n        if (!definedName.refersTo) {\n            var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n            var sheetName = getSheetName(this.parent);\n            sheetName = sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName;\n            var selectRange = sheet.selectedRange;\n            if (!isNullOrUndefined(selectRange)) {\n                var colIndex = selectRange.indexOf(':');\n                var left = selectRange.substr(0, colIndex);\n                var right = selectRange.substr(colIndex + 1, selectRange.length);\n                if (parseInt(right.replace(/\\D/g, ''), 10) === sheet.rowCount && parseInt(left.replace(/\\D/g, ''), 10) === 1) {\n                    right = right.replace(/[0-9]/g, '');\n                    left = left.replace(/[0-9]/g, '');\n                    selectRange = '$' + left + ':$' + right;\n                }\n                else if (getCellIndexes(right)[1] === sheet.colCount - 1 && getCellIndexes(left)[1] === 0) {\n                    right = right.replace(/\\D/g, '');\n                    left = left.replace(/\\D/g, '');\n                    selectRange = '$' + left + ':$' + right;\n                }\n                else {\n                    selectRange = left === right ? left : selectRange;\n                }\n            }\n            definedName.refersTo = sheetName + '!' + selectRange;\n            definedName.scope = 'Workbook';\n        }\n        if (name.length > 0 && (/^([a-zA-Z_0-9.]){0,255}$/.test(name))) {\n            var eventArgs = {\n                action: 'addDefinedName', definedName: definedName, isAdded: false\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            isAdded = eventArgs.isAdded;\n            if (!eventArgs.isAdded) {\n                this.parent.serviceLocator.getService(dialog).show({\n                    content: this.parent.serviceLocator.getService(locale).getConstant('DefineNameExists'),\n                    width: '300',\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'DefineNameExistsDialog',\n                            element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                    }\n                });\n            }\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService(locale).getConstant('DefineNameInValid'),\n                width: '300',\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'DefineNameInValidDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                }\n            });\n        }\n        return isAdded;\n    };\n    return Formula;\n}());\nexport { Formula };\n","import { Tab } from '@syncfusion/ej2-navigations';\nimport { refreshSheetTabs, locale, insertSheetTab, cMenuBeforeOpen, dialog, renameSheet, hideSheet, beginAction, removeDesignChart } from '../common/index';\nimport { sheetNameUpdate, clearUndoRedoCollection, completeAction, showAggregate, focus } from '../common/index';\nimport { sheetTabs, renameSheetTab, removeSheetTab, activeSheetChanged, onVerticalScroll, onHorizontalScroll } from '../common/index';\nimport { protectSheet, editOperation } from '../common/index';\nimport { getSheetName, aggregateComputation } from '../../workbook/index';\nimport { isSingleCell, getRangeIndexes, getSheet, getSheetIndex } from '../../workbook/index';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { isCollide, calculatePosition } from '@syncfusion/ej2-popups';\nimport { rippleEffect, closest, EventHandler, remove, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { sheetsDestroyed, activeCellChanged, workbookFormulaOperation, checkIsFormula } from '../../workbook/common/index';\nimport { insertModel } from './../../workbook/common/index';\n/**\n * Represents SheetTabs for Spreadsheet.\n */\nvar SheetTabs = /** @class */ (function () {\n    function SheetTabs(parent) {\n        this.aggregateContent = '';\n        this.isSelectCancel = false;\n        this.selaggregateCnt = 'Sum';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    SheetTabs.prototype.getModuleName = function () {\n        return 'sheetTabs';\n    };\n    SheetTabs.prototype.createSheetTabs = function () {\n        var _this = this;\n        if (!this.parent.showSheetTabs && this.tabInstance) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var panel = this.parent.createElement('div', {\n            className: 'e-sheet-tab-panel', id: this.parent.element.id + '_sheet_tab_panel'\n        });\n        var addBtn = this.parent.createElement('button', {\n            className: 'e-add-sheet-tab e-btn e-css e-flat e-icon-btn' + (this.parent.allowInsert ? '' : ' e-disabled'),\n            attrs: { 'title': l10n.getConstant('AddSheet') }\n        });\n        addBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-add-icon' }));\n        addBtn.addEventListener('click', this.addSheetTab.bind(this));\n        addBtn.disabled = !this.parent.allowInsert;\n        panel.appendChild(addBtn);\n        this.addBtnRipple = rippleEffect(panel, { selector: '.e-add-sheet-tab' });\n        var ddb = this.parent.createElement('button', { attrs: { 'title': l10n.getConstant('ListAllSheets') } });\n        panel.appendChild(ddb);\n        this.parent.element.appendChild(panel);\n        var items = this.getSheetTabItems();\n        this.dropDownInstance = new DropDownButton({\n            iconCss: 'e-icons',\n            items: items.ddbItems,\n            beforeItemRender: function (args) {\n                var sheet = _this.parent.sheets[_this.dropDownInstance.items.indexOf(args.item)];\n                if (sheet.state === 'Hidden') {\n                    args.element.classList.add('e-hide');\n                }\n                else if (sheet.state === 'VeryHidden') {\n                    args.element.style.display = 'none';\n                }\n            },\n            select: function (args) { return _this.updateSheetTab({ idx: _this.dropDownInstance.items.indexOf(args.item) }); },\n            beforeOpen: function (args) { return _this.beforeOpenHandler(_this.dropDownInstance, args.element); },\n            open: function (args) { return _this.openHandler(_this.dropDownInstance, args.element, 'left'); },\n            cssClass: 'e-sheets-list e-flat e-caret-hide',\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.dropDownInstance.createElement = this.parent.createElement;\n        this.dropDownInstance.appendTo(ddb);\n        var sheetTab = this.parent.createElement('div', { className: 'e-sheet-tab' });\n        this.tabInstance = new Tab({\n            selectedItem: this.parent.activeSheetIndex,\n            overflowMode: 'Scrollable',\n            items: items.tabItems,\n            scrollStep: 250,\n            selecting: function (args) {\n                var beginEventArgs = {\n                    currentSheetIndex: args.selectingIndex, previousSheetIndex: args.selectedIndex, cancel: false\n                };\n                if (!_this.isSelectCancel) {\n                    _this.parent.notify(beginAction, { eventArgs: beginEventArgs, action: 'gotoSheet' });\n                }\n                _this.isSelectCancel = beginEventArgs.cancel;\n            },\n            selected: function (args) {\n                if (args.selectedIndex === args.previousIndex) {\n                    return;\n                }\n                _this.parent.notify(removeDesignChart, {});\n                if (_this.parent.isEdit) {\n                    var selection = window.getSelection();\n                    var editArgs = { action: 'getCurrentEditValue', editedValue: '' };\n                    _this.parent.notify(editOperation, editArgs);\n                    var formula = editArgs.editedValue ? checkIsFormula(editArgs.editedValue, true) : false;\n                    if (!formula && selection && selection.focusNode && selection.focusNode.classList &&\n                        selection.focusNode.classList.contains('e-formula-bar-panel')) {\n                        formula = checkIsFormula(_this.parent.element.querySelector('.e-formula-bar').value, true);\n                    }\n                    if (!formula) {\n                        _this.parent.endEdit();\n                    }\n                }\n                if (_this.isSelectCancel) {\n                    _this.tabInstance.selectedItem = args.previousIndex;\n                    _this.tabInstance.dataBind();\n                    focus(_this.parent.element);\n                }\n                else {\n                    _this.parent.activeSheetIndex = args.selectedIndex;\n                    _this.parent.dataBind();\n                    _this.updateDropDownItems(args.selectedIndex, args.previousIndex);\n                    focus(_this.parent.element);\n                    var completeEventArgs = {\n                        previousSheetIndex: args.previousIndex, currentSheetIndex: args.selectedIndex\n                    };\n                    _this.parent.notify(completeAction, { eventArgs: completeEventArgs, action: 'gotoSheet' });\n                    var eventArgs = {\n                        action: 'registerGridInCalc',\n                        sheetID: (args.selectedIndex + 1).toString()\n                    };\n                    _this.parent.notify(workbookFormulaOperation, eventArgs);\n                }\n            },\n            created: function () {\n                var tBarItems = _this.tabInstance.element.querySelector('.e-toolbar-items');\n                tBarItems.classList.add('e-sheet-tabs-items');\n                EventHandler.add(tBarItems, 'dblclick', _this.renameSheetTab, _this);\n            }\n        });\n        panel.appendChild(sheetTab);\n        this.tabInstance.createElement = this.parent.createElement;\n        this.tabInstance.appendTo(sheetTab);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        EventHandler.remove(this.tabInstance.element, 'keydown', this.tabInstance.spaceKeyDown);\n        var sheetCount = items.tabItems.length;\n        for (var i = 0; i < sheetCount; i++) {\n            var sheetName = getSheetName(this.parent, i);\n            var arg = { action: 'addSheet', sheetName: 'Sheet' + (i + 1), index: i + 1, visibleName: sheetName };\n            this.parent.notify(workbookFormulaOperation, arg);\n        }\n        this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        this.parent.notify(protectSheet, null);\n    };\n    SheetTabs.prototype.updateDropDownItems = function (curIdx, prevIdx) {\n        if (prevIdx > -1) {\n            this.dropDownInstance.items[prevIdx].iconCss = '';\n        }\n        this.dropDownInstance.items[curIdx].iconCss = 'e-selected-icon e-icons';\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n    };\n    SheetTabs.prototype.beforeOpenHandler = function (instance, element) {\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(element.firstElementChild).height, 10) *\n            instance.items.length) + (parseInt(getComputedStyle(element).paddingTop, 10) * 2);\n        if (actualHeight > viewportHeight) {\n            element.style.height = viewportHeight + \"px\";\n            element.style.overflowY = 'auto';\n        }\n        element.parentElement.style.visibility = 'hidden';\n    };\n    SheetTabs.prototype.openHandler = function (instance, element, positionX) {\n        var wrapper = element.parentElement;\n        var height;\n        var collide = isCollide(wrapper);\n        if (collide.indexOf('bottom') === -1) {\n            height = element.style.overflowY === 'auto' ? this.parent.viewport.height : wrapper.getBoundingClientRect().height;\n            var offset = calculatePosition(instance.element, positionX, 'top');\n            if (positionX === 'right') {\n                offset.left -= wrapper.getBoundingClientRect().width;\n            }\n            wrapper.style.left = offset.left + \"px\";\n            wrapper.style.top = offset.top - height + \"px\";\n        }\n        wrapper.style.visibility = '';\n    };\n    SheetTabs.prototype.getSheetTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        var ddbItems = [];\n        var sheetName;\n        this.parent.sheets.forEach(function (sheet, index) {\n            sheetName = getSheetName(_this.parent, index);\n            tabItems.push({ header: { 'text': sheetName }, visible: sheet.state === 'Visible' });\n            ddbItems.push({ text: sheetName, iconCss: index === _this.parent.activeSheetIndex ? 'e-selected-icon e-icons' : '' });\n        });\n        return { tabItems: tabItems, ddbItems: ddbItems };\n    };\n    SheetTabs.prototype.refreshSheetTab = function () {\n        var items = this.getSheetTabItems();\n        this.dropDownInstance.items = items.ddbItems;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.items = items.tabItems;\n        this.tabInstance.selectedItem = this.parent.activeSheetIndex;\n        this.tabInstance.dataBind();\n    };\n    SheetTabs.prototype.addSheetTab = function () {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        this.parent.notify(insertModel, { model: this.parent, start: this.parent.activeSheetIndex + 1, end: this.parent.activeSheetIndex + 1, modelType: 'Sheet', isAction: true, activeSheetIndex: this.parent.activeSheetIndex + 1 });\n        focus(this.parent.element);\n    };\n    SheetTabs.prototype.insertSheetTab = function (args) {\n        this.parent.notify(removeDesignChart, {});\n        if (!args.preventUpdate || args.startIdx === this.tabInstance.selectedItem) {\n            this.dropDownInstance.items[this.tabInstance.selectedItem].iconCss = '';\n        }\n        for (var i = args.startIdx; i <= args.endIdx; i++) {\n            var sheetName = this.parent.sheets[i].name;\n            this.dropDownInstance.items.splice(i, 0, { text: sheetName });\n            this.tabInstance.addTab([{ header: { text: sheetName }, content: '' }], i);\n        }\n        if (!args.preventUpdate || args.startIdx === this.tabInstance.selectedItem) {\n            this.dropDownInstance.items[args.startIdx].iconCss = 'e-selected-icon e-icons';\n        }\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        if (args.preventUpdate) {\n            if (args.startIdx !== this.tabInstance.selectedItem) {\n                this.refreshSheetTab();\n            }\n        }\n        else {\n            this.updateSheetTab({ idx: args.startIdx });\n        }\n    };\n    SheetTabs.prototype.updateSheetTab = function (args) {\n        if (args.name === 'activeSheetChanged') {\n            args.idx = this.parent.skipHiddenSheets(args.idx);\n        }\n        else {\n            if (this.parent.sheets[args.idx].state === 'Hidden') {\n                if (this.parent.isProtected) {\n                    return;\n                }\n                this.parent.setSheetPropertyOnMute(this.parent.sheets[args.idx], 'state', 'Visible');\n                this.tabInstance.hideTab(args.idx, false);\n            }\n        }\n        this.tabInstance.selectedItem = args.idx;\n        this.tabInstance.dataBind();\n        this.parent.notify(protectSheet, null);\n    };\n    SheetTabs.prototype.switchSheetTab = function (args) {\n        var target = closest(args.event.target, '.e-toolbar-item');\n        if (!target) {\n            return;\n        }\n        var text = target.querySelector('.e-tab-text').textContent;\n        for (var i = 0, len = this.tabInstance.items.length; i < len; i++) {\n            if (this.tabInstance.items[i].header.text === text) {\n                if (this.parent.activeSheetIndex !== i) {\n                    this.updateSheetTab({ idx: i });\n                }\n                break;\n            }\n        }\n        if (args.element.classList.contains('e-contextmenu') && args.items[0] &&\n            args.items[0].id === this.parent.element.id + \"_cmenu_insert_sheet\") {\n            if (this.skipHiddenSheets() === 1) {\n                //let id: string = `${this.parent.element.id}_cmenu`;\n                //this.parent.enableFileMenuItems([`${id}_hide_sheet`, `${id}_delete_sheet`], false, true);\n                args.element.children[1].classList.add('e-disabled');\n                args.element.children[4].classList.add('e-disabled');\n            }\n            if (!this.parent.allowInsert) {\n                args.element.children[0].classList.add('e-disabled');\n            }\n            if (!this.parent.allowDelete) {\n                args.element.children[1].classList.add('e-disabled');\n            }\n        }\n        if (this.parent.password.length > 0 || this.parent.isProtected) {\n            args.element.children[0].classList.add('e-disabled');\n            args.element.children[1].classList.add('e-disabled');\n            args.element.children[2].classList.add('e-disabled');\n            args.element.children[3].classList.add('e-disabled');\n        }\n    };\n    SheetTabs.prototype.skipHiddenSheets = function () {\n        var count = this.parent.sheets.length;\n        this.parent.sheets.forEach(function (sheet) {\n            if (sheet.state !== 'Visible') {\n                --count;\n            }\n        });\n        return count;\n    };\n    SheetTabs.prototype.renameSheetTab = function () {\n        var target = this.tabInstance.element.querySelector('.e-toolbar-item.e-active');\n        if (target) {\n            target = target.querySelector('.e-text-wrap');\n            var value = target.querySelector('.e-tab-text').textContent;\n            var args = {\n                eventArgs: {\n                    name: value, index: this.parent.getActiveSheet().id\n                },\n                action: 'renameSheet', cancel: false\n            };\n            this.parent.trigger('actionBegin', args);\n            if (args.cancel) {\n                return;\n            }\n            var input = this.parent.createElement('input', {\n                id: this.parent.element.id + '_rename_input',\n                className: 'e-input e-sheet-rename', styles: \"width: \" + target.getBoundingClientRect().width + \"px\", attrs: {\n                    'type': 'text', 'name': 'Rename', 'required': '', 'value': value, 'spellcheck': 'false', 'maxlength': '31'\n                }\n            });\n            target.firstElementChild.style.display = 'none';\n            target.appendChild(input);\n            EventHandler.add(document, 'mousedown touchstart', this.renameInputFocusOut, this);\n            EventHandler.add(input, 'input', this.updateWidth, this);\n            input.focus();\n            input.setSelectionRange(0, value.length);\n            EventHandler.remove(closest(target, '.e-toolbar-items'), 'dblclick', this.renameSheetTab);\n        }\n    };\n    SheetTabs.prototype.updateWidth = function (e) {\n        var target = e.target;\n        var len = target.value.length;\n        var value = target.value.split(' ');\n        if (value.length) {\n            var spaceLen = value.length - 1;\n            len -= spaceLen;\n            len += (spaceLen * 0.5);\n        }\n        target.style.width = len + \"ch\";\n    };\n    SheetTabs.prototype.renameInputFocusOut = function (e) {\n        var target = e.target;\n        if ((e.type === 'mousedown' || e.type === 'touchstart') && (target.classList.contains('e-sheet-rename') ||\n            closest(target, '.e-dlg-container'))) {\n            return;\n        }\n        target = document.getElementById(this.parent.element.id + '_rename_input');\n        if (e.type === 'keydown' && e.keyCode === 27) {\n            this.removeRenameInput(target);\n            focus(this.parent.element);\n            return;\n        }\n        var value = target.value;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (value) {\n            var idx = this.tabInstance.selectedItem;\n            // eslint-disable-next-line no-useless-escape\n            if (!value.match(new RegExp('.*[\\\\[\\\\]\\\\*\\\\\\\\\\/\\\\?].*'))) {\n                if (this.tabInstance.items[idx].header.text !== value) {\n                    for (var i = 0, len = this.parent.sheets.length; i < len; i++) {\n                        if (i !== this.parent.activeSheetIndex && this.parent.sheets[i].name.toLowerCase() === value.toLowerCase()) {\n                            this.showRenameDialog(target, l10n.getConstant('SheetRenameAlreadyExistsAlert'));\n                            return;\n                        }\n                    }\n                }\n                var items = this.removeRenameInput(target);\n                if (this.tabInstance.items[idx].header.text !== value) {\n                    this.parent.setSheetPropertyOnMute(this.parent.sheets[idx], 'name', value);\n                    this.updateSheetName({ value: value, idx: idx, items: items });\n                }\n                if (e.type === 'keydown' || (closest(e.target, '.e-spreadsheet'))) {\n                    focus(this.parent.element);\n                }\n            }\n            else {\n                this.showRenameDialog(target, l10n.getConstant('SheetRenameInvalidAlert'));\n            }\n        }\n        else {\n            this.showRenameDialog(target, l10n.getConstant('SheetRenameEmptyAlert'));\n        }\n        var sheetIndex = this.parent.getActiveSheet().id;\n        var args = { action: 'renameUpdation', value: value, sheetId: sheetIndex };\n        this.parent.notify(workbookFormulaOperation, args);\n        var eventArgs = {\n            index: sheetIndex,\n            value: value\n        };\n        this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'renameSheet' });\n    };\n    SheetTabs.prototype.updateSheetName = function (args) {\n        this.tabInstance.items[args.idx].header.text = args.value;\n        this.dropDownInstance.items[args.idx].text = args.value;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        if (args.value.indexOf('  ') > -1) {\n            this.tabInstance.setProperties({ 'items': this.tabInstance.items }, true);\n            args.items.querySelector('.e-toolbar-item.e-active .e-tab-text').textContent = args.value;\n        }\n        else {\n            args.items.querySelector('.e-toolbar-item.e-active .e-tab-text').textContent = args.value;\n            this.tabInstance.dataBind();\n        }\n    };\n    SheetTabs.prototype.hideSheet = function () {\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'state', 'Hidden');\n        this.tabInstance.hideTab(this.parent.activeSheetIndex);\n    };\n    SheetTabs.prototype.removeRenameInput = function (target) {\n        var textEle = target.parentElement.querySelector('.e-tab-text');\n        var sheetItems = closest(target, '.e-toolbar-items');\n        EventHandler.add(sheetItems, 'dblclick', this.renameSheetTab, this);\n        EventHandler.remove(document, 'mousedown touchstart', this.renameInputFocusOut);\n        EventHandler.remove(target, 'input', this.updateWidth);\n        remove(target);\n        textEle.style.display = '';\n        return sheetItems;\n    };\n    SheetTabs.prototype.showRenameDialog = function (target, content) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            target: document.getElementById(this.parent.element.id + '_sheet_panel'),\n            height: 180, width: 400, isModal: true, showCloseIcon: true,\n            content: content,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'SheetRenameDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                target.focus();\n            },\n            close: function () { return target.setSelectionRange(0, target.value.length); }\n        });\n    };\n    SheetTabs.prototype.focusRenameInput = function () {\n        var input = document.getElementById(this.parent.element.id + '_rename_input');\n        if (input) {\n            input.focus();\n        }\n    };\n    SheetTabs.prototype.removeSheetTab = function (args) {\n        var _this = this;\n        if (args.count && (args.count === this.parent.sheets.length)) {\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.skipHiddenSheets() > 1) {\n            var sheet = args.sheetName ?\n                getSheet(this.parent, getSheetIndex(this.parent, args.sheetName)) :\n                this.parent.getActiveSheet();\n            var sheetIndex_1 = args.index || getSheetIndex(this.parent, sheet.name);\n            var eventArgs_1 = {\n                index: sheetIndex_1,\n                sheetCount: this.parent.sheets.length,\n                sheetName: sheet.name\n            };\n            var isDataAvail = sheet.rows && sheet.rows.length ?\n                (sheet.rows.length === 1 ? (sheet.rows[0].cells && sheet.rows[0].cells.length ? true : false) : true) : false;\n            if (isDataAvail) {\n                var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n                if (args.clicked) {\n                    this.forceDelete(sheetIndex_1);\n                }\n                else {\n                    dialogInst_1.show({\n                        height: 200, width: 400, isModal: true, showCloseIcon: true,\n                        content: l10n.getConstant('DeleteSheetAlert'),\n                        beforeOpen: function (args) {\n                            var dlgArgs = {\n                                dialogName: 'DeleteSheetDialog',\n                                element: args.element, target: args.target, cancel: args.cancel\n                            };\n                            _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                            if (dlgArgs.cancel) {\n                                args.cancel = true;\n                            }\n                            focus(_this.parent.element);\n                        },\n                        buttons: [{\n                                buttonModel: {\n                                    content: l10n.getConstant('Ok'), isPrimary: true\n                                },\n                                click: function () {\n                                    dialogInst_1.hide();\n                                    _this.forceDelete(sheetIndex_1);\n                                    _this.parent.notify(clearUndoRedoCollection, null);\n                                    if (args && !args.isAction) {\n                                        eventArgs_1.sheetCount = _this.parent.sheets.length;\n                                        _this.parent.notify(completeAction, { eventArgs: eventArgs_1, action: 'removeSheet' });\n                                    }\n                                }\n                            }]\n                    });\n                }\n            }\n            else {\n                var sheetArgs = {\n                    action: 'deleteSheetTab', sheetName: '', index: sheetIndex_1 + 1\n                };\n                this.parent.notify(workbookFormulaOperation, sheetArgs);\n                this.destroySheet(sheetIndex_1);\n                this.parent.notify(clearUndoRedoCollection, null);\n                if (args && !args.isAction) {\n                    eventArgs_1.sheetCount = this.parent.sheets.length;\n                    this.parent.notify(completeAction, { eventArgs: eventArgs_1, action: 'removeSheet' });\n                }\n            }\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                target: document.getElementById(this.parent.element.id + '_sheet_panel'),\n                height: 180, width: 400, isModal: true, showCloseIcon: true,\n                content: l10n.getConstant('DeleteSingleLastSheetAlert'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'DeleteSingleSheetDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    focus(_this.parent.element);\n                }\n            });\n        }\n    };\n    SheetTabs.prototype.forceDelete = function (sheetIndex) {\n        var sheetArgs = {\n            action: 'deleteSheetTab', sheetName: '', index: sheetIndex + 1\n        };\n        this.parent.notify(removeDesignChart, {});\n        this.parent.notify(workbookFormulaOperation, sheetArgs);\n        this.destroySheet(sheetIndex);\n    };\n    SheetTabs.prototype.destroySheet = function (sheetIndex) {\n        var activeSheetIdx = sheetIndex || this.parent.activeSheetIndex;\n        this.parent.removeSheet(activeSheetIdx);\n        this.parent.notify(sheetsDestroyed, { sheetIndex: activeSheetIdx });\n        this.dropDownInstance.items.splice(activeSheetIdx, 1);\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.removeTab(activeSheetIdx);\n        var activeIndex = this.parent.skipHiddenSheets(this.tabInstance.selectedItem);\n        this.parent.activeSheetIndex = activeIndex;\n        this.parent.setProperties({ activeSheetIndex: activeIndex }, true);\n        this.parent.renderModule.refreshSheet();\n        this.tabInstance.selectedItem = activeIndex;\n        this.tabInstance.dataBind();\n        this.updateDropDownItems(activeIndex);\n        this.parent.notify(protectSheet, null);\n        focus(this.parent.element);\n    };\n    SheetTabs.prototype.showAggregate = function () {\n        var _this = this;\n        if (isSingleCell(getRangeIndexes(this.parent.getActiveSheet().selectedRange))) {\n            return;\n        }\n        var eventArgs = { Count: 0, Sum: '0', Avg: '0', Min: '0', Max: '0', countOnly: true };\n        this.parent.notify(aggregateComputation, eventArgs);\n        if (eventArgs.Count > 1) {\n            this.aggregateContent = eventArgs.countOnly ? 'Count' : this.selaggregateCnt;\n            if (eventArgs.countOnly) {\n                this.aggregateContent = 'Count';\n                delete eventArgs.Sum;\n                delete eventArgs.Avg;\n                delete eventArgs.Min;\n                delete eventArgs.Max;\n            }\n            var btnClass = eventArgs.countOnly ? 'e-aggregate-list e-flat e-aggregate-list-countonly e-caret-hide'\n                : 'e-aggregate-list e-flat';\n            delete eventArgs.countOnly;\n            var key = this.aggregateContent;\n            var content = key + \": \" + eventArgs[key];\n            if (!this.aggregateDropDown) {\n                var aggregateEle = this.parent.createElement('button', { id: this.parent.element.id + '_aggregate' });\n                document.getElementById(this.parent.element.id + \"_sheet_tab_panel\").appendChild(aggregateEle);\n                this.aggregateDropDown = new DropDownButton({\n                    content: content,\n                    items: this.getAggregateItems(eventArgs),\n                    select: function (args) {\n                        _this.parent.notify(aggregateComputation, eventArgs);\n                        _this.updateAggregateContent(args.item.text, { Count: eventArgs.Count, Sum: eventArgs.Sum, Avg: eventArgs.Avg, Min: eventArgs.Min, Max: eventArgs.Max }, true);\n                    },\n                    beforeOpen: function (args) {\n                        return _this.beforeOpenHandler(_this.aggregateDropDown, args.element);\n                    },\n                    open: function (args) { return _this.openHandler(_this.aggregateDropDown, args.element, 'right'); },\n                    close: function () { return focus(_this.parent.element); },\n                    cssClass: btnClass\n                });\n                this.aggregateDropDown.createElement = this.parent.createElement;\n                this.aggregateDropDown.appendTo(aggregateEle);\n            }\n            else {\n                this.updateAggregateContent(content, eventArgs);\n            }\n        }\n        else {\n            this.removeAggregate();\n        }\n    };\n    SheetTabs.prototype.getAggregateItems = function (args) {\n        var _this = this;\n        var items = [];\n        var text;\n        var iconCss;\n        Object.keys(args).forEach(function (key) {\n            if (args[key] !== aggregateComputation) {\n                text = key + \": \" + args[key];\n                iconCss = key === _this.aggregateContent ? 'e-selected-icon e-icons' : '';\n                items.push({ text: text, iconCss: iconCss });\n            }\n        });\n        return items;\n    };\n    SheetTabs.prototype.updateAggregateContent = function (text, eventArgs, isSelect) {\n        this.aggregateContent = text.split(': ')[0];\n        if (isSelect) {\n            this.selaggregateCnt = text.split(': ')[0];\n        }\n        this.aggregateDropDown.content = text;\n        this.aggregateDropDown.dataBind();\n        this.aggregateDropDown.setProperties({ 'items': this.getAggregateItems(eventArgs) }, true);\n    };\n    SheetTabs.prototype.removeAggregate = function () {\n        if (!isNullOrUndefined(this.aggregateDropDown)) {\n            this.aggregateDropDown.destroy();\n            remove(this.aggregateDropDown.element);\n            this.aggregateDropDown = null;\n        }\n    };\n    SheetTabs.prototype.addEventListener = function () {\n        this.parent.on(sheetTabs, this.createSheetTabs, this);\n        this.parent.on(refreshSheetTabs, this.refreshSheetTab, this);\n        this.parent.on(insertSheetTab, this.insertSheetTab, this);\n        this.parent.on(removeSheetTab, this.removeSheetTab, this);\n        this.parent.on(renameSheetTab, this.renameSheetTab, this);\n        this.parent.on(cMenuBeforeOpen, this.switchSheetTab, this);\n        this.parent.on(activeSheetChanged, this.updateSheetTab, this);\n        this.parent.on(renameSheet, this.renameInputFocusOut, this);\n        this.parent.on(activeCellChanged, this.removeAggregate, this);\n        this.parent.on(onVerticalScroll, this.focusRenameInput, this);\n        this.parent.on(onHorizontalScroll, this.focusRenameInput, this);\n        this.parent.on(sheetNameUpdate, this.updateSheetName, this);\n        this.parent.on(hideSheet, this.hideSheet, this);\n        this.parent.on(showAggregate, this.showAggregate, this);\n    };\n    SheetTabs.prototype.destroy = function () {\n        this.removeEventListener();\n        this.dropDownInstance.destroy();\n        this.dropDownInstance = null;\n        this.tabInstance.destroy();\n        this.tabInstance = null;\n        this.removeAggregate();\n        this.aggregateContent = null;\n        this.addBtnRipple();\n        this.addBtnRipple = null;\n        EventHandler.remove(document, 'mousedown touchstart', this.renameInputFocusOut);\n        var ele = document.getElementById(this.parent.element.id + '_sheet_tab_panel');\n        if (ele) {\n            remove(ele);\n        }\n        this.parent = null;\n    };\n    SheetTabs.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(sheetTabs, this.createSheetTabs);\n            this.parent.off(refreshSheetTabs, this.refreshSheetTab);\n            this.parent.off(insertSheetTab, this.insertSheetTab);\n            this.parent.off(removeSheetTab, this.removeSheetTab);\n            this.parent.off(renameSheetTab, this.renameSheetTab);\n            this.parent.off(cMenuBeforeOpen, this.switchSheetTab);\n            this.parent.off(activeSheetChanged, this.updateSheetTab);\n            this.parent.off(renameSheet, this.renameInputFocusOut);\n            this.parent.off(activeCellChanged, this.removeAggregate);\n            this.parent.off(onVerticalScroll, this.focusRenameInput);\n            this.parent.off(onHorizontalScroll, this.focusRenameInput);\n            this.parent.off(sheetNameUpdate, this.updateSheetName);\n            this.parent.off(hideSheet, this.hideSheet);\n            this.parent.off(showAggregate, this.showAggregate);\n        }\n    };\n    return SheetTabs;\n}());\nexport { SheetTabs };\n","import { refreshSheetTabs, completeAction } from '../common/event';\nimport { dialog, importProtectWorkbook, locale } from '../common/index';\nimport { openSuccess, openFailure } from '../../workbook/index';\nvar Open = /** @class */ (function () {\n    function Open(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.renderFileUpload();\n        //Spreadsheet.Inject(WorkbookOpen);\n    }\n    /**\n     * Adding event listener for success and failure\n     *\n     * @returns {void} - Adding event listener for success and failure\n     */\n    Open.prototype.addEventListener = function () {\n        this.parent.on(openSuccess, this.openSuccess, this);\n        this.parent.on(openFailure, this.openFailed, this);\n    };\n    /**\n     * Removing event listener for success and failure\n     *\n     * @returns {void} - Removing event listener for success and failure\n     */\n    Open.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(openSuccess, this.openSuccess);\n            this.parent.off(openFailure, this.openFailed);\n        }\n    };\n    /**\n     * Rendering upload component for importing files.\n     *\n     * @returns {void} - Rendering upload component for importing files.\n     */\n    Open.prototype.renderFileUpload = function () {\n        var uploadID = this.parent.element.id + '_fileUpload';\n        this.parent.element.appendChild(this.parent.createElement('input', {\n            id: uploadID,\n            attrs: { type: 'file', accept: '.xls, .xlsx, .csv, .xlsm', name: 'fileUpload' }\n        }));\n        var uploadBox = document.getElementById(uploadID);\n        uploadBox.onchange = this.fileSelect.bind(this);\n        uploadBox.onerror = this.openFailed.bind(this);\n        uploadBox.style.display = 'none';\n    };\n    /**\n     * Process after select the excel and image file.\n     *\n     * @param {Event} args - File select native event.\n     * @returns {void} - Process after select the excel and image file.\n     */\n    Open.prototype.fileSelect = function (args) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var filesData = args.target.files[0];\n        if (filesData && filesData.length < 1) {\n            return;\n        }\n        var impArgs = {\n            file: filesData\n        };\n        this.parent.open(impArgs);\n        document.getElementById(this.parent.element.id + '_fileUpload').value = '';\n    };\n    /**\n     * File open success event declaration.\n     *\n     * @param {string} response - File open success response text.\n     * @returns {void} - File open success event declaration.\n     */\n    Open.prototype.openSuccess = function (response) {\n        var _this = this;\n        var openError = ['UnsupportedFile', 'InvalidUrl', 'NeedPassword', 'InCorrectPassword'];\n        if (openError.indexOf(response.data) > -1) {\n            if (openError[2] === response.data) {\n                if (!this.parent.element.querySelector('.e-importprotectworkbook-dlg')) {\n                    this.parent.notify(importProtectWorkbook, response.eventArgs);\n                }\n            }\n            else if (openError[3] === response.data) {\n                var l10n = this.parent.serviceLocator.getService(locale);\n                var alertSpan = this.parent.createElement('span', {\n                    className: 'e-importprotectpwd-alert-span',\n                    innerHTML: l10n.getConstant('InCorrectPassword')\n                });\n                (this.parent.element.querySelector('.e-importprotectworkbook-dlg').querySelector('.e-dlg-content')).appendChild(alertSpan);\n            }\n            else {\n                var dialogInst = this.parent.serviceLocator.getService(dialog);\n                dialogInst.hide();\n                this.parent.serviceLocator.getService(dialog).show({\n                    content: this.parent.serviceLocator.getService('spreadsheetLocale')\n                        .getConstant(response.data),\n                    width: '300',\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'OpenDialog',\n                            element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                    }\n                });\n                this.parent.hideSpinner();\n                return;\n            }\n        }\n        else {\n            var dialogInst = this.parent.serviceLocator.getService(dialog);\n            dialogInst.hide();\n            this.parent.showSpinner();\n        }\n        if (!this.parent.element) {\n            return;\n        }\n        this.parent.trigger('openComplete', { response: response });\n        this.parent.notify(completeAction, { response: response, action: 'import' });\n        this.parent.renderModule.refreshSheet(true);\n        this.parent.notify(refreshSheetTabs, this);\n        this.parent.hideSpinner();\n    };\n    /**\n     * File open failure event declaration.\n     *\n     * @param {object} args - Open failure arguments.\n     * @returns {void} - File open failure event declaration.\n     */\n    Open.prototype.openFailed = function (args) {\n        this.parent.trigger('openFailure', args);\n        this.parent.hideSpinner();\n        /* Need to Implement */\n    };\n    /**\n     * To Remove the event listeners.\n     *\n     * @returns {void} - To Remove the event listeners.\n     */\n    Open.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the sheet open module name.\n     *\n     * @returns {string} - Get the sheet open module name.\n     */\n    Open.prototype.getModuleName = function () {\n        return 'open';\n    };\n    return Open;\n}());\nexport { Open };\n","import { dialog, focus } from '../index';\nimport { beginSave, saveCompleted, saveError } from '../../workbook/common/event';\n/**\n * `Save` module is used to handle the save action in Spreadsheet.\n */\nvar Save = /** @class */ (function () {\n    /**\n     * Constructor for Save module in Spreadsheet.\n     *\n     * @private\n     * @param {Spreadsheet} parent - Specifies the Spreadsheet instance.\n     */\n    function Save(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookSave);\n    }\n    /**\n     * To destroy the Save module.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Save.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Save.prototype.addEventListener = function () {\n        this.parent.on(beginSave, this.initiateSave, this);\n        this.parent.on(saveCompleted, this.saveCompleted, this);\n        this.parent.on(saveError, this.showErrorDialog, this);\n    };\n    Save.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(beginSave, this.initiateSave);\n            this.parent.off(saveCompleted, this.saveCompleted);\n            this.parent.off(saveError, this.showErrorDialog);\n        }\n    };\n    /**\n     * Get the module name.\n     *\n     * @returns {string} - Get the module name.\n     * @private\n     */\n    Save.prototype.getModuleName = function () {\n        return 'save';\n    };\n    /**\n     * Initiate save process.\n     *\n     * @hidden\n     * @returns {void} - Initiate save process.\n     */\n    Save.prototype.initiateSave = function () {\n        this.parent.showSpinner();\n    };\n    /**\n     * Save action completed.\n     *\n     * @hidden\n     * @returns {void} - Save action completed.\n     */\n    Save.prototype.saveCompleted = function () {\n        this.parent.hideSpinner();\n    };\n    Save.prototype.showErrorDialog = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            target: this.parent.element, isModal: true, showCloseIcon: true, height: 180, width: 400, content: args.content,\n            beforeOpen: function () { return focus(_this.parent.element); }\n        });\n    };\n    return Save;\n}());\nexport { Save };\n","import { ContextMenu as ContextMenuComponent } from '@syncfusion/ej2-navigations';\nimport { closest, extend, detach } from '@syncfusion/ej2-base';\nimport { removeSheetTab, cMenuBeforeOpen, renameSheetTab, cut, copy, paste, focus } from '../common/index';\nimport { addContextMenuItems, removeContextMenuItems, enableContextMenuItems, initiateCustomSort, hideSheet } from '../common/index';\nimport { openHyperlink, initiateHyperlink, editHyperlink, hideShow, applyProtect } from '../common/index';\nimport { filterByCellValue, reapplyFilter, clearFilter, getFilteredColumn, applySort, locale } from '../common/index';\nimport { getRangeIndexes, getColumnHeaderText, getCellIndexes, insertModel } from '../../workbook/common/index';\nimport { getSwapRange, getSheetIndex, moveSheet, duplicateSheet } from '../../workbook/index';\n/**\n * Represents context menu for Spreadsheet.\n */\nvar ContextMenu = /** @class */ (function () {\n    /**\n     * Constructor for ContextMenu module.\n     *\n     * @param {Spreadsheet} parent - Constructor for ContextMenu module.\n     */\n    function ContextMenu(parent) {\n        this.parent = parent;\n        this.init();\n    }\n    ContextMenu.prototype.init = function () {\n        this.initContextMenu();\n        this.addEventListener();\n    };\n    ContextMenu.prototype.initContextMenu = function () {\n        var ul = document.createElement('ul');\n        ul.id = this.parent.element.id + '_contextmenu';\n        this.parent.element.appendChild(ul);\n        this.contextMenuInstance = new ContextMenuComponent({\n            cssClass: 'e-spreadsheet-contextmenu',\n            target: '#' + this.parent.element.id,\n            filter: 'e-numericcontainer e-active-cell e-selection e-row e-header-row e-select-all-cell e-sheet-tabs-items',\n            select: this.selectHandler.bind(this),\n            beforeOpen: this.beforeOpenHandler.bind(this),\n            beforeClose: this.beforeCloseHandler.bind(this)\n        }, ul);\n    };\n    /**\n     * Before close event handler.\n     *\n     * @param {BeforeOpenCloseMenuEventArgs} args - Specify the args\n     * @returns {void} - Before close event handler.\n     */\n    ContextMenu.prototype.beforeCloseHandler = function (args) {\n        this.parent.trigger('contextMenuBeforeClose', args);\n    };\n    /**\n     * Select event handler.\n     *\n     * @param {MenuEventArgs} args - Specify the args\n     * @returns {void} - Select event handler.\n     */\n    ContextMenu.prototype.selectHandler = function (args) {\n        var selectArgs = extend({ cancel: false }, args);\n        this.parent.trigger('contextMenuItemSelect', selectArgs);\n        var id = this.parent.element.id + '_cmenu';\n        var field;\n        var sheet;\n        var isActive;\n        if (!selectArgs.cancel) {\n            var indexes = void 0;\n            switch (args.item.id) {\n                case id + '_cut':\n                    this.parent.notify(cut, { isAction: true, promise: Promise });\n                    break;\n                case id + '_copy':\n                    this.parent.notify(copy, { isAction: true, promise: Promise });\n                    break;\n                case id + '_paste':\n                    this.parent.notify(paste, { isAction: true, isInternal: true });\n                    break;\n                case id + '_pastevalues':\n                    this.parent.notify(paste, { type: 'Values', isAction: true, isInternal: true });\n                    break;\n                case id + '_pasteformats':\n                    this.parent.notify(paste, { type: 'Formats', isAction: true, isInternal: true });\n                    break;\n                case id + '_rename':\n                    this.parent.notify(renameSheetTab, {});\n                    break;\n                case id + '_delete_sheet':\n                    this.parent.notify(removeSheetTab, {});\n                    break;\n                case id + '_insert_sheet':\n                    this.parent.notify(insertModel, { model: this.parent, start: this.parent.activeSheetIndex,\n                        end: this.parent.activeSheetIndex, modelType: 'Sheet', isAction: true });\n                    break;\n                case id + '_hide_sheet':\n                    this.parent.notify(hideSheet, null);\n                    break;\n                case id + '_duplicate':\n                    duplicateSheet(this.parent, undefined, true);\n                    break;\n                case id + '_move_right':\n                    moveSheet(this.parent, this.parent.activeSheetIndex + 1, null, true);\n                    break;\n                case id + '_move_left':\n                    moveSheet(this.parent, this.parent.activeSheetIndex - 1, null, true);\n                    break;\n                case id + '_ascending':\n                    this.parent.notify(applySort, null);\n                    break;\n                case id + '_descending':\n                    this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: 'Descending' } } });\n                    break;\n                case id + '_customsort':\n                    this.parent.notify(initiateCustomSort, null);\n                    break;\n                case id + '_filtercellvalue':\n                    this.parent.notify(filterByCellValue, null);\n                    break;\n                case id + '_clearfilter':\n                    field = getColumnHeaderText(getCellIndexes(this.parent.getActiveSheet().activeCell)[1] + 1);\n                    this.parent.notify(clearFilter, { field: field });\n                    break;\n                case id + '_reapplyfilter':\n                    this.parent.notify(reapplyFilter, null);\n                    break;\n                case id + '_hide_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[0], endIndex: indexes[2], hide: true, isCol: false, actionUpdate: true\n                    });\n                    focus(this.parent.element);\n                    break;\n                case id + '_unhide_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[0], endIndex: indexes[2], hide: false, isCol: false, actionUpdate: true\n                    });\n                    focus(this.parent.element);\n                    break;\n                case id + '_hide_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[1], endIndex: indexes[3], hide: true, isCol: true, actionUpdate: true\n                    });\n                    focus(this.parent.element);\n                    break;\n                case id + '_unhide_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[1], endIndex: indexes[3], hide: false, isCol: true, actionUpdate: true\n                    });\n                    focus(this.parent.element);\n                    break;\n                case id + '_insert_row_above':\n                case id + '_delete_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(args.item.id.substr(id.length + 1, 6) + \"Model\", { model: this.parent.getActiveSheet(), start: indexes[0], end: indexes[2], modelType: 'Row', isAction: true,\n                        insertType: 'above' });\n                    focus(this.parent.element);\n                    break;\n                case id + '_insert_row_below':\n                    indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                    this.parent.notify(insertModel, { model: this.parent.getActiveSheet(), start: indexes[2] + 1, end: indexes[2] + 1 + (indexes[2] - indexes[0]), modelType: 'Row', isAction: true,\n                        insertType: 'below' });\n                    focus(this.parent.element);\n                    break;\n                case id + '_insert_column_before':\n                case id + '_delete_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(args.item.id.substr(id.length + 1, 6) + \"Model\", { model: this.parent.getActiveSheet(), start: indexes[1], end: indexes[3], modelType: 'Column', isAction: true });\n                    focus(this.parent.element);\n                    break;\n                case id + '_insert_column_after':\n                    indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                    this.parent.notify(insertModel, { model: this.parent.getActiveSheet(), start: indexes[3] + 1, end: indexes[3] + 1 + (indexes[3] - indexes[1]), modelType: 'Column', isAction: true });\n                    focus(this.parent.element);\n                    break;\n                case id + '_hyperlink':\n                    this.parent.notify(initiateHyperlink, null);\n                    break;\n                case id + '_editHyperlink':\n                    this.parent.notify(editHyperlink, null);\n                    break;\n                case id + '_openHyperlink':\n                    this.parent.notify(openHyperlink, null);\n                    break;\n                case id + '_removeHyperlink':\n                    this.parent.removeHyperlink(this.parent.getActiveSheet().selectedRange);\n                    break;\n                case id + '_protect':\n                    sheet = this.parent.getActiveSheet();\n                    this.parent.setSheetPropertyOnMute(sheet, 'isProtected', !sheet.isProtected);\n                    isActive = sheet.isProtected ? false : true;\n                    this.parent.notify(applyProtect, { isActive: isActive });\n                    break;\n            }\n        }\n    };\n    ContextMenu.prototype.getInsertModel = function (startIndex, endIndex) {\n        var model = [];\n        for (var i = startIndex; i <= endIndex; i++) {\n            if (i === startIndex) {\n                model.push({ index: i });\n            }\n            else {\n                model.push({});\n            }\n        }\n        return model;\n    };\n    /**\n     * Before open event handler.\n     *\n     * @param {BeforeOpenCloseMenuEventArgs} args - Specify the args.\n     * @returns {void} - Before open event handler.\n     */\n    ContextMenu.prototype.beforeOpenHandler = function (args) {\n        var trgt = args.event.target;\n        var target = this.getTarget(trgt);\n        var items;\n        if (args.element.classList.contains('e-contextmenu')) {\n            if (args.event.target && (trgt.classList.contains('e-rowresize') || trgt.classList.contains('e-colresize'))) {\n                var sheet = this.parent.getActiveSheet();\n                var range = getRangeIndexes(sheet.selectedRange);\n                if (!(trgt.classList.contains('e-rowresize') ? range[1] === 0 && range[3] === sheet.colCount - 1 :\n                    range[0] === 0 && range[2] === sheet.rowCount - 1)) {\n                    args.cancel = true;\n                    return;\n                }\n                if (trgt.classList.contains('e-rowresize') ? this.parent.hiddenCount(range[0], range[2]) !== Math.abs(range[2] - range[0]) +\n                    1 : this.parent.hiddenCount(range[1], range[3], 'columns') !== Math.abs(range[3] - range[1]) + 1) {\n                    items = this.getDataSource(target);\n                }\n                else {\n                    items = this.getDataSource(target, trgt);\n                }\n            }\n            else {\n                items = this.getDataSource(target);\n            }\n            this.contextMenuInstance.items = items;\n            this.contextMenuInstance.dataBind();\n        }\n        else {\n            items = args.items;\n        }\n        if (target === 'ColumnHeader' || target === 'RowHeader') {\n            if (args.element && args.element.childElementCount > 0) {\n                var insertEle = target === 'ColumnHeader' ? args.element.querySelector('#' + this.parent.element.id + '_cmenu_insert_column') :\n                    args.element.querySelector('#' + this.parent.element.id + '_cmenu_insert_row');\n                var deleteEle = target ===\n                    'ColumnHeader' ? args.element.querySelector('#' + this.parent.element.id + '_cmenu_delete_column') :\n                    args.element.querySelector('#' + this.parent.element.id + '_cmenu_delete_row');\n                if (this.parent.allowInsert && insertEle.classList.contains('e-disabled')) {\n                    insertEle.classList.remove('e-disabled');\n                }\n                else if (!this.parent.allowInsert && !insertEle.classList.contains('e-disabled')) {\n                    insertEle.classList.add('e-disabled');\n                }\n                if (this.parent.allowDelete && deleteEle.classList.contains('e-disabled')) {\n                    deleteEle.classList.remove('e-disabled');\n                }\n                else if (!this.parent.allowDelete && !deleteEle.classList.contains('e-disabled')) {\n                    deleteEle.classList.add('e-disabled');\n                }\n            }\n        }\n        else if (target === 'Footer') {\n            var sheetIdx = getSheetIndex(this.parent, trgt.textContent);\n            if (sheetIdx === 0) {\n                args.element.querySelector('#' + this.parent.element.id + '_cmenu_move_left').classList.add('e-disabled');\n            }\n            if (sheetIdx === this.parent.sheets.length - 1) {\n                args.element.querySelector('#' + this.parent.element.id + '_cmenu_move_right').classList.add('e-disabled');\n            }\n        }\n        this.parent.trigger('contextMenuBeforeOpen', args);\n        this.parent.notify(cMenuBeforeOpen, extend(args, { target: target, items: items }));\n    };\n    /**\n     * To get target area based on right click.\n     *\n     * @param {Element} target - Specify the target\n     * @returns {string} - To get target area based on right click.\n     */\n    ContextMenu.prototype.getTarget = function (target) {\n        if (closest(target, '.e-sheet-content')) {\n            return 'Content';\n        }\n        else if (closest(target, '.e-column-header')) {\n            return target.classList.contains('e-header-cell') ? 'ColumnHeader' : 'Content';\n        }\n        else if (closest(target, '.e-row-header')) {\n            return target.classList.contains('e-header-cell') ? 'RowHeader' : 'Content';\n        }\n        else if (closest(target, '.e-sheet-tabs-items')) {\n            return 'Footer';\n        }\n        else if (closest(target, '.e-selectall-container')) {\n            if (target.classList.contains('e-header-cell')) {\n                return closest(target, '.e-header-row') ? 'ColumnHeader' : 'RowHeader';\n            }\n            return closest(target, '.e-select-all-cell') ? 'SelectAll' : 'Content';\n        }\n        else {\n            return '';\n        }\n    };\n    /**\n     * To populate context menu items based on target area.\n     *\n     * @param {string} target - Specify the target\n     * @returns {MenuItemModel[]} - To populate context menu items based on target area.\n     */\n    ContextMenu.prototype.getDataSource = function (target, targetEle) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var items = [];\n        var id = this.parent.element.id + '_cmenu';\n        if (target === 'Content') {\n            this.setClipboardData(items, l10n, id);\n            items.push({ separator: true });\n            //push filter and sort items here\n            this.setFilterItems(items, id);\n            this.setSortItems(items, id);\n            items.push({ separator: true });\n            this.setHyperLink(items, id);\n        }\n        else if (target === 'RowHeader') {\n            this.setClipboardData(items, l10n, id);\n            var sheet = this.parent.getActiveSheet();\n            var indexes = getRangeIndexes(sheet.selectedRange);\n            this.setInsertDeleteItems(items, l10n, 'Row', id, [indexes[0], indexes[2]], ['Above', 'Below']);\n            if (!sheet.frozenRows && !sheet.frozenColumns && (!targetEle || !targetEle.parentElement ||\n                !targetEle.parentElement.classList.value.includes('e-hide'))) {\n                this.setHideShowItems(items, l10n, 'Row', id, [indexes[0], indexes[2]]);\n            }\n        }\n        else if (target === 'ColumnHeader') {\n            this.setClipboardData(items, l10n, id);\n            var sheet = this.parent.getActiveSheet();\n            var indexes = getRangeIndexes(sheet.selectedRange);\n            this.setInsertDeleteItems(items, l10n, 'Column', id, [indexes[1], indexes[3]], ['Before', 'After']);\n            if (!sheet.frozenRows && !sheet.frozenColumns && (!targetEle || !targetEle.classList.value.includes('e-hide'))) {\n                this.setHideShowItems(items, l10n, 'Column', id, [indexes[1], indexes[3]]);\n            }\n        }\n        else if (target === 'SelectAll') {\n            this.setClipboardData(items, l10n, id);\n            this.setFilterItems(items, id);\n            this.setSortItems(items, id);\n        }\n        else if (target === 'Footer') {\n            items.push({\n                text: l10n.getConstant('Insert'), id: id + '_insert_sheet'\n            });\n            items.push({\n                text: l10n.getConstant('Delete'), iconCss: 'e-icons e-delete', id: id + '_delete_sheet'\n            });\n            items.push({\n                text: l10n.getConstant('DuplicateSheet'), id: id + '_duplicate'\n            });\n            items.push({\n                text: l10n.getConstant('Rename'), id: id + '_rename'\n            });\n            items.push({\n                text: l10n.getConstant('Hide'), id: id + '_hide_sheet'\n            });\n            this.setProtectSheetItems(items, id);\n            items.push({\n                text: l10n.getConstant('MoveRight'), id: id + '_move_right'\n            });\n            items.push({\n                text: l10n.getConstant('MoveLeft'), id: id + '_move_left'\n            });\n        }\n        return items;\n    };\n    ContextMenu.prototype.setProtectSheetItems = function (items, id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.parent.getActiveSheet().isProtected) {\n            items.push({\n                text: l10n.getConstant('UnprotectSheet'), id: id + '_protect', iconCss: 'e-icons e-protect-icon'\n            });\n        }\n        else {\n            items.push({\n                text: l10n.getConstant('ProtectSheet'), id: id + '_protect', iconCss: 'e-icons e-protect-icon'\n            });\n        }\n    };\n    /**\n     * Sets sorting related items to the context menu.\n     *\n     * @param {MenuItemModel[]} items - Specifies the item\n     * @param {string} id - Specify the id.\n     * @returns {void} - Sets sorting related items to the context menu.\n     */\n    ContextMenu.prototype.setFilterItems = function (items, id) {\n        if (this.parent.allowFiltering) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            var args = { clearFilterText: null, isFiltered: false };\n            this.parent.notify(getFilteredColumn, args);\n            items.push({\n                text: l10n.getConstant('Filter'), id: id + '_filter',\n                iconCss: '',\n                items: [\n                    { text: args.clearFilterText, iconCss: 'e-icons e-filter-clear', id: id + '_clearfilter' },\n                    { text: l10n.getConstant('ReapplyFilter'), iconCss: 'e-icons e-filter-reapply', id: id + '_reapplyfilter' },\n                    { separator: true },\n                    { text: l10n.getConstant('FilterCellValue'), iconCss: '', id: id + '_filtercellvalue' }\n                ]\n            });\n        }\n    };\n    /**\n     * Sets sorting related items to the context menu.\n     *\n     * @param {MenuItemModel[]} items - Specifies the item\n     * @param {string} id - Specify the id.\n     * @returns {void} - Sets sorting related items to the context menu.\n     */\n    ContextMenu.prototype.setSortItems = function (items, id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.parent.allowSorting) {\n            items.push({\n                text: l10n.getConstant('Sort'), id: id + '_sort',\n                iconCss: 'e-icons e-sort-icon',\n                items: [\n                    { text: l10n.getConstant('SortAscending'), iconCss: 'e-icons e-sort-asc', id: id + '_ascending' },\n                    { text: l10n.getConstant('SortDescending'), iconCss: 'e-icons e-sort-desc', id: id + '_descending' },\n                    { text: l10n.getConstant('CustomSort') + '...', iconCss: 'e-icons e-sort-custom', id: id + '_customsort' }\n                ]\n            });\n        }\n    };\n    ContextMenu.prototype.setHyperLink = function (items, id) {\n        var sheet = this.parent.getActiveSheet();\n        if (this.parent.allowHyperlink) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            if ((!document.activeElement.getElementsByClassName('e-hyperlink')[0] &&\n                !document.activeElement.classList.contains('e-hyperlink')) || (sheet.isProtected && !sheet.protectSettings.insertLink)) {\n                items.push({\n                    text: l10n.getConstant('Hyperlink'), iconCss: 'e-icons e-hyperlink-icon', id: id + '_hyperlink'\n                });\n            }\n            else {\n                items.push({ text: l10n.getConstant('EditHyperlink'), iconCss: 'e-icons e-edithyperlink-icon', id: id + '_editHyperlink' }, { text: l10n.getConstant('OpenHyperlink'), iconCss: 'e-icons e-openhyperlink-icon', id: id + '_openHyperlink' }, { text: l10n.getConstant('RemoveHyperlink'), iconCss: 'e-icons e-removehyperlink-icon', id: id + '_removeHyperlink' });\n            }\n        }\n    };\n    ContextMenu.prototype.setClipboardData = function (items, l10n, id) {\n        if (this.parent.enableClipboard) {\n            items.push({\n                text: l10n.getConstant('Cut'),\n                iconCss: 'e-icons e-cut-icon', id: id + '_cut'\n            });\n            items.push({\n                text: l10n.getConstant('Copy'),\n                iconCss: 'e-icons e-copy-icon', id: id + '_copy'\n            });\n            items.push({\n                text: l10n.getConstant('Paste'),\n                iconCss: 'e-icons e-paste-icon', id: id + '_paste'\n            });\n            items.push({\n                text: l10n.getConstant('PasteSpecial'), id: id + '_pastespecial',\n                items: [\n                    { text: l10n.getConstant('Values'), id: id + '_pastevalues' },\n                    { text: l10n.getConstant('Formats'), id: id + '_pasteformats' }\n                ]\n            });\n        }\n    };\n    ContextMenu.prototype.setInsertDeleteItems = function (items, l10n, layout, id, indexes, subItems) {\n        items.push({ separator: true });\n        ['Insert', 'Delete'].forEach(function (action) {\n            if (indexes[0] === indexes[1]) {\n                items.push({ text: l10n.getConstant(\"\" + action + layout), id: id + (\"_\" + action.toLowerCase() + \"_\" + layout.toLowerCase()) });\n            }\n            else {\n                items.push({ text: l10n.getConstant(\"\" + action + layout + \"s\"), id: id + (\"_\" + action.toLowerCase() + \"_\" + layout.toLowerCase()) });\n            }\n            if (action === 'Insert') {\n                items[items.length - 1].items = [];\n                subItems.forEach(function (item) {\n                    items[items.length - 1].items.push({\n                        text: l10n.getConstant(item), id: items[items.length - 1].id + \"_\" + item.toLowerCase()\n                    });\n                });\n            }\n        });\n    };\n    ContextMenu.prototype.setHideShowItems = function (items, l10n, layout, id, indexes) {\n        if (indexes[0] === indexes[1]) {\n            items.push({ text: l10n.getConstant(\"Hide\" + layout), id: id + (\"_hide_\" + layout.toLowerCase()) });\n        }\n        else {\n            var StartIdx = indexes[0];\n            indexes[0] = indexes[0] > indexes[1] ? indexes[1] : indexes[0];\n            indexes[1] = indexes[1] > StartIdx ? indexes[1] : StartIdx;\n            items.push({ text: l10n.getConstant(\"Hide\" + layout + \"s\"), id: id + (\"_hide_\" + layout.toLowerCase()) });\n        }\n        if (this.parent.hiddenCount(indexes[0], indexes[1], layout.toLowerCase() + \"s\")) {\n            items.push({ text: l10n.getConstant(\"UnHide\" + layout + \"s\"), id: id + (\"_unhide_\" + layout.toLowerCase()) });\n        }\n    };\n    /**\n     * To add event listener.\n     *\n     * @returns {void} - To add event listener.\n     */\n    ContextMenu.prototype.addEventListener = function () {\n        this.parent.on(addContextMenuItems, this.addItemsHandler, this);\n        this.parent.on(removeContextMenuItems, this.removeItemsHandler, this);\n        this.parent.on(enableContextMenuItems, this.enableItemsHandler, this);\n    };\n    /**\n     * To add context menu items before / after particular item.\n     *\n     * @param {InsertArgs} args - Specify the add item handler\n     * @returns {void} - To add context menu items before / after particular item.\n     */\n    ContextMenu.prototype.addItemsHandler = function (args) {\n        if (args.insertAfter) {\n            this.contextMenuInstance.insertAfter(args.items, args.text, args.isUniqueId);\n        }\n        else {\n            this.contextMenuInstance.insertBefore(args.items, args.text, args.isUniqueId);\n        }\n    };\n    /**\n     * To remove context menu items.\n     *\n     * @param {RemoveArgs} args - Specifies the args\n     * @returns {void} - To remove context menu items.\n     */\n    ContextMenu.prototype.removeItemsHandler = function (args) {\n        this.contextMenuInstance.removeItems(args.items, args.isUniqueId);\n    };\n    /**\n     * To enable / disable context menu items.\n     *\n     * @param {EnableDisableArgs} args - Specifies the args\n     * @returns {void} - To enable / disable context menu items.\n     */\n    ContextMenu.prototype.enableItemsHandler = function (args) {\n        this.contextMenuInstance.enableItems(args.items, args.enable, args.isUniqueId);\n    };\n    /**\n     * To remove event listener.\n     *\n     * @returns {void} - To remove event listener.\n     */\n    ContextMenu.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(addContextMenuItems, this.addItemsHandler);\n            this.parent.off(removeContextMenuItems, this.removeItemsHandler);\n            this.parent.off(enableContextMenuItems, this.enableItemsHandler);\n        }\n    };\n    /**\n     * To get module name.\n     *\n     * @returns {string} - To get module name.\n     */\n    ContextMenu.prototype.getModuleName = function () {\n        return 'contextMenu';\n    };\n    /**\n     * Destroy method.\n     *\n     * @returns {void} - Destroy method.\n     */\n    ContextMenu.prototype.destroy = function () {\n        this.removeEventListener();\n        this.contextMenuInstance.destroy();\n        var ele = document.getElementById(this.parent.element.id + '_contextmenu');\n        if (ele) {\n            detach(ele);\n        }\n        this.parent = null;\n    };\n    return ContextMenu;\n}());\nexport { ContextMenu };\n","import { refreshCellElement } from '../../workbook/common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Specifies number format.\n */\nvar NumberFormat = /** @class */ (function () {\n    function NumberFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookNumberFormat);\n    }\n    NumberFormat.prototype.refreshCellElement = function (args) {\n        var cell = this.parent.getCell(args.rowIndex, args.colIndex);\n        if (!isNullOrUndefined(cell)) {\n            this.parent.refreshNode(cell, args);\n        }\n    };\n    /**\n     * Adding event listener for number format.\n     *\n     * @hidden\n     * @returns {void} - Adding event listener for number format.\n     */\n    NumberFormat.prototype.addEventListener = function () {\n        this.parent.on(refreshCellElement, this.refreshCellElement, this);\n    };\n    /**\n     * Removing event listener for number format.\n     *\n     * @hidden\n     * @returns {void} - Removing event listener for number format.\n     */\n    NumberFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(refreshCellElement, this.refreshCellElement);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     *\n     * @returns {void} - To Remove the event listeners.\n     */\n    NumberFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook import module name.\n     *\n     * @returns {string} - Get the workbook import module name.\n     */\n    NumberFormat.prototype.getModuleName = function () {\n        return 'numberFormat';\n    };\n    return NumberFormat;\n}());\nexport { NumberFormat };\n","import { initiateCustomSort, locale, dialog, getFilterRange } from '../index';\nimport { applySort, completeAction, beginAction, focus } from '../index';\nimport { sortComplete, beforeSort, getFormattedCellObject, sortImport, workbookFormulaOperation } from '../../workbook/common/event';\nimport { getIndexesFromAddress, getSwapRange, getCell, inRange } from '../../workbook/index';\nimport { getColumnHeaderText, getRangeAddress } from '../../workbook/index';\nimport { getUniqueID, getComponent, enableRipple } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { RadioButton, CheckBox } from '@syncfusion/ej2-buttons';\nimport { ListView } from '@syncfusion/ej2-lists';\n/**\n * `Sort` module is used to handle the sort action in Spreadsheet.\n */\nvar Sort = /** @class */ (function () {\n    /**\n     * Constructor for sort module.\n     *\n     * @param {Spreadsheet} parent - Specifies the Spreadsheet instance.\n     */\n    function Sort(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     *\n     * @returns {void}\n     */\n    Sort.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Sort.prototype.addEventListener = function () {\n        this.parent.on(applySort, this.applySortHandler, this);\n        this.parent.on(sortComplete, this.sortCompleteHandler, this);\n        this.parent.on(initiateCustomSort, this.initiateCustomSortHandler, this);\n        this.parent.on(sortImport, this.sortImport, this);\n    };\n    Sort.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applySort, this.applySortHandler);\n            this.parent.off(sortComplete, this.sortCompleteHandler);\n            this.parent.off(initiateCustomSort, this.initiateCustomSortHandler);\n            this.parent.off(sortImport, this.sortImport);\n        }\n    };\n    /**\n     * Gets the module name.\n     *\n     * @returns {string} - Gets the module name.\n     */\n    Sort.prototype.getModuleName = function () {\n        return 'sort';\n    };\n    /**\n     * Validates the range and returns false when invalid.\n     *\n     * @returns {boolean} - Validates the range and returns false when invalid.\n     */\n    Sort.prototype.isValidSortRange = function () {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * sort while importing.\n     *\n     * @param {any} args - Specifies the args\n     * @param {number} args.sheetIdx - Specifies the sheet index\n     * @returns {void}\n     */\n    Sort.prototype.sortImport = function (args) {\n        var sort = this.parent.sortCollection;\n        var cell;\n        var rowId = this.parent.getActiveSheet().usedRange.rowIndex - 1;\n        var sheetIdx = args ? args.sheetIdx : this.parent.activeSheetIndex;\n        for (var j = 0; j < sort.length; j++) {\n            if (sort[j].sheetIndex === sheetIdx) {\n                for (var i = 0; i < rowId; i++) {\n                    cell = this.parent.getCell(i, sort[j].columnIndex);\n                    if (cell && cell.querySelector('.e-filter-icon')) {\n                        if (sort[j].order === 'Ascending' || sort[j].order === 'OnTop') {\n                            if (!cell.querySelector('.e-filter-icon').classList.contains('e-sortasc-filter')) {\n                                cell.querySelector('.e-filter-icon').classList.add('e-sortasc-filter');\n                            }\n                        }\n                        else {\n                            if (!cell.querySelector('.e-filter-icon').classList.contains('e-sortdesc-filter')) {\n                                cell.querySelector('.e-filter-icon').classList.add('e-sortdesc-filter');\n                            }\n                        }\n                        return;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Shows the range error alert dialog.\n     *\n     * @param {object} args - specify the args\n     * @param {string} args.error - range error string.\n     * @returns {void}\n     */\n    Sort.prototype.sortRangeAlertHandler = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            height: 180, width: 400, isModal: true, showCloseIcon: true,\n            content: args.error,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'SortRangeDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            }\n        });\n        this.parent.hideSpinner();\n    };\n    /**\n     * Initiates the custom sort dialog.\n     *\n     * @returns {void}\n     */\n    Sort.prototype.initiateCustomSortHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.isValidSortRange()) {\n            this.sortRangeAlertHandler({ error: l10n.getConstant('SortOutOfRangeError') });\n            return;\n        }\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            height: 400, width: 560, isModal: true, showCloseIcon: true, cssClass: 'e-customsort-dlg',\n            header: l10n.getConstant('CustomSort'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'CustomSortDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                dialogInst.dialogInstance.content = _this.customSortContent();\n                dialogInst.dialogInstance.dataBind();\n                focus(_this.parent.element);\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'), isPrimary: true\n                    },\n                    click: function () {\n                        var element = dialogInst.dialogInstance.content;\n                        var list = element.getElementsByClassName('e-list-sort e-listview e-lib')[0];\n                        var listview = getComponent(list, 'listview');\n                        var data = listview.dataSource;\n                        _this.clearError();\n                        var errorElem = element.getElementsByClassName('e-sort-error')[0];\n                        errorElem.style.display = 'block';\n                        if (!_this.validateError(data, element, errorElem)) {\n                            dialogInst.hide();\n                            var headercheck = element.getElementsByClassName('e-sort-checkheader')[0];\n                            var headerCheckbox = getComponent(headercheck, 'checkbox');\n                            var caseCheckbox = getComponent(element.getElementsByClassName('e-sort-checkcase')[0], 'checkbox');\n                            var hasHeader = headerCheckbox.checked;\n                            _this.applySortHandler({ sortOptions: { sortDescriptors: data, containsHeader: hasHeader, caseSensitive: caseCheckbox.checked } });\n                        }\n                    }\n                }]\n        });\n    };\n    /**\n     * Validates the errors of the sort criteria and displays the error.\n     *\n     * @param {Object} json - listview datasource.\n     * @param {HTMLElement} dialogElem - dialog content element.\n     * @param {HTMLElement} errorElem - element to display error.\n     * @returns {boolean} - Return boolean value.\n     */\n    Sort.prototype.validateError = function (json, dialogElem, errorElem) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var hasEmpty = json.some(function (element) { return element.field.toString() === ''; });\n        if (hasEmpty) {\n            Array.prototype.some.call(dialogElem.getElementsByClassName('e-sort-field'), function (dropDown) {\n                var hasError = !getComponent(dropDown, 'dropdownlist').value;\n                if (hasError) {\n                    dropDown.parentElement.classList.add('e-error');\n                }\n                return hasError; //breaks the loop if only one error added.\n            });\n            errorElem.innerText = l10n.getConstant('SortEmptyFieldError');\n            return true;\n        }\n        var temp = new Set();\n        var duplicateField = '';\n        var hasDuplicate = json.some(function (element) {\n            duplicateField = element.field.toString();\n            return temp.size === temp.add(element.field).size;\n        });\n        var errorField = '';\n        if (hasDuplicate) {\n            var count_1 = 0;\n            Array.prototype.some.call(dialogElem.getElementsByClassName('e-sort-field'), function (dropDown) {\n                var dropDownList = getComponent(dropDown, 'dropdownlist');\n                if (dropDownList.value === duplicateField) {\n                    dropDown.parentElement.classList.add('e-error');\n                    errorField = dropDownList.text;\n                    count_1++;\n                }\n                return count_1 === 2; //breaks the loop when 2 errors added.\n            });\n            errorElem.innerHTML = '<strong>' + errorField + '</strong>' + l10n.getConstant('SortDuplicateFieldError');\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Creates all the elements and generates the dialog content element.\n     *\n     * @returns {HTMLElement} - Returns the dialog element.\n     */\n    Sort.prototype.customSortContent = function () {\n        var dialogElem = this.parent.createElement('div', { className: 'e-sort-dialog' });\n        var fields = this.getFields();\n        var listId = getUniqueID('customSort');\n        var listviewObj = this.getCustomListview(listId);\n        this.setHeaderTab(dialogElem, listviewObj, fields);\n        var contentElem = this.parent.createElement('div', {\n            className: 'e-sort-listsection',\n            styles: ''\n        });\n        dialogElem.appendChild(contentElem);\n        var listview = this.parent.createElement('div', { className: 'e-list-sort', styles: '' });\n        contentElem.appendChild(listview);\n        listviewObj.createElement = this.parent.createElement;\n        listviewObj.appendTo(listview);\n        this.renderListItem(listId, listviewObj, true, fields);\n        var errorElem = this.parent.createElement('div', { className: 'e-sort-error' });\n        dialogElem.appendChild(errorElem);\n        return dialogElem;\n    };\n    /**\n     * Gets the fields data from the selected range.\n     *\n     * @returns {Object} - Gets the fields data from the selected range.\n     */\n    Sort.prototype.getFields = function () {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        if (range[0] === range[2] && (range[2] - range[0]) === 0) { //for entire range\n            range[0] = 0;\n            range[1] = 0;\n            range[3] = sheet.usedRange.colIndex;\n            var args = { filterRange: [], hasFilter: false };\n            this.parent.notify(getFilterRange, args);\n            if (args.hasFilter && args.filterRange) {\n                range[0] = args.filterRange[0];\n            }\n        }\n        var fields = [];\n        var fieldName;\n        for (range[1]; range[1] <= range[3]; range[1]++) {\n            var cell = getCell(range[0], range[1], sheet);\n            if (cell && cell.value) {\n                var eventArgs = {\n                    formattedText: cell.value,\n                    value: cell.value,\n                    format: cell.format,\n                    onLoad: true\n                };\n                if (cell.format) {\n                    this.parent.notify(getFormattedCellObject, eventArgs);\n                }\n                fieldName = eventArgs.formattedText;\n            }\n            else {\n                fieldName = 'Column ' + getColumnHeaderText(range[1] + 1);\n            }\n            fields.push({ text: fieldName, value: 'Column ' + getColumnHeaderText(range[1] + 1) });\n        }\n        return fields;\n    };\n    /**\n     * Creates the header tab for the custom sort dialog.\n     *\n     * @param {HTMLElement} dialogElem - dialog content element.\n     * @param {ListView} listviewObj - listview instance.\n     * @param {Object} fields - fields data.\n     * @returns {void} - set header tab.\n     */\n    Sort.prototype.setHeaderTab = function (dialogElem, listviewObj, fields) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var headerTabElement = this.parent.createElement('div', {\n            className: 'e-sort-header',\n            styles: '',\n            innerHTML: ''\n        });\n        dialogElem.appendChild(headerTabElement);\n        var addButton = this.parent.createElement('button', {\n            className: 'e-btn e-sort-addbtn e-flat',\n            innerHTML: l10n.getConstant('AddColumn')\n        });\n        var footer = this.parent.element.querySelector('.e-customsort-dlg .e-footer-content');\n        footer.insertBefore(addButton, footer.firstElementChild);\n        addButton.addEventListener('click', function () {\n            if (listviewObj) {\n                var listId = getUniqueID('customSort');\n                listviewObj.addItem([{ id: listId, text: l10n.getConstant('ThenBy'), field: '', order: 'ascending' }]);\n                _this.renderListItem(listId, listviewObj, checkHeaderObj.checked, fields, true);\n            }\n        });\n        var checkHeaderObj = new CheckBox({\n            label: l10n.getConstant('ContainsHeader'),\n            checked: true,\n            change: function (args) {\n                var fieldsMap = args.checked ? { text: 'text', value: 'value' } : { text: 'value' };\n                Array.prototype.forEach.call(dialogElem.getElementsByClassName('e-sort-field e-dropdownlist e-lib'), function (dropDown) {\n                    var dropDownListObj = getComponent(dropDown, 'dropdownlist');\n                    dropDownListObj.dataSource = null; //reset datasource.\n                    dropDownListObj.dataSource = fields;\n                    dropDownListObj.fields = fieldsMap;\n                    dropDownListObj.dataBind();\n                });\n            },\n            cssClass: 'e-sort-headercheckbox'\n        });\n        var headerCheckbox = this.parent.createElement('input', {\n            className: 'e-sort-checkheader', attrs: { type: 'checkbox' }\n        });\n        headerTabElement.appendChild(headerCheckbox);\n        checkHeaderObj.createElement = this.parent.createElement;\n        checkHeaderObj.appendTo(headerCheckbox);\n        var checkCaseObj = new CheckBox({\n            label: l10n.getConstant('CaseSensitive'),\n            checked: false,\n            cssClass: 'e-sort-casecheckbox'\n        });\n        var caseCheckbox = this.parent.createElement('input', {\n            className: 'e-sort-checkcase', attrs: { type: 'checkbox' }\n        });\n        headerTabElement.appendChild(caseCheckbox);\n        checkCaseObj.createElement = this.parent.createElement;\n        checkCaseObj.appendTo(caseCheckbox);\n    };\n    /**\n     * Creates a listview instance.\n     *\n     * @param {string} listId - unique id of the list item.\n     * @returns {void}\n     */\n    Sort.prototype.getCustomListview = function (listId) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var data = [{ id: listId, text: l10n.getConstant('SortBy'), field: '', order: 'ascending' }];\n        enableRipple(false);\n        var listviewObj = new ListView({\n            dataSource: data,\n            fields: { id: 'id' },\n            height: '100%',\n            template: '<div class=\"e-sort-listwrapper\">' +\n                '<span class=\"text\">${text}</span>' +\n                '<div class=\"e-sort-row\"><div class=\"e-sort-field\"></div>' +\n                '<div class=\"e-sort-order\">' +\n                '<span class=\"e-sort-ordertxt\" style=\"display:none;\">${order}</span></div>' +\n                '<span class=\"e-icons e-sort-delete\"></span></div>',\n            cssClass: 'e-sort-template'\n        });\n        return listviewObj;\n    };\n    /**\n     * Triggers the click event for delete icon.\n     *\n     * @param {Element} element - current list item element.\n     * @param {ListView} listviewObj - listview instance.\n     * @returns {void}\n     */\n    Sort.prototype.deleteHandler = function (element, listviewObj) {\n        var iconEle = element.getElementsByClassName('e-sort-delete')[0];\n        //Event handler to bind the click event for delete icon\n        iconEle.addEventListener('click', function () {\n            if (element) {\n                listviewObj.removeItem(element);\n            }\n        });\n    };\n    /**\n     * Renders the dropdown and radio button components inside list item.\n     *\n     * @param {string} id - unique id of the list item.\n     * @param {ListView} lvObj - listview instance.\n     * @param {boolean} containsHeader - data contains header.\n     * @param {string} fields - fields data.\n     * @param {boolean} btn - boolean value.\n     * @returns {void}\n     */\n    Sort.prototype.renderListItem = function (id, lvObj, containsHeader, fields, btn) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var element = lvObj.element.querySelector('li[data-uid=' + id + ']');\n        var fieldsMap = containsHeader ? { text: 'text', value: 'value' } : { text: 'value' };\n        var dropDown = element.getElementsByClassName('e-sort-field')[0];\n        var dropDownListObj = new DropDownList({\n            dataSource: fields,\n            width: 'auto',\n            cssClass: 'e-sort-field-ddl',\n            fields: fieldsMap,\n            placeholder: l10n.getConstant('SelectAColumn'),\n            change: function (args) {\n                if (!args.value) {\n                    return;\n                }\n                Array.prototype.some.call(lvObj.dataSource, function (item) {\n                    if (item.id === id) {\n                        item.field = args.value.toString().replace('Column ', '');\n                    }\n                    return item.id === id; //breaks the loop when proper id found\n                });\n                _this.clearError();\n            }\n        });\n        dropDownListObj.createElement = this.parent.createElement;\n        dropDownListObj.appendTo(dropDown);\n        if (!btn) {\n            dropDownListObj.index = 0;\n        }\n        /* sort ascending radio button */\n        var orderRadio = element.getElementsByClassName('e-sort-order')[0];\n        var ordertxtElem = orderRadio.getElementsByClassName('e-sort-ordertxt')[0];\n        var isAscending = ordertxtElem.innerText.toLocaleLowerCase() === 'ascending';\n        var radiobutton = new RadioButton({\n            label: l10n.getConstant('SortAscending'),\n            name: 'sortAZ_' + id, value: 'ascending', checked: isAscending, cssClass: 'e-sort-radiobutton',\n            change: function (args) { _this.setRadioBtnValue(lvObj, id, args.value); }\n        });\n        var radio = this.parent.createElement('input', {\n            id: 'orderAsc_' + id, className: 'e-sort-radioasc', styles: '', attrs: { type: 'radio' }\n        });\n        orderRadio.appendChild(radio);\n        radiobutton.createElement = this.parent.createElement;\n        radiobutton.appendTo(radio);\n        /* sort descending radio button */\n        var radiobutton2 = new RadioButton({\n            label: l10n.getConstant('SortDescending'),\n            name: 'sortAZ_' + id, value: 'descending', checked: !isAscending, cssClass: 'e-sort-radiobutton',\n            change: function (args) { _this.setRadioBtnValue(lvObj, id, args.value); }\n        });\n        var radio2 = this.parent.createElement('input', {\n            id: 'orderDesc_' + id, className: 'e-sort-radiodesc', styles: '', attrs: { type: 'radio' }\n        });\n        orderRadio.appendChild(radio2);\n        radiobutton2.createElement = this.parent.createElement;\n        radiobutton2.appendTo(radio2);\n        this.deleteHandler(element, lvObj);\n    };\n    /**\n     * Sets the new value of the radio button.\n     *\n     * @param {ListView} listviewObj - listview instance.\n     * @param {string} id - unique id of the list item.\n     * @param {string} value - new value.\n     * @returns {void}\n     */\n    Sort.prototype.setRadioBtnValue = function (listviewObj, id, value) {\n        if (!value) {\n            return;\n        }\n        Array.prototype.some.call(listviewObj.dataSource, function (item) {\n            if (item.id === id) {\n                item.order = value;\n            }\n            return item.id === id; //breaks the loop when proper id found\n        });\n    };\n    /**\n     *\n     * Clears the error from the dialog.\n     *\n     * @returns {void}\n     */\n    Sort.prototype.clearError = function () {\n        var dialogElem = document.getElementsByClassName('e-sort-dialog')[0];\n        var errorElem = dialogElem.getElementsByClassName('e-sort-error')[0];\n        if (errorElem.style.display !== 'none' && errorElem.innerHTML !== '') {\n            errorElem.style.display = 'none';\n            Array.prototype.forEach.call(dialogElem.getElementsByClassName('e-error'), function (element) {\n                element.classList.remove('e-error');\n            });\n        }\n    };\n    /**\n     * Triggers sort events and applies sorting.\n     *\n     * @param {Object} args - Specifies the args.\n     * @param {SortOptions} args.sortOptions - Specifies the sort options.\n     * @param {string} args.range - Specifies the range.\n     * @returns {void}\n     */\n    Sort.prototype.applySortHandler = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var address = args && args.range || sheet.selectedRange;\n        var sortOptions = args && args.sortOptions || { sortDescriptors: {} };\n        var beforeArgs = { range: address, sortOptions: sortOptions, cancel: false };\n        this.parent.trigger(beforeSort, beforeArgs);\n        if (beforeArgs.cancel) {\n            return;\n        }\n        this.parent.notify(beginAction, { eventArgs: beforeArgs, action: 'beforeSort' });\n        this.parent.showSpinner();\n        var range = getSwapRange(getIndexesFromAddress(beforeArgs.range));\n        var eventArgs = { filterRange: [], hasFilter: false };\n        if (range[0] === range[2] && (range[2] - range[0]) === 0) { //check for filter range\n            this.parent.notify(getFilterRange, eventArgs);\n            if (eventArgs.hasFilter && inRange(eventArgs.filterRange, range[0], range[1])) {\n                range[0] = eventArgs.filterRange[0];\n                range[1] = 0;\n                range[2] = sheet.usedRange.rowIndex;\n                range[3] = sheet.usedRange.colIndex;\n                beforeArgs.sortOptions.containsHeader = true;\n            }\n        }\n        this.parent.sort(beforeArgs.sortOptions, getRangeAddress(range)).then(function (sortArgs) {\n            _this.parent.trigger(sortComplete, sortArgs);\n            _this.parent.notify(completeAction, { eventArgs: sortArgs, action: 'sorting' });\n            return Promise.resolve(sortArgs);\n        }).catch(function (error) {\n            _this.sortRangeAlertHandler({ error: error });\n            return Promise.reject(error);\n        });\n    };\n    /**\n     *\n     * Invoked when the sort action is completed.\n     *\n     * @param {SortEventArgs} args - Specifies the range and sort options.\n     * @returns {void}\n     */\n    Sort.prototype.sortCompleteHandler = function (args) {\n        var range = getIndexesFromAddress(args.range);\n        for (var i = range[0]; i <= range[2]; i++) {\n            for (var j = range[1]; j <= range[3]; j++) {\n                this.parent.notify(workbookFormulaOperation, { action: 'refreshCalculate', rowIndex: i, colIndex: j });\n            }\n        }\n        this.parent.serviceLocator.getService('cell').refreshRange(range, true);\n        this.parent.hideSpinner();\n    };\n    return Sort;\n}());\nexport { Sort };\n","/* eslint-disable no-useless-escape */\nimport { locale, dialog, mouseDown, renderFilterCell, initiateFilterUI, getStartEvent } from '../index';\nimport { reapplyFilter, filterCellKeyDown } from '../index';\nimport { getFilteredColumn, cMenuBeforeOpen, filterByCellValue, clearFilter, getFilterRange, applySort, getCellPosition } from '../index';\nimport { filterRangeAlert, clearAllFilter, getFilteredCollection, beforeDelete, sheetsDestroyed } from '../../workbook/common/event';\nimport { getRangeIndexes, getCellAddress, updateFilter, beforeInsert } from '../../workbook/index';\nimport { getIndexesFromAddress, getSwapRange, getColumnHeaderText, getDataRange } from '../../workbook/index';\nimport { getData, getTypeFromFormat, getCell, getCellIndexes, getRangeAddress, getSheet, inRange } from '../../workbook/index';\nimport { sortImport, clear, getColIndex } from '../../workbook/index';\nimport { getComponent, EventHandler, isUndefined, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { ExcelFilterBase, beforeFltrcMenuOpen, CheckBoxFilterBase } from '@syncfusion/ej2-grids';\nimport { filterCmenuSelect, parentsUntil, filterCboxValue, filterDialogCreated, filterDialogClose } from '@syncfusion/ej2-grids';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { Query, DataManager } from '@syncfusion/ej2-data';\nimport { beginAction, completeAction, contentLoaded } from '../../spreadsheet/index';\n/**\n * `Filter` module is used to handle the filter action in Spreadsheet.\n */\nvar Filter = /** @class */ (function () {\n    /**\n     * Constructor for filter module.\n     *\n     * @param {Spreadsheet} parent - Specifies the Spreadsheet.\n     */\n    function Filter(parent) {\n        this.parent = parent;\n        this.filterCollection = new Map();\n        this.filterRange = new Map();\n        this.addEventListener();\n    }\n    /**\n     * To destroy the filter module.\n     *\n     * @returns {void} - To destroy the filter module.\n     */\n    Filter.prototype.destroy = function () {\n        this.removeEventListener();\n        this.filterRange = null;\n        this.filterCollection = null;\n        this.parent = null;\n    };\n    Filter.prototype.addEventListener = function () {\n        this.parent.on(filterRangeAlert, this.filterRangeAlertHandler, this);\n        this.parent.on(initiateFilterUI, this.initiateFilterUIHandler, this);\n        this.parent.on(mouseDown, this.filterMouseDownHandler, this);\n        this.parent.on(renderFilterCell, this.renderFilterCellHandler, this);\n        this.parent.on(clearAllFilter, this.clearAllFilterHandler, this);\n        this.parent.on(beforeFltrcMenuOpen, this.beforeFilterMenuOpenHandler, this);\n        this.parent.on(filterCmenuSelect, this.closeDialog, this);\n        this.parent.on(reapplyFilter, this.reapplyFilterHandler, this);\n        this.parent.on(filterByCellValue, this.filterByCellValueHandler, this);\n        this.parent.on(clearFilter, this.clearFilterHandler, this);\n        this.parent.on(getFilteredColumn, this.getFilteredColumnHandler, this);\n        this.parent.on(cMenuBeforeOpen, this.cMenuBeforeOpenHandler, this);\n        this.parent.on(filterCboxValue, this.filterCboxValueHandler, this);\n        this.parent.on(getFilterRange, this.getFilterRangeHandler, this);\n        this.parent.on(filterCellKeyDown, this.filterCellKeyDownHandler, this);\n        this.parent.on(getFilteredCollection, this.getFilteredCollection, this);\n        this.parent.on(contentLoaded, this.updateFilter, this);\n        this.parent.on(updateFilter, this.updateFilter, this);\n        this.parent.on(beforeInsert, this.beforeInsertHandler, this);\n        this.parent.on(beforeDelete, this.beforeDeleteHandler, this);\n        this.parent.on(sheetsDestroyed, this.deleteSheetHandler, this);\n        this.parent.on(clear, this.clearHanlder, this);\n        this.parent.on(filterDialogCreated, this.filterDialogCreatedHandler, this);\n        this.parent.on(filterDialogClose, this.removeFilterClass, this);\n    };\n    Filter.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(filterRangeAlert, this.filterRangeAlertHandler);\n            this.parent.off(initiateFilterUI, this.initiateFilterUIHandler);\n            this.parent.off(mouseDown, this.filterMouseDownHandler);\n            this.parent.off(renderFilterCell, this.renderFilterCellHandler);\n            this.parent.off(clearAllFilter, this.clearAllFilterHandler);\n            this.parent.off(beforeFltrcMenuOpen, this.beforeFilterMenuOpenHandler);\n            this.parent.off(filterCmenuSelect, this.closeDialog);\n            this.parent.off(reapplyFilter, this.reapplyFilterHandler);\n            this.parent.off(filterByCellValue, this.filterByCellValueHandler);\n            this.parent.off(clearFilter, this.clearFilterHandler);\n            this.parent.off(getFilteredColumn, this.getFilteredColumnHandler);\n            this.parent.off(cMenuBeforeOpen, this.cMenuBeforeOpenHandler);\n            this.parent.on(filterCboxValue, this.filterCboxValueHandler);\n            this.parent.off(getFilterRange, this.getFilterRangeHandler);\n            this.parent.off(filterCellKeyDown, this.filterCellKeyDownHandler);\n            this.parent.off(getFilteredCollection, this.getFilteredCollection);\n            this.parent.off(contentLoaded, this.updateFilter);\n            this.parent.off(updateFilter, this.updateFilter);\n            this.parent.off(beforeInsert, this.beforeInsertHandler);\n            this.parent.off(beforeDelete, this.beforeDeleteHandler);\n            this.parent.off(sheetsDestroyed, this.deleteSheetHandler);\n            this.parent.off(clear, this.clearHanlder);\n            this.parent.off(filterDialogCreated, this.filterDialogCreatedHandler);\n            this.parent.off(filterDialogClose, this.removeFilterClass);\n        }\n    };\n    /**\n     * Gets the module name.\n     *\n     * @returns {string} - Gets the module name.\n     */\n    Filter.prototype.getModuleName = function () {\n        return 'filter';\n    };\n    /**\n     * Validates the range and returns false when invalid.\n     *\n     * @param {SheetModel} sheet - Specify the sheet.\n     * @param {string} range - Specify the range.\n     * @returns {void} - Validates the range and returns false when invalid.\n     */\n    Filter.prototype.isInValidFilterRange = function (sheet, range) {\n        var selectedRange = range ? getSwapRange(getIndexesFromAddress(range)) :\n            getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        return selectedRange[0] > sheet.usedRange.rowIndex || selectedRange[1] > sheet.usedRange.colIndex;\n    };\n    /**\n     * Shows the range error alert dialog.\n     *\n     * @param {any} args - Specifies the args\n     * @param {string} args.error - range error string.\n     * @returns {void} - Shows the range error alert dialog.\n     */\n    Filter.prototype.filterRangeAlertHandler = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            content: args.error, isModal: true,\n            height: 180, width: 400, showCloseIcon: true,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'FilterRangeDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            }\n        });\n        this.parent.hideSpinner();\n    };\n    /**\n     * Triggers before filter context menu opened and used to add sorting items.\n     *\n     * @param {any} args - Specifies the args\n     * @param {HTMLElement} args.element - Specify the element\n     * @returns {void} - Triggers before filter context menu opened and used to add sorting items.\n     */\n    Filter.prototype.beforeFilterMenuOpenHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.element.classList.add('e-spreadsheet-contextmenu'); // to show sort icons\n        var ul = args.element.querySelector('ul');\n        this.addMenuItem(ul, l10n.getConstant('SortDescending'), 'e-filter-sortdesc', 'e-sort-desc');\n        this.addMenuItem(ul, l10n.getConstant('SortAscending'), 'e-filter-sortasc', 'e-sort-asc');\n        args.element.appendChild(ul);\n    };\n    /**\n     * Creates new menu item element\n     *\n     * @param {Element} ul - Specify the element.\n     * @param {string} text - Specify the text.\n     * @param {string} className - Specify the className\n     * @param {string} iconCss - Specify the iconCss\n     * @returns {void} - Creates new menu item element\n     */\n    Filter.prototype.addMenuItem = function (ul, text, className, iconCss) {\n        var li = this.parent.createElement('li', { className: className + ' e-menu-item' });\n        li.innerHTML = text;\n        li.insertBefore(this.parent.createElement('span', { className: 'e-menu-icon e-icons ' + iconCss }), li.firstChild);\n        ul.insertBefore(li, ul.firstChild);\n    };\n    /**\n     * Initiates the filter UI for the selected range.\n     *\n     * @param {any} args - Specifies the args\n     * @param {PredicateModel[]} args.predicates - Specify the predicates.\n     * @param {number} args.range - Specify the range.\n     * @param {number} args.sIdx - Specify the sIdx\n     * @param {boolean} args.isCut - Specify the bool value\n     * @returns {void} - Initiates the filter UI for the selected range.\n     */\n    Filter.prototype.initiateFilterUIHandler = function (args) {\n        var _this = this;\n        var predicates = args ? args.predicates : null;\n        var sheetIdx = args.sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        if (this.filterRange.size > 0 && this.filterRange.has(sheetIdx)) { //disable filter\n            this.removeFilter(sheetIdx);\n            if (!predicates) {\n                return;\n            }\n        }\n        var sheet = getSheet(this.parent, sheetIdx);\n        if (this.isInValidFilterRange(sheet, args.range)) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            this.filterRangeAlertHandler({ error: l10n.getConstant('FilterOutOfRangeError') });\n            return;\n        }\n        var selectedRange = sheet.selectedRange;\n        var rangeIdx = getRangeIndexes(selectedRange);\n        if (rangeIdx[0] === rangeIdx[2] && rangeIdx[1] === rangeIdx[3]) {\n            rangeIdx = getDataRange(rangeIdx[0], rangeIdx[1], sheet);\n            selectedRange = getRangeAddress(rangeIdx);\n        }\n        var eventArgs = {\n            range: args.range ? args.range : selectedRange,\n            filterOptions: { predicates: args.predicates }, cancel: false\n        };\n        if (!args.isCut) {\n            this.parent.notify(beginAction, { action: 'filter', eventArgs: eventArgs });\n        }\n        this.processRange(sheet, sheetIdx, args.range ? args.range : selectedRange);\n        if (predicates) {\n            var range = this.filterRange.get(sheetIdx).slice();\n            range[0] = range[0] + 1; // to skip first row.\n            range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n            getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n                _this.filterSuccessHandler(new DataManager(jsonData), {\n                    action: 'filtering',\n                    filterCollection: predicates, field: predicates[0] ? predicates[0].field : null, sIdx: args.sIdx\n                });\n                _this.refreshFilterRange(null, false, args.sIdx);\n            });\n        }\n        if (!args.isCut) {\n            this.parent.notify(completeAction, { action: 'filter', eventArgs: eventArgs });\n        }\n    };\n    /**\n     * Processes the range if no filter applied.\n     *\n     * @param {SheetModel} sheet - Specify the sheet.\n     * @param {number} sheetIdx - Specify the sheet index.\n     * @param {number} filterRange - Specify the filterRange\n     * @returns {void} - Processes the range if no filter applied.\n     */\n    Filter.prototype.processRange = function (sheet, sheetIdx, filterRange) {\n        var range = getSwapRange(getIndexesFromAddress(filterRange || sheet.selectedRange));\n        if (range[0] === range[2] && range[1] === range[3]) { //if selected range is a single cell\n            range[0] = 0;\n            range[1] = 0;\n            range[2] = sheet.usedRange.rowIndex;\n            range[3] = sheet.usedRange.colIndex;\n        }\n        this.filterRange.set(sheetIdx, range);\n        this.filterCollection.set(sheetIdx, []);\n        this.refreshFilterRange(range, false, sheetIdx);\n    };\n    /**\n     * Removes all the filter related collections for the active sheet.\n     *\n     * @param {number} sheetIdx - Specify the sheet index.\n     * @returns {void} - Removes all the filter related collections for the active sheet.\n     */\n    Filter.prototype.removeFilter = function (sheetIdx) {\n        var range = this.filterRange.get(sheetIdx).slice();\n        var rangeAddr = getRangeAddress(range);\n        var eventArgs = { range: rangeAddr, cancel: false };\n        this.parent.notify(beginAction, { action: 'filter', eventArgs: eventArgs });\n        if (eventArgs.cancel) {\n            return;\n        }\n        if (this.filterCollection.get(sheetIdx).length) {\n            this.parent.clearFilter();\n        }\n        this.filterRange.delete(sheetIdx);\n        this.filterCollection.delete(sheetIdx);\n        this.refreshFilterRange(range, true, sheetIdx);\n        if (this.parent.filterCollection) {\n            var count = 0;\n            var filterColl = void 0;\n            for (var i = 0, len = this.parent.filterCollection.length; i < len; i++) {\n                filterColl = this.parent.filterCollection[count];\n                if (filterColl.sheetIndex === sheetIdx && filterColl.filterRange === rangeAddr) {\n                    this.parent.filterCollection.splice(count, 1);\n                }\n                else {\n                    count++;\n                }\n            }\n        }\n        this.parent.notify(completeAction, { action: 'filter', eventArgs: eventArgs });\n    };\n    /**\n     * Handles filtering cell value based on context menu.\n     *\n     * @returns {void} - Handles filtering cell value based on context menu.\n     */\n    Filter.prototype.filterByCellValueHandler = function () {\n        var _this = this;\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.getActiveSheet();\n        if (this.isInValidFilterRange(sheet)) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            this.filterRangeAlertHandler({ error: l10n.getConstant('FilterOutOfRangeError') });\n            return;\n        }\n        var cell = getCellIndexes(sheet.activeCell);\n        if (!this.isFilterRange(sheetIdx, cell[0], cell[1])) {\n            this.processRange(sheet, sheetIdx);\n        }\n        var range = this.filterRange.get(sheetIdx).slice();\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        var field = getColumnHeaderText(cell[1] + 1);\n        var type = this.getColumnType(sheet, cell[1] + 1, range);\n        var predicates = [{\n                field: field,\n                operator: type === 'date' || type === 'datetime' || type === 'boolean' ? 'equal' : 'contains',\n                value: getCell(cell[0], cell[1], sheet).value, matchCase: false, type: type\n            }];\n        getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n            _this.filterSuccessHandler(new DataManager(jsonData), { action: 'filtering', filterCollection: predicates, field: field });\n        });\n    };\n    /**\n     * Creates filter buttons and renders the filter applied cells.\n     *\n     * @param { any} args - Specifies the args\n     * @param { HTMLElement} args.td - specify the element\n     * @param { number} args.rowIndex - specify the rowIndex\n     * @param { number} args.colIndex - specify the colIndex\n     * @param { number} args.sIdx - specify the sIdx\n     * @returns {void} - Creates filter buttons and renders the filter applied cells.\n     */\n    Filter.prototype.renderFilterCellHandler = function (args) {\n        var sheetIdx = args.sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        if (this.filterRange.has(sheetIdx) && this.isFilterCell(sheetIdx, args.rowIndex, args.colIndex)) {\n            if (!args.td) {\n                return;\n            }\n            var field = getColumnHeaderText(args.colIndex + 1);\n            if (args.td.querySelector('.e-filter-btn')) {\n                var element = args.td.querySelector('.e-filter-iconbtn');\n                var filterBtnObj = getComponent(element, 'btn');\n                filterBtnObj.iconCss = 'e-icons e-filter-icon' + this.getFilterSortClassName(args.colIndex, sheetIdx);\n            }\n            else {\n                var filterButton = this.parent.createElement('div', { className: 'e-filter-btn' });\n                var filterBtnObj = new Button({ iconCss: 'e-icons e-filter-icon' + this.getFilterSortClassName(args.colIndex, sheetIdx), cssClass: 'e-filter-iconbtn' });\n                args.td.insertBefore(filterButton, args.td.firstChild);\n                filterBtnObj.createElement = this.parent.createElement;\n                filterBtnObj.appendTo(filterButton);\n            }\n        }\n        if (this.parent.sortCollection) {\n            this.parent.notify(sortImport, { sheetIdx: sheetIdx });\n        }\n    };\n    Filter.prototype.getFilterSortClassName = function (colIdx, sheetIdx) {\n        var field = getColumnHeaderText(colIdx + 1);\n        var className = '';\n        var predicates = this.filterCollection.get(sheetIdx);\n        var sortCollection = this.parent.sortCollection;\n        for (var i = 0; i < predicates.length; i++) {\n            if (predicates[i].field === field) {\n                className = ' e-filtered';\n                break;\n            }\n        }\n        if (sortCollection) {\n            for (var i = 0; i < sortCollection.length; i++) {\n                if (sortCollection[i].sheetIndex === sheetIdx && sortCollection[i].columnIndex === colIdx) {\n                    className += sortCollection[i].order === 'Ascending' ? ' e-sortasc-filter' : ' e-sortdesc-filter';\n                    break;\n                }\n            }\n        }\n        return className;\n    };\n    /**\n     * Refreshes the filter header range.\n     *\n     * @param {number[]} filterRange - Specify the filterRange.\n     * @param {boolean} remove - Specify the bool value\n     * @param {number} sIdx - Specify the index.\n     * @returns {void} - Refreshes the filter header range.\n     */\n    Filter.prototype.refreshFilterRange = function (filterRange, remove, sIdx) {\n        var sheetIdx = sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var range = filterRange || this.filterRange.get(sheetIdx).slice();\n        for (var index = range[1]; index <= range[3]; index++) {\n            var cell = this.parent.getCell(range[0], index);\n            if (remove) {\n                if (cell && cell.hasChildNodes()) {\n                    var element = cell.querySelector('.e-filter-btn');\n                    if (element) {\n                        cell.removeChild(element);\n                    }\n                }\n            }\n            else {\n                this.renderFilterCellHandler({ td: cell, rowIndex: range[0], colIndex: index, sIdx: sheetIdx });\n            }\n        }\n        if (this.parent.sortCollection) {\n            this.parent.notify(sortImport, null);\n        }\n    };\n    /**\n     * Checks whether the provided cell is a filter cell.\n     *\n     * @param {number} sheetIdx - Specify the sheet index.\n     * @param {number} rowIndex - Specify the row index\n     * @param {number} colIndex - Specify the col index.\n     * @returns {boolean} - Checks whether the provided cell is a filter cell.\n     */\n    Filter.prototype.isFilterCell = function (sheetIdx, rowIndex, colIndex) {\n        var range = this.filterRange.get(sheetIdx);\n        return (range && range[0] === rowIndex && range[1] <= colIndex && range[3] >= colIndex);\n    };\n    /**\n     * Checks whether the provided cell is in a filter range\n     *\n     * @param {number} sheetIdx - Specify the sheet index.\n     * @param {number} rowIndex - Specify the row index\n     * @param {number} colIndex - Specify the col index.\n     * @returns {boolean} - Checks whether the provided cell is in a filter range\n     */\n    Filter.prototype.isFilterRange = function (sheetIdx, rowIndex, colIndex) {\n        var range = this.filterRange.get(sheetIdx);\n        return (range && range[0] <= rowIndex && range[2] >= rowIndex && range[1] <= colIndex && range[3] >= colIndex);\n    };\n    /**\n     * Gets the filter information from active cell\n     *\n     * @param {any} args - Specifies the args\n     * @param {string} args.field - Specify the field\n     * @param {string} args.clearFilterText - Specify the clearFilterText\n     * @param {boolean} args.isFiltered - Specify the isFiltered\n     * @param {boolean} args.isClearAll - Specify the isClearAll\n     * @returns {void} - Triggers before context menu created to enable or disable items.\n     */\n    Filter.prototype.getFilteredColumnHandler = function (args) {\n        var sheetIdx = this.parent.activeSheetIndex;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.clearFilterText = l10n.getConstant('ClearFilter');\n        if (this.filterRange.has(sheetIdx)) {\n            var filterCollection = this.filterCollection.get(sheetIdx);\n            if (args.isClearAll) {\n                args.isFiltered = filterCollection && filterCollection.length > 0;\n                return;\n            }\n            var range = this.filterRange.get(sheetIdx).slice();\n            var sheet = this.parent.getActiveSheet();\n            var cell = getCellIndexes(sheet.activeCell);\n            if (this.isFilterRange(sheetIdx, cell[0], cell[1])) {\n                args.field = getColumnHeaderText(cell[1] + 1);\n                var headerCell = getCell(range[0], cell[1], sheet);\n                var cellValue = this.parent.getDisplayText(headerCell);\n                args.clearFilterText = l10n.getConstant('ClearFilterFrom') + '\\\"'\n                    + (cellValue ? cellValue.toString() : 'Column ' + args.field) + '\\\"';\n                filterCollection.some(function (value) {\n                    args.isFiltered = value.field === args.field;\n                    return args.isFiltered;\n                });\n            }\n        }\n    };\n    /**\n     * Triggers before context menu created to enable or disable items.\n     *\n     * @param {any} e - Specifies the args\n     * @param {HTMLElement} e.element - Specify the element\n     * @param {MenuItemModel[]} e.items - Specify the items\n     * @param {MenuItemModel} e.parentItem - Specify the parentItem\n     * @param {string} e.target - Specify the target\n     * @returns {void} - Triggers before context menu created to enable or disable items.\n     */\n    Filter.prototype.cMenuBeforeOpenHandler = function (e) {\n        var id = this.parent.element.id + '_cmenu';\n        if (e.parentItem && e.parentItem.id === id + '_filter' && e.target === '') {\n            var args = { isFiltered: false };\n            this.getFilteredColumnHandler(args);\n            this.parent.enableContextMenuItems([id + '_clearfilter', id + '_reapplyfilter'], !!args.isFiltered, true);\n        }\n    };\n    /**\n     * Closes the filter popup.\n     *\n     * @returns {void} - Closes the filter popup.\n     */\n    Filter.prototype.closeDialog = function () {\n        var filterPopup = document.querySelector('.e-filter-popup');\n        if (filterPopup && filterPopup.id.includes(this.parent.element.id)) {\n            var excelFilter = getComponent(filterPopup, 'dialog');\n            EventHandler.remove(filterPopup, getStartEvent(), this.filterMouseDownHandler);\n            if (excelFilter) {\n                excelFilter.hide();\n            }\n            this.removeFilterClass();\n        }\n    };\n    Filter.prototype.removeFilterClass = function () {\n        if (this.parent.element.style.position === 'relative') {\n            this.parent.element.style.position = '';\n        }\n        if (this.parent.element.classList.contains('e-filter-open')) {\n            this.parent.element.classList.remove('e-filter-open');\n        }\n    };\n    /**\n     * Returns true if the filter popup is opened.\n     *\n     * @returns {boolean} - Returns true if the filter popup is opened.\n     */\n    Filter.prototype.isPopupOpened = function () {\n        var filterPopup = document.querySelector('.e-filter-popup');\n        return filterPopup && filterPopup.id.includes(this.parent.element.id) && filterPopup.style.display !== 'none';\n    };\n    Filter.prototype.filterCellKeyDownHandler = function (args) {\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getCellIndexes(sheet.activeCell);\n        if (this.isFilterCell(sheetIdx, indexes[0], indexes[1])) {\n            args.isFilterCell = true;\n            var pos = getCellPosition(sheet, indexes);\n            var target = this.parent.getCell(indexes[0], indexes[1]);\n            if (this.isPopupOpened()) {\n                this.closeDialog();\n            }\n            this.openDialog(target, pos.left, target ? target.getBoundingClientRect().bottom : pos.top);\n        }\n        else {\n            args.isFilterCell = false;\n        }\n    };\n    /**\n     * Opens the filter popup dialog on filter button click.\n     *\n     * @param {MouseEvent | TouchEvent} e - Specidy the event\n     * @returns {void} - Opens the filter popup dialog on filter button click.\n     */\n    Filter.prototype.filterMouseDownHandler = function (e) {\n        if (Browser.isDevice && e.type === 'mousedown') {\n            return;\n        }\n        var target = e.target;\n        if (target.classList.contains('e-filter-icon')) {\n            if (this.isPopupOpened()) {\n                this.closeDialog();\n                return;\n            }\n            this.openDialog(target, e.x, target.getBoundingClientRect().bottom);\n        }\n        else if (this.isPopupOpened()) {\n            if (!target.classList.contains('e-searchinput') && !target.classList.contains('e-searchclear')\n                && (target.offsetParent && !target.offsetParent.classList.contains('e-filter-popup'))) {\n                this.closeDialog();\n            }\n            else {\n                this.selectSortItemHandler(target);\n            }\n        }\n    };\n    /**\n     * Opens the excel filter dialog based on target.\n     *\n     * @param {HTMLElement} target - Specify the target\n     * @param {number} xPos - Specify the xPos\n     * @param {number} yPos - Specify the yPos\n     * @returns {void} - Opens the excel filter dialog based on target.\n     */\n    Filter.prototype.openDialog = function (target, xPos, yPos) {\n        var _this = this;\n        var cell = parentsUntil(target, 'e-cell');\n        var colIndex = parseInt(cell.getAttribute('aria-colindex'), 10);\n        var field = getColumnHeaderText(colIndex);\n        //Update datasource dynamically\n        this.parent.showSpinner();\n        var sheetIdx = this.parent.activeSheetIndex;\n        var range = this.filterRange.get(sheetIdx).slice();\n        var sheet = this.parent.getActiveSheet();\n        var filterCell = getCell(range[0], colIndex - 1, sheet);\n        var displayName = this.parent.getDisplayText(filterCell);\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true, null, true).then(function (jsonData) {\n            //to avoid undefined array data\n            var checkBoxData;\n            jsonData.some(function (value, index) {\n                if (value) {\n                    checkBoxData = new DataManager(jsonData.slice(index));\n                }\n                return !!value;\n            });\n            var offset = _this.parent.element.getBoundingClientRect();\n            xPos -= offset.left;\n            yPos -= offset.top;\n            _this.parent.element.style.position = 'relative';\n            _this.parent.element.classList.add('e-filter-open');\n            var options = {\n                type: _this.getColumnType(sheet, colIndex, range), field: field, displayName: displayName || 'Column ' + field,\n                dataSource: checkBoxData, height: _this.parent.element.classList.contains('e-bigger') ? 800 : 500, columns: [],\n                hideSearchbox: false, filteredColumns: _this.filterCollection.get(sheetIdx), column: { 'field': field, 'filter': {} },\n                handler: _this.filterSuccessHandler.bind(_this, new DataManager(jsonData)), target: target,\n                position: { X: xPos, Y: yPos }, localeObj: _this.parent.serviceLocator.getService(locale)\n            };\n            var excelFilter = new ExcelFilterBase(_this.parent, _this.getLocalizedCustomOperators());\n            excelFilter.openDialog(options);\n            var filterPopup = document.querySelector('.e-filter-popup');\n            if (filterPopup && filterPopup.id.includes(_this.parent.element.id)) {\n                EventHandler.add(filterPopup, getStartEvent(), _this.filterMouseDownHandler, _this);\n                filterPopup.style.top = '0px';\n                filterPopup.style.visibility = 'hidden';\n                if (filterPopup.classList.contains('e-hide')) {\n                    filterPopup.classList.remove('e-hide');\n                }\n                var height = filterPopup.getBoundingClientRect().height;\n                if (height < 400) {\n                    height = 400;\n                }\n                var popupOpenArea = offset.height - yPos;\n                filterPopup.style.top = (height > popupOpenArea ? (yPos - Math.abs(height - popupOpenArea)) : yPos) + 'px';\n                filterPopup.style.visibility = '';\n            }\n            _this.parent.hideSpinner();\n        });\n    };\n    Filter.prototype.filterDialogCreatedHandler = function () {\n        var filterPopup = document.querySelector('.e-filter-popup');\n        if (filterPopup && filterPopup.id.includes(this.parent.element.id) && filterPopup.classList.contains('e-popup-close')) {\n            filterPopup.classList.add('e-hide');\n        }\n    };\n    /**\n     * Formats cell value for listing it in filter popup.\n     *\n     * @param {any} args - Specifies the args\n     * @param {string | number} args.value - Specify the value\n     * @param {object} args.column - Specify the column\n     * @param {object} args.data - Specify the data\n     * @returns {void} - Formats cell value for listing it in filter popup.\n     */\n    Filter.prototype.filterCboxValueHandler = function (args) {\n        if (args.column && args.data) {\n            var fieldKey = 'field';\n            var field = args.column[fieldKey];\n            var dataKey = 'dataObj';\n            var rowKey = '__rowIndex';\n            if (args.value) {\n                var indexes = getCellIndexes(field + args.data[dataKey][rowKey]);\n                var cell = getCell(indexes[0], indexes[1], this.parent.getActiveSheet());\n                if (cell && cell.format) {\n                    args.value = this.parent.getDisplayText(cell);\n                }\n            }\n        }\n    };\n    /**\n     * Triggers when sorting items are chosen on context menu of filter popup.\n     *\n     * @param {HTMLElement} target - Specify the element.\n     * @returns {void} - Triggers when sorting items are chosen on context menu of filter popup.\n     */\n    Filter.prototype.selectSortItemHandler = function (target) {\n        var sortOrder = target.classList.contains('e-filter-sortasc') ? 'Ascending'\n            : target.classList.contains('e-filter-sortdesc') ? 'Descending' : null;\n        if (!sortOrder) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var sheetIdx = this.parent.activeSheetIndex;\n        var range = this.filterRange.get(sheetIdx).slice();\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: sortOrder } }, range: getRangeAddress(range) });\n        var cell = getIndexesFromAddress(sheet.activeCell);\n        this.parent.sortCollection = this.parent.sortCollection ? this.parent.sortCollection : [];\n        for (var i = 0; i < this.parent.sortCollection.length; i++) {\n            if (this.parent.sortCollection[i] && this.parent.sortCollection[i].sheetIndex === sheetIdx) {\n                this.parent.sortCollection.splice(i, 1);\n            }\n        }\n        this.parent.sortCollection.push({\n            sortRange: getRangeAddress(range), columnIndex: cell[1], order: sortOrder,\n            sheetIndex: sheetIdx\n        });\n        this.refreshFilterRange();\n        this.closeDialog();\n    };\n    /**\n     * Triggers when OK button or clear filter item is selected\n     *\n     * @param {DataManager} dataSource - Specify the data source\n     * @param {Object} args - Specify the data source\n     * @param {string} args.action - Specify the action\n     * @param {PredicateModel[]} args.filterCollection - Specify the filter collection.\n     * @param {string} args.field - Specify the field.\n     * @param {number} args.sIdx - Specify the index.\n     * @returns {void} - Triggers when OK button or clear filter item is selected\n     */\n    Filter.prototype.filterSuccessHandler = function (dataSource, args) {\n        var sheetIdx = args.sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var predicates = this.filterCollection.get(sheetIdx);\n        var dataManager = new DataManager(predicates);\n        var query = new Query();\n        var fields = dataManager.executeLocal(query.where('field', 'equal', args.field));\n        for (var index = 0; index < fields.length; index++) {\n            var sameIndex = -1;\n            for (var filterIndex = 0; filterIndex < predicates.length; filterIndex++) {\n                if (predicates[filterIndex].field === fields[index].field) {\n                    sameIndex = filterIndex;\n                    break;\n                }\n            }\n            if (sameIndex !== -1) {\n                predicates.splice(sameIndex, 1);\n            }\n        }\n        if (args.action === 'filtering') {\n            predicates = predicates.concat(args.filterCollection);\n            if (predicates.length) {\n                for (var i = 0; i < predicates.length; i++) {\n                    args.field = predicates[i].field;\n                }\n            }\n        }\n        else {\n        }\n        this.filterCollection.set(sheetIdx, predicates);\n        var filterOptions = {\n            datasource: dataSource,\n            predicates: this.getPredicates(sheetIdx)\n        };\n        this.filterRange.get(sheetIdx)[2] = getSheet(this.parent, sheetIdx).usedRange.rowIndex; //extend the range if filtered\n        this.applyFilter(filterOptions, getRangeAddress(this.filterRange.get(sheetIdx)), sheetIdx);\n    };\n    /**\n     * Triggers events for filtering and applies filter.\n     *\n     * @param {FilterOptions} filterOptions - Specify the filteroptions.\n     * @param {string} range - Specify the range.\n     * @param {number} sheetIdx - Specify the sheet index.\n     * @returns {void} - Triggers events for filtering and applies filter.\n     */\n    Filter.prototype.applyFilter = function (filterOptions, range, sheetIdx) {\n        var _this = this;\n        var eventArgs = { range: range, predicates: [].slice.call(this.filterCollection.get(sheetIdx)), cancel: false };\n        this.parent.notify(beginAction, { action: 'filter', eventArgs: eventArgs });\n        if (eventArgs.cancel) {\n            return;\n        }\n        this.parent.showSpinner();\n        this.parent.filter(filterOptions, range).then(function (args) {\n            _this.refreshFilterRange();\n            _this.parent.notify(getFilteredCollection, null);\n            _this.parent.hideSpinner();\n            delete eventArgs.cancel;\n            _this.parent.notify(completeAction, { action: 'filter', eventArgs: eventArgs });\n            return Promise.resolve(args);\n        }).catch(function (error) {\n            _this.filterRangeAlertHandler({ error: error });\n            return Promise.reject(error);\n        });\n    };\n    /**\n     * Gets the predicates for the sheet\n     *\n     * @param {number} sheetIdx - Specify the sheetindex\n     * @returns {Predicate[]} - Gets the predicates for the sheet\n     */\n    Filter.prototype.getPredicates = function (sheetIdx) {\n        var predicateList = [];\n        var excelPredicate = CheckBoxFilterBase.getPredicate(this.filterCollection.get(sheetIdx));\n        for (var _i = 0, _a = Object.keys(excelPredicate); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            predicateList.push(excelPredicate[prop]);\n        }\n        return predicateList;\n    };\n    /**\n     * Gets the column type to pass it into the excel filter options.\n     *\n     * @param {SheetModel} sheet - Specify the sheet.\n     * @param {number} colIndex - Specify the colindex\n     * @param {number[]} range - Specify the range.\n     * @returns {string} - Gets the column type to pass it into the excel filter options.\n     */\n    Filter.prototype.getColumnType = function (sheet, colIndex, range) {\n        var num = 0;\n        var str = 0;\n        var date = 0;\n        var time = 0;\n        for (var i = range[0]; i <= sheet.usedRange.rowIndex; i++) {\n            var cell = getCell(i, colIndex - 1, sheet);\n            if (cell) {\n                if (cell.format) {\n                    var type = getTypeFromFormat(cell.format).toLowerCase();\n                    switch (type) {\n                        case 'number':\n                        case 'currency':\n                        case 'accounting':\n                        case 'percentage':\n                            num++;\n                            break;\n                        case 'shortdate':\n                        case 'longdate':\n                            date++;\n                            break;\n                        case 'time':\n                            num++;\n                            break;\n                        default:\n                            str++;\n                            break;\n                    }\n                }\n                else {\n                    if (typeof cell.value === 'string') {\n                        str++;\n                    }\n                    else {\n                        num++;\n                    }\n                }\n            }\n            else {\n                str++;\n            }\n        }\n        return (num > str && num > date && num > time) ? 'number' : (str > num && str > date && str > time) ? 'string'\n            : (date > num && date > str && date > time) ? 'date' : 'datetime';\n    };\n    /**\n     * Clears all the filtered columns in the active sheet.\n     *\n     * @returns {void} - Clears all the filtered columns in the active sheet.\n     */\n    Filter.prototype.clearAllFilterHandler = function () {\n        if (this.filterRange.has(this.parent.activeSheetIndex)) {\n            this.filterCollection.set(this.parent.activeSheetIndex, []);\n            var filterColl = this.parent.filterCollection;\n            for (var i = 0; i < filterColl.length; i++) {\n                if (filterColl[i].sheetIndex === this.parent.activeSheetIndex) {\n                    filterColl.splice(i, 1);\n                    break;\n                }\n            }\n            this.refreshFilterRange();\n        }\n    };\n    /**\n     * Clear filter from the field.\n     *\n     * @param {any} args - Specifies the args\n     * @param {{ field: string }} args.field - Specify the args\n     * @returns {void} - Clear filter from the field.\n     */\n    Filter.prototype.clearFilterHandler = function (args) {\n        this.filterSuccessHandler(null, { action: 'clear-filter', filterCollection: [], field: args.field });\n    };\n    /**\n     * Reapplies the filter.\n     *\n     * @returns {void} - Reapplies the filter.\n     */\n    Filter.prototype.reapplyFilterHandler = function () {\n        var sheetIdx = this.parent.activeSheetIndex;\n        if (this.filterRange.has(sheetIdx)) {\n            this.applyFilter({ predicates: this.getPredicates(sheetIdx) }, getRangeAddress(this.filterRange.get(sheetIdx)), sheetIdx);\n        }\n    };\n    /**\n     * Gets the filter information of the sheet.\n     *\n     * @param {FilterInfoArgs} args - Specify the args\n     * @returns {void} - Gets the filter information of the sheet.\n     */\n    Filter.prototype.getFilterRangeHandler = function (args) {\n        var sheetIdx = args.sheetIdx;\n        if (this.filterRange && this.filterRange.has(sheetIdx)) {\n            args.hasFilter = true;\n            args.filterRange = this.filterRange.get(sheetIdx);\n        }\n        else {\n            args.hasFilter = false;\n            args.filterRange = null;\n        }\n    };\n    /**\n     * Returns the custom operators for filter items.\n     *\n     * @returns {Object} - Returns the custom operators for filter items.\n     */\n    Filter.prototype.getLocalizedCustomOperators = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var numOptr = [\n            { value: 'equal', text: l10n.getConstant('Equal') },\n            { value: 'greaterthan', text: l10n.getConstant('GreaterThan') },\n            { value: 'greaterthanorequal', text: l10n.getConstant('GreaterThanOrEqual') },\n            { value: 'lessthan', text: l10n.getConstant('LessThan') },\n            { value: 'lessthanorequal', text: l10n.getConstant('LessThanOrEqual') },\n            { value: 'notequal', text: l10n.getConstant('NotEqual') }\n        ];\n        var customOperators = {\n            stringOperator: [\n                { value: 'startswith', text: l10n.getConstant('StartsWith') },\n                { value: 'endswith', text: l10n.getConstant('EndsWith') },\n                { value: 'contains', text: l10n.getConstant('Contains') },\n                { value: 'equal', text: l10n.getConstant('Equal') },\n                { value: 'notequal', text: l10n.getConstant('NotEqual') }\n            ],\n            numberOperator: numOptr,\n            dateOperator: numOptr,\n            datetimeOperator: numOptr,\n            booleanOperator: [\n                { value: 'equal', text: l10n.getConstant('Equal') },\n                { value: 'notequal', text: l10n.getConstant('NotEqual') }\n            ]\n        };\n        return customOperators;\n    };\n    /**\n     * To get filtered range and predicates collections\n     *\n     * @returns {void} - To get filtered range and predicates collections\n     */\n    Filter.prototype.getFilteredCollection = function () {\n        var sheetLen = this.parent.sheets.length;\n        var col = [];\n        var fil;\n        for (var i = 0; i < sheetLen; i++) {\n            var range = void 0;\n            var hasFilter = void 0;\n            var args = { sheetIdx: i, filterRange: range, hasFilter: hasFilter };\n            this.getFilterRangeHandler(args);\n            if (args.hasFilter) {\n                var colCollection = [];\n                var condition = [];\n                var value = [];\n                var type = [];\n                var predi = [];\n                var predicate = this.filterCollection.get(args.sheetIdx);\n                for (var i_1 = 0; i_1 < predicate.length; i_1++) {\n                    if (predicate[i_1].field && predicate[i_1].operator) {\n                        var colIdx = getCellIndexes(predicate[i_1].field + '1')[1];\n                        colCollection.push(colIdx);\n                        condition.push(predicate[i_1].operator);\n                        value.push(isNullOrUndefined(predicate[i_1].value) ? '' : predicate[i_1].value);\n                        type.push(predicate[i_1].type);\n                        predi.push(predicate[i_1].predicate);\n                    }\n                }\n                var address = getRangeAddress(args.filterRange);\n                fil = {\n                    sheetIndex: args.sheetIdx, filterRange: address, hasFilter: args.hasFilter, column: colCollection,\n                    criteria: condition, value: value, dataType: type, predicates: predi\n                };\n                col.push(fil);\n            }\n        }\n        if (fil) {\n            this.parent.filterCollection = col;\n        }\n    };\n    Filter.prototype.updateFilter = function (args) {\n        if (this.parent.filterCollection && (args.initLoad || args.isOpen)) {\n            for (var i = 0; i < this.parent.filterCollection.length; i++) {\n                var filterCol = this.parent.filterCollection[i];\n                var sIdx = filterCol.sheetIndex;\n                if (i === 0) {\n                    sIdx = 0;\n                }\n                var predicates = [];\n                if (filterCol.column) {\n                    for (var j = 0; j < filterCol.column.length; j++) {\n                        var predicateCol = {\n                            field: getCellAddress(0, filterCol.column[j]).charAt(0),\n                            operator: this.getFilterOperator(filterCol.criteria[j]), value: filterCol.value[j].toString().split('*').join(''),\n                            predicate: filterCol.predicates && filterCol.predicates[j]\n                        };\n                        predicates.push(predicateCol);\n                    }\n                }\n                for (var i_2 = 0; i_2 < predicates.length - 1; i_2++) {\n                    if (predicates[i_2].field === predicates[i_2 + 1].field) {\n                        if (!predicates[i_2].predicate) {\n                            predicates[i_2].predicate = 'or';\n                        }\n                        if (!predicates[i_2 + 1].predicate) {\n                            predicates[i_2 + 1].predicate = 'or';\n                        }\n                    }\n                }\n                this.parent.notify(initiateFilterUI, { predicates: predicates !== [] ? predicates : null, range: filterCol.filterRange, sIdx: sIdx });\n            }\n            if (this.parent.sortCollection) {\n                this.parent.notify(sortImport, null);\n            }\n        }\n    };\n    Filter.prototype.getFilterOperator = function (value) {\n        switch (value) {\n            case \"BeginsWith\":\n                value = \"startswith\";\n                break;\n            case \"Less\":\n                value = \"lessthan\";\n                break;\n            case \"EndsWith\":\n                value = \"endswith\";\n                break;\n            case \"Equal\":\n                value = \"equal\";\n                break;\n            case \"Notequal\":\n                value = \"notEqual\";\n                break;\n            case \"Greater\":\n                value = \"greaterthan\";\n                break;\n            case \"Contains\":\n                value = \"contains\";\n                break;\n            case \"LessOrEqual\":\n                value = \"lessthanorequal\";\n                break;\n            case \"GreaterOrEqual\":\n                value = \"greaterthanorequal\";\n                break;\n        }\n        return value;\n    };\n    Filter.prototype.beforeInsertHandler = function (args) {\n        if (args.modelType === 'Column') {\n            var sheetIdx_1 = isUndefined(args.activeSheetIndex) ? this.parent.activeSheetIndex : args.activeSheetIndex;\n            if (this.filterRange.size && this.filterRange.has(sheetIdx_1)) {\n                var range = this.filterRange.get(sheetIdx_1);\n                if (this.isFilterCell(sheetIdx_1, range[0], args.index) || args.index < range[1]) {\n                    range[3] += args.model.length;\n                    if (args.index <= range[1]) {\n                        range[1] += args.model.length;\n                    }\n                    this.filterCollection.get(sheetIdx_1).forEach(function (predicate) {\n                        var colIdx = getColIndex(predicate.field);\n                        if (args.index <= colIdx) {\n                            predicate.field = getColumnHeaderText(colIdx + args.model.length + 1);\n                        }\n                    });\n                    if (this.parent.sortCollection) {\n                        this.parent.sortCollection.forEach(function (sortCollection) {\n                            if (sortCollection.sheetIndex === sheetIdx_1 && args.index <= sortCollection.columnIndex) {\n                                sortCollection.columnIndex += args.model.length;\n                            }\n                        });\n                    }\n                    this.getFilteredCollection();\n                }\n            }\n        }\n        else if (args.modelType === 'Sheet') {\n            var isChanged = false;\n            for (var _i = 0, _a = Array.from(this.filterRange.keys()).sort().reverse(); _i < _a.length; _i++) {\n                var key = _a[_i];\n                if (args.index <= key) {\n                    isChanged = true;\n                    this.filterRange.set(key + args.model.length, this.filterRange.get(key));\n                    this.filterRange.delete(key);\n                    this.filterCollection.set(key + args.model.length, this.filterCollection.get(key));\n                    this.filterCollection.delete(key);\n                }\n            }\n            if (this.parent.sortCollection) {\n                this.parent.sortCollection.forEach(function (sortCollection) {\n                    if (args.index <= sortCollection.sheetIndex) {\n                        sortCollection.sheetIndex += args.model.length;\n                    }\n                });\n            }\n            if (isChanged) {\n                this.getFilteredCollection();\n            }\n        }\n    };\n    Filter.prototype.beforeDeleteHandler = function (args) {\n        if (args.modelType === 'Column') {\n            var sheetIdx = this.parent.activeSheetIndex;\n            if (this.filterRange.size && this.filterRange.has(sheetIdx)) {\n                var isChanged = true;\n                var range = this.filterRange.get(sheetIdx);\n                if (args.start >= range[1] && args.end <= range[3]) { // in between\n                    range[3] -= args.end - args.start + 1;\n                }\n                else if (args.start < range[1] && args.end < range[1]) { // before\n                    range[1] -= args.end - args.start + 1;\n                    range[3] -= args.end - args.start + 1;\n                }\n                else if (args.start < range[1] && args.end > range[1] && args.end < range[3]) { // from before to inbetween\n                    range[1] = args.start;\n                    range[3] -= args.end - args.start + 1;\n                }\n                else {\n                    isChanged = false;\n                }\n                if (isChanged) {\n                    var filterCollection = this.filterCollection.get(sheetIdx);\n                    var isPredicateRemoved = void 0;\n                    for (var i = filterCollection.length - 1; i >= 0; i--) {\n                        var colIdx = getColIndex(filterCollection[i].field);\n                        if (args.end < colIdx) {\n                            filterCollection[i].field = getColumnHeaderText(colIdx - (args.end - args.start + 1) + 1);\n                        }\n                        else if (args.start <= colIdx && args.end >= colIdx) {\n                            isPredicateRemoved = true;\n                        }\n                    }\n                    var sortColl = this.parent.sortCollection;\n                    if (sortColl) {\n                        for (var i = 0; i < sortColl.length; i++) {\n                            if (sortColl[i].sheetIndex === sheetIdx) {\n                                if (args.end < sortColl[i].columnIndex) {\n                                    sortColl[i].columnIndex = sortColl[i].columnIndex - (args.end - args.start + 1);\n                                    break;\n                                }\n                                else if (args.start <= sortColl[i].columnIndex && args.end >= sortColl[i].columnIndex) {\n                                    sortColl.splice(i, 1);\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (isPredicateRemoved) {\n                        this.parent.clearFilter();\n                    }\n                    this.getFilteredCollection();\n                }\n            }\n        }\n    };\n    Filter.prototype.deleteSheetHandler = function (args) {\n        if (!isUndefined(args.sheetIndex)) {\n            var isChanged = void 0;\n            for (var _i = 0, _a = Array.from(this.filterRange.keys()).sort().reverse(); _i < _a.length; _i++) {\n                var key = _a[_i];\n                isChanged = true;\n                if (args.sheetIndex === key) {\n                    this.filterRange.delete(key);\n                    this.filterCollection.delete(key);\n                }\n                else if (args.sheetIndex < key) {\n                    this.filterRange.set(key - 1, this.filterRange.get(key));\n                    this.filterRange.delete(key);\n                    this.filterCollection.set(key - 1, this.filterCollection.get(key));\n                    this.filterCollection.delete(key);\n                }\n                else {\n                    isChanged = false;\n                }\n            }\n            var sortColl = this.parent.sortCollection;\n            if (sortColl) {\n                for (var i = sortColl.length - 1; i >= 0; i--) {\n                    if (args.sheetIndex === sortColl[i].sheetIndex) {\n                        sortColl.splice(i, 1);\n                    }\n                    else if (args.sheetIndex < sortColl[i].sheetIndex) {\n                        sortColl[i].sheetIndex -= 1;\n                    }\n                }\n            }\n            if (isChanged) {\n                this.getFilteredCollection();\n            }\n        }\n    };\n    Filter.prototype.clearHanlder = function (args) {\n        var info = this.parent.getAddressInfo(args.range);\n        if (this.filterRange.has(info.sheetIndex)) {\n            var indexes = this.filterRange.get(info.sheetIndex).slice();\n            if (inRange(info.indices, indexes[0], indexes[1]) && inRange(info.indices, indexes[0], indexes[3])) {\n                this.removeFilter(info.sheetIndex);\n            }\n        }\n    };\n    return Filter;\n}());\nexport { Filter };\n","import { getColIdxFromClientX, createImageElement, deleteImage, refreshImagePosition } from '../common/event';\nimport { insertImage, refreshImgElem, refreshImgCellObj, getRowIdxFromClientY } from '../common/event';\nimport { overlay, dialog } from '../common/index';\nimport { removeClass } from '@syncfusion/ej2-base';\nimport { getCell, setCell, getSheetIndex, getRowsHeight, getColumnsWidth } from '../../workbook/index';\nimport { getRangeIndexes, setImage } from '../../workbook/index';\nvar SpreadsheetImage = /** @class */ (function () {\n    function SpreadsheetImage(parent) {\n        this.pictureCount = 1;\n        this.parent = parent;\n        this.addEventListener();\n        this.renderImageUpload();\n    }\n    /**\n     * Adding event listener for success and failure\n     *\n     * @returns {void} - Adding event listener for success and failure\n     */\n    SpreadsheetImage.prototype.addEventListener = function () {\n        this.parent.on(insertImage, this.insertImage, this);\n        this.parent.on(refreshImgElem, this.refreshImgElem, this);\n        this.parent.on(refreshImgCellObj, this.refreshImgCellObj, this);\n        this.parent.on(createImageElement, this.createImageElement, this);\n        this.parent.on(deleteImage, this.deleteImage, this);\n        this.parent.on(refreshImagePosition, this.refreshInsDelImagePosition, this);\n    };\n    /**\n     * Rendering upload component for importing images.\n     *\n     * @returns {void} - Rendering upload component for importing images.\n     */\n    SpreadsheetImage.prototype.renderImageUpload = function () {\n        var uploadID = this.parent.element.id + '_imageUpload';\n        this.parent.element.appendChild(this.parent.createElement('input', {\n            id: uploadID,\n            attrs: { type: 'file', accept: '.image, .jpg, .png, .gif ,jpeg', name: 'fileUpload' }\n        }));\n        var uploadBox = document.getElementById(uploadID);\n        uploadBox.onchange = this.imageSelect.bind(this);\n        uploadBox.style.display = 'none';\n    };\n    /**\n     * Process after select the excel and image file.\n     *\n     * @param {Event} args - File select native event.\n     * @returns {void} - Process after select the excel and image file.\n     */\n    SpreadsheetImage.prototype.imageSelect = function (args) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var filesData = args.target.files[0];\n        if (filesData && filesData.length < 1) {\n            return;\n        }\n        var impArgs = {\n            file: filesData\n        };\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (impArgs.file.type.indexOf('image') === 0) {\n            this.insertImage(impArgs);\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService('spreadsheetLocale')\n                    .getConstant('UnsupportedFile'),\n                width: '300'\n            });\n        }\n        document.getElementById(this.parent.element.id + '_imageUpload').value = '';\n    };\n    /**\n     * Removing event listener for success and failure\n     *\n     * @returns {void} - Removing event listener for success and failure\n     */\n    SpreadsheetImage.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insertImage, this.insertImage);\n            this.parent.off(refreshImgCellObj, this.refreshImgCellObj);\n            this.parent.off(createImageElement, this.createImageElement);\n            this.parent.off(deleteImage, this.deleteImage);\n            this.parent.off(refreshImagePosition, this.refreshInsDelImagePosition);\n        }\n    };\n    /* eslint-disable */\n    SpreadsheetImage.prototype.insertImage = function (args, range) {\n        var _this = this;\n        this.binaryStringVal(args).then(function (src) { return _this.createImageElement({ options: { src: src }, range: range, isPublic: true }); });\n    };\n    SpreadsheetImage.prototype.binaryStringVal = function (args) {\n        return new Promise(function (resolve, reject) {\n            var reader = new FileReader();\n            reader.readAsDataURL(args.file);\n            reader.onload = function () { return resolve(reader.result); };\n            reader.onerror = function (error) { return reject(error); };\n        });\n    };\n    /* eslint-enable */\n    SpreadsheetImage.prototype.createImageElement = function (args) {\n        var range = args.range ? (args.range.indexOf('!') > 0) ? args.range.split('!')[1] : args.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIndex = (args.range && args.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, args.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var overlayObj = this.parent.serviceLocator.getService(overlay);\n        var id = args.options.imageId ? args.options.imageId : this.parent.element.id + '_overlay_picture_' + this.pictureCount;\n        var indexes = getRangeIndexes(range);\n        var sheet = sheetIndex ? this.parent.sheets[sheetIndex] : this.parent.getActiveSheet();\n        if (document.getElementById(id)) {\n            return;\n        }\n        var eventArgs = {\n            requestType: 'beforeInsertImage', range: sheet.name + '!' + range,\n            imageData: args.options.src, sheetIndex: sheetIndex\n        };\n        if (args.isPublic) {\n            this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'beforeInsertImage' });\n        }\n        if (eventArgs.cancel) {\n            return;\n        }\n        var element = overlayObj.insertOverlayElement(id, range, sheetIndex);\n        element.style.backgroundImage = 'url(\\'' + args.options.src + '\\')';\n        if (args.options.height || args.options.left) {\n            element.style.height = args.options.height + 'px';\n            element.style.width = args.options.width + 'px';\n            element.style.top = args.options.top + 'px';\n            element.style.left = args.options.left + 'px';\n        }\n        if (sheet.frozenRows || sheet.frozenColumns) {\n            overlayObj.adjustFreezePaneSize(args.options, element, range);\n        }\n        if (!args.options.imageId) {\n            this.pictureCount++;\n        }\n        var imgData = {\n            src: args.options.src, id: id, height: parseFloat(element.style.height.replace('px', '')),\n            width: parseFloat(element.style.width.replace('px', '')), top: sheet.frozenRows || sheet.frozenColumns ?\n                (indexes[0] ? getRowsHeight(sheet, 0, indexes[0] - 1) : 0) : parseFloat(element.style.top.replace('px', '')),\n            left: sheet.frozenRows || sheet.frozenColumns ? (indexes[1] ? getColumnsWidth(sheet, 0, indexes[1] - 1) : 0) :\n                parseFloat(element.style.left.replace('px', ''))\n        };\n        this.parent.setUsedRange(indexes[0], indexes[1]);\n        if (args.isPublic || args.isUndoRedo) {\n            this.parent.notify(setImage, { options: [imgData], range: sheet.name + '!' + range });\n        }\n        var currCell = getCell(indexes[0], indexes[1], sheet);\n        if (!currCell.image[currCell.image.length - 1].id) {\n            currCell.image[currCell.image.length - 1].id = imgData.id;\n        }\n        eventArgs = {\n            requestType: 'insertImage', range: sheet.name + '!' + range, imageHeight: args.options.height ? args.options.height : 300,\n            imageWidth: args.options.width ? args.options.width : 400, imageData: args.options.src, id: id, sheetIndex: sheetIndex\n        };\n        if (!args.isUndoRedo && args.isPublic) {\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'insertImage' });\n        }\n    };\n    SpreadsheetImage.prototype.refreshImgElem = function () {\n        var overlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        if (overlayElem) {\n            removeClass([overlayElem], 'e-ss-overlay-active');\n        }\n    };\n    SpreadsheetImage.prototype.refreshInsDelImagePosition = function (args) {\n        var count = args.count;\n        var sheetIdx = args.sheetIdx;\n        var sheet = this.parent.sheets[sheetIdx];\n        var pictureElements;\n        var currCellObj = getCell(args.rowIdx, args.colIdx, sheet);\n        var imageLen = currCellObj.image.length;\n        var top;\n        var left;\n        for (var i = 0; i < imageLen; i++) {\n            pictureElements = document.getElementById(currCellObj.image[i].id);\n            top = (args.type === 'Row') ? (args.status === 'insert') ? currCellObj.image[i].top + (count * 20) :\n                currCellObj.image[i].top - (count * 20) : currCellObj.image[i].top;\n            left = (args.type === 'Column') ? (args.status === 'insert') ? currCellObj.image[i].left + (count * 64) :\n                currCellObj.image[i].left - (count * 64) : currCellObj.image[i].left;\n            currCellObj.image[i].top = top;\n            currCellObj.image[i].left = left;\n            pictureElements.style.top = top + 'px';\n            pictureElements.style.left = left + 'px';\n        }\n    };\n    SpreadsheetImage.prototype.refreshImgCellObj = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var prevCellObj = getCell(args.prevRowIdx, args.prevColIdx, sheet);\n        var currCellObj = getCell(args.currentRowIdx, args.currentColIdx, sheet);\n        var prevCellImg = prevCellObj ? prevCellObj.image : [];\n        var prevImgObj;\n        var currImgObj;\n        var prevCellImgLen = (prevCellImg && prevCellImg.length) ? prevCellImg.length : 0;\n        if (prevCellObj && prevCellObj.image && prevCellImg.length > 0) {\n            for (var i = 0; i < prevCellImgLen; i++) {\n                if (prevCellImg[i] && prevCellImg[i].id === args.id) {\n                    prevImgObj = prevCellImg[i];\n                    prevImgObj.height = args.currentHeight;\n                    prevImgObj.width = args.currentWidth;\n                    prevImgObj.top = args.currentTop;\n                    prevImgObj.left = args.currentLeft;\n                    prevCellImg.splice(i, 1);\n                }\n            }\n            if (currCellObj && currCellObj.image) {\n                currImgObj = currCellObj.image;\n                if (prevImgObj) {\n                    currImgObj.push(prevImgObj);\n                }\n            }\n            if (currImgObj) {\n                setCell(args.currentRowIdx, args.currentColIdx, sheet, { image: currImgObj }, true);\n            }\n            else {\n                setCell(args.currentRowIdx, args.currentColIdx, sheet, { image: [prevImgObj] }, true);\n            }\n            if (args.requestType === 'imageRefresh' && !args.isUndoRedo) {\n                var eventArgs = {\n                    requestType: 'imageRefresh', currentRowIdx: args.currentRowIdx, currentColIdx: args.currentColIdx,\n                    prevRowIdx: args.prevRowIdx, prevColIdx: args.prevColIdx, prevTop: args.prevTop, prevLeft: args.prevLeft,\n                    currentTop: args.currentTop, currentLeft: args.currentLeft, currentHeight: args.currentHeight,\n                    currentWidth: args.currentWidth, prevHeight: args.prevHeight, prevWidth: args.prevWidth,\n                    id: args.id, sheetIdx: this.parent.activeSheetIndex\n                };\n                this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'imageRefresh' });\n            }\n        }\n    };\n    SpreadsheetImage.prototype.deleteImage = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var pictureElements = document.getElementById(args.id);\n        var rowIdx;\n        var colIdx;\n        if (pictureElements) {\n            var imgTop = void 0;\n            var imgleft = void 0;\n            if (sheet.frozenRows || sheet.frozenColumns) {\n                var clientRect = pictureElements.getBoundingClientRect();\n                imgTop = { clientY: clientRect.top };\n                imgleft = { clientX: clientRect.left };\n                if (clientRect.top < this.parent.getColumnHeaderContent().getBoundingClientRect().bottom) {\n                    imgTop.target = this.parent.getColumnHeaderContent();\n                }\n                if (clientRect.left < this.parent.getRowHeaderContent().getBoundingClientRect().right) {\n                    imgleft.target = this.parent.getRowHeaderTable();\n                }\n            }\n            else {\n                imgTop = { clientY: pictureElements.offsetTop, isImage: true };\n                imgleft = { clientX: pictureElements.offsetLeft, isImage: true };\n            }\n            this.parent.notify(getRowIdxFromClientY, imgTop);\n            this.parent.notify(getColIdxFromClientX, imgleft);\n            document.getElementById(args.id).remove();\n            rowIdx = imgTop.clientY;\n            colIdx = imgleft.clientX;\n            sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        }\n        else {\n            var rangeVal = args.range ? args.range.indexOf('!') > 0 ? args.range.split('!')[1] : args.range.split('!')[0] :\n                this.parent.getActiveSheet().selectedRange;\n            var sheetIndex = args.range && args.range.indexOf('!') > 0 ? getSheetIndex(this.parent, args.range.split('!')[0]) :\n                this.parent.activeSheetIndex;\n            var index = getRangeIndexes(rangeVal);\n            rowIdx = index[0];\n            colIdx = index[1];\n            sheet = this.parent.sheets[sheetIndex];\n        }\n        var cellObj = getCell(rowIdx, colIdx, sheet);\n        var prevCellImg = cellObj.image;\n        var imgLength = prevCellImg.length;\n        for (var i = 0; i < imgLength; i++) {\n            if (prevCellImg[i].id === args.id) {\n                prevCellImg.splice(i, 1);\n            }\n        }\n        setCell(rowIdx, colIdx, sheet, { image: prevCellImg }, true);\n    };\n    /**\n     * To Remove the event listeners.\n     *\n     * @returns {void} - To Remove the event listeners.\n     */\n    SpreadsheetImage.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the sheet picture module name.\n     *\n     * @returns {string} - Get the sheet picture module name.\n     */\n    SpreadsheetImage.prototype.getModuleName = function () {\n        return 'spreadsheetImage';\n    };\n    return SpreadsheetImage;\n}());\nexport { SpreadsheetImage };\n","import { getSheetIndex, isHiddenRow, getCell, setCell } from '../../workbook/index';\nimport { initiateChart, getRangeIndexes, isNumber, isDateTime, dateToInt } from '../../workbook/common/index';\nimport { overlay, locale, refreshChartCellObj, getRowIdxFromClientY, getColIdxFromClientX, deleteChart, dialog, overlayEleSize } from '../common/index';\nimport { beginAction, completeAction, clearChartBorder, focusBorder } from '../common/index';\nimport { Chart, ColumnSeries, Category, StackingColumnSeries, BarSeries } from '@syncfusion/ej2-charts';\nimport { AreaSeries, StackingAreaSeries, AccumulationChart } from '@syncfusion/ej2-charts';\nimport { Legend, StackingBarSeries, LineSeries, StackingLineSeries, ScatterSeries } from '@syncfusion/ej2-charts';\nimport { AccumulationLegend, PieSeries, AccumulationTooltip, AccumulationDataLabel } from '@syncfusion/ej2-charts';\nimport { isNullOrUndefined, getComponent, closest, detach } from '@syncfusion/ej2-base';\nimport { Tooltip } from '@syncfusion/ej2-popups';\nimport { getTypeFromFormat } from '../../workbook/integrations/index';\nimport { updateChart, deleteChartColl, getFormattedCellObject, setChart, getCellAddress } from '../../workbook/common/index';\nimport { insertChart, chartRangeSelection, addChartEle, chartDesignTab, removeDesignChart } from '../common/index';\nimport { DataLabel } from '@syncfusion/ej2-charts';\nimport { isHiddenCol } from '../../workbook/index';\nChart.Inject(ColumnSeries, LineSeries, BarSeries, AreaSeries, StackingColumnSeries, StackingLineSeries, StackingBarSeries, ScatterSeries);\nChart.Inject(StackingAreaSeries, Category, Legend, Tooltip, DataLabel);\nAccumulationChart.Inject(PieSeries, AccumulationTooltip, AccumulationDataLabel, AccumulationLegend);\n/**\n * Represents Chart support for Spreadsheet.\n */\nvar SpreadsheetChart = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Chart module.\n     *\n     * @param {Spreadsheet} parent - Constructor for the Spreadsheet Chart module.\n     */\n    function SpreadsheetChart(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * Adding event listener for success and failure\n     *\n     * @returns {void} - Adding event listener for success and failure\n     */\n    SpreadsheetChart.prototype.addEventListener = function () {\n        this.parent.on(initiateChart, this.initiateChartHandler, this);\n        this.parent.on(refreshChartCellObj, this.refreshChartCellObj, this);\n        this.parent.on(updateChart, this.updateChartHandler, this);\n        this.parent.on(deleteChart, this.deleteChart, this);\n        this.parent.on(clearChartBorder, this.clearBorder, this);\n        this.parent.on(insertChart, this.insertChartHandler, this);\n        this.parent.on(chartRangeSelection, this.chartRangeHandler, this);\n        this.parent.on(chartDesignTab, this.chartDesignTabHandler, this);\n        this.parent.on(addChartEle, this.updateChartElement, this);\n    };\n    SpreadsheetChart.prototype.insertChartHandler = function (args) {\n        var chartType = 'Column';\n        switch (args.id) {\n            case 'clusteredColumn':\n                chartType = 'Column';\n                break;\n            case 'stackedColumn':\n                chartType = 'StackingColumn';\n                break;\n            case 'stackedColumn100':\n                chartType = 'StackingColumn100';\n                break;\n            case 'clusteredBar':\n                chartType = 'Bar';\n                break;\n            case 'stackedBar':\n                chartType = 'StackingBar';\n                break;\n            case 'stackedBar100':\n                chartType = 'StackingBar100';\n                break;\n            case 'area':\n                chartType = 'Area';\n                break;\n            case 'stackedArea':\n                chartType = 'StackingArea';\n                break;\n            case 'stackedArea100':\n                chartType = 'StackingArea100';\n                break;\n            case 'line':\n                chartType = 'Line';\n                break;\n            case 'stackedLine':\n                chartType = 'StackingLine';\n                break;\n            case 'stackedLine100':\n                chartType = 'StackingLine100';\n                break;\n            case 'pie':\n                chartType = 'Pie';\n                break;\n            case 'doughnut':\n                chartType = 'Doughnut';\n                break;\n            //  case 'radar':\n            //     chartType = ;\n            //     break;\n            //  case 'radar_markers':\n            //     chartType = 'Column';\n            //     break;\n            case 'scatter':\n                chartType = 'Scatter';\n                break;\n        }\n        var chart = [{ type: chartType }];\n        if (args.isChart) {\n            this.parent.notify(setChart, { chart: chart });\n        }\n        else {\n            this.parent.notify(chartDesignTab, { chartType: chartType });\n        }\n    };\n    SpreadsheetChart.prototype.chartRangeHandler = function () {\n        var overlayEle = document.querySelector('.e-datavisualization-chart.e-ss-overlay-active');\n        if (overlayEle) {\n            var chartId = overlayEle.getElementsByClassName('e-control')[0].id;\n            var chartColl = this.parent.chartColl;\n            var chartCollLen = chartColl.length;\n            for (var idx = 0; idx < chartCollLen; idx++) {\n                var chartEle = document.getElementById(chartColl[idx].id);\n                if (overlayEle && chartEle && chartColl[idx].id === chartId) {\n                    this.parent.notify(initiateChart, {\n                        option: chartColl[idx], chartCount: this.parent.chartCount, isRefresh: true\n                    });\n                }\n            }\n        }\n    };\n    SpreadsheetChart.prototype.getPropertyValue = function (rIdx, cIdx, sheetIndex) {\n        var sheets = this.parent.sheets;\n        if (sheets[sheetIndex] && sheets[sheetIndex].rows[rIdx] && sheets[sheetIndex].rows[rIdx].cells[cIdx]) {\n            var cell = getCell(rIdx, cIdx, this.parent.sheets[sheetIndex]);\n            var value = '';\n            if (cell.format) {\n                var formatObj = {\n                    type: getTypeFromFormat(cell.format),\n                    value: cell && cell.value, format: cell && cell.format ?\n                        cell.format : 'General', formattedText: cell && cell.value,\n                    onLoad: true, isRightAlign: false, cell: cell,\n                    rowIdx: rIdx.toString(), colIdx: cIdx.toString()\n                };\n                if (cell) {\n                    this.parent.notify(getFormattedCellObject, formatObj);\n                    if (typeof (formatObj.value) === 'number') {\n                        // eslint-disable-next-line no-useless-escape\n                        var escapeRegx = new RegExp('[!@#$%^&()+=\\';,{}|\\\":<>~_-]', 'g');\n                        formatObj.formattedText = (formatObj.formattedText.toString()).replace(escapeRegx, '');\n                        value = parseInt(formatObj.formattedText.toString(), 10);\n                    }\n                    else {\n                        value = formatObj.formattedText.toString();\n                        parseFloat('');\n                    }\n                }\n            }\n            else {\n                value = this.parent.sheets[sheetIndex].rows[rIdx].cells[cIdx].value;\n            }\n            value = isNullOrUndefined(value) ? '' : value;\n            return value;\n        }\n        else {\n            return '';\n        }\n    };\n    SpreadsheetChart.prototype.updateChartHandler = function (args) {\n        var series = this.initiateChartHandler({ option: args.chart, isRefresh: true });\n        var chartObj = this.parent.element.querySelector('.' + args.chart.id);\n        if (chartObj) {\n            var chartComp = getComponent(chartObj, 'chart');\n            if (isNullOrUndefined(chartComp)) {\n                chartComp = getComponent(chartObj, 'accumulationchart');\n            }\n            chartComp.series = series;\n            chartComp.refresh();\n        }\n    };\n    SpreadsheetChart.prototype.refreshChartCellObj = function (args) {\n        var sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        var prevCellObj = getCell(args.prevRowIdx, args.prevColIdx, sheet);\n        var currCellObj = getCell(args.currentRowIdx, args.currentColIdx, sheet);\n        var prevCellChart = prevCellObj ? prevCellObj.chart : [];\n        var prevChartObj;\n        var currChartObj;\n        var prevCellChartLen = (prevCellChart && prevCellChart.length) ? prevCellChart.length : 0;\n        if (prevCellObj && prevCellObj.chart) {\n            for (var i = 0; i < prevCellChartLen; i++) {\n                var overlayEle = document.getElementsByClassName('e-datavisualization-chart e-ss-overlay-active')[0];\n                var chartEleClassName = document.getElementById(prevCellChart[i].id);\n                if (closest(chartEleClassName, '.' + overlayEle.classList[1]) === overlayEle) {\n                    prevChartObj = prevCellChart[i];\n                    prevChartObj.height = args.currentHeight;\n                    prevChartObj.width = args.currentWidth;\n                    prevChartObj.top = args.currentTop;\n                    prevChartObj.left = args.currentLeft;\n                    prevCellChart.splice(i, 1);\n                    for (var idx = 0, chartCollLen = this.parent.chartColl.length; idx < chartCollLen; idx++) {\n                        if (prevChartObj.id === this.parent.chartColl[idx].id) {\n                            prevChartObj.height = args.currentHeight;\n                            this.parent.chartColl[idx].width = args.currentWidth;\n                            this.parent.chartColl[idx].top = args.currentTop;\n                            this.parent.chartColl[idx].left = args.currentLeft;\n                        }\n                    }\n                }\n            }\n            if (currCellObj && currCellObj.chart) {\n                currChartObj = currCellObj.chart;\n                if (prevChartObj) {\n                    currChartObj.push(prevChartObj);\n                }\n            }\n            if (currChartObj) {\n                setCell(args.currentRowIdx, args.currentColIdx, sheet, { chart: currChartObj }, true);\n            }\n            else {\n                setCell(args.currentRowIdx, args.currentColIdx, sheet, { chart: [prevChartObj] }, true);\n            }\n            if (args.requestType === 'chartRefresh' && !args.isUndoRedo) {\n                var eventArgs = {\n                    requestType: 'chartRefresh', currentRowIdx: args.currentRowIdx, currentColIdx: args.currentColIdx,\n                    currentWidth: args.currentWidth, prevHeight: args.prevHeight, prevWidth: args.prevWidth,\n                    prevRowIdx: args.prevRowIdx, prevColIdx: args.prevColIdx, prevTop: args.prevTop, prevLeft: args.prevLeft,\n                    currentTop: args.currentTop, currentLeft: args.currentLeft, currentHeight: args.currentHeight,\n                    id: args.id, sheetIdx: this.parent.activeSheetIndex\n                };\n                this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'chartRefresh' });\n            }\n        }\n    };\n    SpreadsheetChart.prototype.processChartRange = function (range, dataSheetIdx, opt) {\n        var xRange;\n        var yRange;\n        var lRange;\n        var minr = range[0];\n        var minc = range[1];\n        var isStringSeries = false;\n        var maxr = range[2];\n        var maxc = range[3];\n        var isSingleRow = minr === maxr;\n        var isSingleCol = minc === maxc;\n        var trVal = this.getPropertyValue(minr, maxc, dataSheetIdx);\n        // trVal = this.getParseValue(trVal);\n        var blVal = this.getPropertyValue(maxr, minc, dataSheetIdx);\n        // blVal = this.getParseValue(blVal);\n        var tlVal = this.getPropertyValue(minr, minc, dataSheetIdx);\n        // tlVal = this.getParseValue(tlVal);\n        if (!isNumber(blVal) || !tlVal) {\n            isStringSeries = true;\n        }\n        if (isNullOrUndefined(tlVal) && !isSingleRow && !isSingleCol || (opt.type === 'Scatter' && range[3] - range[1] === 1)) {\n            xRange = [minr + 1, minc, maxr, minc];\n            yRange = [minr + 1, minc + 1, maxr, maxc];\n            lRange = [minr, minc + 1, minr, maxc];\n        }\n        else if ((!isNullOrUndefined(blVal) && isStringSeries && !isSingleRow && !isSingleCol)) {\n            if (!isNullOrUndefined(trVal) && (!isNumber(trVal) || !tlVal)) {\n                xRange = [minr + 1, minc, maxr, minc];\n                yRange = [minr + 1, minc + 1, maxr, maxc];\n                lRange = [minr, minc + 1, minr, maxc];\n            }\n            else {\n                xRange = [minr, minc, maxr, minc];\n                yRange = [minr, minc + 1, maxr, maxc];\n            }\n        }\n        else {\n            yRange = [minr, minc, maxr, maxc];\n            if ((!isNullOrUndefined(trVal) && !isNumber(trVal) && !isDateTime(trVal))) {\n                lRange = [minr, minc, minr, maxc];\n                yRange[0] = yRange[0] + 1;\n            }\n            else if (isNullOrUndefined(tlVal) && (isSingleRow || isSingleCol)) {\n                lRange = [minr, minc, minr, maxc];\n                if (isSingleRow) {\n                    yRange[1] = yRange[1] + 1;\n                    lRange[3] = lRange[1];\n                }\n                else {\n                    yRange[0] = yRange[0] + 1;\n                }\n            }\n        }\n        return { xRange: xRange, yRange: yRange, lRange: lRange };\n    };\n    SpreadsheetChart.prototype.toIntrnlRange = function (range, sheetIdx) {\n        if (!range) {\n            range = getRangeIndexes[this.parent.sheets[sheetIdx].selectedRange];\n        }\n        else if (typeof (range) === 'string') {\n            range = getRangeIndexes[range];\n        }\n        return range;\n    };\n    SpreadsheetChart.prototype.getRangeData = function (options) {\n        options.range = this.toIntrnlRange(options.range, options.sheetIdx);\n        var rowIdx = [];\n        var arr = [];\n        this.pushRowData(options, options.range[0], options.range[1], options.range[2], options.range[3], arr, rowIdx, true, options.isYvalue);\n        return arr;\n    };\n    SpreadsheetChart.prototype.pushRowData = function (options, minr, minc, maxr, maxc, arr, rowIdx, isDataSrcEnsured, isYvalue) {\n        var minCol = minc;\n        var sheet = this.parent.sheets[options.sheetIdx];\n        while (minr <= maxr) {\n            if (isHiddenRow(sheet, minr)) {\n                minr++;\n                continue;\n            }\n            minc = minCol;\n            while (minc <= maxc) {\n                if (isHiddenCol(sheet, minc)) {\n                    minc++;\n                    continue;\n                }\n                var value = '';\n                var cell = getCell(minr, minc, sheet);\n                if (cell && cell.format && !isYvalue) {\n                    var forArgs = {\n                        value: cell && cell.value, format: cell && cell.format ? cell.format : 'General',\n                        formattedText: cell && cell.value, onLoad: true,\n                        type: cell && getTypeFromFormat(cell.format),\n                        rowIdx: minr.toString(), colIdx: minc.toString(),\n                        isRightAlign: false, cell: cell\n                    };\n                    this.parent.notify(getFormattedCellObject, forArgs);\n                    value = forArgs.formattedText.toString();\n                }\n                else {\n                    value = cell ? (!isNullOrUndefined(cell.value) ? cell.value : '') : '';\n                }\n                // = this.parent.getValueRowCol(options.sheetIdx, minr + 1, minc + 1);\n                arr.push({ value: value });\n                minc++;\n            }\n            minr++;\n        }\n        rowIdx.push(minr);\n    };\n    SpreadsheetChart.prototype.toArrayData = function (args) {\n        var prop = 'value';\n        var obj;\n        var i = 0;\n        var temp = [];\n        var len = args.length;\n        while (i < len) {\n            obj = args[i];\n            if (Object.keys(obj).length) {\n                if (prop in obj) {\n                    temp.push(obj[prop]);\n                }\n            }\n            else {\n                temp.push('');\n            }\n            i++;\n        }\n        return temp;\n    };\n    SpreadsheetChart.prototype.getVirtualXValues = function (limit) {\n        var i = 1;\n        var arr = [];\n        while (i < limit) {\n            arr.push(i.toString());\n            i++;\n        }\n        return arr;\n    };\n    SpreadsheetChart.prototype.processChartSeries = function (options, sheetIndex, xRange, yRange, lRange) {\n        options = options || {};\n        var seriesName = '';\n        var dataLabel = {};\n        var val;\n        var xValue;\n        var lValue;\n        var diff;\n        var pArr;\n        var pObj = {};\n        var j;\n        var i = 0;\n        var yInc = 0;\n        var sArr = [];\n        var dtVal;\n        sheetIndex = isNullOrUndefined(sheetIndex) ? this.parent.getActiveSheet().index : sheetIndex;\n        var sheet = this.parent.sheets[sheetIndex];\n        var yValue = this.getRangeData({ range: yRange, sheetIdx: sheetIndex, skipFormula: true, isYvalue: true });\n        var rDiff = ((yRange[2] - yRange[0]) + 1) - this.parent.hiddenCount(yRange[0], yRange[2], 'rows', sheet);\n        var cDiff = ((yRange[3] - yRange[1]) + 1) - this.parent.hiddenCount(yRange[0], yRange[2], 'columns', sheet);\n        if (options.isSeriesInRows) {\n            xValue = lRange ? this.toArrayData(this.getRangeData({ range: lRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false })) :\n                this.getVirtualXValues(cDiff + 1);\n            if (xRange) {\n                lValue = this.toArrayData(this.getRangeData({ range: xRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false }));\n            }\n            diff = rDiff;\n        }\n        else {\n            xValue = xRange ? this.toArrayData(this.getRangeData({ range: xRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false })) :\n                this.getVirtualXValues(rDiff + 1);\n            if (lRange) {\n                lValue = this.toArrayData(this.getRangeData({ range: lRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false }));\n            }\n            diff = cDiff;\n        }\n        var len = xValue.length;\n        var inc = options.isSeriesInRows ? 1 : diff;\n        if (!isNullOrUndefined(options.dataLabelSettings)) {\n            dataLabel.visible = options.dataLabelSettings.visible;\n            dataLabel.position = options.dataLabelSettings.position;\n        }\n        while (i < diff) {\n            j = 0;\n            pArr = [];\n            yInc = options.isSeriesInRows ? yInc : i;\n            while (j < len) {\n                if (yValue[yInc]) {\n                    val = yValue[yInc].value;\n                    if (isNumber(val)) {\n                        val = Number(val);\n                    }\n                    else {\n                        dtVal = dateToInt(val);\n                        val = isNaN(dtVal) ? 0 : dtVal;\n                    }\n                    pArr.push({ x: xValue[j], y: val });\n                }\n                yInc += inc;\n                j++;\n            }\n            if (lValue && lValue.length > 0) {\n                seriesName = lValue[i];\n            }\n            else {\n                seriesName = 'series' + i;\n            }\n            if (options.type) {\n                var type = options.type;\n                if (type === 'Line' || type === 'StackingLine' || type === 'StackingLine100') {\n                    pObj = {\n                        dataSource: pArr, type: options.type, xName: 'x', yName: 'y', name: seriesName.toString(), marker: {\n                            visible: true,\n                            width: 10,\n                            height: 10,\n                            dataLabel: dataLabel\n                        }\n                    };\n                }\n                else if (type === 'Scatter') {\n                    pObj = {\n                        dataSource: pArr, type: options.type, xName: 'x', yName: 'y', name: seriesName.toString(), marker: {\n                            visible: false,\n                            width: 12,\n                            height: 12,\n                            shape: 'Circle',\n                            dataLabel: dataLabel\n                        }\n                    };\n                }\n                else if (type === 'Pie' || type === 'Doughnut') {\n                    var innerRadius = options.type === 'Pie' ? '0%' : '40%';\n                    var visible = dataLabel.visible;\n                    var position = isNullOrUndefined(dataLabel.position) ? 'Inside' : dataLabel.position === 'Outer' ? 'Outside' : 'Inside';\n                    pObj = {\n                        dataSource: pArr,\n                        dataLabel: {\n                            visible: !isNullOrUndefined(visible) ? visible : false, position: position, name: 'text', font: { fontWeight: '600' }\n                        },\n                        radius: '100%', xName: 'x', yName: 'y', innerRadius: innerRadius\n                    };\n                }\n                else {\n                    pObj = {\n                        dataSource: pArr, type: options.type, xName: 'x', yName: 'y',\n                        name: seriesName.toString(), marker: { dataLabel: dataLabel }\n                    };\n                }\n            }\n            sArr.push(pObj);\n            i++;\n        }\n        var retVal;\n        if (options.type) {\n            retVal = {\n                series: sArr, xRange: options.isSeriesInRows ? lRange : xRange,\n                yRange: yRange, lRange: options.isSeriesInRows ? xRange : lRange\n            };\n        }\n        return retVal;\n    };\n    SpreadsheetChart.prototype.primaryYAxisFormat = function (yRange) {\n        if (isNullOrUndefined(yRange)) {\n            return '{value}';\n        }\n        var type;\n        var cell = getCell(yRange[0], yRange[1], this.parent.getActiveSheet());\n        if (cell && cell.format) {\n            type = getTypeFromFormat(cell.format);\n            if (type === 'Accounting') {\n                return '${value}';\n            }\n            else if (type === 'Currency') {\n                return '${value}';\n            }\n            else if (type === 'Percentage') {\n                return '{value}%';\n            }\n        }\n        return '{value}';\n    };\n    SpreadsheetChart.prototype.focusChartRange = function (xRange, yRange, lRange) {\n        var border = ['e-rcborderright', 'e-rcborderbottom', 'e-vcborderright', 'e-vcborderbottom', 'e-bcborderright', 'e-bcborderbottom'];\n        this.clearBorder();\n        var range;\n        var sheet = this.parent.getActiveSheet();\n        var isFreezePane = !!(sheet.frozenRows || sheet.frozenColumns);\n        if (lRange) {\n            if (isFreezePane) {\n                range = lRange;\n            }\n            else {\n                this.parent.notify(focusBorder, {\n                    startcell: { rowIndex: lRange[0], colIndex: lRange[1] },\n                    endcell: { rowIndex: lRange[2], colIndex: lRange[3] }, classes: [border[0], border[1]]\n                });\n            }\n        }\n        if (xRange) {\n            if (isFreezePane) {\n                if (range) {\n                    range[0] = Math.min(lRange[0], xRange[0]);\n                    range[1] = Math.min(lRange[1], xRange[1]);\n                    range[2] = Math.max(lRange[2], xRange[2]);\n                    range[3] = Math.max(lRange[3], xRange[3]);\n                }\n                else {\n                    range = xRange;\n                }\n            }\n            else {\n                this.parent.notify(focusBorder, {\n                    startcell: { rowIndex: xRange[0], colIndex: xRange[1] },\n                    endcell: { rowIndex: xRange[2], colIndex: xRange[3] }, classes: [border[2], border[3]]\n                });\n            }\n        }\n        if (isFreezePane && range) {\n            this.parent.notify(focusBorder, {\n                startcell: { rowIndex: Math.min(range[0], yRange[0]), colIndex: Math.min(range[1], yRange[1]) },\n                endcell: {\n                    rowIndex: Math.max(range[2], yRange[2]), colIndex: Math.max(range[3], yRange[3])\n                }, classes: [border[4], border[5]]\n            });\n        }\n        else {\n            this.parent.notify(focusBorder, {\n                startcell: { rowIndex: yRange[0], colIndex: yRange[1] },\n                endcell: { rowIndex: yRange[2], colIndex: yRange[3] }, classes: [border[4], border[5]]\n            });\n        }\n    };\n    SpreadsheetChart.prototype.clearBorder = function () {\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.frozenColumns || sheet.frozenRows) {\n            var chartIndicator = [].slice.call(this.parent.element.getElementsByClassName('e-chart-range'));\n            chartIndicator.forEach(function (indicator) { detach(indicator); });\n            return;\n        }\n        var mainCont = this.parent.getMainContent();\n        var border = ['e-rcborderright', 'e-rcborderbottom', 'e-vcborderright', 'e-vcborderbottom', 'e-bcborderright', 'e-bcborderbottom'];\n        for (var borderIdx = 0, borderLen = border.length; borderIdx < borderLen; borderIdx++) {\n            var eleColl = mainCont.querySelectorAll('.' + border[borderIdx]);\n            for (var tdIdx = 0, eleCollLen = eleColl.length; tdIdx < eleCollLen; tdIdx++) {\n                var td = eleColl[tdIdx];\n                td.classList.remove(border[borderIdx]);\n            }\n        }\n    };\n    SpreadsheetChart.prototype.initiateChartHandler = function (argsOpt) {\n        var chart = argsOpt.option;\n        var isRangeSelect = true;\n        isRangeSelect = isNullOrUndefined(argsOpt.isInitCell) ? true : !argsOpt.isInitCell;\n        argsOpt.isUndoRedo = isNullOrUndefined(argsOpt.isUndoRedo) ? true : argsOpt.isUndoRedo;\n        var seriesModel;\n        argsOpt.isRefresh = isNullOrUndefined(argsOpt.isRefresh) ? false : argsOpt.isRefresh;\n        var sheet = this.parent.getActiveSheet();\n        var range = chart.range ? (chart.range.indexOf('!') > 0) ?\n            chart.range.split('!')[1] : chart.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var rangeIdx = getRangeIndexes(range);\n        var options = {};\n        var isRowLesser;\n        var eventArgs;\n        if (!this.parent.allowChart && sheet.isProtected) {\n            return seriesModel;\n        }\n        var sheetIdx = (chart.range && chart.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, chart.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var args = {\n            sheetIndex: sheetIdx, reqType: 'shape', type: 'actionBegin', shapeType: 'chart',\n            action: 'create', options: chart, range: range, operation: 'create'\n        };\n        options = args.options;\n        range = args.range;\n        options = options || {};\n        if (rangeIdx.length > 0) {\n            var rDiff = rangeIdx[2] - rangeIdx[0];\n            var cDiff = rangeIdx[3] - rangeIdx[1];\n            if (rDiff < cDiff) {\n                isRowLesser = true;\n            }\n        }\n        options.isSeriesInRows = isRowLesser ? true : options.isSeriesInRows ? options.isSeriesInRows : false;\n        argsOpt.dataSheetIdx = isNullOrUndefined(argsOpt.dataSheetIdx) ? sheetIdx : argsOpt.dataSheetIdx;\n        var chartRange = this.processChartRange(rangeIdx, argsOpt.dataSheetIdx, options);\n        var xRange = chartRange.xRange;\n        var yRange = chartRange.yRange;\n        var lRange = chartRange.lRange;\n        if (sheetIdx === this.parent.activeSheetIndex && isRangeSelect) {\n            this.focusChartRange(xRange, yRange, lRange);\n        }\n        var chartOptions = this.processChartSeries(options, argsOpt.dataSheetIdx, xRange, yRange, lRange);\n        var primaryXAxis = {\n            majorGridLines: chart.primaryXAxis && chart.primaryXAxis.majorGridLines &&\n                !isNullOrUndefined(chart.primaryXAxis.majorGridLines.width) ?\n                { width: chart.primaryXAxis.majorGridLines.width } : { width: 0 },\n            minorGridLines: chart.primaryXAxis && chart.primaryXAxis.minorGridLines &&\n                !isNullOrUndefined(chart.primaryXAxis.minorGridLines.width) ?\n                { width: chart.primaryXAxis.minorGridLines.width } : { width: 0 },\n            minorTicksPerInterval: chart.primaryXAxis && chart.primaryXAxis.minorGridLines && chart.primaryXAxis.minorGridLines.width > 0 ?\n                5 : 0,\n            lineStyle: { width: 0 },\n            valueType: 'Category',\n            visible: chart.primaryXAxis ? chart.primaryXAxis.visible : true,\n            title: chart.primaryXAxis ? chart.primaryXAxis.title : ''\n        };\n        var primaryYAxis = {\n            lineStyle: { width: 0 },\n            majorGridLines: chart.primaryYAxis && chart.primaryYAxis.majorGridLines &&\n                !isNullOrUndefined(chart.primaryYAxis.majorGridLines.width) ?\n                { width: chart.primaryYAxis.majorGridLines.width } : { width: 1 },\n            minorGridLines: chart.primaryYAxis && chart.primaryYAxis.minorGridLines &&\n                !isNullOrUndefined(chart.primaryYAxis.minorGridLines.width) ?\n                { width: chart.primaryYAxis.minorGridLines.width } : { width: 0 },\n            minorTicksPerInterval: chart.primaryYAxis && chart.primaryYAxis.minorGridLines && chart.primaryYAxis.minorGridLines.width > 0 ?\n                5 : 0,\n            labelFormat: this.primaryYAxisFormat(yRange),\n            visible: chart.primaryYAxis ? chart.primaryYAxis.visible : true,\n            title: chart.primaryYAxis ? chart.primaryYAxis.title : ''\n        };\n        if (argsOpt.isRefresh) {\n            return chartOptions.series;\n        }\n        if (argsOpt.isUndoRedo) {\n            eventArgs = {\n                type: chart.type, theme: chart.theme, isSeriesInRows: chart.isSeriesInRows, range: chart.range, id: chart.id,\n                height: chart.height, width: chart.width, posRange: argsOpt.range, isInitCell: argsOpt.isInitCell, cancel: false\n            };\n            this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'beforeInsertChart' });\n            if (eventArgs.cancel) {\n                return [];\n            }\n            chart.type = eventArgs.type;\n            chart.theme = eventArgs.theme;\n            chart.isSeriesInRows = eventArgs.isSeriesInRows;\n            chart.range = eventArgs.range;\n            chart.id = eventArgs.id;\n            chart.height = eventArgs.height;\n            chart.width = eventArgs.width;\n        }\n        var id = chart.id + '_overlay';\n        var sheetIndex = argsOpt.isPaste ? this.parent.getActiveSheet().index :\n            (argsOpt.option.range && argsOpt.option.range.indexOf('!') > 0) ?\n                getSheetIndex(this.parent, argsOpt.option.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var overlayObj = this.parent.serviceLocator.getService(overlay);\n        var eleRange = !isNullOrUndefined(argsOpt.isInitCell) && argsOpt.isInitCell ? argsOpt.range : range;\n        var element = overlayObj.insertOverlayElement(id, eleRange, sheetIndex);\n        element.classList.add('e-datavisualization-chart');\n        element.style.width = chart.width + 'px';\n        element.style.height = chart.height + 'px';\n        if (sheet.frozenRows || sheet.frozenColumns) {\n            overlayObj.adjustFreezePaneSize(chart, element, eleRange);\n        }\n        else {\n            element.style.top = isNullOrUndefined(chart.top) ? element.style.top : (chart.top + 'px');\n            element.style.left = isNullOrUndefined(chart.left) ? element.style.left : (chart.left + 'px');\n            chart.top = parseInt(element.style.top.replace('px', ''), 10);\n            chart.left = parseInt(element.style.left.replace('px', ''), 10);\n        }\n        this.parent.notify(overlayEleSize, { height: chart.height, width: chart.width });\n        var legendSettings = (chart.type === 'Pie' || chart.type === 'Doughnut') ? { position: 'Bottom', visible: true } : {};\n        if (!isNullOrUndefined(chart.legendSettings)) {\n            legendSettings.visible = chart.legendSettings.visible;\n            legendSettings.position = chart.legendSettings.position;\n        }\n        var chartContent = this.parent.createElement('div', {\n            id: chart.id, className: chart.id\n        });\n        if (chart.type !== 'Pie' && chart.type !== 'Doughnut') {\n            this.chart = new Chart({\n                primaryXAxis: primaryXAxis,\n                primaryYAxis: primaryYAxis,\n                chartArea: {\n                    border: {\n                        width: 0\n                    }\n                },\n                title: chart.title,\n                legendSettings: legendSettings,\n                theme: chart.theme,\n                series: chartOptions.series,\n                tooltip: {\n                    enable: true\n                },\n                width: element.style.width,\n                height: element.style.height,\n                load: function (args) {\n                    var selectedTheme = chart.theme;\n                    selectedTheme = selectedTheme ? selectedTheme : 'Material';\n                    args.chart.theme = selectedTheme;\n                },\n                beforeResize: function (args) {\n                    args.cancelResizedEvent = true; // This is for cancel the resized event.\n                }\n            });\n            this.chart.appendTo(chartContent);\n        }\n        else {\n            this.chart = new AccumulationChart({\n                title: chart.title,\n                legendSettings: legendSettings,\n                theme: chart.theme,\n                series: chartOptions.series,\n                width: element.style.width,\n                height: element.style.height,\n                center: { x: '50%', y: '50%' },\n                enableSmartLabels: true,\n                enableAnimation: true,\n                load: function (args) {\n                    var selectedTheme = chart.theme;\n                    selectedTheme = selectedTheme ? selectedTheme : 'Material';\n                    args.chart.theme = selectedTheme;\n                },\n                beforeResize: function (args) {\n                    args.cancelResizedEvent = true; // This is for cancel the resized event.\n                }\n            });\n            this.chart.appendTo(chartContent);\n        }\n        element.appendChild(chartContent);\n        if (argsOpt.isUndoRedo) {\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'insertChart' });\n        }\n        return seriesModel;\n    };\n    SpreadsheetChart.prototype.deleteChart = function (args) {\n        this.clearBorder();\n        var chartElements = null;\n        var sheet = this.parent.getActiveSheet();\n        if (isNullOrUndefined(args.id)) {\n            chartElements = document.querySelector('.e-datavisualization-chart.e-ss-overlay-active');\n            args.id = chartElements ? chartElements.getElementsByClassName('e-control')[0].id : null;\n        }\n        else {\n            args.id = args.id.includes('overlay') ? args.id : args.id + '_overlay';\n            chartElements = document.getElementById(args.id);\n        }\n        if (isNullOrUndefined(args.id) || isNullOrUndefined(chartElements)) {\n            return;\n        }\n        else {\n            args.id = args.id.includes('overlay') ? args.id : args.id + '_overlay';\n        }\n        var rowIdx;\n        var colIdx;\n        var prevCellChart;\n        var isRemoveEle = false;\n        var chartObj;\n        for (var i = 0, chartCollLen = this.parent.chartColl.length; i < chartCollLen; i++) {\n            if (this.parent.chartColl[i].id === args.id.split('_overlay')[0]) {\n                chartObj = this.parent.chartColl[i];\n                break;\n            }\n        }\n        var eventArgs = {\n            id: chartObj.id, range: chartObj.range, type: chartObj.type, theme: chartObj.theme, height: chartObj.height,\n            width: chartObj.width, isSeriesInRows: chartObj.isSeriesInRows, isInitCell: true, posRange: null,\n            top: chartObj.top, left: chartObj.left, cancel: false\n        };\n        if (chartElements) {\n            var chartTop = void 0;\n            var chartleft = void 0;\n            if (sheet.frozenRows || sheet.frozenColumns) {\n                var clientRect = chartElements.getBoundingClientRect();\n                chartTop = { clientY: clientRect.top };\n                chartleft = { clientX: clientRect.left };\n                if (clientRect.top < this.parent.getColumnHeaderContent().getBoundingClientRect().bottom) {\n                    chartTop.target = this.parent.getColumnHeaderContent();\n                }\n                if (clientRect.left < this.parent.getRowHeaderContent().getBoundingClientRect().right) {\n                    chartleft.target = this.parent.getRowHeaderTable();\n                }\n            }\n            else {\n                chartTop = { clientY: chartElements.offsetTop, isImage: true };\n                chartleft = { clientX: chartElements.offsetLeft, isImage: true };\n            }\n            this.parent.notify(deleteChartColl, { id: args.id });\n            this.parent.notify(getRowIdxFromClientY, chartTop);\n            this.parent.notify(getColIdxFromClientX, chartleft);\n            isRemoveEle = true;\n            rowIdx = chartTop.clientY;\n            colIdx = chartleft.clientX;\n            sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        }\n        else {\n            this.parent.notify(deleteChartColl, { id: args.id });\n            var sheetIndex = args.range && args.range.indexOf('!') > 0 ? getSheetIndex(this.parent, args.range.split('!')[0]) :\n                this.parent.activeSheetIndex;\n            var rangeVal = args.range ? args.range.indexOf('!') > 0 ? args.range.split('!')[1] : args.range.split('!')[0] :\n                this.parent.getActiveSheet().selectedRange;\n            var index = getRangeIndexes(rangeVal);\n            rowIdx = index[0];\n            colIdx = index[1];\n            sheet = this.parent.sheets[sheetIndex];\n        }\n        var cellObj = getCell(rowIdx, colIdx, sheet);\n        if (cellObj) {\n            prevCellChart = cellObj.chart;\n        }\n        var chartLength = prevCellChart ? prevCellChart.length : null;\n        for (var i = 0; i < chartLength; i++) {\n            var overlayEle = document.getElementById(args.id);\n            var chartEleClassName = document.getElementById(prevCellChart[i].id);\n            if (closest(chartEleClassName, '.' + overlayEle.classList[1]) === overlayEle) {\n                prevCellChart.splice(i, 1);\n            }\n        }\n        if (isRemoveEle) {\n            document.getElementById(args.id).remove();\n            this.parent.notify(removeDesignChart, {});\n        }\n        setCell(rowIdx, colIdx, sheet, { chart: prevCellChart }, true);\n        eventArgs.posRange = getCellAddress(rowIdx, colIdx);\n        if (!args.isUndoRedo) {\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'deleteChart' });\n        }\n    };\n    SpreadsheetChart.prototype.updateChartModel = function (eleId, chartComp, currCellObj, chartCollId, isAccumulationChart) {\n        var accumulationChartComp = chartComp;\n        chartComp = chartComp;\n        var chartId = this.parent.chartColl[chartCollId].id;\n        if (isAccumulationChart &&\n            ['PHAxes', 'PVAxes', 'PHAxisTitle', 'PVAxisTitle', 'GLMajorHorizontal',\n                'GLMajorVertical', 'GLMinorHorizontal', 'GLMinorVertical'].indexOf(eleId) > -1) {\n            return;\n        }\n        for (var idx = 0, chartsCount = currCellObj.chart.length; idx < chartsCount; idx++) {\n            if (currCellObj.chart[idx].id === chartId) {\n                switch (eleId) {\n                    case 'PHAxes':\n                    case 'PHAxisTitle':\n                        if (isNullOrUndefined(currCellObj.chart[idx].primaryXAxis)) {\n                            currCellObj.chart[idx].primaryXAxis = {};\n                            this.parent.chartColl[chartCollId].primaryXAxis = {};\n                        }\n                        if (eleId === 'PHAxes') {\n                            currCellObj.chart[idx].primaryXAxis.visible = chartComp.primaryXAxis.visible;\n                            this.parent.chartColl[chartCollId].primaryXAxis.visible = chartComp.primaryXAxis.visible;\n                        }\n                        else if (eleId === 'PHAxisTitle') {\n                            currCellObj.chart[idx].primaryXAxis.title = chartComp.primaryXAxis.title;\n                            this.parent.chartColl[chartCollId].primaryXAxis.title = chartComp.primaryXAxis.title;\n                        }\n                        break;\n                    case 'PVAxes':\n                    case 'PVAxisTitle':\n                        if (isNullOrUndefined(currCellObj.chart[idx].primaryYAxis)) {\n                            currCellObj.chart[idx].primaryYAxis = {};\n                            this.parent.chartColl[chartCollId].primaryYAxis = {};\n                        }\n                        if (eleId === 'PVAxes') {\n                            currCellObj.chart[idx].primaryYAxis.visible = chartComp.primaryYAxis.visible;\n                            this.parent.chartColl[chartCollId].primaryYAxis.visible = chartComp.primaryYAxis.visible;\n                        }\n                        else if (eleId === 'PVAxisTitle') {\n                            currCellObj.chart[idx].primaryYAxis.title = chartComp.primaryYAxis.title;\n                            this.parent.chartColl[chartCollId].primaryYAxis.title = chartComp.primaryYAxis.title;\n                        }\n                        break;\n                    case 'ChartTitleNone':\n                    case 'ChartTitleAbove':\n                        currCellObj.chart[idx].title = chartComp.title;\n                        this.parent.chartColl[chartCollId].title = chartComp.title;\n                        break;\n                    case 'DLNone':\n                    case 'DLCenter':\n                    case 'DLInsideend':\n                    case 'DLInsidebase':\n                    case 'DLOutsideend':\n                        if (isNullOrUndefined(currCellObj.chart[idx].dataLabelSettings)) {\n                            currCellObj.chart[idx].dataLabelSettings = {};\n                            this.parent.chartColl[chartCollId].dataLabelSettings = {};\n                        }\n                        if (eleId === 'DLNone') {\n                            currCellObj.chart[idx].dataLabelSettings.visible = false;\n                            this.parent.chartColl[chartCollId].dataLabelSettings.visible = false;\n                        }\n                        else {\n                            currCellObj.chart[idx].dataLabelSettings.visible = true;\n                            this.parent.chartColl[chartCollId].dataLabelSettings.visible = true;\n                            var position = void 0;\n                            if (isAccumulationChart) {\n                                position = accumulationChartComp.series[0].dataLabel.position === 'Outside' ? 'Outer' : 'Middle';\n                            }\n                            else {\n                                position = chartComp.series[0].marker.dataLabel.position;\n                            }\n                            currCellObj.chart[idx].dataLabelSettings.position = position;\n                            this.parent.chartColl[chartCollId].dataLabelSettings.position = position;\n                        }\n                        break;\n                    case 'GLMajorHorizontal':\n                        if (isNullOrUndefined(currCellObj.chart[idx].primaryYAxis)) {\n                            currCellObj.chart[idx].primaryYAxis = {};\n                            this.parent.chartColl[chartCollId].primaryYAxis = {};\n                        }\n                        if (isNullOrUndefined(currCellObj.chart[idx].primaryYAxis.majorGridLines)) {\n                            currCellObj.chart[idx].primaryYAxis.majorGridLines = {};\n                            this.parent.chartColl[chartCollId].primaryYAxis.majorGridLines = {};\n                        }\n                        currCellObj.chart[idx].primaryYAxis.majorGridLines.width = chartComp.primaryYAxis.majorGridLines.width;\n                        this.parent.chartColl[chartCollId].primaryYAxis.majorGridLines.width = chartComp.primaryYAxis.majorGridLines.width;\n                        break;\n                    case 'GLMajorVertical':\n                        if (isNullOrUndefined(currCellObj.chart[idx].primaryXAxis)) {\n                            currCellObj.chart[idx].primaryXAxis = {};\n                            this.parent.chartColl[chartCollId].primaryXAxis = {};\n                        }\n                        if (isNullOrUndefined(currCellObj.chart[idx].primaryXAxis.majorGridLines)) {\n                            currCellObj.chart[idx].primaryXAxis.majorGridLines = {};\n                            this.parent.chartColl[chartCollId].primaryXAxis.majorGridLines = {};\n                        }\n                        currCellObj.chart[idx].primaryXAxis.majorGridLines.width = chartComp.primaryXAxis.majorGridLines.width;\n                        this.parent.chartColl[chartCollId].primaryXAxis.majorGridLines.width = chartComp.primaryXAxis.majorGridLines.width;\n                        break;\n                    case 'GLMinorHorizontal':\n                        if (isNullOrUndefined(currCellObj.chart[idx].primaryYAxis)) {\n                            currCellObj.chart[idx].primaryYAxis = {};\n                            this.parent.chartColl[chartCollId].primaryYAxis = {};\n                        }\n                        if (isNullOrUndefined(currCellObj.chart[idx].primaryYAxis.minorGridLines)) {\n                            currCellObj.chart[idx].primaryYAxis.minorGridLines = {};\n                            this.parent.chartColl[chartCollId].primaryYAxis.minorGridLines = {};\n                        }\n                        currCellObj.chart[idx].primaryYAxis.minorGridLines.width = chartComp.primaryYAxis.minorGridLines.width;\n                        this.parent.chartColl[chartCollId].primaryYAxis.minorGridLines.width = chartComp.primaryYAxis.minorGridLines.width;\n                        break;\n                    case 'GLMinorVertical':\n                        if (isNullOrUndefined(currCellObj.chart[idx].primaryXAxis)) {\n                            currCellObj.chart[idx].primaryXAxis = {};\n                            this.parent.chartColl[chartCollId].primaryXAxis = {};\n                        }\n                        if (isNullOrUndefined(currCellObj.chart[idx].primaryXAxis.minorGridLines)) {\n                            currCellObj.chart[idx].primaryXAxis.minorGridLines = {};\n                            this.parent.chartColl[chartCollId].primaryXAxis.minorGridLines = {};\n                        }\n                        currCellObj.chart[idx].primaryXAxis.minorGridLines.width = chartComp.primaryXAxis.minorGridLines.width;\n                        this.parent.chartColl[chartCollId].primaryXAxis.minorGridLines.width = chartComp.primaryXAxis.minorGridLines.width;\n                        break;\n                    case 'LegendNone':\n                    case 'LegendsRight':\n                    case 'LegendsLeft':\n                    case 'LegendsBottom':\n                    case 'LegendsTop':\n                        if (isNullOrUndefined(currCellObj.chart[idx].legendSettings)) {\n                            currCellObj.chart[idx].legendSettings = {};\n                            this.parent.chartColl[chartCollId].legendSettings = {};\n                        }\n                        currCellObj.chart[idx].legendSettings.visible = chartComp.legendSettings.visible;\n                        this.parent.chartColl[chartCollId].legendSettings.visible = chartComp.legendSettings.visible;\n                        if (eleId !== 'LegendNone') {\n                            currCellObj.chart[idx].legendSettings.position = chartComp.legendSettings.position;\n                            this.parent.chartColl[chartCollId].legendSettings.position =\n                                chartComp.legendSettings.position;\n                            break;\n                        }\n                }\n            }\n        }\n    };\n    SpreadsheetChart.prototype.updateChartElement = function (value, chartComp, currCellObj, chartCollId, title, isAccumulationChart) {\n        if (isAccumulationChart &&\n            ['PHAxes', 'PVAxes', 'PHAxisTitle', 'PVAxisTitle', 'GLMajorHorizontal',\n                'GLMajorVertical', 'GLMinorHorizontal', 'GLMinorVertical'].indexOf(value) > -1) {\n            return;\n        }\n        var chartSeries;\n        switch (value) {\n            case 'PHAxes':\n                chartComp = chartComp;\n                chartComp.primaryXAxis.visible = !chartComp.primaryXAxis.visible;\n                break;\n            case 'PVAxes':\n                chartComp = chartComp;\n                chartComp.primaryYAxis.visible = !chartComp.primaryYAxis.visible;\n                break;\n            case 'PHAxisTitle':\n                chartComp = chartComp;\n                chartComp.primaryXAxis.title = title;\n                break;\n            case 'PVAxisTitle':\n                chartComp = chartComp;\n                chartComp.primaryYAxis.title = title;\n                break;\n            case 'ChartTitleNone':\n                chartComp.title = '';\n                break;\n            case 'ChartTitleAbove':\n                chartComp.title = title;\n                break;\n            case 'DLNone':\n            case 'DLCenter':\n            case 'DLInsideend':\n            case 'DLInsidebase':\n            case 'DLOutsideend':\n                chartComp = isAccumulationChart ? chartComp : chartComp;\n                chartSeries = chartComp.series;\n                if (value === 'DLNone') {\n                    for (var idx = 0, len = chartSeries.length; idx < len; idx++) {\n                        if (isAccumulationChart) {\n                            chartSeries[idx].dataLabel.visible = false;\n                        }\n                        else {\n                            chartSeries[idx].marker.dataLabel.visible = false;\n                        }\n                    }\n                }\n                else {\n                    for (var idx = 0, len = chartSeries.length; idx < len; idx++) {\n                        if (isAccumulationChart) {\n                            var position = value === 'DLOutsideend' ? 'Outside' : 'Inside';\n                            chartSeries[idx].dataLabel.visible = true;\n                            chartSeries[idx].dataLabel.position = position;\n                        }\n                        else {\n                            var position = value === 'DLCenter' ? 'Middle' : value === 'DLInsideend' ? 'Top' : value === 'DLInsidebase' ?\n                                'Bottom' : value === 'DLOutsideend' ? 'Outer' : chartSeries[0].marker.dataLabel.position;\n                            chartSeries[idx].marker.dataLabel.visible = true;\n                            chartSeries[idx].marker.dataLabel.position = position;\n                        }\n                    }\n                }\n                chartComp.series = chartSeries;\n                if (isAccumulationChart) {\n                    chartComp.refresh();\n                }\n                break;\n            case 'GLMajorHorizontal':\n                chartComp = chartComp;\n                chartComp.primaryYAxis.majorGridLines.width = chartComp.primaryYAxis.majorGridLines.width === 0 ? 1 : 0;\n                break;\n            case 'GLMajorVertical':\n                chartComp = chartComp;\n                chartComp.primaryXAxis.majorGridLines.width = chartComp.primaryXAxis.majorGridLines.width === 0 ? 1 : 0;\n                break;\n            case 'GLMinorHorizontal':\n                chartComp = chartComp;\n                chartComp.primaryYAxis.minorTicksPerInterval = chartComp.primaryYAxis.minorGridLines.width === 0 ? 5 : 0;\n                chartComp.primaryYAxis.minorGridLines.width = chartComp.primaryYAxis.minorGridLines.width === 0 ? 1 : 0;\n                break;\n            case 'GLMinorVertical':\n                chartComp = chartComp;\n                chartComp.primaryXAxis.minorTicksPerInterval = chartComp.primaryXAxis.minorGridLines.width === 0 ? 5 : 0;\n                chartComp.primaryXAxis.minorGridLines.width = chartComp.primaryXAxis.minorGridLines.width === 0 ? 1 : 0;\n                break;\n            case 'LegendNone':\n                chartComp.legendSettings.visible = false;\n                break;\n            case 'LegendsRight':\n            case 'LegendsLeft':\n            case 'LegendsBottom':\n            case 'LegendsTop':\n                chartComp.legendSettings.visible = true;\n                chartComp.legendSettings.position = value === 'LegendsRight' ? 'Right' : value === 'LegendsLeft' ? 'Left' : value ===\n                    'LegendsBottom' ? 'Bottom' : value === 'LegendsTop' ? 'Top' : chartComp.legendSettings.position;\n                break;\n        }\n        this.updateChartModel(value, chartComp, currCellObj, chartCollId, isAccumulationChart);\n    };\n    SpreadsheetChart.prototype.chartDesignTabHandler = function (args) {\n        var title = '';\n        var isAccumulationChart = false;\n        var sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        var switchRowColumn = args.switchRowColumn;\n        var chartType = args.chartType;\n        var chartTheme = args.chartTheme;\n        var addChartEle = args.addChartEle;\n        var chartComp = null;\n        var chartCollId;\n        var overlayElem = document.querySelector('.e-datavisualization-chart.e-ss-overlay-active');\n        if (!overlayElem) {\n            return;\n        }\n        var chartTop;\n        var chartleft;\n        if (sheet.frozenRows || sheet.frozenColumns) {\n            var clientRect = overlayElem.getBoundingClientRect();\n            chartTop = { clientY: clientRect.top };\n            chartleft = { clientX: clientRect.left };\n            if (clientRect.top < this.parent.getColumnHeaderContent().getBoundingClientRect().bottom) {\n                chartTop.target = this.parent.getColumnHeaderContent();\n            }\n            if (clientRect.left < this.parent.getRowHeaderContent().getBoundingClientRect().right) {\n                chartleft.target = this.parent.getRowHeaderTable();\n            }\n        }\n        else {\n            chartTop = { clientY: overlayElem.offsetTop, isImage: true };\n            chartleft = { clientX: overlayElem.offsetLeft, isImage: true };\n        }\n        this.parent.notify(getRowIdxFromClientY, chartTop);\n        this.parent.notify(getColIdxFromClientX, chartleft);\n        var currCellObj = getCell(chartTop.clientY, chartleft.clientX, sheet);\n        var chartObj = overlayElem.querySelector('.e-chart');\n        if (isNullOrUndefined(chartObj)) {\n            chartObj = overlayElem.querySelector('.e-accumulationchart');\n        }\n        var chartId = chartObj.getAttribute('id');\n        for (var idx = 0, chartCollLen = this.parent.chartColl.length; idx < chartCollLen; idx++) {\n            if (chartId === this.parent.chartColl[idx].id) {\n                chartCollId = idx;\n            }\n        }\n        if (chartObj) {\n            chartComp = getComponent(chartObj, 'chart');\n            if (isNullOrUndefined(chartComp)) {\n                chartComp = getComponent(chartObj, 'accumulationchart');\n                isAccumulationChart = true;\n            }\n        }\n        if (switchRowColumn && !isAccumulationChart) {\n            this.parent.chartColl[chartCollId].isSeriesInRows =\n                isNullOrUndefined(this.parent.chartColl[chartCollId].isSeriesInRows) ?\n                    true : !this.parent.chartColl[chartCollId].isSeriesInRows;\n            for (var idx = 0, chartCount = currCellObj.chart.length; idx < chartCount; idx++) {\n                if (currCellObj.chart[idx].id === chartId) {\n                    currCellObj.chart[idx].isSeriesInRows =\n                        isNullOrUndefined(currCellObj.chart[idx].isSeriesInRows) ? true : !currCellObj.chart[idx].isSeriesInRows;\n                }\n            }\n            var chartSeries = this.initiateChartHandler({ option: this.parent.chartColl[chartCollId], isRefresh: true });\n            chartComp.series = chartSeries;\n        }\n        if (chartType) {\n            var type = this.parent.chartColl[chartCollId].type;\n            this.parent.chartColl[chartCollId].type = chartType;\n            for (var idx = 0, chartCount = currCellObj.chart.length; idx < chartCount; idx++) {\n                if (currCellObj.chart[idx].id === chartId) {\n                    currCellObj.chart[idx].type = chartType;\n                }\n            }\n            if (chartType !== 'Pie' && chartType !== 'Doughnut') {\n                if (type === 'Pie' || type === 'Doughnut') {\n                    this.changeCharType(chartCollId);\n                }\n                else {\n                    var chartSeries = chartComp.series;\n                    for (var idx = 0, len = chartSeries.length; idx < len; idx++) {\n                        chartSeries[idx].type = chartType;\n                    }\n                    chartComp.series = chartSeries;\n                    chartComp.refresh();\n                }\n            }\n            else {\n                if (type === 'Pie' || type === 'Doughnut') {\n                    var chartSeries = chartComp.series;\n                    for (var idx = 0, len = chartSeries.length; idx < len; idx++) {\n                        chartSeries[idx].innerRadius = chartType === 'Pie' ? '0%' : '40%';\n                    }\n                    chartComp.series = chartSeries;\n                    chartComp.refresh();\n                }\n                else {\n                    this.changeCharType(chartCollId);\n                }\n            }\n        }\n        if (chartTheme) {\n            this.parent.chartColl[chartCollId].theme = chartTheme;\n            for (var idx = 0, chartCount = currCellObj.chart.length; idx < chartCount; idx++) {\n                if (currCellObj.chart[idx].id === chartId) {\n                    currCellObj.chart[idx].theme = chartTheme;\n                }\n            }\n            chartComp.theme = chartTheme;\n            chartComp.refresh();\n        }\n        if (addChartEle) {\n            if (addChartEle === 'ChartTitleAbove' || addChartEle === 'PHAxisTitle' || addChartEle === 'PVAxisTitle') {\n                if (this.parent.element.getElementsByClassName('e-title-dlg').length > 0) {\n                    return;\n                }\n                else {\n                    this.titleDlgHandler(addChartEle, chartComp, currCellObj, chartCollId, isAccumulationChart);\n                }\n            }\n            else {\n                this.updateChartElement(addChartEle, chartComp, currCellObj, chartCollId, title, isAccumulationChart);\n            }\n        }\n    };\n    SpreadsheetChart.prototype.changeCharType = function (chartCollId) {\n        var chartEle = document.getElementById(this.parent.chartColl[chartCollId].id);\n        var chartParEle = closest(chartEle, '.e-datavisualization-chart');\n        chartParEle.remove();\n        this.parent.notify(initiateChart, {\n            option: this.parent.chartColl[chartCollId], isInitCell: false, isUndoRedo: true,\n            isPaste: false\n        });\n        chartEle = document.getElementById(this.parent.chartColl[chartCollId].id);\n        chartParEle = closest(chartEle, '.e-datavisualization-chart');\n        if (!chartParEle.classList.contains('e-ss-overlay-active')) {\n            chartParEle.classList.add('e-ss-overlay-active');\n        }\n    };\n    SpreadsheetChart.prototype.titleDlgHandler = function (addChartEle, chartComp, currCellObj, chartCollId, isAccumulationChart) {\n        var _this = this;\n        var title = '';\n        if (isAccumulationChart && (addChartEle === 'PHAxisTitle' || addChartEle === 'PVAxisTitle')) {\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 375, showCloseIcon: true, isModal: true, cssClass: 'e-title-dlg',\n            header: addChartEle === 'chart_abovechart' ? l10n.getConstant('ChartTitle') : addChartEle ===\n                'PHAxisTitle' ? l10n.getConstant('HorizontalAxisTitle') : l10n.getConstant('VerticalAxisTitle'),\n            target: document.querySelector('.e-control.e-spreadsheet'),\n            beforeOpen: function () {\n                dialogInst.dialogInstance.content = _this.titleDlgContent(addChartEle, chartComp);\n                dialogInst.dialogInstance.dataBind();\n                _this.parent.element.focus();\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'),\n                        isPrimary: true,\n                        cssClass: 'e-btn e-clearall-btn e-flat'\n                    },\n                    click: function () {\n                        var dlgCont = _this.parent.element.querySelector('.e-title-dlg').\n                            getElementsByClassName('e-title-dlg-content')[0];\n                        title = dlgCont.getElementsByTagName('input')[0].value;\n                        dialogInst.hide();\n                        _this.updateChartElement(addChartEle, chartComp, currCellObj, chartCollId, title);\n                    }\n                }]\n        });\n        dialogInst.dialogInstance.refresh();\n    };\n    SpreadsheetChart.prototype.titleDlgContent = function (addChartEle, chartComp) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dlgText = l10n.getConstant('EnterTitle');\n        var dlgContent = this.parent.createElement('div', { className: 'e-title-dlg-content' });\n        var value1Text = this.parent.createElement('span', { className: 'e-header e-top-header', innerHTML: dlgText });\n        var value1Inp = this.parent.createElement('input', { className: 'e-input', id: 'titleInput', attrs: { type: 'text' } });\n        dlgContent.appendChild(value1Text);\n        dlgContent.appendChild(value1Inp);\n        if (chartComp) {\n            if (addChartEle === 'PHAxisTitle') {\n                value1Inp.value = chartComp.primaryXAxis.title ? chartComp.primaryXAxis.title : value1Inp.value;\n            }\n            else if (addChartEle === 'PVAxisTitle') {\n                value1Inp.value = chartComp.primaryYAxis.title ? chartComp.primaryYAxis.title : value1Inp.value;\n            }\n            else {\n                value1Inp.value = chartComp.title ? chartComp.title : value1Inp.value;\n            }\n        }\n        return dlgContent;\n    };\n    /**\n     * Removing event listener for success and failure\n     *\n     * @returns {void} - Removing event listener for success and failure\n     */\n    SpreadsheetChart.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateChart, this.initiateChartHandler);\n            this.parent.off(refreshChartCellObj, this.refreshChartCellObj);\n            this.parent.off(updateChart, this.updateChartHandler);\n            this.parent.off(deleteChart, this.deleteChart);\n            this.parent.off(clearChartBorder, this.clearBorder);\n            this.parent.off(insertChart, this.insertChartHandler);\n            this.parent.off(chartRangeSelection, this.chartRangeHandler);\n            this.parent.off(chartDesignTab, this.chartDesignTabHandler);\n            this.parent.off(addChartEle, this.updateChartElement);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     *\n     * @returns {void} - To Remove the event listeners.\n     */\n    SpreadsheetChart.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        var chartEle = null;\n        if (this.chart) {\n            chartEle = this.chart.element;\n            this.chart.destroy();\n        }\n        if (chartEle) {\n            detach(chartEle);\n        }\n        this.chart = null;\n    };\n    /**\n     * Get the sheet chart module name.\n     *\n     * @returns {string} - Get the module name.\n     */\n    SpreadsheetChart.prototype.getModuleName = function () {\n        return 'spreadsheetChart';\n    };\n    return SpreadsheetChart;\n}());\nexport { SpreadsheetChart };\n","import { Spreadsheet } from '../index';\nimport { Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, WrapText, Insert, Delete, ProtectSheet } from '../actions/index';\nimport { CellFormat, CollaborativeEditing, UndoRedo, Resize, SpreadsheetHyperlink, FindAndReplace, Merge } from '../actions/index';\nimport { Formula, Sort, Filter, SpreadsheetImage, SpreadsheetChart } from '../integrations/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, ContextMenu, Save, NumberFormat } from '../integrations/index';\nimport { DataBind } from '../../workbook/index';\nimport { DataValidation } from '../actions/data-validation';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\n/**\n * Spreadsheet basic module.\n *\n * @private\n */\nvar BasicModule = /** @class */ (function () {\n    /**\n     * Constructor for Spreadsheet basic module.\n     *\n     * @private\n     */\n    function BasicModule() {\n        Spreadsheet.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, ContextMenu, Save, NumberFormat, CellFormat, Formula, Sort, CollaborativeEditing, UndoRedo, Resize, Filter, SpreadsheetHyperlink, WrapText, Insert, Delete, ProtectSheet, DataValidation, FindAndReplace, Merge, ConditionalFormatting, SpreadsheetImage, SpreadsheetChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} - Get the module name.\n     * @private\n     */\n    BasicModule.prototype.getModuleName = function () {\n        return 'basic';\n    };\n    /**\n     * Destroys the Spreadsheet basic module.\n     *\n     * @returns {void} - Destroys the Spreadsheet basic module.\n     */\n    BasicModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return BasicModule;\n}());\nexport { BasicModule };\n","import { Spreadsheet } from '../index';\nimport { Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, CellFormat, WrapText, ProtectSheet } from '../actions/index';\nimport { CollaborativeEditing, UndoRedo, Resize, SpreadsheetHyperlink, Insert, Delete, FindAndReplace, Merge } from '../actions/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, Save, NumberFormat, Formula, Sort, Filter, SpreadsheetImage } from '../integrations/index';\nimport { SpreadsheetChart } from '../integrations/index';\nimport { DataBind } from '../../workbook/integrations/index';\nimport { DataValidation } from '../actions/data-validation';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\n/**\n * Spreadsheet all module.\n *\n * @private\n */\nvar AllModule = /** @class */ (function () {\n    /**\n     * Constructor for Spreadsheet all module.\n     *\n     * @private\n     */\n    function AllModule() {\n        Spreadsheet.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, Save, NumberFormat, CellFormat, Formula, Sort, Resize, CollaborativeEditing, UndoRedo, Filter, SpreadsheetHyperlink, WrapText, Insert, Delete, DataValidation, ProtectSheet, FindAndReplace, Merge, SpreadsheetImage, ConditionalFormatting, SpreadsheetChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @private\n     * @returns {string} - Get the module name.\n     */\n    AllModule.prototype.getModuleName = function () {\n        return 'all';\n    };\n    /**\n     * Destroys the Spreadsheet all module.\n     *\n     * @returns {void} - Destroys the Spreadsheet all module.\n     */\n    AllModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return AllModule;\n}());\nexport { AllModule };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Property, ChildProperty } from '@syncfusion/ej2-base';\n/**\n * Represents the scroll settings.\n */\nvar ScrollSettings = /** @class */ (function (_super) {\n    __extends(ScrollSettings, _super);\n    function ScrollSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(false)\n    ], ScrollSettings.prototype, \"isFinite\", void 0);\n    __decorate([\n        Property(true)\n    ], ScrollSettings.prototype, \"enableVirtualization\", void 0);\n    return ScrollSettings;\n}(ChildProperty));\nexport { ScrollSettings };\n/**\n * Represents the selection settings.\n */\nvar SelectionSettings = /** @class */ (function (_super) {\n    __extends(SelectionSettings, _super);\n    function SelectionSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Multiple')\n    ], SelectionSettings.prototype, \"mode\", void 0);\n    return SelectionSettings;\n}(ChildProperty));\nexport { SelectionSettings };\n","/** @hidden */\nexport var DISABLED = 'e-disabled';\n/** @hidden */\nexport var WRAPTEXT = 'e-wraptext';\n/** @hidden */\nexport var locale = 'spreadsheetLocale';\n/** @hidden */\nexport var dialog = 'dialog';\n/** @hidden */\nexport var actionEvents = 'actionEvents';\n/** @hidden */\nexport var overlay = 'shape';\n/** @hidden */\nexport var fontColor = {\n    'Custom': [\n        '#ffffff', '#000000', '#e7e6e6', '#44546a', '#4472c4', '#ed7d31', '#a5a5a5', '#ffc000', '#70ad47', '#ff0000',\n        '#f2f2f2', '#808080', '#cfcdcd', '#d5dce4', '#d9e2f3', '#fbe4d5', '#ededed', '#fff2cc', '#e2efd9', '#ffcccc',\n        '#d9d9d9', '#595959', '#aeaaaa', '#acb9ca', '#b4c6e7', '#f7caac', '#dbdbdb', '#ffe599', '#c5e0b3', '#ff8080',\n        '#bfbfbf', '#404040', '#747070', '#8496b0', '#8eaadb', '#f4b083', '#c9c9c9', '#ffd966', '#a8d08d', '#ff3333',\n        '#a6a6a6', '#262626', '#3b3838', '#323e4f', '#2f5496', '#c45911', '#7b7b7b', '#bf8f00', '#538135', '#b30000',\n        '#7f7f7f', '#0d0d0d', '#161616', '#212934', '#1f3763', '#823b0b', '#525252', '#7f5f00', '#375623', '#660000'\n    ]\n};\n/** @hidden */\nexport var fillColor = {\n    'Custom': [\n        '#ffffff', '#000000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff0000', '#000080', '#800080', '#996633',\n        '#f2f2f2', '#808080', '#ffffcc', '#b3ffb3', '#ccffff', '#ccccff', '#ffcccc', '#ccccff', '#ff80ff', '#f2e6d9',\n        '#d9d9d9', '#595959', '#ffff80', '#80ff80', '#b3ffff', '#8080ff', '#ff8080', '#8080ff', '#ff00ff', '#dfbf9f',\n        '#bfbfbf', '#404040', '#ffff33', '#33ff33', '#33ffff', '#3333ff', '#ff3333', '#0000b3', '#b300b3', '#c68c53',\n        '#a6a6a6', '#262626', '#e6e600', '#00b300', '#009999', '#000099', '#b30000', '#000066', '#660066', '#86592d',\n        '#7f7f7f', '#0d0d0d', '#999900', '#006600', '#006666', '#000066', '#660000', '#00004d', '#4d004d', '#734d26'\n    ]\n};\n/**\n * Default locale text\n *\n * @hidden\n */\nexport var defaultLocale = {\n    FindValue: 'Find value',\n    ReplaceValue: 'Replace value',\n    FindReplaceTooltip: 'Find & Replace',\n    InsertingEmptyValue: 'Reference value is not valid.',\n    ReplaceAllEnd: ' matches replaced with ',\n    ByRow: 'By Rows',\n    ByColumn: 'By Columns',\n    MatchCase: 'Match case   ',\n    MatchExactCellElements: 'Match exact cell contents',\n    Replace: 'Replace...',\n    Find: 'Find and Replace...',\n    Goto: 'Goto...',\n    EntercellAddress: 'Enter cell address',\n    GotoSpecial: 'GotoSpecial...',\n    FindAndReplace: 'Find and Replace',\n    FindNextBtn: 'Find Next',\n    FindPreviousBtn: 'Find Previous',\n    ReplaceBtn: 'Replace',\n    ReplaceAllBtn: 'Replace All',\n    GotoHeader: 'Go To',\n    GotoSpecialHeader: 'Go To Special',\n    Sheet: 'Sheet',\n    Workbook: 'Workbook',\n    NoElements: 'We couldn\\'t find what you were looking for.',\n    FindWhat: 'Find what',\n    ReplaceWith: 'Replace with',\n    Cut: 'Cut',\n    Copy: 'Copy',\n    Paste: 'Paste',\n    PasteSpecial: 'Paste Special',\n    Link: 'Link',\n    SpreadsheetHyperlink: 'SpreadsheetHyperlink',\n    Hyperlink: 'Hyperlink',\n    EditHyperlink: 'Edit Hyperlink',\n    OpenHyperlink: 'Open Hyperlink',\n    RemoveHyperlink: 'Remove Hyperlink',\n    InvalidHyperlinkAlert: 'The address of this site is not valid. Check the address and try again.',\n    InsertLink: 'Insert Link',\n    EditLink: 'Edit Link',\n    All: 'All',\n    Values: 'Values',\n    Formats: 'Formats',\n    Bold: 'Bold',\n    Font: 'Font',\n    FontSize: 'Font Size',\n    Italic: 'Italic',\n    Underline: 'Underline',\n    Strikethrough: 'Strikethrough',\n    TextColor: 'Text Color',\n    FillColor: 'Fill Color',\n    HorizontalAlignment: 'Horizontal Alignment',\n    AlignLeft: 'Align Left',\n    AlignCenter: 'Center',\n    AlignRight: 'Align Right',\n    VerticalAlignment: 'Vertical Alignment',\n    AlignTop: 'Align Top',\n    AlignMiddle: 'Align Middle',\n    AlignBottom: 'Align Bottom',\n    WrapText: 'Wrap Text',\n    MergeCells: 'Merge Cells',\n    MergeAll: 'Merge All',\n    MergeHorizontally: 'Merge Horizontally',\n    MergeVertically: 'Merge Vertically',\n    Unmerge: 'Unmerge',\n    UnmergeCells: 'Unmerge Cells',\n    SelectMergeType: 'Select Merge Type',\n    MergeCellsAlert: 'Merging cells will only preserve the top-leftmost(Uppermost) value. Merge anyway?',\n    PasteMergeAlert: 'We can\"t do that to a merge cell.',\n    Borders: 'Borders',\n    TopBorders: 'Top Borders',\n    LeftBorders: 'Left Borders',\n    RightBorders: 'Right Borders',\n    BottomBorders: 'Bottom Borders',\n    AllBorders: 'All Borders',\n    HorizontalBorders: 'Horizontal Borders',\n    VerticalBorders: 'Vertical Borders',\n    OutsideBorders: 'Outside Borders',\n    InsideBorders: 'Inside Borders',\n    NoBorders: 'No Borders',\n    BorderColor: 'Border Color',\n    BorderStyle: 'Border Style',\n    InsertFunction: 'Insert Function',\n    Insert: 'Insert',\n    Delete: 'Delete',\n    DuplicateSheet: 'Duplicate',\n    MoveRight: 'Move Right',\n    MoveLeft: 'Move Left',\n    Rename: 'Rename',\n    Hide: 'Hide',\n    Unhide: 'Unhide',\n    NameBox: 'Name Box',\n    ShowHeaders: 'Show Headers',\n    HideHeaders: 'Hide Headers',\n    ShowGridLines: 'Show Gridlines',\n    HideGridLines: 'Hide Gridlines',\n    FreezePanes: 'Freeze Panes',\n    FreezeRows: 'Freeze Rows',\n    FreezeColumns: 'Freeze Columns',\n    UnfreezePanes: 'Unfreeze Panes',\n    UnfreezeRows: 'Unfreeze Rows',\n    UnfreezeColumns: 'Unfreeze Columns',\n    AddSheet: 'Add Sheet',\n    ListAllSheets: 'List All Sheets',\n    FullScreen: 'Full Screen',\n    CollapseToolbar: 'Collapse Toolbar',\n    ExpandToolbar: 'Expand Toolbar',\n    CollapseFormulaBar: 'Collapse Formula Bar',\n    ExpandFormulaBar: 'Expand Formula Bar',\n    File: 'File',\n    Home: 'Home',\n    Formulas: 'Formulas',\n    View: 'View',\n    New: 'New',\n    Open: 'Open',\n    SaveAs: 'Save As',\n    Update: 'Update',\n    ExcelXlsx: 'Microsoft Excel',\n    ExcelXls: 'Microsoft Excel 97-2003',\n    CSV: 'Comma-separated values',\n    FormulaBar: 'Formula Bar',\n    Sort: 'Sort',\n    SortAscending: 'Ascending',\n    SortDescending: 'Descending',\n    CustomSort: 'Custom Sort',\n    AddColumn: 'Add Column',\n    ContainsHeader: 'Data contains header',\n    CaseSensitive: 'Case sensitive',\n    SortBy: 'Sort by',\n    ThenBy: 'Then by',\n    SelectAColumn: 'Select a column',\n    SortEmptyFieldError: 'Sort criteria column should not be empty.',\n    SortDuplicateFieldError: ' is mentioned more than once. Duplicate columns must be removed.',\n    SortOutOfRangeError: 'Select a cell or range inside the used range and try again.',\n    SortAndFilter: 'Sort & Filter',\n    Filter: 'Filter',\n    ClearAllFilter: 'Clear',\n    ClearFilterFrom: 'Clear Filter From ',\n    ReapplyFilter: 'Reapply',\n    FilterCellValue: 'Filter by Value of Selected Cell',\n    FilterOutOfRangeError: 'Select a cell or range inside the used range and try again.',\n    HideRow: 'Hide Row',\n    HideRows: 'Hide Rows',\n    UnHideRows: 'UnHide Rows',\n    HideColumn: 'Hide Column',\n    HideColumns: 'Hide Columns',\n    UnHideColumns: 'UnHide Columns',\n    InsertRow: 'Insert Row',\n    InsertRows: 'Insert Rows',\n    Above: 'Above',\n    Below: 'Below',\n    InsertColumn: 'Insert Column',\n    InsertColumns: 'Insert Columns',\n    Before: 'Before',\n    After: 'After',\n    DeleteRow: 'Delete Row',\n    DeleteRows: 'Delete Rows',\n    DeleteColumn: 'Delete Column',\n    DeleteColumns: 'Delete Columns',\n    Ok: 'Ok',\n    Close: 'Close',\n    Cancel: 'CANCEL',\n    Apply: 'Apply',\n    MoreColors: 'More Colors',\n    StandardColors: 'Standard Colors',\n    General: 'General',\n    Number: 'Number',\n    Currency: 'Currency',\n    Accounting: 'Accounting',\n    ShortDate: 'Short Date',\n    LongDate: 'Long Date',\n    Time: 'Time',\n    Percentage: 'Percentage',\n    Fraction: 'Fraction',\n    Scientific: 'Scientific',\n    Text: 'Text',\n    MobileFormulaBarPlaceHolder: 'Enter value or Formula',\n    NumberFormat: 'Number Format',\n    PasteAlert: 'You can\\'t paste this here, because the copy area and paste area aren\\'t in the same size. ' +\n        'Please try pasting in a different range.',\n    DestroyAlert: 'Are you sure you want to destroy the current workbook without saving and create a new workbook?',\n    SheetRenameInvalidAlert: 'Sheet name contains invalid character.',\n    SheetRenameEmptyAlert: 'Sheet name cannot be empty.',\n    SheetRenameAlreadyExistsAlert: 'Sheet name already exists. Please enter another name.',\n    DeleteSheetAlert: 'You can\\'t undo deleting sheets, and you might be removing some data. If you don\\'t need it, click OK to delete.',\n    DeleteSingleLastSheetAlert: 'A Workbook must contain at least one visible worksheet.',\n    PickACategory: 'Pick a category',\n    Description: 'Description',\n    UnsupportedFile: 'Unsupported File',\n    InvalidUrl: 'Invalid URL',\n    SUM: 'Adds a series of numbers and/or cells.',\n    SUMIF: 'Adds the cells based on specified condition.',\n    SUMIFS: 'Adds the cells based on specified conditions.',\n    ABS: 'Returns the value of a number without its sign.',\n    RAND: 'Returns a random number between 0 and 1.',\n    RANDBETWEEN: 'Returns a random integer based on specified values.',\n    FLOOR: 'Rounds a number down to the nearest multiple of a given factor.',\n    CEILING: 'Rounds a number up to the nearest multiple of a given factor.',\n    T: 'Checks whether a value is text and returns the text if it is, or returns empty string if it is not.',\n    PRODUCT: 'Multiplies a series of numbers and/or cells.',\n    INT: 'Returns a number to the nearest integer.',\n    UNIQUE: 'Returns a unique values from a range or array',\n    ROUNDUP: 'Rounds a number away from zero.',\n    SUMPRODUCT: 'Returns sum of the product of given ranges of arrays.',\n    SORT: 'Sorts a range of an array',\n    TODAY: 'Returns the current date as date value.',\n    AVERAGE: 'Calculates average for the series of numbers and/or cells excluding text.',\n    AVERAGEIF: 'Calculates average for the cells based on specified criterion.',\n    AVERAGEIFS: 'Calculates average for the cells based on specified conditions.',\n    AVERAGEA: 'Calculates the average for the cells evaluating TRUE as 1, text and FALSE as 0.',\n    COUNT: 'Counts the cells that contain numeric values in a range.',\n    COUNTIF: 'Counts the cells based on specified condition.',\n    COUNTIFS: 'Counts the cells based on specified conditions.',\n    COUNTA: 'Counts the cells that contains values in a range.',\n    MIN: 'Returns the smallest number of the given arguments.',\n    MAX: 'Returns the largest number of the given arguments.',\n    DATE: 'Returns the date based on given year, month, and day.',\n    DAY: 'Returns the day from the given date.',\n    DAYS: 'Returns the number of days between two dates.',\n    IF: 'Returns value based on the given expression.',\n    IFS: 'Returns value based on the given multiple expressions.',\n    CalculateAND: 'Returns TRUE if all the arguments are TRUE, otherwise returns FALSE.',\n    CalculateOR: 'Returns TRUE if any of the arguments are TRUE, otherwise returns FALSE.',\n    IFERROR: 'Returns value if no error found else it will return specified value.',\n    CHOOSE: 'Returns a value from list of values, based on index number.',\n    INDEX: 'Returns a value of the cell in a given range based on row and column number.',\n    FIND: 'Returns the position of a string within another string, which is case sensitive',\n    TEXT: 'Converts a value to text in specified number format.',\n    CONCATENATE: 'Combines two or more strings together.',\n    CONCAT: 'Concatenates a list or a range of text strings.',\n    SUBTOTAL: 'Returns subtotal for a range using the given function number.',\n    RADIANS: 'Converts degrees into radians.',\n    MATCH: 'Returns the relative position of a specified value in given range.',\n    LN: 'Returns the natural logarithm of a number.',\n    INTERCEPT: 'Calculates the point of the Y-intercept line via linear regression.',\n    SLOPE: 'Returns the slope of the line from linear regression of the data points.',\n    DefineNameExists: 'This name already exists, try different name.',\n    DefineNameInValid: 'The name that you entered is not valid.',\n    CircularReference: 'When a formula refers to one or more circular references, this may result in an incorrect calculation.',\n    ShowRowsWhere: 'Show rows where:',\n    OR: 'OR',\n    AND: 'AND',\n    CustomFilterDatePlaceHolder: 'Choose a date',\n    CustomFilterPlaceHolder: 'Enter the value',\n    CustomFilter: 'Custom Filter',\n    Between: 'Between',\n    DateTimeFilter: 'DateTime Filters',\n    Undo: 'Undo',\n    Redo: 'Redo',\n    DateFilter: 'Date Filters',\n    TextFilter: 'Text Filters',\n    NumberFilter: 'Number Filters',\n    ClearFilter: 'Clear Filter',\n    NoResult: 'No Matches Found',\n    FilterFalse: 'False',\n    FilterTrue: 'True',\n    Blanks: 'Blanks',\n    SelectAll: 'Select All',\n    GreaterThanOrEqual: 'Greater Than Or Equal',\n    GreaterThan: 'Greater Than',\n    LessThanOrEqual: 'Less Than Or Equal',\n    LessThan: 'Less Than',\n    NotEqual: 'Not Equal',\n    Equal: 'Equal',\n    Contains: 'Contains',\n    EndsWith: 'Ends With',\n    StartsWith: 'Starts With',\n    ClearButton: 'Clear',\n    FilterButton: 'Filter',\n    CancelButton: 'Cancel',\n    OKButton: 'OK',\n    Search: 'Search',\n    ProtectSheet: 'Protect Sheet',\n    UnprotectSheet: 'Unprotect Sheet',\n    LockCells: 'Lock Cells',\n    SelectCells: 'Select cells',\n    FormatCells: 'Format cells',\n    FormatRows: 'Format rows',\n    FormatColumns: 'Format columns',\n    InsertLinks: 'Insert links',\n    ProtectContent: 'Protect the contents of locked cells',\n    ProtectAllowUser: ' Allow all users of this worksheet to:',\n    EditAlert: 'The cell you\\'re trying to change is protected. To make change, unprotect the sheet.',\n    SearchWithin: 'Search within',\n    SearchBy: 'Search by',\n    Reference: 'Reference',\n    DataValidation: 'Data Validation',\n    CLEARALL: 'Clear All',\n    APPLY: 'Apply',\n    CellRange: 'Cell Range',\n    Allow: 'Allow',\n    Data: 'Data',\n    Minimum: 'Minimum',\n    Maximum: 'Maximum',\n    IgnoreBlank: 'Ignore blank',\n    WholeNumber: 'Whole Number',\n    Decimal: 'Decimal',\n    Date: 'Date',\n    TextLength: 'Text Length',\n    List: 'List',\n    NotBetween: 'Not between',\n    EqualTo: 'Equal to',\n    NotEqualTo: 'Not equal to',\n    Greaterthan: 'Greater than',\n    Lessthan: 'Less than',\n    GreaterThanOrEqualTo: 'Greater than or equal to',\n    LessThanOrEqualTo: 'Less than or equal to',\n    InCellDropDown: 'In-cell-dropdown',\n    Sources: 'Sources',\n    Value: 'Value',\n    Retry: 'Retry',\n    EnterValue: 'Enter value',\n    DialogError: 'The list source must be a reference to single row or column.',\n    ListLengthError: 'The list values allows only upto 256 charcters',\n    ValidationError: 'This value doesn' + '\\'' + 't match the data validation restrictions defined for the cell.',\n    EmptyError: 'You must enter a value',\n    ClearHighlight: 'Clear Highlight',\n    HighlightInvalidData: 'Highlight Invalid Data',\n    ClearValidation: 'Clear Validation',\n    HighlightCellsRules: 'Highlight Cells Rules',\n    CFEqualTo: 'Equal To',\n    TextThatContains: 'Text that Contains',\n    ADateOccuring: 'A Date Occuring',\n    DuplicateValues: 'Duplicate Values',\n    TopBottomRules: 'Top/Bottom Rules',\n    Top10Items: 'Top 10 Items',\n    Top10: 'Top 10',\n    Bottom10Items: 'Bottom 10 Items',\n    Bottom10: 'Bottom 10',\n    AboveAverage: 'Above Average',\n    BelowAverage: 'Below Average',\n    FormatCellsGreaterThan: 'Format cells that are GREATER THAN:',\n    FormatCellsLessThan: 'Format cells that are LESS THAN:',\n    FormatCellsBetween: 'Format cells that are BETWEEN:',\n    FormatCellsEqualTo: 'Format cells that are EQUAL TO:',\n    FormatCellsThatContainTheText: 'Format cells that contain the text:',\n    FormatCellsThatContainADateOccurring: 'Format cells that contain a date occurring:',\n    FormatCellsDuplicate: 'Format cells that contain:',\n    FormatCellsTop: 'Format cells that rank in the TOP:',\n    FormatCellsBottom: 'Format cells that rank in the BOTTOM:',\n    FormatCellsAbove: 'Format cells that are ABOVE AVERAGE:',\n    FormatCellsBelow: 'Format cells that are BELOW AVERAGE:',\n    With: 'with',\n    DataBars: 'Data Bars',\n    ColorScales: 'Color Scales',\n    IconSets: 'Icon Sets',\n    ClearRules: 'Clear Rules',\n    SelectedCells: 'Clear Rules from Selected Cells',\n    EntireSheet: 'Clear Rules from Entire Sheet',\n    ISNUMBER: 'Returns true when the value parses as a numeric value.',\n    ROUND: 'Rounds a number to a specified number of digits.',\n    GEOMEAN: 'Returns the geometric mean of an array or range of positive data.',\n    POWER: 'Returns the result of a number raised to power',\n    LOG: 'Returns the logarithm of a number to the base that you specify.',\n    TRUNC: 'Returns the truncated value of a number to a specified number of decimal places.',\n    EXP: 'Returns e raised to the power of the given number.',\n    Clear: 'Clear',\n    ClearContents: 'Clear Contents',\n    ClearAll: 'Clear All',\n    ClearFormats: 'Clear Formats',\n    ClearHyperlinks: 'Clear Hyperlinks',\n    LightRedFillWithDarkRedText: 'Light Red Fill with Dark Red Text',\n    YellowFillWithDarkYellowText: 'Yellow Fill with Dark Yellow Text',\n    GreenFillWithDarkGreenText: 'Green Fill with Dark Green Text',\n    RedFill: 'Red Fill',\n    RedText: 'Red Text',\n    Duplicate: 'Duplicate',\n    Unique: 'Unique',\n    And: 'and',\n    WebPage: 'WEB PAGE',\n    ThisDocument: 'THIS DOCUMENT',\n    DisplayText: 'Display Text',\n    Url: 'URL',\n    CellReference: 'Cell Reference',\n    DefinedNames: 'Defined Names',\n    EnterTheTextToDisplay: 'Enter the text to display',\n    EnterTheUrl: 'Enter the URL',\n    Image: 'Image',\n    ConditionalFormatting: 'Conditional Formatting',\n    BlueDataBar: 'Blue Data Bar',\n    GreenDataBar: 'Green Data Bar',\n    RedDataBar: 'Red Data Bar',\n    OrangeDataBar: 'Orange Data Bar',\n    LightblueDataBar: 'Light blue Data Bar',\n    PurpleDataBar: 'Purple Data Bar',\n    GYRColorScale: 'Green - Yellow - Red Color Scale',\n    RYGColorScale: 'Red - Yellow - Green Color Scale',\n    GWRColorScale: 'Green - White - Red Color Scale',\n    RWGColorScale: 'Red - White - Green Color Scale',\n    BWRColorScale: 'Blue - White - Red Color Scale',\n    RWBColorScale: 'Red - White - Blue Color Scale',\n    WRColorScale: 'White - Red Color Scale',\n    RWColorScale: 'Red - White Color Scale',\n    GWColorScale: 'Green - White Color Scale',\n    WGColorScale: 'White - Green Color Scale',\n    GYColorScale: 'Green - Yellow Color Scale',\n    YGColorScale: 'Yellow - Green Color Scale',\n    ThreeArrowsColor: '3 Arrows (Colored)',\n    ThreeArrowsGray: '3 Arrows (Gray)',\n    ThreeTriangles: '3 Triangles',\n    FourArrowsColor: '4 Arrows (Gray)',\n    FourArrowsGray: '4 Arrows (Colored)',\n    FiveArrowsColor: '5 Arrows (Gray)',\n    FiveArrowsGray: '5 Arrows (Colored)',\n    ThreeTrafficLights1: '3 Traffic Lights (Unrimmed)',\n    ThreeTrafficLights2: '3 Traffic Lights (Rimmed)',\n    ThreeSigns: '3 Signs',\n    FourTrafficLights: '4 Traffic Lights',\n    RedToBlack: 'Red To Black',\n    ThreeSymbols1: '3 Symbols (Circled)',\n    ThreeSymbols2: '3 Symbols (Uncircled)',\n    ThreeFlags: '3 Flags',\n    ThreeStars: '3 Stars',\n    FourRatings: '4 Ratings',\n    FiveQuarters: '5 Quarters',\n    FiveRatings: '5 Ratings',\n    FiveBoxes: '5 Boxes',\n    Chart: 'Chart',\n    Column: 'Column',\n    Bar: 'Bar',\n    Area: 'Area',\n    Pie: 'Pie',\n    Doughnut: 'Doughnut',\n    PieAndDoughnut: 'Pie/Doughnut',\n    Line: 'Line',\n    Radar: 'Radar',\n    Scatter: 'Scatter',\n    ChartDesign: 'Chart Design',\n    ClusteredColumn: 'Clustered Column',\n    StackedColumn: 'Stacked Column',\n    StackedColumn100: '100% Stacked Column',\n    ClusteredBar: 'Clustered Bar',\n    StackedBar: 'Stacked Bar',\n    StackedBar100: '100% Stacked Bar',\n    StackedArea: 'Stacked Area',\n    StackedArea100: '100% Stacked Area',\n    StackedLine: 'Stacked Line',\n    StackedLine100: '100% Stacked Line',\n    AddChartElement: 'Add Chart Element',\n    Axes: 'Axes',\n    AxisTitle: 'Axis Title',\n    ChartTitle: 'Chart Title',\n    DataLabels: 'Data Labels',\n    Gridlines: 'Gridlines',\n    Legends: 'Legends',\n    PrimaryHorizontal: 'Primary Horizontal',\n    PrimaryVertical: 'Primary Vertical',\n    None: 'None',\n    AboveChart: 'Above Chart',\n    Center: 'Center',\n    InsideEnd: 'Inside End',\n    InsideBase: 'Inside Base',\n    OutsideEnd: 'OutSide End',\n    PrimaryMajorHorizontal: 'Primary Major Horizontal',\n    PrimaryMajorVertical: 'Primary Major Vertical',\n    PrimaryMinorHorizontal: 'Primary Minor Horizontal',\n    PrimaryMinorVertical: 'Primary Minor Vertical',\n    Right: 'Right',\n    Left: 'Left',\n    Bottom: 'Bottom',\n    Top: 'Top',\n    SwitchRowColumn: 'Switch Row/Column',\n    ChartTheme: 'Chart Theme',\n    ChartType: 'Chart Type',\n    Material: 'Material',\n    Fabric: 'Fabric',\n    Bootstrap: 'Bootstrap',\n    HighContrastLight: 'HighContrast Light',\n    MaterialDark: 'Material Dark',\n    FabricDark: 'Fabric Dark',\n    HighContrast: 'HighContrast',\n    BootstrapDark: 'Bootstrap Dark',\n    Bootstrap4: 'Bootstrap4',\n    VerticalAxisTitle: 'Vertical Axis Title',\n    HorizontalAxisTitle: 'Horizontal Axis Title',\n    EnterTitle: 'Enter Title',\n    ProtectWorkbook: 'Protect Workbook',\n    Password: 'Password (optional):',\n    unProtectPassword: 'Password',\n    EnterThePassword: 'Enter the password',\n    ConfirmPassword: 'Confirm Password',\n    EnterTheConfirmPassword: 'Re-enter your password',\n    PasswordAlert: 'Confirmation password is not identical',\n    UnProtectWorkbook: 'Unprotect Workbook',\n    UnProtectPasswordAlert: 'The password you supplied is not correct.',\n    InCorrectPassword: 'Unable to open the file or worksheet with the given password',\n    PasswordAlertMsg: 'Please enter the password',\n    ConfirmPasswordAlertMsg: 'Please enter the confirm password',\n    IsProtected: 'is protected',\n    PDF: 'PDF document'\n};\n","import { formatUnit, detach, attributes, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { getCellIndexes, getRangeIndexes } from './../../workbook/common/address';\nimport { getColumnsWidth, getColumnWidth } from '../../workbook/base/column';\nimport { contentLoaded, editOperation, getUpdateUsingRaf, removeAllChildren } from '../common/index';\nimport { beforeContentLoaded, getColGroupWidth, virtualContentLoaded, setAriaOptions, dataBound } from '../common/index';\nimport { created, spreadsheetDestroyed, skipHiddenIdx, isReact, getDPRValue } from '../common/index';\nimport { checkMerge, forRefSelRender, initiateEdit, chartRangeSelection, renderReactTemplates, rowHeightChanged } from '../common/index';\nimport { colWidthChanged, clearUndoRedoCollection } from '../common/index';\nimport { getCell, getRowsHeight } from '../../workbook/index';\n/**\n * Sheet module is used to render Sheet\n *\n * @hidden\n */\nvar SheetRender = /** @class */ (function () {\n    function SheetRender(parent) {\n        this.colGroupWidth = 30; //Row header and selectall table colgroup width\n        this.parent = parent;\n        this.col = parent.createElement('col');\n        this.rowRenderer = parent.serviceLocator.getService('row');\n        this.cellRenderer = parent.serviceLocator.getService('cell');\n        this.addEventListener();\n    }\n    SheetRender.prototype.refreshSelectALLContent = function () {\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.frozenColumns || sheet.frozenRows) {\n            var tHead = this.getSelectAllTable().querySelector('thead');\n            var row = this.rowRenderer.render();\n            tHead.appendChild(row);\n            cell = this.parent.createElement('th', { className: 'e-select-all-cell' });\n            row.appendChild(cell);\n        }\n        else {\n            cell = this.headerPanel.firstElementChild;\n            cell.classList.add('e-select-all-cell');\n        }\n        cell.appendChild(this.parent.createElement('button', { className: 'e-selectall e-icons',\n            id: this.parent.element.id + \"_select_all\" }));\n    };\n    SheetRender.prototype.updateLeftColGroup = function (width, rowHdr) {\n        if (width) {\n            this.colGroupWidth = width;\n        }\n        if (!rowHdr) {\n            rowHdr = this.getRowHeaderPanel();\n        }\n        var table = rowHdr.querySelector('table');\n        var sheet = this.parent.getActiveSheet();\n        var colGrp;\n        if (width) {\n            table.querySelector('colgroup').firstElementChild.style.width = this.colGroupWidth + \"px\";\n        }\n        else {\n            colGrp = this.parent.createElement('colgroup');\n            var col = this.col.cloneNode();\n            col.style.width = this.colGroupWidth + \"px\";\n            colGrp.appendChild(col);\n            table.insertBefore(colGrp, table.querySelector('tbody'));\n        }\n        if (sheet.frozenRows || sheet.frozenColumns) {\n            table = this.getSelectAllTable();\n            if (width) {\n                table.querySelector('colgroup').firstElementChild.style.width = this.colGroupWidth + \"px\";\n            }\n            else {\n                table.insertBefore(colGrp.cloneNode(true), table.querySelector('thead'));\n            }\n        }\n        this.setPanelWidth(sheet, rowHdr);\n        this.setPanelHeight(sheet);\n    };\n    SheetRender.prototype.setPanelWidth = function (sheet, rowHdr) {\n        var scrollSize = this.getScrollSize(true);\n        var width = this.getRowHeaderWidth(sheet);\n        var offset = this.parent.enableRtl ? 'right' : 'left';\n        if (sheet.frozenColumns) {\n            var frozenCol = document.getElementById(this.parent.element.id + '_sheet').getElementsByClassName('e-frozen-column')[0];\n            frozenCol.style.height = \"calc(100% - \" + scrollSize + \"px)\";\n            frozenCol.style[offset] = width - getDPRValue(1) + 'Px';\n            frozenCol.style.display = '';\n        }\n        this.setHeaderPanelWidth(this.getSelectAllContent(), width);\n        this.getColHeaderPanel().style.width = \"calc(100% - \" + width + \"px)\";\n        this.getColHeaderPanel().style[offset] = width + 'px';\n        this.setHeaderPanelWidth(rowHdr, width);\n        this.getContentPanel().style.width = \"calc(100% - \" + width + \"px)\";\n        this.getContentPanel().style[offset] = width + 'px';\n        var scroll = (this.contentPanel.nextElementSibling ? this.contentPanel.nextElementSibling : null);\n        if (scroll) {\n            if (scrollSize) {\n                scroll.style.height = scrollSize + 1 + 'px';\n            }\n            else {\n                scroll.style.height = '1px';\n                scroll.style.borderTopWidth = '0px';\n            }\n            scroll = scroll.firstElementChild;\n            scroll.style[offset] = width + 'px';\n            scroll.style.width = \"calc(100% - \" + width + \"px)\";\n            if (Browser.userAgent.indexOf('Mac OS') > -1 && Browser.info.name === 'safari') {\n                scroll.style.height = '7px';\n                scroll.style.top = '-7px';\n            }\n        }\n    };\n    SheetRender.prototype.getScrollSize = function (addOffset) {\n        var prop = this.parent.enableRtl ? 'margin-left' : 'margin-right';\n        return parseInt(this.headerPanel.style[prop], 10) ? parseInt(this.headerPanel.style[prop], 10) + (addOffset ? 1 : 0) : 0;\n    };\n    SheetRender.prototype.setHeaderPanelWidth = function (content, width) {\n        var emptyCol = [].slice.call(content.querySelectorAll('col.e-empty'));\n        emptyCol.forEach(function (col) {\n            width += parseInt(col.style.width, 10);\n        });\n        content.style.width = width + 'px';\n    };\n    SheetRender.prototype.setPanelHeight = function (sheet) {\n        var scrollSize = this.getScrollSize(true);\n        if (sheet.frozenRows) {\n            var frozenHeight = this.getColHeaderHeight(sheet);\n            if (!sheet.showHeaders && !sheet.frozenColumns) {\n                this.headerPanel.style.height = frozenHeight + 'px';\n            }\n            else {\n                this.headerPanel.style.height = '';\n            }\n            this.contentPanel.style.height = \"calc(100% - \" + (frozenHeight + scrollSize) + \"px)\";\n            var frozenRow = document.getElementById(this.parent.element.id + '_sheet').getElementsByClassName('e-frozen-row')[0];\n            frozenRow.style.width = Browser.isDevice ? '100%' :\n                \"calc(100% - \" + scrollSize + \"px)\";\n            frozenRow.style.top = frozenHeight - 1 - (sheet.showHeaders ? 1 : 0) + 'px';\n            frozenRow.style.display = '';\n        }\n        else {\n            this.contentPanel.style.height = \"calc(100% - \" + ((sheet.showHeaders ? getDPRValue(31) : 0) + scrollSize) + \"px)\";\n        }\n    };\n    SheetRender.prototype.renderPanel = function () {\n        this.contentPanel = this.parent.createElement('div', { className: 'e-main-panel' });\n        var sheet = this.parent.getActiveSheet();\n        var id = this.parent.element.id;\n        this.contentPanel.appendChild(this.parent.createElement('div', { className: 'e-row-header', id: id + \"_row_header\" }));\n        this.initHeaderPanel();\n        if (this.parent.allowScrolling) {\n            this.parent.scrollModule.setPadding();\n        }\n        var sheetEle = document.getElementById(this.parent.element.id + '_sheet');\n        if (sheet.frozenColumns) {\n            sheetEle.classList.add('e-frozen-columns');\n        }\n        if (sheet.frozenRows) {\n            sheetEle.classList.add('e-frozen-rows');\n        }\n        this.updateHideHeaders(sheet, sheetEle);\n        if (!sheet.showGridLines) {\n            sheetEle.classList.add('e-hide-gridlines');\n        }\n        var content = this.contentPanel.appendChild(this.parent.createElement('div', { className: 'e-sheet-content', id: id + \"_main_content\" }));\n        if (!this.parent.allowScrolling) {\n            content.style.overflow = 'hidden';\n        }\n        if (sheet.frozenRows) {\n            sheetEle.appendChild(this.parent.createElement('div', { className: 'e-frozen-row', styles: 'display: none' }));\n        }\n        if (sheet.frozenColumns) {\n            sheetEle.appendChild(this.parent.createElement('div', { className: 'e-frozen-column', styles: 'display: none' }));\n        }\n        if (Browser.userAgent.indexOf('Mac OS') > -1 && Browser.info.name === 'safari') {\n            sheetEle.classList.add('e-mac-safari');\n        }\n    };\n    SheetRender.prototype.initHeaderPanel = function () {\n        var id = this.parent.element.id;\n        this.headerPanel = this.parent.createElement('div', { className: 'e-header-panel' });\n        this.headerPanel.appendChild(this.parent.createElement('div', { className: 'e-selectall-container', id: id + \"_selectall\" }));\n        this.headerPanel.appendChild(this.parent.createElement('div', { className: 'e-column-header', id: id + \"_col_header\" }));\n    };\n    SheetRender.prototype.createHeaderTable = function () {\n        var rowHdrEle = this.contentPanel.querySelector('.e-row-header');\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.frozenRows || sheet.frozenColumns) {\n            this.updateTable(sheet.frozenRows ? ['thead', 'tbody'] : ['thead'], 'selectall', this.headerPanel.querySelector('.e-selectall-container'));\n        }\n        this.updateTable(sheet.frozenRows ? ['thead', 'tbody'] : ['thead'], 'colhdr', this.headerPanel.querySelector('.e-column-header'));\n        this.updateTable(['tbody'], 'rowhdr', rowHdrEle);\n        this.updateLeftColGroup(null, rowHdrEle);\n    };\n    SheetRender.prototype.updateTable = function (tagName, name, appendTo) {\n        var _this = this;\n        var table = this.parent.createElement('table', { className: 'e-table', attrs: { 'role': 'grid' } });\n        table.classList.add(\"e-\" + name + \"-table\");\n        appendTo.appendChild(table);\n        tagName.forEach(function (tag) { table.appendChild(_this.parent.createElement(tag)); });\n    };\n    /**\n     * It is used to refresh the select all, row header, column header and content of the spreadsheet.\n     *\n     * @param {SheetRenderArgs} args - Specifies the cells, indexes, direction, skipUpdateOnFirst, top, left, initload properties.\n     * @returns {void}\n     */\n    SheetRender.prototype.renderTable = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var hRow;\n        var sheet = this.parent.getActiveSheet();\n        var frag = document.createDocumentFragment();\n        frag.appendChild(this.headerPanel);\n        frag.appendChild(this.contentPanel);\n        if (this.parent.allowScrolling) {\n            var scrollPanel = this.parent.createElement('div', { className: 'e-scrollbar' });\n            scrollPanel.appendChild(this.parent.createElement('div', { className: 'e-scroller' }));\n            frag.appendChild(scrollPanel);\n        }\n        this.createHeaderTable();\n        this.updateTable(['tbody'], 'content', this.contentPanel.lastElementChild);\n        var colGrp = this.parent.createElement('colgroup');\n        var col;\n        var cTBody = this.contentPanel.querySelector('.e-sheet-content tbody');\n        this.refreshSelectALLContent();\n        var selectAllColGrp = this.getSelectAllContent().querySelector('colgroup');\n        var rowHdrColGrp = this.getRowHeaderPanel().querySelector('colgroup');\n        var selectAllHdrRow = this.getSelectAllContent().querySelector('thead .e-header-row');\n        var rHdrTBody = this.contentPanel.querySelector('.e-row-header tbody');\n        var selectAllTBody = this.getSelectAllContent().querySelector('tbody');\n        var cHdrTHead = this.headerPanel.querySelector('.e-column-header thead');\n        var cHdrTBody = this.headerPanel.querySelector('.e-column-header tbody');\n        var cHdrRow = this.rowRenderer.render();\n        cHdrTHead.appendChild(cHdrRow);\n        this.getColHeaderTable().insertBefore(colGrp, cHdrTHead);\n        var frozenRow = this.parent.frozenRowCount(sheet);\n        var frozenCol = this.parent.frozenColCount(sheet);\n        this.parent.notify(beforeContentLoaded, { top: args.top, left: args.left });\n        var colCount = sheet.colCount.toString();\n        var rowCount = sheet.colCount.toString();\n        var layout = args.top && args.left ? 'RowColumn' : (args.top ? 'Row' : (args.left ? 'Column' : ''));\n        this.parent.getColHeaderTable().setAttribute('aria-colcount', colCount);\n        this.parent.getRowHeaderTable().setAttribute('aria-rowcount', rowCount);\n        var emptyRow;\n        attributes(this.parent.getContentTable(), { 'aria-rowcount': rowCount, 'aria-colcount': colCount });\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[1] === args.indexes[1] || !row) {\n                hRow = _this.rowRenderer.render(indexes[0], true);\n                if (frozenCol && frozenRow && indexes[1] < frozenCol && indexes[0] < frozenRow) {\n                    emptyRow = selectAllTBody.querySelector('.e-empty');\n                    if (emptyRow) {\n                        selectAllTBody.insertBefore(hRow, emptyRow);\n                    }\n                    else {\n                        selectAllTBody.appendChild(hRow);\n                    }\n                    row = hRow;\n                }\n                else if (frozenCol && indexes[1] < frozenCol) {\n                    rHdrTBody.appendChild(hRow);\n                    row = hRow;\n                }\n                else {\n                    row = _this.rowRenderer.render(indexes[0]);\n                    if (frozenRow && indexes[0] < frozenRow) {\n                        emptyRow = cHdrTBody.querySelector('.e-empty');\n                        if (emptyRow) {\n                            cHdrTBody.insertBefore(row, emptyRow);\n                        }\n                        else {\n                            cHdrTBody.appendChild(row);\n                        }\n                    }\n                    else {\n                        cTBody.appendChild(row);\n                    }\n                    if (indexes[1] === args.indexes[1]) {\n                        if (frozenRow && indexes[0] < frozenRow) {\n                            selectAllTBody.appendChild(hRow);\n                        }\n                        else {\n                            rHdrTBody.appendChild(hRow);\n                        }\n                    }\n                }\n                if (indexes[1] === args.indexes[1]) {\n                    hRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                }\n            }\n            row.appendChild(_this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value,\n                address: key, lastCell: indexes[1] === args.indexes[3], isHeightCheckNeeded: true, row: row, hRow: hRow,\n                pRow: row.previousSibling, pHRow: hRow.previousSibling, isRefreshing: args.isRefreshing,\n                first: layout ? (layout.includes('Row') ? (indexes[0] === args.indexes[0] ? 'Row' : (layout.includes('Column') ? (indexes[1] === args.indexes[1] ? 'Column' : '') : '')) : (indexes[1] === args.indexes[1] ? 'Column' : '')) : '' }));\n            if (frozenCol && indexes[1] === frozenCol - 1) {\n                row = null;\n            }\n            if (indexes[0] === args.indexes[0]) {\n                if (frozenCol && indexes[1] < frozenCol) {\n                    col = _this.updateCol(sheet, indexes[1], selectAllColGrp);\n                    var empty = rowHdrColGrp.querySelector('.e-empty');\n                    empty ? rowHdrColGrp.insertBefore(col.cloneNode(true), empty) : rowHdrColGrp.appendChild(col.cloneNode(true));\n                    selectAllHdrRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                }\n                else {\n                    _this.updateCol(sheet, indexes[1], colGrp);\n                    cHdrRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                }\n            }\n        });\n        if (this.parent[isReact]) {\n            this.parent[renderReactTemplates]();\n        }\n        cTBody.parentElement.insertBefore(colGrp.cloneNode(true), cTBody);\n        getUpdateUsingRaf(function () {\n            var content = _this.parent.getMainContent();\n            var sheetContent = document.getElementById(_this.parent.element.id + '_sheet');\n            sheetContent.appendChild(frag);\n            sheetContent.style.backgroundColor = '';\n            if (args.top) {\n                content.parentElement.scrollTop = args.top;\n            }\n            if (args.left) {\n                content.scrollLeft = args.left;\n                _this.parent.getColumnHeaderContent().scrollLeft = args.left;\n            }\n            _this.parent.notify(contentLoaded, args);\n            _this.checkTableWidth(sheet);\n            _this.parent.notify(editOperation, { action: 'renderEditor' });\n            if (!args.initLoad && !_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(content, { busy: false });\n            _this.parent.trigger(dataBound, {});\n            if (_this.parent.isEdit) {\n                _this.parent.notify(initiateEdit, null);\n            }\n            if (args.initLoad) {\n                var triggerEvent = true;\n                if (_this.parent.scrollSettings.enableVirtualization) {\n                    for (var i = 0; i < sheet.ranges.length; i++) {\n                        if (sheet.ranges[i].info.count - 1 > _this.parent.viewport.bottomIndex) {\n                            triggerEvent = false;\n                            break;\n                        }\n                    }\n                }\n                if (triggerEvent) {\n                    /* eslint-disable */\n                    if (_this.parent.isReact) {\n                        setTimeout(function () { return _this.triggerCreatedEvent(); });\n                        /* eslint-enable */\n                    }\n                    else {\n                        _this.triggerCreatedEvent();\n                    }\n                }\n            }\n        });\n    };\n    SheetRender.prototype.triggerCreatedEvent = function () {\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        if (this.parent.createdHandler) {\n            if (this.parent.createdHandler.observers) {\n                this.parent[created].observers = this.parent.createdHandler.observers;\n            }\n            else {\n                this.parent.setProperties({ created: this.parent.createdHandler }, true);\n            }\n            this.parent.createdHandler = undefined;\n            this.parent.trigger(created, null);\n            this.parent.notify(clearUndoRedoCollection, null);\n        }\n    };\n    SheetRender.prototype.checkTableWidth = function (sheet) {\n        if (this.parent.scrollSettings.isFinite && !this.parent.scrollSettings.enableVirtualization && sheet.colCount - 1 ===\n            this.parent.viewport.rightIndex) {\n            var cellsWidth = getColumnsWidth(sheet, this.parent.viewport.leftIndex + this.parent.frozenColCount(sheet), this.parent.viewport.rightIndex);\n            var rowHdrWidth = this.getRowHeaderWidth(sheet);\n            var scrollSize = this.getScrollSize();\n            if (cellsWidth < this.contentPanel.getBoundingClientRect().width - rowHdrWidth - scrollSize) {\n                this.getContentPanel().style.width = cellsWidth + 'px';\n                this.getColHeaderPanel().style.width = cellsWidth + 'px';\n            }\n            else if (!this.getContentPanel().style.width.includes('calc')) {\n                this.getContentPanel().style.width = \"calc(100% - \" + rowHdrWidth + \"px)\";\n                this.getColHeaderPanel().style.width = \"calc(100% - \" + rowHdrWidth + \"px)\";\n            }\n        }\n    };\n    SheetRender.prototype.refreshColumnContent = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var table;\n        var count = 0;\n        var cell;\n        var col;\n        var sheet = this.parent.getActiveSheet();\n        var frag = document.createDocumentFragment();\n        var hFrag = document.createDocumentFragment();\n        var tBody = this.parent.element.querySelector('.e-sheet-content tbody');\n        var hTBody = this.parent.element.querySelector('.e-column-header tbody');\n        var colGrp = this.parent.element.querySelector('.e-sheet-content colgroup');\n        colGrp = colGrp.cloneNode();\n        frag.appendChild(colGrp);\n        tBody = frag.appendChild(tBody.cloneNode(true));\n        var hColGrp = colGrp.cloneNode();\n        hFrag.appendChild(hColGrp);\n        var tHead;\n        tHead = this.parent.element.querySelector('.e-column-header thead');\n        tHead = hFrag.appendChild(tHead.cloneNode(true));\n        var hRow = tHead.querySelector('tr');\n        hRow.innerHTML = '';\n        var frozenRow = this.parent.frozenRowCount(sheet);\n        var frozenCol = this.parent.frozenColCount(sheet);\n        if (frozenRow) {\n            hTBody = hFrag.appendChild(hTBody.cloneNode(true));\n        }\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[0] === args.indexes[0]) {\n                col = _this.updateCol(sheet, indexes[1], hColGrp);\n                colGrp.appendChild(col.cloneNode());\n                hRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n            }\n            if (indexes[1] - frozenCol === args.indexes[1]) {\n                if (indexes[0] < frozenRow) {\n                    row = hTBody.children[count];\n                }\n                else {\n                    row = tBody.children[count];\n                }\n                if (row) {\n                    row.innerHTML = '';\n                    count++;\n                }\n                else {\n                    return;\n                }\n            }\n            cell = row.appendChild(_this.cellRenderer.render({\n                colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: key, row: row, pRow: row.previousSibling,\n                first: !args.skipUpdateOnFirst && indexes[1] === args.indexes[1] ? 'Column' : (_this.parent.scrollSettings.\n                    enableVirtualization && indexes[0] === args.indexes[0] && _this.parent.viewport.topIndex !==\n                    skipHiddenIdx(sheet, 0, true) ? 'Row' : ''), isRefreshing: true\n            }));\n            _this.checkColMerge(indexes, args.indexes, cell, value);\n            if (frozenRow && indexes[0] === frozenRow - 1) {\n                count = 0;\n            }\n        });\n        getUpdateUsingRaf(function () {\n            table = _this.getColHeaderTable();\n            removeAllChildren(table);\n            table.appendChild(hFrag);\n            table = _this.getContentTable();\n            removeAllChildren(table);\n            table.appendChild(frag);\n            _this.parent.notify(virtualContentLoaded, { refresh: 'Column', prevRowColCnt: args.prevRowColCnt });\n            if (_this.parent.isEdit) {\n                _this.parent.notify(forRefSelRender, {});\n            }\n            if (_this.parent.allowChart) {\n                _this.parent.notify(chartRangeSelection, null);\n            }\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.refreshRowContent = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var hdrRow;\n        var colGroupWidth = this.colGroupWidth;\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var frag = document.createDocumentFragment();\n        var tBody = this.parent.createElement('tbody');\n        var hFrag = document.createDocumentFragment();\n        var hTBody = tBody.cloneNode();\n        hFrag.appendChild(hTBody);\n        frag.appendChild(tBody);\n        var frozenCol = this.parent.frozenColCount(sheet);\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[1] === args.indexes[1] || !row) {\n                hdrRow = _this.rowRenderer.render(indexes[0], true);\n                if (frozenCol && indexes[1] < frozenCol) {\n                    hTBody.appendChild(hdrRow);\n                    row = hdrRow;\n                }\n                else {\n                    if (indexes[1] === args.indexes[1]) {\n                        hTBody.appendChild(hdrRow);\n                    }\n                    row = _this.rowRenderer.render(indexes[0]);\n                    tBody.appendChild(row);\n                }\n                if (indexes[1] === args.indexes[1]) {\n                    hdrRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                    colGroupWidth = getColGroupWidth(indexes[0] + 1);\n                }\n            }\n            if (frozenCol) {\n                hdrRow = hTBody.lastElementChild || hdrRow;\n            }\n            cell = row.appendChild(_this.cellRenderer.render({\n                rowIdx: indexes[0], colIdx: indexes[1], cell: value, address: key, lastCell: indexes[1] === args.indexes[3], row: row, hRow: hdrRow, pRow: row.previousSibling,\n                pHRow: hdrRow.previousSibling,\n                isHeightCheckNeeded: true, first: !args.skipUpdateOnFirst && indexes[0] === args.indexes[0] ?\n                    'Row' : (_this.parent.scrollSettings.enableVirtualization && indexes[1] === args.indexes[1] && _this.parent.viewport.leftIndex\n                    !== skipHiddenIdx(sheet, 0, true, 'columns') ? 'Column' : ''), isRefreshing: true\n            }));\n            _this.checkRowMerge(indexes, args.indexes, cell, value);\n            if (frozenCol && indexes[1] === frozenCol - 1) {\n                row = null;\n            }\n        });\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth);\n        }\n        if (this.contentPanel.querySelector('.e-row-header tbody')) {\n            detach(this.contentPanel.querySelector('.e-row-header tbody'));\n            this.getRowHeaderTable().appendChild(hFrag);\n        }\n        if (this.contentPanel.querySelector('.e-sheet-content tbody')) {\n            detach(this.contentPanel.querySelector('.e-sheet-content tbody'));\n            this.getContentTable().appendChild(frag);\n        }\n        this.parent.notify(virtualContentLoaded, { refresh: 'Row', prevRowColCnt: args.prevRowColCnt });\n        if (this.parent.allowChart) {\n            this.parent.notify(chartRangeSelection, {});\n        }\n        if (this.parent.isEdit) {\n            this.parent.notify(forRefSelRender, null);\n        }\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: false });\n    };\n    SheetRender.prototype.updateCol = function (sheet, idx, appendTo) {\n        var col = this.col.cloneNode();\n        col.style.width = formatUnit(getColumnWidth(sheet, idx, null, true));\n        if (appendTo) {\n            var empty = appendTo.querySelector('.e-empty');\n            return empty ? appendTo.insertBefore(col, empty) : appendTo.appendChild(col);\n        }\n        else {\n            return col;\n        }\n    };\n    SheetRender.prototype.updateColContent = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var indexes;\n            var row;\n            var refChild;\n            var cell;\n            var rowCount = 0;\n            var col;\n            var sheet = _this.parent.getActiveSheet();\n            var hRow = _this.parent.element.querySelector('.e-column-header .e-header-row');\n            var hRefChild = hRow.firstElementChild;\n            var colGrp = _this.parent.element.querySelector('.e-sheet-content colgroup');\n            var hColGrp = _this.parent.element.querySelector('.e-column-header colgroup');\n            var colRefChild = colGrp.firstElementChild;\n            var skipRender;\n            var hColRefChild = hColGrp.firstElementChild;\n            var tBody = _this.parent.element.querySelector('.e-sheet-content tbody');\n            var hTBody = _this.parent.element.querySelector('.e-column-header tbody');\n            var frozenRow = _this.parent.frozenRowCount(sheet);\n            var frozenCol = _this.parent.frozenColCount(sheet);\n            args.cells.forEach(function (value, key) {\n                if (skipRender) {\n                    return;\n                }\n                indexes = getRangeIndexes(key);\n                if (args.direction === 'first' && indexes[1] === args.indexes[1]) {\n                    _this.checkColMerge([indexes[0], _this.parent.viewport.leftIndex + frozenCol], args.indexes, ((indexes[0] < frozenRow ? hTBody : tBody).rows[rowCount] ||\n                        { cells: [] }).cells[(args.indexes[3] - args.indexes[1]) + 1], getCell(indexes[0], _this.parent.viewport.leftIndex + frozenCol, sheet) || {});\n                }\n                if (indexes[0] === args.indexes[0]) {\n                    if (args.direction === 'last') {\n                        col = _this.col.cloneNode();\n                        col.style.width = formatUnit(getColumnWidth(sheet, indexes[1], null, true));\n                        colGrp.insertBefore(col, colRefChild);\n                        hColGrp.insertBefore(col.cloneNode(), hColRefChild);\n                        hRow.insertBefore(_this.cellRenderer.renderColHeader(indexes[1]), hRefChild);\n                    }\n                    else {\n                        col = _this.updateCol(sheet, indexes[1], colGrp);\n                        hColGrp.appendChild(col.cloneNode());\n                        hRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                    }\n                    if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                        /* eslint-disable */\n                        detach(colGrp[args.direction + 'ElementChild']);\n                        detach(hColGrp[args.direction + 'ElementChild']);\n                        detach(hRow[args.direction + 'ElementChild']);\n                        /* eslint-enable */\n                    }\n                }\n                if (indexes[1] === args.indexes[1]) {\n                    if (indexes[0] < frozenRow) {\n                        row = hTBody.children[rowCount];\n                    }\n                    else {\n                        row = tBody.children[rowCount];\n                        if (!row) {\n                            skipRender = true;\n                            return;\n                        }\n                    }\n                    rowCount++;\n                    refChild = row.firstElementChild;\n                }\n                cell = _this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: key,\n                    lastCell: indexes[1] === args.indexes[3], isHeightCheckNeeded: args.direction === 'first', first: args.direction ===\n                        'last' && !args.skipUpdateOnFirst && indexes[1] === args.indexes[1] ? 'Column' : '', checkNextBorder: args.direction\n                        === 'last' && indexes[3] === args.indexes[3] ? 'Column' : '', isRefreshing: args.direction === 'first' });\n                if (args.direction === 'last') {\n                    _this.checkColMerge(indexes, args.indexes, cell, value, ((indexes[0] < frozenRow ? hTBody : tBody).rows[rowCount - 1] ||\n                        { cells: [] }).cells[0]);\n                    row.insertBefore(cell, refChild);\n                }\n                else {\n                    row.appendChild(cell);\n                }\n                if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    detach(row[args.direction + 'ElementChild']);\n                }\n                if (frozenRow && indexes[0] === frozenRow - 1) {\n                    rowCount = 0;\n                }\n            });\n            _this.parent.notify(virtualContentLoaded, { refresh: 'Column', prevRowColCnt: args.prevRowColCnt });\n            if (_this.parent.allowChart) {\n                _this.parent.notify(chartRangeSelection, null);\n            }\n            if (_this.parent.isEdit) {\n                _this.parent.notify(forRefSelRender, {});\n            }\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.updateRowContent = function (args) {\n        var _this = this;\n        var colGroupWidth = this.colGroupWidth;\n        var row;\n        var hRow;\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        var count = 0;\n        var tBody = this.parent.getMainContent().querySelector('tbody');\n        var rTBody = this.parent.getRowHeaderContent().querySelector('tbody');\n        var rFrag = document.createDocumentFragment();\n        var indexes;\n        var frag = document.createDocumentFragment();\n        this.parent.showSpinner();\n        var frozenCol = this.parent.frozenColCount(sheet);\n        var frozenRow = this.parent.frozenRowCount(sheet);\n        var firstRow;\n        args.cells.forEach(function (value, cKey) {\n            indexes = getRangeIndexes(cKey);\n            if (args.direction === 'first' && indexes[0] === args.indexes[0]) {\n                if (firstRow === undefined) {\n                    firstRow = (indexes[1] < frozenCol ? rTBody : tBody).rows[(args.indexes[2] - args.indexes[0]) + 1] || null;\n                }\n                _this.checkRowMerge([_this.parent.viewport.topIndex + frozenRow, indexes[1]], args.indexes, (firstRow || { cells: [] }).cells[indexes[1] < frozenCol ? count + 1 : count], getCell(_this.parent.viewport.topIndex + frozenRow, indexes[1], sheet) || {});\n            }\n            if (indexes[1] === args.indexes[1] || !row) {\n                hRow = _this.rowRenderer.render(indexes[0], true);\n                if (frozenCol && indexes[1] < frozenCol) {\n                    rFrag.appendChild(hRow);\n                    row = hRow;\n                }\n                else {\n                    row = _this.rowRenderer.render(indexes[0]);\n                    frag.appendChild(row);\n                    if (indexes[1] === args.indexes[1]) {\n                        rFrag.appendChild(hRow);\n                    }\n                    if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        detach(tBody[args.direction + 'ElementChild']);\n                    }\n                }\n                if (indexes[1] === args.indexes[1]) {\n                    hRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                    colGroupWidth = getColGroupWidth(indexes[0] + 1);\n                    if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        detach(rTBody[args.direction + 'ElementChild']);\n                    }\n                }\n            }\n            if (frozenCol) {\n                hRow = rFrag.lastElementChild || hRow;\n            }\n            cell = row.appendChild(_this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[2], cell: value, address: cKey, lastCell: indexes[1] === args.indexes[3], row: row, pHRow: hRow.previousSibling,\n                checkNextBorder: args.direction === 'last' && indexes[2] === args.indexes[2] ? 'Row' : '', pRow: row.previousSibling,\n                isHeightCheckNeeded: args.direction === 'first' || args.direction === '', hRow: hRow, first: args.direction === 'last' &&\n                    !args.skipUpdateOnFirst && indexes[0] === args.indexes[0] ? 'Row' : '', isRefreshing: args.direction === 'first' }));\n            if (args.direction === 'last' && tBody.rows.length) {\n                _this.checkRowMerge(indexes, args.indexes, cell, value, (indexes[1] < frozenCol ? rTBody : tBody).rows[0].cells[indexes[1] < frozenCol ?\n                    count + 1 : count]);\n            }\n            count++;\n            if (frozenCol && indexes[1] === frozenCol - 1) {\n                row = null;\n                firstRow = undefined;\n                count = 0;\n            }\n        });\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth);\n        }\n        if (args.direction === 'last') {\n            rTBody.insertBefore(rFrag, rTBody.firstElementChild);\n            tBody.insertBefore(frag, tBody.firstElementChild);\n        }\n        else {\n            rTBody.appendChild(rFrag);\n            tBody.appendChild(frag);\n        }\n        if (this.parent.scrollSettings.enableVirtualization) {\n            this.parent.notify(virtualContentLoaded, { refresh: 'Row', prevRowColCnt: args.prevRowColCnt });\n        }\n        if (this.parent.isEdit) {\n            this.parent.notify(forRefSelRender, null);\n        }\n        if (this.parent.allowChart) {\n            this.parent.notify(chartRangeSelection, {});\n        }\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: false });\n    };\n    SheetRender.prototype.checkRowMerge = function (indexes, range, cell, model, firstcell) {\n        if (this.parent.scrollSettings.enableVirtualization && cell &&\n            (!isNullOrUndefined(model.rowSpan) || !isNullOrUndefined(model.colSpan))) {\n            var frozenRow = this.parent.frozenRowCount(this.parent.getActiveSheet());\n            if (indexes[0] === this.parent.viewport.topIndex + frozenRow) {\n                if (model.rowSpan < 0) {\n                    var args = { td: cell, rowIdx: indexes[0], colIdx: indexes[1], isRow: true,\n                        isFreezePane: true };\n                    this.parent.notify(checkMerge, args);\n                    if (args.insideFreezePane) {\n                        return;\n                    }\n                    if (this.parent.viewport.topIndex + frozenRow >= range[0]) {\n                        this.refreshPrevMerge(range[0] + 1, indexes[1]);\n                    }\n                }\n                if (firstcell && (firstcell.colSpan > 1 || firstcell.rowSpan > 1)) {\n                    this.cellRenderer.refresh(indexes[0] + (range[2] - range[0]) + 1, indexes[1], null, firstcell);\n                }\n            }\n            else if (model.rowSpan > 1) {\n                var prevTopIdx = range[2] + 1;\n                if (indexes[0] + model.rowSpan - 1 > prevTopIdx && indexes[0] < prevTopIdx) {\n                    this.refreshPrevMerge(prevTopIdx, indexes[1], this.parent.viewport.topIndex + frozenRow);\n                }\n            }\n        }\n    };\n    SheetRender.prototype.refreshPrevMerge = function (prevTopIdx, colIndex, currTopIdx) {\n        var td = this.parent.getCell(prevTopIdx, colIndex, this.parent.getRow(currTopIdx ?\n            currTopIdx : 0, null, colIndex));\n        if (td && td.rowSpan > 1) {\n            this.cellRenderer.refresh(prevTopIdx, colIndex, null, td);\n        }\n    };\n    SheetRender.prototype.checkColMerge = function (indexes, range, cell, model, firstcell) {\n        if (this.parent.scrollSettings.enableVirtualization && cell && indexes[1] === this.parent.viewport.leftIndex +\n            this.parent.frozenColCount(this.parent.getActiveSheet()) && (!isNullOrUndefined(model.rowSpan) ||\n            !isNullOrUndefined(model.colSpan))) {\n            if (model.colSpan < 0) {\n                var e = { td: cell, colIdx: indexes[1], rowIdx: indexes[0], isFreezePane: true };\n                this.parent.notify(checkMerge, e);\n                if (e.insideFreezePane) {\n                    return;\n                }\n            }\n            if (firstcell && (firstcell.colSpan > 1 || firstcell.rowSpan > 1)) {\n                this.cellRenderer.refresh(indexes[0], indexes[1] + (range[3] - range[1]) + 1, null, firstcell);\n            }\n        }\n    };\n    /**\n     * Used to toggle row and column headers.\n     *\n     * @returns {void}\n     */\n    SheetRender.prototype.showHideHeaders = function () {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        getUpdateUsingRaf(function () {\n            if (sheet.showHeaders) {\n                var content = _this.getContentPanel();\n                _this.setPanelWidth(sheet, _this.getRowHeaderPanel());\n                _this.setPanelHeight(sheet);\n                document.getElementById(_this.parent.element.id + '_sheet').classList.remove('e-hide-headers');\n                _this.getColHeaderPanel().scrollLeft = content.scrollLeft;\n                _this.parent.selectRange(sheet.selectedRange);\n            }\n            else {\n                _this.updateHideHeaders(sheet, document.getElementById(_this.parent.element.id + '_sheet'));\n                _this.setPanelHeight(sheet);\n                if (_this.parent.frozenColCount(sheet) || _this.parent.frozenRowCount(sheet)) {\n                    _this.setPanelWidth(sheet, _this.getRowHeaderPanel());\n                    _this.parent.selectRange(sheet.selectedRange);\n                }\n                else {\n                    _this.getContentPanel().style.width = '';\n                    var offset = _this.parent.enableRtl ? 'right' : 'left';\n                    _this.getContentPanel().style[offset] = '';\n                }\n                _this.getScrollElement().style.left = _this.getRowHeaderWidth(sheet) + 'px';\n            }\n        });\n    };\n    SheetRender.prototype.updateHideHeaders = function (sheet, ele) {\n        if (!sheet.showHeaders) {\n            ele.classList.add('e-hide-headers');\n        }\n    };\n    SheetRender.prototype.rowHeightChange = function (args) {\n        if (args.threshold) {\n            var sheet = this.parent.getActiveSheet();\n            if (args.rowIdx < this.parent.frozenRowCount(sheet)) {\n                this.setPanelHeight(sheet);\n            }\n        }\n    };\n    SheetRender.prototype.colWidthChange = function (args) {\n        if (args.threshold) {\n            var sheet = this.parent.getActiveSheet();\n            if (args.colIdx < this.parent.frozenColCount(sheet)) {\n                this.setPanelWidth(sheet, this.getRowHeaderPanel());\n            }\n            this.checkTableWidth(sheet);\n        }\n    };\n    SheetRender.prototype.getRowHeaderWidth = function (sheet, skipFreezeCheck) {\n        var width = 0;\n        if (!skipFreezeCheck && sheet.frozenColumns) {\n            var leftIdx = getCellIndexes(sheet.topLeftCell)[1];\n            width = getColumnsWidth(sheet, leftIdx, leftIdx + sheet.frozenColumns - 1, true);\n        }\n        width += sheet.showHeaders ? getDPRValue(this.colGroupWidth) : 0;\n        return width;\n    };\n    SheetRender.prototype.getColHeaderHeight = function (sheet, skipHeader) {\n        var topIndex = getCellIndexes(sheet.topLeftCell)[0];\n        return (sheet.showHeaders && !skipHeader ? getDPRValue(31) : 0) +\n            getRowsHeight(sheet, topIndex, topIndex + sheet.frozenRows - 1, true);\n    };\n    /**\n     * Get the select all table element of spreadsheet\n     *\n     * @returns {HTMLElement} - Select all content element.\n     */\n    SheetRender.prototype.getSelectAllContent = function () {\n        return this.headerPanel.getElementsByClassName('e-selectall-container')[0];\n    };\n    /**\n     * Get the horizontal scroll element of spreadsheet\n     *\n     * @returns {HTMLElement} - Select all content element.\n     */\n    SheetRender.prototype.getScrollElement = function () {\n        return (this.contentPanel.parentElement || this.contentPanel.nextElementSibling).querySelector('.e-scroller');\n    };\n    /**\n     * Get the select all table element of spreadsheet\n     *\n     * @returns {HTMLTableElement} - Select all table element.\n     */\n    SheetRender.prototype.getSelectAllTable = function () {\n        return this.headerPanel.getElementsByClassName('e-selectall-table')[0];\n    };\n    /**\n     * Get the column header element of spreadsheet\n     *\n     * @returns {HTMLTableElement} - Column header table element.\n     */\n    SheetRender.prototype.getColHeaderTable = function () {\n        return this.headerPanel.getElementsByClassName('e-colhdr-table')[0];\n    };\n    /**\n     * Get the row header table element of spreadsheet\n     *\n     * @returns {HTMLTableElement} - Row header table element.\n     */\n    SheetRender.prototype.getRowHeaderTable = function () {\n        return this.contentPanel.getElementsByClassName('e-rowhdr-table')[0];\n    };\n    /**\n     * Get the main content table element of spreadsheet\n     *\n     * @returns {Element} - Content table element.\n     */\n    SheetRender.prototype.getContentTable = function () {\n        return this.contentPanel.getElementsByClassName('e-content-table')[0];\n    };\n    /**\n     * Get the row header div element of spreadsheet\n     *\n     * @returns {HTMLElement} - Row header panel element.\n     */\n    SheetRender.prototype.getRowHeaderPanel = function () {\n        return this.contentPanel.getElementsByClassName('e-row-header')[0];\n    };\n    /**\n     * Get the column header div element of spreadsheet\n     *\n     * @returns {HTMLElement} - Column header panel element.\n     */\n    SheetRender.prototype.getColHeaderPanel = function () {\n        return this.headerPanel.getElementsByClassName('e-column-header')[0];\n    };\n    /**\n     * Get the main content div element of spreadsheet\n     *\n     * @returns {HTMLElement} - Content panel element.\n     */\n    SheetRender.prototype.getContentPanel = function () {\n        return this.contentPanel.getElementsByClassName('e-sheet-content')[0];\n    };\n    SheetRender.prototype.addEventListener = function () {\n        this.parent.on(created, this.triggerCreatedEvent, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChange, this);\n        this.parent.on(colWidthChanged, this.colWidthChange, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    SheetRender.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    SheetRender.prototype.removeEventListener = function () {\n        this.parent.off(created, this.triggerCreatedEvent);\n        this.parent.off(rowHeightChanged, this.rowHeightChange);\n        this.parent.off(colWidthChanged, this.colWidthChange);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return SheetRender;\n}());\nexport { SheetRender };\n","import { skipHiddenIdx } from '../common/index';\nimport { getRowHeight, getCell, isHiddenRow } from '../../workbook/base/index';\nimport { attributes } from '@syncfusion/ej2-base';\nimport { getCellAddress } from '../../workbook/common/index';\n/**\n * Sheet module is used for creating row element\n *\n * @hidden\n */\nvar RowRenderer = /** @class */ (function () {\n    function RowRenderer(parent) {\n        this.parent = parent;\n        this.element = this.parent.createElement('tr', { attrs: { 'role': 'row' } });\n        this.cellRenderer = parent.serviceLocator.getService('cell');\n    }\n    RowRenderer.prototype.render = function (index, isRowHeader, skipHidden) {\n        var row = this.element.cloneNode();\n        if (index === undefined) {\n            row.classList.add('e-header-row');\n            return row;\n        }\n        row.classList.add('e-row');\n        var sheet = this.parent.getActiveSheet();\n        attributes(row, { 'aria-rowindex': (index + 1).toString() });\n        row.style.height = getRowHeight(sheet, index, true) + \"px\";\n        if (isRowHeader && !skipHidden) {\n            if (isHiddenRow(sheet, index + 1) && !isHiddenRow(sheet, index - 1)) {\n                row.classList.add('e-hide-start');\n            }\n            if (index !== 0 && isHiddenRow(sheet, index - 1) && !isHiddenRow(sheet, index + 1)) {\n                row.classList.add('e-hide-end');\n            }\n        }\n        return row;\n    };\n    RowRenderer.prototype.refresh = function (index, pRow, hRow, header) {\n        var row;\n        var sheet = this.parent.getActiveSheet();\n        if (header) {\n            row = this.render(index, true, true);\n            row.appendChild(this.cellRenderer.renderRowHeader(index));\n        }\n        else {\n            row = this.render(index);\n            var len = this.parent.viewport.leftIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2);\n            for (var i = this.parent.viewport.leftIndex; i <= len; i++) {\n                row.appendChild(this.cellRenderer.render({ colIdx: i, rowIdx: index, cell: getCell(index, i, sheet),\n                    address: getCellAddress(index, i), lastCell: i === len, row: row, hRow: hRow, isHeightCheckNeeded: true, pRow: pRow,\n                    first: index === this.parent.viewport.topIndex && skipHiddenIdx(sheet, index, true) !== skipHiddenIdx(sheet, 0, true) ?\n                        'Row' : '' }));\n            }\n        }\n        return row;\n    };\n    return RowRenderer;\n}());\nexport { RowRenderer };\n","import { inView, renderFilterCell, checkConditionalFormat } from '../common/index';\nimport { hasTemplate, createHyperlinkElement, checkPrevMerge, createImageElement, getDPRValue } from '../common/index';\nimport { removeAllChildren } from '../common/index';\nimport { getColumnHeaderText, getRangeIndexes, getRangeAddress } from '../../workbook/common/index';\nimport { setChart, refreshChart, getCellAddress } from '../../workbook/common/index';\nimport { skipDefaultValue, isHiddenRow, isHiddenCol } from '../../workbook/base/index';\nimport { getRowHeight, setRowHeight, getCell, getColumn, getColumnWidth, getSheet, setCell } from '../../workbook/base/index';\nimport { addClass, attributes, getNumberDependable, extend, compile, isNullOrUndefined, detach } from '@syncfusion/ej2-base';\nimport { getFormattedCellObject, applyCellFormat, workbookFormulaOperation, wrapEvent, cFRender } from '../../workbook/common/index';\nimport { getTypeFromFormat, activeCellMergedRange, addHighlight, getCellIndexes, updateView } from '../../workbook/index';\nimport { checkIsFormula } from '../../workbook/common/util';\n/**\n * CellRenderer class which responsible for building cell content.\n *\n * @hidden\n */\nvar CellRenderer = /** @class */ (function () {\n    function CellRenderer(parent) {\n        this.parent = parent;\n        this.element = this.parent.createElement('td');\n        this.th = this.parent.createElement('th', { className: 'e-header-cell' });\n        this.tableRow = parent.createElement('tr', { className: 'e-row' });\n        this.parent.on(updateView, this.updateView, this);\n        this.parent.on('calculateFormula', this.calculateFormula, this);\n    }\n    CellRenderer.prototype.renderColHeader = function (index) {\n        var headerCell = this.th.cloneNode();\n        attributes(headerCell, { 'role': 'columnheader', 'aria-colindex': (index + 1).toString(), 'tabindex': '-1' });\n        headerCell.innerHTML = getColumnHeaderText(index + 1);\n        var sheet = this.parent.getActiveSheet();\n        if (isHiddenCol(sheet, index + 1)) {\n            headerCell.classList.add('e-hide-start');\n        }\n        if (index !== 0 && isHiddenCol(sheet, index - 1)) {\n            headerCell.classList.add('e-hide-end');\n        }\n        return headerCell;\n    };\n    CellRenderer.prototype.renderRowHeader = function (index) {\n        var headerCell = this.element.cloneNode();\n        addClass([headerCell], 'e-header-cell');\n        attributes(headerCell, { 'role': 'rowheader', 'tabindex': '-1' });\n        headerCell.innerHTML = (index + 1).toString();\n        return headerCell;\n    };\n    CellRenderer.prototype.render = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(args.rowIdx, args.colIdx, sheet);\n        var column = getColumn(sheet, args.colIdx);\n        var validation;\n        if (cell && cell.validation) {\n            validation = cell.validation;\n        }\n        else if (column && column.validation) {\n            validation = column.validation;\n        }\n        args.td = this.element.cloneNode();\n        args.td.className = 'e-cell';\n        attributes(args.td, { 'role': 'gridcell', 'aria-colindex': (args.colIdx + 1).toString(), 'tabindex': '-1' });\n        if (this.checkMerged(args)) {\n            return args.td;\n        }\n        args.isRefresh = false;\n        this.update(args);\n        if (args.cell && args.td) {\n            if (validation && validation.isHighlighted) {\n                this.parent.notify(addHighlight, { range: getRangeAddress([args.rowIdx, args.colIdx]), td: args.td });\n            }\n            this.parent.notify(cFRender, { rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.cell, td: args.td, isChecked: false });\n            if (args.td && args.td.children[0] && args.td.children[0].className === 'e-cf-databar') {\n                if (args.cell.style && args.cell.style.fontSize) {\n                    args.td.children[0].querySelector('.e-databar-value').style.fontSize = args.cell.style.fontSize;\n                }\n                args.td.children[0].style.height = '100%';\n                args.td.children[0].firstElementChild.nextElementSibling.style.height = '100%';\n            }\n        }\n        if (!hasTemplate(this.parent, args.rowIdx, args.colIdx, this.parent.activeSheetIndex)) {\n            this.parent.notify(renderFilterCell, { td: args.td, rowIndex: args.rowIdx, colIndex: args.colIdx });\n        }\n        var evtArgs = { cell: args.cell, element: args.td, address: args.address, rowIndex: args.rowIdx, colIndex: args.colIdx };\n        this.parent.trigger('beforeCellRender', evtArgs);\n        this.updateRowHeight({\n            rowIdx: args.rowIdx,\n            cell: evtArgs.element,\n            lastCell: args.lastCell,\n            rowHgt: 20,\n            row: args.row,\n            hRow: args.hRow\n        });\n        this.setWrapByValue(sheet, args);\n        return evtArgs.element;\n    };\n    CellRenderer.prototype.setWrapByValue = function (sheet, args) {\n        var isWrap = args.td.classList.contains('e-wraptext');\n        var cellValue = args.td.innerHTML;\n        if (cellValue.indexOf('\\n') > -1 && !isWrap) {\n            var splitVal = cellValue.split('\\n');\n            if (splitVal.length > 1) {\n                setCell(args.rowIdx, args.colIdx, sheet, { wrap: true }, true);\n                this.parent.notify(wrapEvent, { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx], wrap: true, initial: true, sheet: sheet,\n                    td: args.td, row: args.row, hRow: args.hRow });\n            }\n        }\n    };\n    CellRenderer.prototype.update = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var compiledTemplate = this.processTemplates(args.cell, args.rowIdx, args.colIdx);\n        if (compiledTemplate) {\n            if (typeof compiledTemplate === 'string') {\n                args.td.innerHTML = compiledTemplate;\n            }\n            else {\n                removeAllChildren(args.td);\n                args.td.appendChild(compiledTemplate);\n            }\n        }\n        if (args.isRefresh) {\n            if (args.td.rowSpan) {\n                this.mergeFreezeRow(sheet, args.rowIdx, args.colIdx, args.td.rowSpan, args.row, true);\n                args.td.removeAttribute('rowSpan');\n            }\n            if (args.td.colSpan) {\n                this.mergeFreezeCol(sheet, args.rowIdx, args.colIdx, args.td.colSpan, true);\n                args.td.removeAttribute('colSpan');\n            }\n            if (this.checkMerged(args)) {\n                return;\n            }\n            if (args.cell && !args.cell.hyperlink && args.td.querySelector('.e-hyperlink')) {\n                args.td.removeChild(args.td.querySelector('.e-hyperlink'));\n            }\n        }\n        if (args.cell && args.cell.formula && (!args.cell.value || args.isRefreshing)) {\n            if (args.cell.formula.indexOf('UNIQUE') === -1 && args.cell.value !== '') {\n                this.calculateFormula(args);\n            }\n        }\n        var formatArgs = {\n            type: args.cell && getTypeFromFormat(args.cell.format),\n            value: args.cell && args.cell.value, format: args.cell && args.cell.format ? args.cell.format : 'General',\n            formattedText: args.cell && args.cell.value, onLoad: true, isRightAlign: false, cell: args.cell,\n            rowIdx: args.rowIdx.toString(), colIdx: args.colIdx.toString()\n        };\n        if (args.cell) {\n            this.parent.notify(getFormattedCellObject, formatArgs);\n        }\n        if (!isNullOrUndefined(args.td)) {\n            this.parent.refreshNode(args.td, { type: formatArgs.type, result: formatArgs.formattedText,\n                curSymbol: getNumberDependable(this.parent.locale, 'USD'), isRightAlign: formatArgs.isRightAlign,\n                value: formatArgs.value || ''\n            });\n        }\n        var style = {};\n        if (args.cell) {\n            if (args.cell.style) {\n                if (args.cell.style.properties) {\n                    style = skipDefaultValue(args.cell.style, true);\n                }\n                else {\n                    style = args.cell.style;\n                }\n            }\n            if (args.cell.chart && args.cell.chart.length > 0) {\n                this.parent.notify(setChart, { chart: args.cell.chart, isInitCell: true, range: getCellAddress(args.rowIdx, args.colIdx) });\n            }\n            if (args.cell.hyperlink) {\n                this.parent.notify(createHyperlinkElement, { cell: args.cell, td: args.td, rowIdx: args.rowIdx, colIdx: args.colIdx });\n            }\n            if (args.cell.rowSpan > 1) {\n                var rowSpan = args.cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (args.cell.rowSpan - 1));\n                if (rowSpan > 1) {\n                    args.td.rowSpan = rowSpan;\n                    this.mergeFreezeRow(sheet, args.rowIdx, args.colIdx, rowSpan, args.row);\n                }\n            }\n            if (args.cell.colSpan > 1) {\n                var colSpan = args.cell.colSpan -\n                    this.parent.hiddenCount(args.colIdx, args.colIdx + (args.cell.colSpan - 1), 'columns');\n                if (colSpan > 1) {\n                    args.td.colSpan = colSpan;\n                    this.mergeFreezeCol(sheet, args.rowIdx, args.colIdx, colSpan);\n                }\n            }\n            if (args.cell.image) {\n                for (var i = 0; i < args.cell.image.length; i++) {\n                    if (args.cell.image[i]) {\n                        this.parent.notify(createImageElement, {\n                            options: {\n                                src: args.cell.image[i].src, imageId: args.cell.image[i].id,\n                                height: args.cell.image[i].height, width: args.cell.image[i].width,\n                                top: args.cell.image[i].top, left: args.cell.image[i].left\n                            },\n                            range: getRangeAddress([args.rowIdx, args.colIdx, args.rowIdx, args.colIdx]), isPublic: false\n                        });\n                    }\n                }\n            }\n        }\n        if (args.isRefresh) {\n            this.removeStyle(args.td, args.rowIdx, args.colIdx);\n        }\n        if (this.parent.allowChart && args.lastCell) {\n            this.parent.notify(refreshChart, {\n                cell: args.cell, rIdx: args.rowIdx, cIdx: args.colIdx, sheetIdx: this.parent.activeSheetIndex\n            });\n        }\n        if (Object.keys(style).length || Object.keys(this.parent.commonCellStyle).length || args.lastCell) {\n            this.parent.notify(applyCellFormat, {\n                style: extend({}, this.parent.commonCellStyle, style), rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.td,\n                first: args.first, row: args.row, lastCell: args.lastCell, hRow: args.hRow, pRow: args.pRow, isHeightCheckNeeded: args.isHeightCheckNeeded, manualUpdate: args.manualUpdate\n            });\n        }\n        if (this.parent.allowConditionalFormat && args.lastCell) {\n            this.parent.notify(checkConditionalFormat, { rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.cell });\n        }\n        if (args.checkNextBorder === 'Row') {\n            var borderTop = this.parent.getCellStyleValue(['borderTop'], [Number(this.parent.getContentTable().rows[0].getAttribute('aria-rowindex')) - 1, args.colIdx]).borderTop;\n            if (borderTop !== '' && (!args.cell || !args.cell.style || !args.cell.style.bottomPriority)) {\n                this.parent.notify(applyCellFormat, { style: { borderBottom: borderTop }, rowIdx: args.rowIdx,\n                    colIdx: args.colIdx, cell: args.td });\n            }\n        }\n        if (args.checkNextBorder === 'Column') {\n            var borderLeft = this.parent.getCellStyleValue(['borderLeft'], [args.rowIdx, args.colIdx + 1]).borderLeft;\n            if (borderLeft !== '' && (!args.cell || !args.cell.style || (!args.cell.style.borderRight && !args.cell.style.border))) {\n                this.parent.notify(applyCellFormat, { style: { borderRight: borderLeft }, rowIdx: args.rowIdx, colIdx: args.colIdx,\n                    cell: args.td });\n            }\n        }\n        if (args.cell && args.cell.hyperlink && !hasTemplate(this.parent, args.rowIdx, args.colIdx, this.parent.activeSheetIndex)) {\n            var address = void 0;\n            if (typeof (args.cell.hyperlink) === 'string') {\n                address = args.cell.hyperlink;\n                if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                    args.cell.hyperlink = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n                }\n            }\n            else {\n                address = args.cell.hyperlink.address;\n                if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                    args.cell.hyperlink.address = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n                }\n            }\n            this.parent.notify(createHyperlinkElement, { cell: args.cell, td: args.td, rowIdx: args.rowIdx, colIdx: args.colIdx });\n        }\n        if (args.cell && args.cell.wrap) {\n            var prevHgt = getRowHeight(sheet, args.rowIdx);\n            this.parent.notify(wrapEvent, {\n                range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx], wrap: true, sheet: sheet, initial: true, td: args.td, row: args.row, hRow: args.hRow, isCustomHgt: !args.isRefresh && prevHgt > 20\n            });\n        }\n    };\n    CellRenderer.prototype.calculateFormula = function (args) {\n        var isFormula = checkIsFormula(args.cell.formula);\n        var eventArgs = { action: 'refreshCalculate', value: args.cell.formula, rowIndex: args.rowIdx, colIndex: args.colIdx, isFormula: isFormula, sheetIndex: args.sheetIndex, isRefreshing: args.isRefreshing };\n        this.parent.notify(workbookFormulaOperation, eventArgs);\n        args.cell.value = getCell(args.rowIdx, args.colIdx, isNullOrUndefined(args.sheetIndex) ? this.parent.getActiveSheet() :\n            getSheet(this.parent, args.sheetIndex)).value;\n    };\n    CellRenderer.prototype.checkMerged = function (args) {\n        if (args.cell && (args.cell.colSpan < 0 || args.cell.rowSpan < 0)) {\n            var sheet = this.parent.getActiveSheet();\n            if (sheet.frozenRows || sheet.frozenColumns) {\n                var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                var frozenRow = this.parent.frozenRowCount(sheet);\n                var frozenCol = this.parent.frozenColCount(sheet);\n                var setDisplay = void 0;\n                if (sheet.frozenRows && sheet.frozenColumns) {\n                    if (mergeArgs.range[0] < frozenRow && mergeArgs.range[1] < frozenCol) {\n                        setDisplay = args.rowIdx < frozenRow && args.colIdx < frozenCol;\n                    }\n                    else if (mergeArgs.range[0] < frozenRow) {\n                        setDisplay = args.rowIdx < frozenRow;\n                    }\n                    else if (mergeArgs.range[1] < frozenCol) {\n                        setDisplay = args.colIdx < frozenCol;\n                    }\n                    else {\n                        setDisplay = true;\n                    }\n                }\n                else {\n                    setDisplay = frozenRow ? (mergeArgs.range[0] >= frozenRow || args.rowIdx < frozenRow) : (mergeArgs.range[1] >= frozenCol\n                        || args.colIdx < frozenCol);\n                }\n                if (setDisplay) {\n                    args.td.style.display = 'none';\n                }\n            }\n            else {\n                args.td.style.display = 'none';\n            }\n            if (args.cell.colSpan < 0) {\n                this.parent.notify(checkPrevMerge, args);\n            }\n            if (args.cell.rowSpan < 0) {\n                args.isRow = true;\n                this.parent.notify(checkPrevMerge, args);\n                if (args.cell && args.cell.rowSpan && args.cell.rowSpan < 0) {\n                    var prevCell = this.parent.getCell(args.rowIdx, args.colIdx - 1, args.row);\n                    var border = 'none';\n                    border = args.cell && args.cell.style && args.cell.style.borderLeft ? args.cell.style.borderLeft : 'none';\n                    if (prevCell && border) {\n                        prevCell.style.borderRight = (border === 'none') ? prevCell.style.borderRight : border;\n                    }\n                }\n            }\n            return true;\n        }\n        return false;\n    };\n    CellRenderer.prototype.mergeFreezeRow = function (sheet, rowIdx, colIdx, rowSpan, tr, unMerge) {\n        var frozenRow = this.parent.frozenRowCount(sheet);\n        if (frozenRow && rowIdx < frozenRow && rowIdx + (rowSpan - 1) >= frozenRow) {\n            var rowEle = void 0;\n            var spanRowTop = 0;\n            var height = void 0;\n            var frozenCol = this.parent.frozenColCount(sheet);\n            var row = tr || this.parent.getRow(rowIdx, null, colIdx);\n            var emptyRows = [].slice.call(row.parentElement.querySelectorAll('.e-empty'));\n            if (unMerge) {\n                var curEmptyLength = rowIdx + rowSpan - frozenRow;\n                if (curEmptyLength < emptyRows.length) {\n                    return;\n                }\n                else {\n                    var curSpan = 0;\n                    if (curEmptyLength === emptyRows.length) {\n                        var curCell = void 0;\n                        var i = void 0;\n                        var len = void 0;\n                        if (frozenCol && colIdx < frozenCol) {\n                            i = getCellIndexes(sheet.topLeftCell)[1];\n                            len = frozenCol;\n                        }\n                        else {\n                            i = this.parent.viewport.leftIndex + frozenCol;\n                            len = this.parent.viewport.rightIndex;\n                        }\n                        for (i; i < len; i++) {\n                            if (i === colIdx) {\n                                continue;\n                            }\n                            curCell = getCell(rowIdx, i, sheet, false, true);\n                            if (curCell.rowSpan && rowIdx + curCell.rowSpan - frozenRow > curSpan) {\n                                curSpan = rowIdx + curCell.rowSpan - frozenRow;\n                            }\n                        }\n                        if (curSpan === curEmptyLength) {\n                            return;\n                        }\n                    }\n                    else {\n                        curSpan = curEmptyLength;\n                    }\n                    var lastRowIdx = rowIdx + (rowSpan - 1);\n                    for (var i = curSpan, len = emptyRows.length; i < len; i++) {\n                        spanRowTop += getRowHeight(sheet, lastRowIdx);\n                        lastRowIdx--;\n                        detach(emptyRows.pop());\n                    }\n                    this.updateSpanTop(colIdx, frozenCol, spanRowTop, true);\n                    if (!emptyRows.length) {\n                        this.updateColZIndex(colIdx, frozenCol, true);\n                    }\n                    return;\n                }\n            }\n            this.updateColZIndex(colIdx, frozenCol);\n            for (var i = frozenRow, len = rowIdx + (rowSpan - 1); i <= len; i++) {\n                height = getRowHeight(sheet, i);\n                spanRowTop += -height;\n                if (frozenRow + emptyRows.length > i) {\n                    continue;\n                }\n                rowEle = row.cloneNode();\n                rowEle.classList.add('e-empty');\n                rowEle.style.visibility = 'hidden';\n                rowEle.style.height = height + 'px';\n                row.parentElement.appendChild(rowEle);\n            }\n            this.updateSpanTop(colIdx, frozenCol, spanRowTop);\n        }\n    };\n    CellRenderer.prototype.updateSpanTop = function (colIdx, frozenCol, top, update) {\n        var mainPanel = this.parent.serviceLocator.getService('sheet').contentPanel;\n        if (update) {\n            if (!parseInt(mainPanel.style.top, 10)) {\n                return;\n            }\n            top = parseInt(mainPanel.style.top, 10) + top;\n        }\n        if (frozenCol && colIdx < frozenCol && (update || !parseInt(mainPanel.style.top, 10) || top <\n            parseInt(mainPanel.style.top, 10))) {\n            mainPanel.style.top = top + 'px';\n            var scroll_1 = mainPanel.nextElementSibling;\n            if (scroll_1) {\n                scroll_1.style.top = top + 'px';\n            }\n        }\n    };\n    CellRenderer.prototype.mergeFreezeCol = function (sheet, rowIdx, colIdx, colSpan, unMerge) {\n        var frozenCol = this.parent.frozenColCount(sheet);\n        if (frozenCol && colIdx < frozenCol && colIdx + (colSpan - 1) >= frozenCol) {\n            var col = void 0;\n            var width = void 0;\n            var frozenRow = this.parent.frozenRowCount(sheet);\n            var colGrp = (rowIdx < frozenRow ? this.parent.getSelectAllContent() : this.parent.getRowHeaderContent()).querySelector('colgroup');\n            var emptyCols = [].slice.call(colGrp.querySelectorAll('.e-empty'));\n            if (unMerge) {\n                var curEmptyLength = colIdx + colSpan - frozenCol;\n                if (curEmptyLength < emptyCols.length) {\n                    return;\n                }\n                else {\n                    var curSpan = 0;\n                    if (curEmptyLength === emptyCols.length) {\n                        var curCell = void 0;\n                        var len = void 0;\n                        var i = void 0;\n                        if (frozenRow && rowIdx < frozenCol) {\n                            len = frozenRow;\n                            i = getCellIndexes(sheet.topLeftCell)[0];\n                        }\n                        else {\n                            len = this.parent.viewport.bottomIndex;\n                            i = this.parent.viewport.topIndex + frozenRow;\n                        }\n                        for (i; i < len; i++) {\n                            if (i === rowIdx) {\n                                continue;\n                            }\n                            curCell = getCell(i, colIdx, sheet, false, true);\n                            if (curCell.colSpan && colIdx + curCell.colSpan - frozenCol > curSpan) {\n                                curSpan = colIdx + curCell.colSpan - frozenCol;\n                            }\n                        }\n                        if (curSpan === curEmptyLength) {\n                            return;\n                        }\n                    }\n                    else {\n                        curSpan = curEmptyLength;\n                    }\n                    for (var i = curSpan, len = emptyCols.length; i < len; i++) {\n                        detach(emptyCols.pop());\n                    }\n                    this.parent.serviceLocator.getService('sheet').setPanelWidth(sheet, this.parent.getRowHeaderContent());\n                    if (!emptyCols.length) {\n                        this.updateRowZIndex(rowIdx, frozenRow, true);\n                    }\n                    return;\n                }\n            }\n            this.updateRowZIndex(rowIdx, frozenRow);\n            for (var i = frozenCol, len = colIdx + (colSpan - 1); i <= len; i++) {\n                if (frozenCol + emptyCols.length > i) {\n                    continue;\n                }\n                col = colGrp.childNodes[0].cloneNode();\n                col.classList.add('e-empty');\n                col.style.visibility = 'hidden';\n                width = getColumnWidth(sheet, i, null, true);\n                col.style.width = width + 'px';\n                colGrp.appendChild(col);\n                if (i === len) {\n                    this.parent.serviceLocator.getService('sheet').setPanelWidth(sheet, this.parent.getRowHeaderContent());\n                }\n            }\n        }\n    };\n    CellRenderer.prototype.updateColZIndex = function (colIdx, frozenCol, remove) {\n        if (colIdx < frozenCol) {\n            this.updateSelectAllZIndex(remove);\n        }\n        else {\n            this.parent.getColumnHeaderContent().style.zIndex = remove ? '' : '2';\n            this.updatedHeaderZIndex(remove);\n        }\n    };\n    CellRenderer.prototype.updateSelectAllZIndex = function (remove) {\n        var frozenRowEle = this.parent.element.querySelector('.e-frozen-row');\n        var frozenColEle = this.parent.element.querySelector('.e-frozen-column');\n        if (remove) {\n            this.parent.getSelectAllContent().style.zIndex = '';\n            if (frozenRowEle) {\n                frozenRowEle.style.zIndex = '';\n            }\n            if (frozenColEle) {\n                frozenColEle.style.zIndex = '';\n            }\n        }\n        else {\n            if (this.parent.getRowHeaderContent().style.zIndex || this.parent.getColumnHeaderContent().style.zIndex) {\n                this.parent.getSelectAllContent().style.zIndex = '3';\n                if (frozenRowEle) {\n                    frozenRowEle.style.zIndex = '4';\n                }\n                if (frozenColEle) {\n                    frozenColEle.style.zIndex = '4';\n                }\n            }\n            else {\n                this.parent.getSelectAllContent().style.zIndex = '2';\n            }\n        }\n    };\n    CellRenderer.prototype.updatedHeaderZIndex = function (remove) {\n        if (!remove && this.parent.getSelectAllContent().style.zIndex === '2') {\n            this.parent.getSelectAllContent().style.zIndex = '3';\n            var frozenRowEle = this.parent.element.querySelector('.e-frozen-row');\n            var frozenColEle = this.parent.element.querySelector('.e-frozen-column');\n            if (frozenColEle) {\n                frozenColEle.style.zIndex = '4';\n            }\n            if (frozenRowEle) {\n                frozenRowEle.style.zIndex = '4';\n            }\n        }\n    };\n    CellRenderer.prototype.updateRowZIndex = function (rowIdx, frozenRow, remove) {\n        if (rowIdx < frozenRow) {\n            this.updateSelectAllZIndex(remove);\n        }\n        else {\n            this.parent.getRowHeaderContent().style.zIndex = remove ? '' : '2';\n            this.updatedHeaderZIndex(remove);\n        }\n    };\n    CellRenderer.prototype.processTemplates = function (cell, rowIdx, colIdx) {\n        var sheet = this.parent.getActiveSheet();\n        var ranges = sheet.ranges;\n        var range;\n        for (var j = 0, len = ranges.length; j < len; j++) {\n            if (ranges[j].template) {\n                range = getRangeIndexes(ranges[j].address.length ? ranges[j].address : ranges[j].startCell);\n                if (range[0] <= rowIdx && range[1] <= colIdx && range[2] >= rowIdx && range[3] >= colIdx) {\n                    if (cell) {\n                        return this.compileCellTemplate(ranges[j].template, cell);\n                    }\n                    else {\n                        if (!getCell(rowIdx, colIdx, sheet, true)) {\n                            return this.compileCellTemplate(ranges[j].template, getCell(rowIdx, colIdx, sheet, null, true));\n                        }\n                    }\n                }\n            }\n        }\n        return '';\n    };\n    CellRenderer.prototype.compileCellTemplate = function (template, cell) {\n        var compiledStr;\n        if (typeof template === 'string') {\n            var templateString = void 0;\n            if (template.trim().indexOf('#') === 0) {\n                templateString = document.querySelector(template).innerHTML.trim();\n            }\n            else {\n                templateString = template;\n            }\n            compiledStr = compile(templateString);\n            return compiledStr(cell, null, null, '', true)[0].outerHTML;\n        }\n        else {\n            compiledStr = compile(template);\n            return compiledStr(cell, this.parent, 'ranges', '')[0];\n        }\n    };\n    CellRenderer.prototype.updateRowHeight = function (args) {\n        if (args.cell && args.cell.children.length) {\n            var clonedCell = args.cell.cloneNode(true);\n            this.tableRow.appendChild(clonedCell);\n        }\n        if (args.lastCell && this.tableRow.childElementCount) {\n            var sheet = this.parent.getActiveSheet();\n            var tableRow = args.row || this.parent.getRow(args.rowIdx);\n            var previouseHeight = getRowHeight(sheet, args.rowIdx);\n            var rowHeight = this.getRowHeightOnInit();\n            if (rowHeight > previouseHeight) {\n                var dprHgt = getDPRValue(rowHeight);\n                tableRow.style.height = dprHgt + \"px\";\n                (args.hRow || this.parent.getRow(args.rowIdx, this.parent.getRowHeaderTable())).style.height = dprHgt + \"px\";\n                setRowHeight(sheet, args.rowIdx, rowHeight);\n            }\n            this.tableRow.innerHTML = '';\n        }\n    };\n    CellRenderer.prototype.getRowHeightOnInit = function () {\n        var tTable = this.parent.createElement('table', { className: 'e-table e-test-table' });\n        var tBody = tTable.appendChild(this.parent.createElement('tbody'));\n        tBody.appendChild(this.tableRow);\n        this.parent.element.appendChild(tTable);\n        var height = Math.round(this.tableRow.getBoundingClientRect().height);\n        this.parent.element.removeChild(tTable);\n        return height < 20 ? 20 : height;\n    };\n    CellRenderer.prototype.removeStyle = function (element, rowIdx, colIdx) {\n        var cellStyle;\n        if (element.style.length) {\n            cellStyle = this.parent.getCellStyleValue(['borderLeft', 'border'], [rowIdx, colIdx + 1]);\n            var rightBorder_1 = cellStyle.borderLeft || cellStyle.border;\n            cellStyle = this.parent.getCellStyleValue(['borderTop', 'border'], [rowIdx + 1, colIdx]);\n            var bottomBorder_1 = cellStyle.borderTop || cellStyle.border;\n            if (rightBorder_1 || bottomBorder_1) {\n                [].slice.call(element.style).forEach(function (style) {\n                    if ((rightBorder_1 && !(style.indexOf('border-right') > -1) && (!bottomBorder_1 || bottomBorder_1 === 'none')) ||\n                        (bottomBorder_1 && !(style.indexOf('border-bottom') > -1) && (!rightBorder_1 || rightBorder_1 === 'none'))) {\n                        element.style.removeProperty(style);\n                    }\n                });\n            }\n            else {\n                element.removeAttribute('style');\n            }\n        }\n        var prevRowCell = this.parent.getCell(rowIdx - 1, colIdx);\n        if (prevRowCell && prevRowCell.style.borderBottom) {\n            var prevRowIdx = Number(prevRowCell.parentElement.getAttribute('aria-rowindex')) - 1;\n            cellStyle = this.parent.getCellStyleValue(['borderBottom', 'border'], [prevRowIdx, colIdx]);\n            if (!(cellStyle.borderBottom || cellStyle.border)) {\n                prevRowCell.style.borderBottom = '';\n            }\n        }\n        var prevColCell = element.previousElementSibling;\n        if (prevColCell && prevColCell.style.borderRight) {\n            colIdx = Number(prevColCell.getAttribute('aria-colindex')) - 1;\n            cellStyle = this.parent.getCellStyleValue(['borderRight', 'border'], [rowIdx, colIdx]);\n            if (!(cellStyle.borderRight || cellStyle.border)) {\n                prevColCell.style.borderRight = '';\n            }\n        }\n    };\n    /**\n     * @hidden\n     * @param {number[]} range - Specifies the range.\n     * @returns {void}\n     */\n    CellRenderer.prototype.refreshRange = function (range, refreshing, checkWrap) {\n        var sheet = this.parent.getActiveSheet();\n        var cRange = range.slice();\n        var args;\n        var cell;\n        if (inView(this.parent, cRange, true)) {\n            for (var i = cRange[0]; i <= cRange[2]; i++) {\n                if (isHiddenRow(sheet, i)) {\n                    continue;\n                }\n                for (var j = cRange[1]; j <= cRange[3]; j++) {\n                    if (isHiddenCol(sheet, j)) {\n                        continue;\n                    }\n                    cell = this.parent.getCell(i, j);\n                    if (cell) {\n                        args = { rowIdx: i, colIdx: j, td: cell, cell: getCell(i, j, sheet), isRefreshing: refreshing, lastCell: j ===\n                                cRange[3], isRefresh: true, isHeightCheckNeeded: true, manualUpdate: true, first: '' };\n                        this.update(args);\n                        this.parent.notify(renderFilterCell, { td: cell, rowIndex: i, colIndex: j });\n                        if (checkWrap) {\n                            this.setWrapByValue(sheet, args);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    CellRenderer.prototype.refresh = function (rowIdx, colIdx, lastCell, element) {\n        var sheet = this.parent.getActiveSheet();\n        if (!element && (isHiddenRow(sheet, rowIdx) || isHiddenCol(sheet, colIdx))) {\n            return;\n        }\n        if (element || !this.parent.scrollSettings.enableVirtualization || this.parent.insideViewport(rowIdx, colIdx)) {\n            var cell = element || this.parent.getCell(rowIdx, colIdx);\n            if (!cell) {\n                return;\n            }\n            this.update({ rowIdx: rowIdx, colIdx: colIdx, td: cell, cell: getCell(rowIdx, colIdx, sheet), lastCell: lastCell, isRefresh: true, isHeightCheckNeeded: true,\n                manualUpdate: true, first: '' });\n            this.parent.notify(renderFilterCell, { td: cell, rowIndex: rowIdx, colIndex: colIdx });\n        }\n    };\n    CellRenderer.prototype.updateView = function (args) {\n        if (isNullOrUndefined(args.sheetIndex) || (args.sheetIndex === this.parent.activeSheetIndex)) {\n            this.refreshRange(args.indexes, args.refreshing, args.checkWrap);\n        }\n        else if (args.refreshing) {\n            this.calculateFormula({ cell: getCell(args.indexes[0], args.indexes[1], getSheet(this.parent, args.sheetIndex), true), rowIdx: args.indexes[0],\n                colIdx: args.indexes[1], sheetIndex: args.sheetIndex });\n        }\n    };\n    return CellRenderer;\n}());\nexport { CellRenderer };\n","import { initialLoad, ribbon, formulaBar, beforeVirtualContentLoaded, setAriaOptions, skipHiddenIdx, refreshSheetTabs } from '../common/index';\nimport { SheetRender, RowRenderer, CellRenderer } from './index';\nimport { isNullOrUndefined, remove } from '@syncfusion/ej2-base';\nimport { getSheetName, getRowsHeight, getColumnsWidth, getData } from '../../workbook/base/index';\nimport { dataRefresh, getCellAddress, getCellIndexes, workbookFormulaOperation, moveOrDuplicateSheet } from '../../workbook/common/index';\nimport { sheetTabs, onContentScroll, deInitProperties, beforeDataBound, isReact } from '../common/index';\nimport { spreadsheetDestroyed, isFormulaBarEdit, editOperation, renderReactTemplates } from '../common/index';\nimport { getSiblingsHeight } from '../common/index';\n/**\n * Render module is used to render the spreadsheet\n *\n * @hidden\n */\nvar Render = /** @class */ (function () {\n    function Render(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Render.prototype.render = function (isRefreshing) {\n        this.parent.setProperties({ activeSheetIndex: this.parent.skipHiddenSheets(this.parent.activeSheetIndex) }, true);\n        if (!this.parent.isMobileView()) {\n            this.parent.notify(ribbon, null);\n            this.parent.notify(formulaBar, null);\n        }\n        var sheetPanel = this.parent.createElement('div', {\n            id: this.parent.element.id + '_sheet_panel', className: 'e-sheet-panel'\n        });\n        if (this.parent.enableRtl) {\n            sheetPanel.classList.add('e-rtl');\n        }\n        this.parent.element.appendChild(sheetPanel);\n        if (this.parent.showSheetTabs) {\n            this.parent.notify(sheetTabs, null);\n        }\n        else { // for formula calculation\n            var sheetName = getSheetName(this.parent, 0);\n            var arg = { action: 'addSheet', sheetName: 'Sheet1', index: 1, visibleName: sheetName };\n            this.parent.notify(workbookFormulaOperation, arg);\n            this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        }\n        if (this.parent.isMobileView()) {\n            this.parent.notify(formulaBar, null);\n            this.parent.notify(ribbon, null);\n        }\n        if (this.parent.password.length > 0 || this.parent.isProtected) {\n            this.parent.isProtected = true;\n            if (this.parent.showSheetTabs) {\n                this.parent.element.querySelector('.e-add-sheet-tab').setAttribute('disabled', 'true');\n                this.parent.element.querySelector('.e-add-sheet-tab').classList.add('e-disabled');\n            }\n        }\n        this.setSheetPanelSize();\n        this.renderSheet(sheetPanel);\n        this.checkTopLeftCell(true, isRefreshing);\n    };\n    Render.prototype.checkTopLeftCell = function (initLoad, isRefreshing) {\n        var sheet = this.parent.getActiveSheet();\n        this.parent.showSpinner();\n        var isTopLeftCell = sheet.topLeftCell === 'A1';\n        var indexes = getCellIndexes(sheet.topLeftCell);\n        var isFreezeScrolled;\n        if (sheet.topLeftCell !== sheet.paneTopLeftCell && (sheet.frozenRows || sheet.frozenColumns)) {\n            var paneIndexes = getCellIndexes(sheet.paneTopLeftCell);\n            isFreezeScrolled = this.parent.scrollSettings.enableVirtualization;\n            isTopLeftCell = sheet.frozenRows && sheet.frozenColumns ? indexes[0] + sheet.frozenRows === paneIndexes[0] &&\n                indexes[1] + sheet.frozenColumns === paneIndexes[1] : (sheet.frozenRows ? indexes[0] + sheet.frozenRows === paneIndexes[0]\n                && indexes[1] === 0 : indexes[1] + sheet.frozenColumns === paneIndexes[1] && indexes[0] === 0);\n            if (indexes[0] && paneIndexes[0] > indexes[0]) {\n                this.parent.viewport.beforeFreezeHeight = getRowsHeight(sheet, 0, indexes[0] - 1, true);\n            }\n            else {\n                this.parent.viewport.beforeFreezeHeight = 0;\n            }\n            if (indexes[1] && paneIndexes[1] > indexes[1]) {\n                this.parent.viewport.beforeFreezeWidth = getColumnsWidth(sheet, 0, indexes[1] - 1, true);\n            }\n            else {\n                this.parent.viewport.beforeFreezeWidth = 0;\n            }\n        }\n        else {\n            this.parent.viewport.beforeFreezeHeight = this.parent.viewport.beforeFreezeWidth = 0;\n        }\n        if (!this.parent.scrollSettings.enableVirtualization || isTopLeftCell) {\n            this.refreshUI({ rowIndex: indexes[0], colIndex: indexes[1], refresh: 'All' }, null, initLoad, isRefreshing);\n            if (isFreezeScrolled) {\n                this.parent.viewport.topIndex = skipHiddenIdx(sheet, 0, true);\n                this.parent.viewport.leftIndex = skipHiddenIdx(sheet, 0, true, 'columns');\n            }\n        }\n        else {\n            var pIndexes = sheet.paneTopLeftCell === sheet.topLeftCell ? indexes : getCellIndexes(sheet.paneTopLeftCell);\n            var frozenRow = this.parent.frozenRowCount(sheet);\n            var frozenCol = this.parent.frozenColCount(sheet);\n            var eventArgs = { preventScroll: true };\n            eventArgs.scrollTop = pIndexes[0] > frozenRow ? getRowsHeight(sheet, frozenRow ? frozenRow : 0, pIndexes[0] - 1) : 0;\n            eventArgs.scrollLeft = pIndexes[1] > frozenCol ? getColumnsWidth(sheet, frozenCol ? frozenCol : 0, pIndexes[1] - 1) : 0;\n            this.parent.notify(onContentScroll, eventArgs);\n            var threshold = this.parent.getThreshold('row');\n            var rowIndex = sheet.frozenRows ? indexes[0] : (indexes[0] > threshold ?\n                skipHiddenIdx(sheet, indexes[0] - threshold, true) : 0);\n            var frozenIndexes = [];\n            if (sheet.frozenRows) {\n                frozenIndexes.push(pIndexes[0] - threshold > frozenRow ? (pIndexes[0] - threshold) : frozenRow);\n            }\n            threshold = this.parent.getThreshold('col');\n            var colIndex = sheet.frozenColumns ? indexes[1] :\n                (indexes[1] > threshold ? skipHiddenIdx(sheet, indexes[1] - threshold, true, 'columns') : 0);\n            if (sheet.frozenColumns) {\n                if (!frozenIndexes.length) {\n                    frozenIndexes.push(frozenRow);\n                }\n                frozenIndexes.push(pIndexes[1] - threshold > frozenCol ? pIndexes[1] - threshold : frozenCol);\n            }\n            else if (frozenIndexes.length) {\n                frozenIndexes.push(frozenCol);\n            }\n            this.refreshUI({ rowIndex: rowIndex, colIndex: colIndex, refresh: 'All', top: eventArgs.scrollTop, left: eventArgs.scrollLeft,\n                frozenIndexes: frozenIndexes }, null, initLoad, isRefreshing);\n            if (isFreezeScrolled) {\n                if (frozenIndexes[0] >= frozenRow) {\n                    this.parent.viewport.topIndex = skipHiddenIdx(sheet, frozenIndexes[0] - frozenRow, true);\n                }\n                if (frozenIndexes[1] >= frozenCol) {\n                    this.parent.viewport.leftIndex = skipHiddenIdx(sheet, frozenIndexes[1] - frozenCol, true, 'columns');\n                }\n            }\n        }\n    };\n    Render.prototype.renderSheet = function (panel) {\n        if (panel === void 0) { panel = document.getElementById(this.parent.element.id + '_sheet_panel'); }\n        panel.appendChild(this.parent.createElement('div', { className: 'e-sheet', id: this.parent.element.id + '_sheet', styles: 'background-color: #fff' }));\n        this.parent.serviceLocator.getService('sheet').renderPanel();\n    };\n    /**\n     * @hidden\n     * @param {RefreshArgs} args - Specifies the RefreshArgs.\n     * @param {string} address - Specifies the address.\n     * @param {boolean} initLoad - Specifies the initLoad.\n     * @returns {void}\n     */\n    // tslint:disable-next-line:max-func-body-length\n    Render.prototype.refreshUI = function (args, address, initLoad, isRefreshing) {\n        var _this = this;\n        if (args.refresh !== 'All') {\n            this.parent.showSpinner();\n        }\n        var sheetModule = this.parent.serviceLocator.getService('sheet');\n        var sheet = this.parent.getActiveSheet();\n        var sheetName = getSheetName(this.parent);\n        var prevRowColCnt = { rowCount: sheet.rowCount, colCount: sheet.colCount };\n        args.frozenIndexes = args.frozenIndexes ? args.frozenIndexes : [];\n        if (!address) {\n            if (this.parent.scrollSettings.enableVirtualization) {\n                var lastRow = args.rowIndex + this.parent.viewport.rowCount + (this.parent.getThreshold('row') * 2);\n                var lastCol = args.colIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2);\n                var frozenRow = this.parent.frozenRowCount(sheet);\n                var frozenCol = this.parent.frozenColCount(sheet);\n                if (args.frozenIndexes.length) {\n                    lastRow += (args.frozenIndexes[0] - frozenRow);\n                    lastCol += (args.frozenIndexes[1] - frozenCol);\n                }\n                lastRow += sheet.frozenRows;\n                lastCol += sheet.frozenColumns;\n                var count = sheet.rowCount - 1;\n                var diff = 0;\n                if (this.parent.scrollSettings.isFinite && lastRow > count) {\n                    diff = lastRow - count;\n                    lastRow = count;\n                    if (diff && !isNullOrUndefined(this.parent.viewport.topIndex)) {\n                        diff = this.parent.viewport.topIndex - diff > -1 ? this.parent.viewport.topIndex - diff : 0;\n                        this.parent.viewport.topIndex = args.rowIndex = this.skipHiddenIdx(diff, true);\n                    }\n                }\n                count = sheet.colCount - 1;\n                diff = 0;\n                if (this.parent.scrollSettings.isFinite && lastCol > count) {\n                    diff = lastCol - count;\n                    lastCol = count;\n                    if (diff && !isNullOrUndefined(this.parent.viewport.leftIndex)) {\n                        diff = this.parent.viewport.leftIndex - diff > -1 ? this.parent.viewport.leftIndex - diff : 0;\n                        this.parent.viewport.leftIndex = args.colIndex = this.skipHiddenIdx(diff, true, 'columns');\n                    }\n                }\n                var indexes = this.parent.skipHidden(args.rowIndex, lastRow);\n                if (args.rowIndex !== indexes[0]) {\n                    var topLeftCell_1 = getCellIndexes(sheet.topLeftCell);\n                    if (topLeftCell_1[0] === args.rowIndex) {\n                        this.parent.updateTopLeftCell(indexes[0], topLeftCell_1[1], 'row');\n                    }\n                    args.rowIndex = indexes[0];\n                }\n                var startRow = args.rowIndex;\n                lastRow = indexes[1];\n                var topLeftCell = getCellIndexes(sheet.topLeftCell);\n                indexes = this.parent.skipHidden(args.colIndex, lastCol, 'columns');\n                if (args.colIndex !== indexes[0]) {\n                    if (topLeftCell[1] === args.colIndex) {\n                        this.parent.updateTopLeftCell(topLeftCell[0], indexes[0], 'col');\n                    }\n                    args.colIndex = indexes[0];\n                }\n                var startCol = args.colIndex;\n                lastCol = indexes[1];\n                if (args.refresh === 'Row') {\n                    startRow += frozenRow;\n                    if (frozenRow) {\n                        lastRow += topLeftCell[0];\n                    }\n                }\n                if (args.refresh === 'Column') {\n                    startCol += frozenCol;\n                    if (frozenCol) {\n                        lastCol += topLeftCell[1];\n                    }\n                }\n                this.parent.viewport.topIndex = args.rowIndex;\n                this.parent.viewport.bottomIndex = lastRow;\n                this.parent.viewport.leftIndex = args.colIndex;\n                this.parent.viewport.rightIndex = lastCol;\n                address = getCellAddress(startRow, startCol) + \":\" + getCellAddress(lastRow, lastCol);\n            }\n            else {\n                if (args.refresh === 'All') {\n                    var topLeftCell = getCellIndexes(sheet.topLeftCell);\n                    var paneTopLeftCell = getCellIndexes(sheet.paneTopLeftCell);\n                    if (sheet.frozenRows) {\n                        var frozenRow = this.parent.frozenRowCount(sheet);\n                        if (paneTopLeftCell[0] > frozenRow) {\n                            args.top = getRowsHeight(sheet, frozenRow, paneTopLeftCell[0] - 1);\n                        }\n                    }\n                    else {\n                        args.rowIndex = 0;\n                        if (topLeftCell[0] !== 0) {\n                            args.top = getRowsHeight(sheet, 0, topLeftCell[0] - 1);\n                        }\n                    }\n                    if (sheet.frozenColumns) {\n                        var frozenCol = this.parent.frozenRowCount(sheet);\n                        if (paneTopLeftCell[1] > frozenCol) {\n                            args.left = getColumnsWidth(sheet, frozenCol, paneTopLeftCell[1] - 1);\n                        }\n                    }\n                    else {\n                        args.colIndex = 0;\n                        if (topLeftCell[1] !== 0) {\n                            args.left = getColumnsWidth(sheet, 0, topLeftCell[1] - 1);\n                        }\n                    }\n                }\n                this.parent.viewport.bottomIndex = sheet.rowCount - 1;\n                this.parent.viewport.rightIndex = sheet.colCount - 1;\n                address = getCellAddress(args.rowIndex, args.colIndex) + \":\" + getCellAddress(this.parent.viewport.bottomIndex, this.parent.viewport.rightIndex);\n            }\n        }\n        if (args.refresh === 'All') {\n            this.parent.trigger(beforeDataBound, {});\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: true });\n        var sheetsLen = this.parent.sheets.length;\n        getData(this.parent, sheetName + \"!\" + address, null, null, args.frozenIndexes).then(function (values) {\n            if (sheetsLen < _this.parent.sheets.length) {\n                return;\n            }\n            var sheetIdx = _this.parent.sheets.indexOf(sheet);\n            if (sheetIdx === -1 || sheetIdx !== _this.parent.activeSheetIndex) {\n                if (sheetIdx > -1) {\n                    _this.checkTopLeftCell();\n                }\n                return;\n            }\n            var indexes = [args.rowIndex, args.colIndex].concat(getCellIndexes(address.split(':')[1]));\n            var isEdit;\n            var arg;\n            switch (args.refresh) {\n                case 'All':\n                    sheetModule.renderTable({ cells: values, indexes: indexes, top: args.top, left: args.left, initLoad: initLoad, isRefreshing: isRefreshing });\n                    break;\n                case 'Row':\n                    sheetModule.refreshRowContent({ cells: values, indexes: indexes, skipUpdateOnFirst: args.skipUpdateOnFirst, prevRowColCnt: prevRowColCnt });\n                    isEdit = false;\n                    arg = { isEdit: isEdit };\n                    _this.parent.notify(isFormulaBarEdit, arg);\n                    if (arg.isEdit) {\n                        _this.parent.notify(editOperation, { action: 'startEdit', refreshCurPos: false });\n                    }\n                    break;\n                case 'Column':\n                    sheetModule.refreshColumnContent({\n                        cells: values, indexes: indexes, skipUpdateOnFirst: args.skipUpdateOnFirst,\n                        prevRowColCnt: prevRowColCnt\n                    });\n                    break;\n                case 'RowPart':\n                    sheetModule.updateRowContent({\n                        cells: values, indexes: indexes, direction: args.direction, skipUpdateOnFirst: args.skipUpdateOnFirst,\n                        prevRowColCnt: prevRowColCnt\n                    });\n                    break;\n                case 'ColumnPart':\n                    sheetModule.updateColContent({\n                        cells: values, indexes: indexes, direction: args.direction, skipUpdateOnFirst: args.skipUpdateOnFirst,\n                        prevRowColCnt: prevRowColCnt\n                    });\n                    break;\n            }\n            if (_this.parent[isReact]) {\n                _this.parent[renderReactTemplates]();\n            }\n        });\n        this.parent.notify(beforeVirtualContentLoaded, { refresh: args.refresh, skipTranslate: args.skipTranslate });\n    };\n    Render.prototype.skipHiddenIdx = function (index, increase, layout, sheet) {\n        if (layout === void 0) { layout = 'rows'; }\n        if (sheet === void 0) { sheet = this.parent.getActiveSheet(); }\n        if ((sheet[layout])[index] && (sheet[layout])[index].hidden) {\n            index = increase ? ++index : --index;\n            index = this.skipHiddenIdx(index, increase, layout, sheet);\n        }\n        return index;\n    };\n    Render.prototype.removeSheet = function () {\n        remove(document.getElementById(this.parent.element.id + '_sheet'));\n    };\n    /**\n     * Refresh the active sheet.\n     *\n     * @returns {void}\n     */\n    Render.prototype.refreshSheet = function (isOpen) {\n        this.removeSheet();\n        this.renderSheet();\n        this.parent.notify(deInitProperties, {});\n        this.checkTopLeftCell(false, isOpen);\n    };\n    /**\n     * Used to set sheet panel size.\n     *\n     * @returns {void}\n     */\n    Render.prototype.setSheetPanelSize = function () {\n        var panel = document.getElementById(this.parent.element.id + '_sheet_panel');\n        var offset = this.parent.element.getBoundingClientRect();\n        var height;\n        if (this.parent.height === 'auto') {\n            panel.style.height = '260px';\n            height = 230;\n        }\n        else {\n            height = offset.height - getSiblingsHeight(panel);\n            panel.style.height = height + \"px\";\n            height -= 32;\n        }\n        this.parent.viewport.height = height;\n        this.parent.viewport.width = offset.width - 32;\n        this.parent.viewport.rowCount = this.roundValue(height, 20);\n        this.parent.viewport.colCount = this.roundValue(offset.width, 64);\n    };\n    Render.prototype.roundValue = function (size, threshold) {\n        var value = size / threshold;\n        var roundedValue = Math.round(value);\n        return Math.abs(value - roundedValue) < 0.5 ? roundedValue : roundedValue - 1;\n    };\n    Render.prototype.moveOrDuplicateSheetHandler = function (args) {\n        this.parent.notify(refreshSheetTabs, null);\n        if (args.refresh) {\n            this.refreshSheet(args.isDuplicate);\n        }\n    };\n    /**\n     * Registing the renderer related services.\n     *\n     * @returns {void}\n     */\n    Render.prototype.instantiateRenderer = function () {\n        this.parent.serviceLocator.register('cell', new CellRenderer(this.parent));\n        this.parent.serviceLocator.register('row', new RowRenderer(this.parent));\n        this.parent.serviceLocator.register('sheet', new SheetRender(this.parent));\n    };\n    /**\n     * Destroy the Render module.\n     *\n     * @returns {void}\n     */\n    Render.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Render.prototype.addEventListener = function () {\n        this.parent.on(initialLoad, this.instantiateRenderer, this);\n        this.parent.on(dataRefresh, this.refreshSheet, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n        this.parent.on(moveOrDuplicateSheet, this.moveOrDuplicateSheetHandler, this);\n    };\n    Render.prototype.removeEventListener = function () {\n        this.parent.off(initialLoad, this.instantiateRenderer);\n        this.parent.off(dataRefresh, this.refreshSheet);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n        this.parent.off(moveOrDuplicateSheet, this.moveOrDuplicateSheetHandler);\n    };\n    return Render;\n}());\nexport { Render };\n","import { Dialog as DialogComponent } from '@syncfusion/ej2-popups';\nimport { extend, remove, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { locale } from '../common/index';\n/**\n * Dialog Service.\n *\n * @hidden\n */\nvar Dialog = /** @class */ (function () {\n    /**\n     * Constructor for initializing dialog service.\n     *\n     * @param {Spreadsheet} parent - Specifies the Spreadsheet instance.\n     */\n    function Dialog(parent) {\n        this.parent = parent;\n    }\n    /**\n     * To show dialog.\n     *\n     * @param {DialogModel} dialogModel - Specifies the Dialog model.\n     * @param {boolean} cancelBtn - Specifies the cancel button.\n     * @returns {void}\n     */\n    Dialog.prototype.show = function (dialogModel, cancelBtn) {\n        var _this = this;\n        var btnContent;\n        cancelBtn = isNullOrUndefined(cancelBtn) ? true : false;\n        var closeHandler = dialogModel.close || null;\n        var model = {\n            header: 'Spreadsheet',\n            cssClass: this.parent.cssClass,\n            target: this.parent.element,\n            buttons: []\n        };\n        dialogModel.close = function () {\n            _this.destroyDialog();\n            if (closeHandler) {\n                closeHandler();\n            }\n        };\n        extend(model, dialogModel);\n        if (cancelBtn) {\n            btnContent = this.parent.serviceLocator.getService(locale).getConstant(model.buttons.length ? 'Cancel' : 'Ok');\n            model.buttons.push({\n                buttonModel: { content: btnContent, isPrimary: model.buttons.length === 0 },\n                click: this.hide.bind(this)\n            });\n        }\n        var div = this.parent.createElement('div');\n        document.body.appendChild(div);\n        this.dialogInstance = new DialogComponent(model);\n        this.dialogInstance.createElement = this.parent.createElement;\n        this.dialogInstance.appendTo(div);\n        this.dialogInstance.refreshPosition();\n    };\n    /**\n     * To destroy the dialog if it open is prevented by user.\n     *\n     * @returns {void}\n     */\n    Dialog.prototype.destroyDialog = function () {\n        this.dialogInstance.destroy();\n        remove(this.dialogInstance.element);\n        this.dialogInstance = null;\n    };\n    /**\n     * To hide dialog.\n     *\n     * @returns {void}\n     */\n    Dialog.prototype.hide = function () {\n        if (this.dialogInstance) {\n            this.dialogInstance.hide();\n        }\n    };\n    /**\n     * To clear private variables.\n     *\n     * @returns {void}\n     */\n    Dialog.prototype.destroy = function () {\n        this.parent = null;\n    };\n    return Dialog;\n}());\nexport { Dialog };\n","import { triggerDataChange } from '../../workbook/index';\nimport { completeAction, beginAction } from '../common/index';\nimport { setActionData, updateUndoRedoCollection } from '../common/index';\n/**\n *  Begin and complete events.\n *\n * @hidden\n */\nvar ActionEvents = /** @class */ (function () {\n    /**\n     * Constructor for initializing action begin and action complete services.\n     *\n     * @param {Spreadsheet} parent - Specifies the spreadsheet element.\n     */\n    function ActionEvents(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //this.initializeActionBegin();\n        //this.initializeActionComplete();\n    }\n    ActionEvents.prototype.initializeActionBegin = function () {\n        var _this = this;\n        var cellFormat = this.parent.beforeCellFormat;\n        this.parent.beforeCellFormat = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: cellFormat, actionType: 'begin', eventType: 'format' });\n        };\n        var beforeOpen = this.parent.beforeOpen;\n        this.parent.beforeOpen = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeOpen, actionType: 'begin', eventType: 'beforeOpen' });\n        };\n        var beforeSave = this.parent.beforeSave;\n        this.parent.beforeSave = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeSave, actionType: 'begin', eventType: 'beforeSave' });\n        };\n        var beforeSort = this.parent.beforeSort;\n        this.parent.beforeSort = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeSort, actionType: 'begin', eventType: 'beforeSort' });\n        };\n    };\n    ActionEvents.prototype.initializeActionComplete = function () {\n        var _this = this;\n        var sortComplete = this.parent.sortComplete;\n        this.parent.sortComplete = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: sortComplete, actionType: 'complete', eventType: 'sorting' });\n        };\n        var cellSave = this.parent.cellSave;\n        this.parent.cellSave = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: cellSave, actionType: 'complete', eventType: 'cellSave' });\n        };\n    };\n    ActionEvents.prototype.actionEventHandler = function (args) {\n        if (args.evtFunc) {\n            args.evtFunc.apply(this, [args]);\n        }\n        if (args.actionType === 'begin') {\n            this.actionBeginHandler({ eventArgs: args.evtArgs, action: args.eventType });\n        }\n        else {\n            this.actionCompleteHandler({ eventArgs: args.evtArgs, action: args.eventType });\n        }\n    };\n    ActionEvents.prototype.actionBeginHandler = function (args) {\n        this.parent.trigger('actionBegin', { action: args.action, args: args });\n        if (args.action === 'clipboard' || args.action === 'beforeSort' || args.action === 'format' || args.action === 'cellSave'\n            || args.action === 'beforeWrap' || args.action === 'beforeReplace'\n            || args.action === 'beforeClear' || args.action === 'beforeInsertImage' || args.action === 'beforeInsertChart'\n            || args.action === 'filter' || args.action === 'cellDelete') {\n            this.parent.notify(setActionData, { args: args });\n        }\n    };\n    ActionEvents.prototype.actionCompleteHandler = function (args) {\n        this.parent.notify(triggerDataChange, args);\n        this.parent.trigger('actionComplete', args);\n        if (args.action !== 'undoRedo' && args.action !== 'gotoSheet') {\n            this.parent.notify(updateUndoRedoCollection, { args: args });\n        }\n    };\n    ActionEvents.prototype.addEventListener = function () {\n        this.parent.on(completeAction, this.actionCompleteHandler, this);\n        this.parent.on(beginAction, this.actionBeginHandler, this);\n    };\n    ActionEvents.prototype.removeEventListener = function () {\n        this.parent.off(completeAction, this.actionCompleteHandler);\n        this.parent.off(beginAction, this.actionBeginHandler);\n    };\n    return ActionEvents;\n}());\nexport { ActionEvents };\n","import { getCellPosition, refreshImgCellObj, refreshChartCellObj, insertDesignChart } from '../common/index';\nimport { getRowIdxFromClientY, getColIdxFromClientX, overlayEleSize } from '../common/index';\nimport { getRangeIndexes, refreshChartSize, focusChartBorder, getRowsHeight, getCellIndexes } from '../../workbook/index';\nimport { getColumnsWidth } from '../../workbook/index';\nimport { EventHandler, removeClass, closest, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Specifes to create or modify overlay.\n *\n * @hidden\n */\nvar Overlay = /** @class */ (function () {\n    /**\n     * Constructor for initializing Overlay service.\n     *\n     *  @param {Spreadsheet} parent - Specifies the Spreadsheet instance.\n     */\n    function Overlay(parent) {\n        this.minHeight = '300px';\n        this.minWidth = '400px';\n        this.isOverlayClicked = false;\n        this.isResizerClicked = false;\n        this.currentWidth = 400;\n        this.currenHeight = 300;\n        this.parent = parent;\n    }\n    /**\n     * To insert a shape.\n     *\n     * @param {string} id - Specifies the id.\n     * @param {string} range - Specifies the range.\n     * @param {number} sheetIndex - Specifies the sheet index.\n     * @returns {HTMLElement} - Returns div element\n     * @hidden\n     */\n    Overlay.prototype.insertOverlayElement = function (id, range, sheetIndex) {\n        var div = this.parent.createElement('div', {\n            id: id,\n            attrs: { 'class': 'e-ss-overlay' },\n            styles: 'width: ' + this.minWidth + ';  height: ' + this.minHeight\n        });\n        var indexes = getRangeIndexes(range);\n        var sheet = this.parent.sheets[sheetIndex];\n        var frozenRow = this.parent.frozenRowCount(sheet);\n        var frozenCol = this.parent.frozenColCount(sheet);\n        var pos = getCellPosition(sheet, indexes, frozenRow, frozenCol, this.parent.viewport.beforeFreezeHeight, this.parent.viewport.beforeFreezeWidth, this.parent.sheetModule.colGroupWidth);\n        if (indexes[0] >= frozenRow && indexes[1] < frozenCol) {\n            var mainPanel = this.parent.sheetModule.contentPanel;\n            if (mainPanel.scrollTop) {\n                pos.top -= mainPanel.scrollTop;\n                pos.top +=\n                    this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height;\n            }\n        }\n        if (indexes[1] >= frozenCol && indexes[0] < frozenRow) {\n            var scrollPanel = this.parent.getScrollElement();\n            if (scrollPanel.scrollLeft) {\n                pos.left -= scrollPanel.scrollLeft;\n                pos.left += this.parent.sheetModule.getRowHeaderWidth(sheet);\n            }\n        }\n        var parent;\n        if (indexes[0] < frozenRow || indexes[1] < frozenCol) {\n            parent = document.getElementById(this.parent.element.id + '_sheet');\n            if (frozenRow) {\n                if (indexes[0] >= frozenRow) {\n                    pos.top += (sheet.showHeaders ? 31 : 0) + getRowsHeight(sheet, getCellIndexes(sheet.topLeftCell)[0], frozenRow - 1);\n                }\n                else if (!frozenCol) {\n                    pos.left += this.parent.sheetModule.getRowHeaderWidth(sheet, true);\n                }\n            }\n            if (frozenCol) {\n                if (indexes[1] >= frozenCol) {\n                    pos.left += this.parent.sheetModule.getRowHeaderWidth(sheet);\n                }\n                else if (!frozenRow) {\n                    pos.left += (sheet.showHeaders ? 31 : 0);\n                }\n            }\n        }\n        else {\n            parent = this.parent.getMainContent();\n        }\n        div.style.top = pos.top + 'px';\n        div.style.left = pos.left + 'px';\n        parent.appendChild(div);\n        this.renderResizeHandles(div);\n        this.addEventListener(div);\n        this.originalWidth = parseFloat(getComputedStyle(div, null).getPropertyValue('width').replace('px', ''));\n        this.originalHeight = parseFloat(getComputedStyle(div, null).getPropertyValue('height').replace('px', ''));\n        return div;\n    };\n    /**\n     * To adjust the layout inside freeze pane.\n     * @hidden\n     */\n    Overlay.prototype.adjustFreezePaneSize = function (model, element, range) {\n        var indexes = getRangeIndexes(range);\n        var sheet = this.parent.getActiveSheet();\n        var frozenRow = this.parent.frozenRowCount(sheet);\n        var frozenCol = this.parent.frozenColCount(sheet);\n        if (indexes[0] < frozenRow || indexes[1] < frozenCol) {\n            if (!isNullOrUndefined(model.top)) {\n                element.style.top = model.top + (sheet.showHeaders ? 31 : 0) - this.parent.viewport.beforeFreezeHeight + 'px';\n            }\n            if (!isNullOrUndefined(model.left)) {\n                element.style.left = model.left + this.parent.sheetModule.getRowHeaderWidth(sheet, true) -\n                    this.parent.viewport.beforeFreezeWidth + 'px';\n            }\n        }\n        else {\n            if (!isNullOrUndefined(model.top)) {\n                element.style.top = model.top - this.parent.viewport.beforeFreezeHeight - (frozenRow ? getRowsHeight(sheet, getCellIndexes(sheet.topLeftCell)[0], frozenRow - 1) : 0) + 'px';\n            }\n            if (!isNullOrUndefined(model.left)) {\n                element.style.left = model.left - this.parent.viewport.beforeFreezeWidth - (frozenCol ? getColumnsWidth(sheet, getCellIndexes(sheet.topLeftCell)[1], frozenCol - 1) : 0) + 'px';\n            }\n        }\n        if (isNullOrUndefined(model.top)) {\n            var startTop = getCellIndexes(sheet.topLeftCell)[0];\n            model.top = this.parent.viewport.beforeFreezeHeight + (frozenRow && startTop === indexes[0] ? 0 : getRowsHeight(sheet, frozenRow ? startTop : 0, indexes[0] - 1));\n        }\n        if (isNullOrUndefined(model.left)) {\n            var startLeft = getCellIndexes(sheet.topLeftCell)[1];\n            model.left = this.parent.viewport.beforeFreezeWidth + (frozenCol && startLeft === indexes[1] ? 0 : getColumnsWidth(sheet, frozenCol ? startLeft : 0, indexes[1] - 1));\n        }\n    };\n    Overlay.prototype.addEventListener = function (div) {\n        var overlayElem = div;\n        EventHandler.add(overlayElem, 'mousedown', this.overlayClickHandler, this);\n        EventHandler.add(overlayElem, 'mousemove', this.overlayMouseMoveHandler, this);\n        EventHandler.add(document.getElementById(this.parent.element.id + '_sheet'), 'mousemove', this.overlayMouseMoveHandler, this);\n        EventHandler.add(document, 'mouseup', this.overlayMouseUpHandler, this);\n        this.parent.on(overlayEleSize, this.setOriginalSize, this);\n    };\n    Overlay.prototype.setOriginalSize = function (args) {\n        this.originalHeight = args.height;\n        this.originalWidth = args.width;\n    };\n    Overlay.prototype.overlayMouseMoveHandler = function (e) {\n        var target = e.target;\n        var overlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        var sheet = this.parent.getActiveSheet();\n        var checkOffset = sheet.frozenRows || sheet.frozenColumns ? [29, this.parent.sheetModule.getRowHeaderWidth(sheet, true)] : [-1, -1];\n        var height1;\n        var top;\n        var width1;\n        var height2;\n        var width2;\n        var left;\n        if (this.isOverlayClicked && this.isResizerClicked) {\n            switch (this.resizer) {\n                case 'e-ss-overlay-t':\n                    height1 = Math.max(this.originalMouseY - e.clientY + this.originalHeight, 20);\n                    top = e.clientY - (this.originalMouseY - this.originalResizeTop);\n                    if (height1 > 180 && top > checkOffset[0]) {\n                        overlayElem.style.height = height1 + 'px';\n                        overlayElem.style.top = top + 'px';\n                        this.resizedReorderTop = top; // resized divTop\n                        this.currenHeight = height1;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-r':\n                    width1 = this.originalWidth + (e.pageX - this.originalMouseX);\n                    if (width1 > 180) {\n                        overlayElem.style.width = width1 + 'px';\n                        this.currentWidth = width1;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-b':\n                    height2 = this.originalHeight + (e.pageY - this.originalMouseY);\n                    if (height2 > 180) {\n                        overlayElem.style.height = height2 + 'px';\n                        this.currenHeight = height2;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-l':\n                    width2 = Math.max(this.originalMouseX - e.clientX + this.originalWidth, 20);\n                    left = e.clientX - (this.originalMouseX - this.originalResizeLeft);\n                    if (width2 > 180 && left > checkOffset[1]) {\n                        overlayElem.style.width = width2 + 'px';\n                        overlayElem.style.left = left + 'px';\n                        this.resizedReorderLeft = left; //resized divLeft\n                        this.currentWidth = width2;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n            }\n        }\n        else if (this.isOverlayClicked) {\n            if ((closest(target, '.e-sheet') && !target.classList.contains('e-sheet-content')) ||\n                target.classList.contains('e-cell')) {\n                if (!overlayElem) {\n                    return;\n                }\n                var aX = e.clientX - this.diffX;\n                var aY = e.clientY - this.diffY;\n                if (aX > checkOffset[1]) {\n                    overlayElem.style.left = aX + 'px';\n                }\n                if (aY > checkOffset[0]) {\n                    overlayElem.style.top = aY + 'px';\n                }\n                this.resizedReorderLeft = aX < 0 ? 0 : aX; //resized divLeft\n                this.resizedReorderTop = aY < 0 ? 0 : aY; // resized divTop\n            }\n            else {\n                this.overlayMouseUpHandler(e, true);\n            }\n        }\n    };\n    Overlay.prototype.overlayMouseUpHandler = function (e, isMouseUp) {\n        if (this.parent.getActiveSheet().isProtected) {\n            return;\n        }\n        this.isResizerClicked = false;\n        var elem = e.target;\n        var overlayElems = document.getElementsByClassName('e-datavisualization-chart e-ss-overlay-active');\n        if (!elem.classList.contains('e-ss-overlay')) {\n            elem = closest(e.target, '.e-datavisualization-chart') ?\n                closest(e.target, '.e-datavisualization-chart') : elem;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var eventArgs = {\n            prevTop: sheet.frozenRows || sheet.frozenColumns ? this.prevY : this.originalReorderTop,\n            prevLeft: sheet.frozenRows || sheet.frozenColumns ? this.prevX : this.originalReorderLeft,\n            currentTop: this.resizedReorderTop >= 0 ? this.resizedReorderTop : this.originalReorderTop,\n            currentLeft: this.resizedReorderLeft >= 0 ? this.resizedReorderLeft : this.originalReorderLeft,\n            id: elem.id, currentHeight: this.currenHeight, currentWidth: this.currentWidth,\n            requestType: 'imageRefresh', prevHeight: this.originalHeight, prevWidth: this.originalWidth\n        };\n        if (this.isOverlayClicked || isMouseUp) {\n            var currRowIdx = void 0;\n            var currColIdx = void 0;\n            var prevRowIdx = { clientY: eventArgs.prevTop, isImage: true };\n            var prevColIdx = { clientX: eventArgs.prevLeft, isImage: true };\n            var overlayEle = this.parent.element.getElementsByClassName('e-ss-overlay-active')[0];\n            if (sheet.frozenRows || sheet.frozenColumns) {\n                if (!overlayEle) {\n                    return;\n                }\n                prevRowIdx.isImage = false;\n                prevColIdx.isImage = false;\n                prevRowIdx.target = overlayEle;\n                prevColIdx.target = overlayEle;\n                if (eventArgs.prevTop < this.parent.getColumnHeaderContent().getBoundingClientRect().bottom) {\n                    prevRowIdx.target = this.parent.getColumnHeaderContent();\n                }\n                if (eventArgs.prevLeft < this.parent.getRowHeaderContent().getBoundingClientRect().right) {\n                    prevColIdx.target = this.parent.getRowHeaderTable();\n                }\n                var clientRect = overlayEle.getBoundingClientRect();\n                currRowIdx = { clientY: clientRect.top };\n                currColIdx = { clientX: clientRect.left };\n                if (clientRect.top < this.parent.getColumnHeaderContent().getBoundingClientRect().bottom) {\n                    currRowIdx.target = this.parent.getColumnHeaderContent();\n                }\n                if (clientRect.left < this.parent.getRowHeaderContent().getBoundingClientRect().right) {\n                    currColIdx.target = this.parent.getRowHeaderTable();\n                }\n            }\n            else {\n                currRowIdx = { clientY: eventArgs.currentTop, isImage: true };\n                currColIdx = { clientX: eventArgs.currentLeft, isImage: true };\n            }\n            this.parent.notify(getRowIdxFromClientY, prevRowIdx);\n            this.parent.notify(getRowIdxFromClientY, currRowIdx);\n            this.parent.notify(getColIdxFromClientX, prevColIdx);\n            this.parent.notify(getColIdxFromClientX, currColIdx);\n            if (currRowIdx.size) {\n                eventArgs.currentTop = currRowIdx.size;\n            }\n            if (currColIdx.size) {\n                eventArgs.currentLeft = currColIdx.size;\n            }\n            eventArgs.prevRowIdx = prevRowIdx.clientY;\n            eventArgs.prevColIdx = prevColIdx.clientX;\n            eventArgs.currentRowIdx = currRowIdx.clientY;\n            eventArgs.currentColIdx = currColIdx.clientX;\n            if ((sheet.frozenColumns || sheet.frozenRows) && !closest(overlayEle, '.e-sheet-content')) {\n                var frozenCol = this.parent.frozenColCount(sheet);\n                var frozenRow = this.parent.frozenRowCount(sheet);\n                if (eventArgs.currentRowIdx >= frozenRow && eventArgs.currentColIdx >= frozenCol) {\n                    var top_1 = parseInt(overlayEle.style.top, 10);\n                    var left = parseInt(overlayEle.style.left, 10);\n                    var mainPanel = this.parent.sheetModule.contentPanel;\n                    top_1 += mainPanel.scrollTop;\n                    top_1 -= this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height;\n                    var scrollPanel = this.parent.getScrollElement();\n                    left += scrollPanel.scrollLeft;\n                    left -= this.parent.sheetModule.getRowHeaderWidth(sheet);\n                    overlayEle.style.top = top_1 + 'px';\n                    overlayEle.style.left = left + 'px';\n                    this.parent.getMainContent().appendChild(overlayEle);\n                }\n            }\n            if (overlayElems && overlayElems[0]) {\n                if (overlayElems[0].querySelector('.e-control')) {\n                    eventArgs.id = overlayElems[0].id;\n                }\n            }\n            if (this.originalReorderTop !== this.resizedReorderTop || this.originalReorderLeft !== this.resizedReorderLeft) {\n                eventArgs.id = overlayEle.id;\n                if (overlayElems && overlayElems[0]) {\n                    eventArgs.requestType = 'chartRefresh';\n                    this.parent.notify(refreshChartCellObj, eventArgs);\n                }\n                else {\n                    this.parent.notify(refreshImgCellObj, eventArgs);\n                }\n                this.resizedReorderTop = this.originalReorderTop;\n                this.resizedReorderLeft = this.originalReorderLeft;\n            }\n            else if (this.currenHeight !== this.originalHeight || this.originalWidth !== this.currentWidth) {\n                eventArgs.id = elem.id.indexOf('overlay') > 0 ? elem.id : elem.parentElement ? elem.parentElement.id : '';\n                if (overlayElems && overlayElems[0]) {\n                    eventArgs.requestType = 'chartRefresh';\n                    this.parent.notify(refreshChartCellObj, eventArgs);\n                }\n                else {\n                    this.parent.notify(refreshImgCellObj, eventArgs);\n                }\n                this.originalHeight = this.currenHeight;\n                this.originalWidth = this.currentWidth;\n            }\n        }\n        this.isOverlayClicked = false;\n    };\n    Overlay.prototype.overlayClickHandler = function (e) {\n        if (this.parent.getActiveSheet().isProtected) {\n            return;\n        }\n        this.isOverlayClicked = true;\n        var target = e.target;\n        var overlayElem = e.target;\n        if (!target.classList.contains('e-ss-overlay')) {\n            overlayElem = target.parentElement;\n            if (closest(e.target, '.e-datavisualization-chart')) {\n                overlayElem = closest(e.target, '.e-datavisualization-chart');\n                this.currentWidth = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('width').replace('px', ''));\n                this.currenHeight = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('height').replace('px', ''));\n            }\n        }\n        var sheet = this.parent.getActiveSheet();\n        if ((sheet.frozenColumns || sheet.frozenRows) && closest(overlayElem, '.e-sheet-content')) {\n            var top_2 = parseInt(overlayElem.style.top, 10);\n            var left = parseInt(overlayElem.style.left, 10);\n            var mainPanel = this.parent.sheetModule.contentPanel;\n            top_2 -= mainPanel.scrollTop;\n            top_2 += this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height;\n            var scrollPanel = this.parent.getScrollElement();\n            left -= scrollPanel.scrollLeft;\n            left += this.parent.sheetModule.getRowHeaderWidth(sheet);\n            overlayElem.style.top = top_2 + 'px';\n            overlayElem.style.left = left + 'px';\n            document.getElementById(this.parent.element.id + '_sheet').appendChild(overlayElem);\n        }\n        this.originalReorderLeft = parseInt(overlayElem.style.left, 10); //divLeft\n        this.originalReorderTop = parseInt(overlayElem.style.top, 10); // divTop\n        this.resizedReorderLeft = parseInt(overlayElem.style.left, 10); //resized divLeft\n        this.resizedReorderTop = parseInt(overlayElem.style.top, 10); // resized divTop\n        this.originalResizeTop = this.originalReorderTop;\n        this.originalResizeLeft = this.originalReorderLeft;\n        this.originalMouseX = e.clientX; // posX\n        this.originalMouseY = e.clientY; // posY\n        this.diffX = this.originalMouseX - this.originalReorderLeft;\n        this.diffY = this.originalMouseY - this.originalReorderTop;\n        var actOverlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        if (actOverlayElem) {\n            removeClass([actOverlayElem], 'e-ss-overlay-active');\n        }\n        document.getElementById(overlayElem.id).classList.add('e-ss-overlay-active');\n        if (target.classList.contains('e-ss-resizer')) {\n            this.resizer = target.classList[0];\n            this.originalWidth = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('width').replace('px', ''));\n            this.originalHeight = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('height').replace('px', ''));\n            this.isResizerClicked = true;\n        }\n        if (overlayElem.classList.contains('e-datavisualization-chart')) {\n            this.parent.notify(focusChartBorder, { id: overlayElem.id });\n            if (!actOverlayElem) {\n                this.parent.notify(insertDesignChart, { id: overlayElem.id });\n            }\n        }\n        var clientRect = overlayElem.getBoundingClientRect();\n        this.prevX = clientRect.left;\n        this.prevY = clientRect.top;\n    };\n    Overlay.prototype.renderResizeHandles = function (div) {\n        var handles = ['e-ss-overlay-t', 'e-ss-overlay-r', 'e-ss-overlay-b', 'e-ss-overlay-l'];\n        var i = 0;\n        var handleElem;\n        var overlay = div;\n        while (handles.length > i) {\n            handleElem = this.parent.createElement('div', {\n                attrs: { 'class': handles[i] + ' ' + 'e-ss-resizer' },\n                styles: 'width: 8px; height: 8px; border-radius: 4px;'\n            });\n            overlay.appendChild(handleElem);\n            i++;\n        }\n    };\n    Overlay.prototype.removeEventListener = function () {\n        var overlayElem = document.getElementById(this.parent.element.id + '_overlay');\n        if (overlayElem) { // Added this condition temporarly to handle chart destroy from spec file.\n            EventHandler.remove(overlayElem, 'mousedown', this.overlayClickHandler);\n            EventHandler.remove(overlayElem, 'mousemove', this.overlayMouseMoveHandler);\n        }\n        EventHandler.remove(document.getElementById(this.parent.element.id + '_sheet'), 'mousemove', this.overlayMouseMoveHandler);\n        EventHandler.remove(document, 'mouseup', this.overlayMouseUpHandler);\n        this.parent.off(overlayEleSize, this.setOriginalSize);\n    };\n    /**\n     * To clear private variables.\n     *\n     * @returns {void}\n     */\n    Overlay.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return Overlay;\n}());\nexport { Overlay };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n// eslint-disable-next-line @typescript-eslint/triple-slash-reference\n/// <reference path='../../workbook/base/workbook-model.d.ts'/>\nimport { Property, NotifyPropertyChanges, Event, isUndefined } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, Complex, formatUnit, L10n, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { detach, select, closest, setStyleAttribute, EventHandler } from '@syncfusion/ej2-base';\nimport { initialLoad, mouseDown, spreadsheetDestroyed, keyUp, clearViewer, blankWorkbook, refreshSheetTabs } from '../common/index';\nimport { hideShow, performUndoRedo, overlay, createImageElement, deleteImage } from '../common/index';\nimport { sheetNameUpdate, updateUndoRedoCollection, getUpdateUsingRaf, setAutoFit, created } from '../common/index';\nimport { actionEvents, keyDown, enableFileMenuItems, hideToolbarItems, updateAction } from '../common/index';\nimport { colWidthChanged, rowHeightChanged, hideRibbonTabs, addFileMenuItems, getSiblingsHeight } from '../common/index';\nimport { defaultLocale, locale, setAriaOptions, setResize, initiateFilterUI, clearFilter, clearTemplate, isReact } from '../common/index';\nimport { ribbon, formulaBar, sheetTabs, formulaOperation, addRibbonTabs } from '../common/index';\nimport { addContextMenuItems, removeContextMenuItems, enableContextMenuItems, selectRange, addToolbarItems } from '../common/index';\nimport { cut, copy, paste, dialog, editOperation, activeSheetChanged, refreshFormulaDatasource } from '../common/index';\nimport { Render } from '../renderer/render';\nimport { Scroll, VirtualScroll, Edit, CellFormat, Selection, KeyboardNavigation, KeyboardShortcut, WrapText } from '../actions/index';\nimport { Clipboard, ShowHide, UndoRedo, SpreadsheetHyperlink, Resize, Insert, Delete, FindAndReplace, Merge } from '../actions/index';\nimport { ProtectSheet } from '../actions/index';\nimport { click, hideFileMenuItems } from '../common/index';\nimport { Dialog, ActionEvents, Overlay } from '../services/index';\nimport { ServiceLocator } from '../../workbook/services/index';\nimport { getColumnsWidth, getSheetIndex, WorkbookHyperlink } from './../../workbook/index';\nimport { getCellAddress } from './../../workbook/common/index';\nimport { activeCellChanged, afterHyperlinkCreate, getColIndex } from './../../workbook/index';\nimport { WorkbookInsert, WorkbookDelete, WorkbookMerge } from './../../workbook/index';\nimport { getSheetNameFromAddress, DataBind, beforeHyperlinkCreate } from './../../workbook/index';\nimport { sortComplete, dataSourceChanged } from './../../workbook/index';\nimport { getSheetIndexFromId, WorkbookEdit, WorkbookOpen, WorkbookSave, WorkbookCellFormat, WorkbookSort } from './../../workbook/index';\nimport { findKeyUp, refreshRibbonIcons } from './../../workbook/index';\nimport { Workbook } from '../../workbook/base/workbook';\nimport { getRequiredModules, ScrollSettings, enableToolbarItems } from '../common/index';\nimport { SelectionSettings, getStartEvent, enableRibbonTabs, getDPRValue } from '../common/index';\nimport { createSpinner, showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nimport { setRowHeight, getRowsHeight, getColumnWidth, getRowHeight, setColumn, setRow } from './../../workbook/base/index';\nimport { getRangeIndexes, getIndexesFromAddress, getCellIndexes, WorkbookNumberFormat, WorkbookFormula } from '../../workbook/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, ContextMenu, Save, NumberFormat, Formula } from '../integrations/index';\nimport { Sort, Filter, SpreadsheetImage, SpreadsheetChart } from '../integrations/index';\nimport { isNumber, getColumn, WorkbookFilter } from '../../workbook/index';\nimport { DataValidation } from '../actions/index';\nimport { WorkbookDataValidation, WorkbookConditionalFormat, WorkbookFindAndReplace } from '../../workbook/actions/index';\nimport { findAllValues } from './../../workbook/common/index';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\nimport { WorkbookImage, WorkbookChart } from '../../workbook/integrations/index';\nimport { WorkbookProtectSheet } from '../../workbook/actions/index';\nimport { beginAction, contentLoaded, completeAction, freeze, getScrollBarWidth } from '../common/index';\nimport { getFilteredCollection, deleteHyperlink } from './../../workbook/common/index';\nimport { updateScroll } from '../common/index';\n/**\n * Represents the Spreadsheet component.\n *\n * ```html\n * <div id='spreadsheet'></div>\n * <script>\n *  var spreadsheetObj = new Spreadsheet();\n *  spreadsheetObj.appendTo('#spreadsheet');\n * </script>\n * ```\n */\nvar Spreadsheet = /** @class */ (function (_super) {\n    __extends(Spreadsheet, _super);\n    /**\n     * Constructor for creating the widget.\n     *\n     * @param  {SpreadsheetModel} options - Configures Spreadsheet options.\n     * @param  {string|HTMLElement} element - Element to render Spreadsheet.\n     */\n    function Spreadsheet(options, element) {\n        var _this = _super.call(this, options) || this;\n        /** @hidden */\n        _this.viewport = {\n            rowCount: 0, colCount: 0, height: 0, topIndex: 0, leftIndex: 0, width: 0,\n            bottomIndex: 0, rightIndex: 0, beforeFreezeHeight: 0, beforeFreezeWidth: 0\n        };\n        _this.needsID = true;\n        Spreadsheet_1.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, ContextMenu, Save, NumberFormat, CellFormat, Formula, WrapText, WorkbookEdit, WorkbookOpen, WorkbookSave, WorkbookCellFormat, WorkbookNumberFormat, WorkbookFormula, Sort, WorkbookSort, Resize, UndoRedo, WorkbookFilter, Filter, SpreadsheetHyperlink, WorkbookHyperlink, Insert, Delete, WorkbookInsert, WorkbookDelete, DataValidation, WorkbookDataValidation, ProtectSheet, WorkbookProtectSheet, FindAndReplace, WorkbookFindAndReplace, Merge, WorkbookMerge, SpreadsheetImage, ConditionalFormatting, WorkbookImage, WorkbookConditionalFormat, SpreadsheetChart, WorkbookChart);\n        if (element) {\n            _this.appendTo(element);\n        }\n        return _this;\n    }\n    Spreadsheet_1 = Spreadsheet;\n    /**\n     * To get cell element.\n     *\n     * @param {number} rowIndex - specify the rowIndex.\n     * @param {number} colIndex - specify the colIndex.\n     * @param {HTMLTableElement} row - specify the row.\n     * @returns {HTMLElement} - Get cell element\n     * @hidden\n     */\n    Spreadsheet.prototype.getCell = function (rowIndex, colIndex, row) {\n        if (!row) {\n            row = this.getRow(rowIndex, null, colIndex);\n        }\n        colIndex = this.getViewportIndex(colIndex, true);\n        return row ? row.cells[colIndex] : row;\n    };\n    /**\n     * Get cell element.\n     *\n     * @param {number} index - specify the index.\n     * @param {HTMLTableElement} table - specify the table.\n     * @param {number} colIdx - specify the column index.\n     * @returns {HTMLTableRowElement} - Get cell element\n     * @hidden\n     */\n    Spreadsheet.prototype.getRow = function (index, table, colIdx) {\n        if (!table) {\n            var sheet = this.getActiveSheet();\n            var frozenRow = this.frozenRowCount(sheet);\n            var frozenCol = this.frozenColCount(sheet);\n            if (isNullOrUndefined(colIdx) || index > frozenRow - 1 && colIdx > frozenCol - 1) {\n                table = this.getContentTable();\n            }\n            else {\n                table = index < frozenRow && colIdx < frozenCol ? this.sheetModule.getSelectAllTable() : (index < frozenRow ?\n                    this.getColHeaderTable() : this.getRowHeaderTable());\n            }\n        }\n        index = this.getViewportIndex(index);\n        return table ? table.rows[index] : null;\n    };\n    /**\n     * To get hidden row/column count between two specified index.\n     *\n     * Set `layout` as `columns` if you want to get column hidden count.\n     *\n     * @param {number} startIndex - specify the startIndex.\n     * @param {number} endIndex - specify the endIndex.\n     * @param {string} layout - specify the layout.\n     * @returns {number} - To get hidden row/column count between two specified index.\n     * @hidden\n     */\n    Spreadsheet.prototype.hiddenCount = function (startIndex, endIndex, layout, sheet) {\n        if (layout === void 0) { layout = 'rows'; }\n        if (sheet === void 0) { sheet = this.getActiveSheet(); }\n        var count = 0;\n        for (var i = startIndex; i <= endIndex; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                count++;\n            }\n        }\n        return count;\n    };\n    /**\n     * To get row/column viewport index.\n     *\n     * @param {number} index - specify the index.\n     * @param {boolean} isCol - specify the bool value.\n     * @returns {number} - To get row/column viewport index.\n     * @hidden\n     */\n    Spreadsheet.prototype.getViewportIndex = function (index, isCol) {\n        var sheet = this.getActiveSheet();\n        if (isCol) {\n            var frozenCol = this.frozenColCount(sheet);\n            if (frozenCol) {\n                var leftIndex = getCellIndexes(sheet.topLeftCell)[1];\n                if (index < frozenCol) {\n                    index -= leftIndex;\n                    return index + 1;\n                }\n                else {\n                    index -= frozenCol;\n                }\n            }\n        }\n        else {\n            var frozenRow = this.frozenRowCount(sheet);\n            if (frozenRow) {\n                var topIndex = getCellIndexes(sheet.topLeftCell)[0];\n                if (index < frozenRow) {\n                    index -= topIndex;\n                    return index + 1;\n                }\n                else {\n                    index -= frozenRow;\n                }\n            }\n        }\n        if (this.scrollSettings.enableVirtualization) {\n            if (isCol) {\n                index -= this.hiddenCount(this.viewport.leftIndex, index, 'columns');\n                index -= this.viewport.leftIndex;\n            }\n            else {\n                index -= this.hiddenCount(this.viewport.topIndex, index);\n                index -= this.viewport.topIndex;\n            }\n        }\n        return index;\n    };\n    /**\n     * To initialize the services;\n     *\n     * @returns {void} - To initialize the services.\n     * @hidden\n     */\n    Spreadsheet.prototype.preRender = function () {\n        _super.prototype.preRender.call(this);\n        this.serviceLocator = new ServiceLocator;\n        this.initServices();\n    };\n    Spreadsheet.prototype.initServices = function () {\n        this.serviceLocator.register(locale, new L10n(this.getModuleName(), defaultLocale, this.locale));\n        this.serviceLocator.register(dialog, new Dialog(this));\n        this.serviceLocator.register(actionEvents, new ActionEvents(this));\n        this.serviceLocator.register(overlay, new Overlay(this));\n    };\n    /**\n     * To Initialize the component rendering.\n     *\n     * @returns {void} - To Initialize the component rendering.\n     * @hidden\n     */\n    Spreadsheet.prototype.render = function () {\n        _super.prototype.render.call(this);\n        this.element.setAttribute('tabindex', '0');\n        setAriaOptions(this.element, { role: 'grid' });\n        this.renderModule = new Render(this);\n        this.notify(initialLoad, null);\n        this.renderSpreadsheet();\n        this.wireEvents();\n        if (this.created) {\n            if (this[created].observers) {\n                if (this[created].observers.length > 0) {\n                    this.createdHandler = { observers: this[created].observers };\n                    this[created].observers = [];\n                }\n            }\n            else {\n                this.createdHandler = this.created;\n                this.setProperties({ created: undefined }, true);\n            }\n        }\n    };\n    Spreadsheet.prototype.renderSpreadsheet = function () {\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass.split(' '));\n        }\n        this.setHeight();\n        this.setWidth();\n        createSpinner({ target: this.element }, this.createElement);\n        if (this.isMobileView() && this.cssClass.indexOf('e-mobile-view') === -1) {\n            this.element.classList.add('e-mobile-view');\n        }\n        this.sheetModule = this.serviceLocator.getService('sheet');\n        if (this.allowScrolling) {\n            this.scrollModule = new Scroll(this);\n        }\n        if (this.scrollSettings.enableVirtualization) {\n            new VirtualScroll(this);\n        }\n        this.renderModule.render(this.refreshing);\n        new ShowHide(this);\n    };\n    /**\n     * By default, Spreadsheet shows the spinner for all its actions. To manually show spinner you this method at your needed time.\n     *\n     * {% codeBlock src='spreadsheet/showSpinner/index.md' %}{% endcodeBlock %}\n     *\n     * @returns {void} - shows spinner\n     */\n    Spreadsheet.prototype.showSpinner = function () {\n        showSpinner(this.element);\n    };\n    /**\n     * To hide showed spinner manually.\n     *\n     * {% codeBlock src='spreadsheet/hideSpinner/index.md' %}{% endcodeBlock %}\n     *\n     * @returns {void} - To hide showed spinner manually.\n     */\n    Spreadsheet.prototype.hideSpinner = function () {\n        hideSpinner(this.element);\n    };\n    /**\n     * To protect the particular sheet.\n     *\n     * {% codeBlock src='spreadsheet/protectSheet/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number | string} sheet - Specifies the sheet to protect.\n     * @param {ProtectSettingsModel} protectSettings - Specifies the protect sheet options.\n     * @default { selectCells: 'false', formatCells: 'false', formatRows: 'false', formatColumns:'false', insertLink:'false' }\n     * @returns {void} - To protect the particular sheet.\n     */\n    Spreadsheet.prototype.protectSheet = function (sheet, protectSettings) {\n        if (typeof (sheet) === 'string') {\n            sheet = getSheetIndex(this, sheet);\n        }\n        if (sheet) {\n            this.setSheetPropertyOnMute(this.sheets[sheet], 'isProtected', true);\n            this.setSheetPropertyOnMute(this.sheets[sheet], 'protectSettings', protectSettings);\n        }\n        sheet = this.getActiveSheet().index;\n        this.setSheetPropertyOnMute(this.getActiveSheet(), 'isProtected', true);\n        _super.prototype.protectSheet.call(this, sheet, protectSettings);\n    };\n    /**\n     * To unprotect the particular sheet.\n     *\n     * {% codeBlock src='spreadsheet/unprotectSheet/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number | string} sheet - Specifies the sheet name or index to Unprotect.\n     * @returns {void} - To unprotect the particular sheet.\n     */\n    Spreadsheet.prototype.unprotectSheet = function (sheet) {\n        if (typeof (sheet) === 'string') {\n            sheet = getSheetIndex(this, sheet);\n        }\n        if (sheet) {\n            this.sheets[sheet].isProtected = false;\n        }\n        else {\n            this.getActiveSheet().isProtected = false;\n        }\n        _super.prototype.unprotectSheet.call(this, sheet);\n    };\n    /**\n     * To find the specified cell value.\n     *\n     * {% codeBlock src='spreadsheet/find/index.md' %}{% endcodeBlock %}\n     *\n     * @param {FindOptions} args - Specifies the replace value with find args to replace specified cell value.\n     * @param {string} args.value - Specifies the value to be find.\n     * @param {string} args.mode - Specifies the value to be find within sheet or workbook.\n     * @param {string} args.searchBy - Specifies the value to be find by row or column.\n     * @param {boolean} args.isCSen - Specifies the find match with case sensitive or not.\n     * @param {boolean} args.isEMatch - Specifies the find match with entire match or not.\n     * @param {string} args.findOpt - Specifies the next or previous find match.\n     * @param {number} args.sheetIndex - Specifies the current sheet to find.\n     * @default { mode: 'Sheet', searchBy: 'By Row', isCSen: 'false', isEMatch:'false' }\n     * @returns {void} - To find the specified cell value.\n     */\n    Spreadsheet.prototype.find = function (args) {\n        var activeCell = this.getActiveSheet().activeCell;\n        _super.prototype.findHandler.call(this, args);\n        if (!args.isAction) {\n            if (activeCell !== this.getActiveSheet().activeCell) {\n                return this.getActiveSheet().name + '!' + this.getActiveSheet().activeCell;\n            }\n            else {\n                return null;\n            }\n        }\n    };\n    /**\n     * To replace the specified cell value.\n     *\n     * {% codeBlock src='spreadsheet/replace/index.md' %}{% endcodeBlock %}\n     *\n     * @param {FindOptions} args - Specifies the replace value with find args to replace specified cell value.\n     * @param {string} args.replaceValue - Specifies the replacing value.\n     * @param {string} args.replaceBy - Specifies the value to be replaced for one or all.\n     * @param {string} args.value - Specifies the value to be replaced\n     * @returns {void} - To replace the specified cell value.\n     */\n    Spreadsheet.prototype.replace = function (args) {\n        args = {\n            value: args.value, mode: args.mode ? args.mode : 'Sheet', isCSen: args.isCSen ? args.isCSen : false,\n            isEMatch: args.isEMatch ? args.isEMatch : false, searchBy: args.searchBy ? args.searchBy : 'By Row',\n            replaceValue: args.replaceValue, replaceBy: args.replaceBy,\n            sheetIndex: args.sheetIndex ? args.sheetIndex : this.activeSheetIndex, findOpt: args.findOpt ? args.findOpt : ''\n        };\n        _super.prototype.replaceHandler.call(this, args);\n    };\n    /**\n     * To Find All the Match values Address within Sheet or Workbook.\n     *\n     * {% codeBlock src='spreadsheet/findAll/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} value - Specifies the value to find.\n     * @param {string} mode - Specifies the value to be find within Sheet/Workbook.\n     * @param {boolean} isCSen - Specifies the find match with case sensitive or not.\n     * @param {boolean} isEMatch - Specifies the find match with entire match or not.\n     * @param {number} sheetIndex - Specifies the sheetIndex. If not specified, it will consider the active sheet.\n     * @returns {string[]} - To Find All the Match values Address within Sheet or Workbook.\n     */\n    Spreadsheet.prototype.findAll = function (value, mode, isCSen, isEMatch, sheetIndex) {\n        mode = mode ? mode : 'Sheet';\n        sheetIndex = sheetIndex ? sheetIndex : this.activeSheetIndex;\n        isCSen = isCSen ? isCSen : false;\n        isEMatch = isEMatch ? isEMatch : false;\n        var findCollection = [];\n        var findAllArguments = {\n            value: value, mode: mode, sheetIndex: sheetIndex, isCSen: isCSen,\n            isEMatch: isEMatch, findCollection: findCollection\n        };\n        this.notify(findAllValues, findAllArguments);\n        return findCollection;\n    };\n    /**\n     * Used to navigate to cell address within workbook.\n     *\n     * {% codeBlock src='spreadsheet/goTo/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} address - Specifies the cell address you need to navigate.\n     * You can specify the address in two formats,\n     * `{sheet name}!{cell address}` - Switch to specified sheet and navigate to specified cell address.\n     * `{cell address}` - Navigate to specified cell address with in the active sheet.\n     * @returns {void} - Used to navigate to cell address within workbook.\n     */\n    Spreadsheet.prototype.goTo = function (address) {\n        if (address.includes('!')) {\n            var addrArr = address.split('!');\n            var idx = getSheetIndex(this, addrArr[0]);\n            if (idx === undefined) {\n                return;\n            }\n            if (idx !== this.activeSheetIndex) {\n                var activeCell = addrArr[1].split(':')[0];\n                var sheet_1 = this.sheets[idx];\n                this.setSheetPropertyOnMute(sheet_1, 'activeCell', activeCell);\n                this.setSheetPropertyOnMute(sheet_1, 'selectedRange', addrArr[1]);\n                var cellIndex = getCellIndexes(activeCell);\n                if (sheet_1.frozenColumns || sheet_1.frozenRows) {\n                    var topLeftCell = getCellIndexes(sheet_1.topLeftCell);\n                    if (!((sheet_1.frozenRows && cellIndex[0] < topLeftCell[0]) || (sheet_1.frozenColumns && cellIndex[1] < topLeftCell[1]))) {\n                        var frozenRow_1 = this.frozenRowCount(sheet_1);\n                        var frozenCol_1 = this.frozenColCount(sheet_1);\n                        var curCell = [];\n                        var paneCell = [];\n                        var paneTopLeftCell = getCellIndexes(sheet_1.paneTopLeftCell);\n                        if (frozenRow_1) {\n                            curCell.push(topLeftCell[0]);\n                            if (cellIndex[0] >= frozenRow_1) {\n                                paneCell.push(cellIndex[0]);\n                            }\n                            else {\n                                paneCell.push(paneTopLeftCell[0]);\n                            }\n                        }\n                        else {\n                            curCell.push(cellIndex[0]);\n                            paneCell.push(cellIndex[0]);\n                        }\n                        if (frozenCol_1) {\n                            curCell.push(topLeftCell[1]);\n                            if (cellIndex[1] >= frozenCol_1) {\n                                paneCell.push(cellIndex[1]);\n                            }\n                            else {\n                                paneCell.push(paneTopLeftCell[1]);\n                            }\n                        }\n                        else {\n                            curCell.push(cellIndex[1]);\n                            paneCell.push(cellIndex[1]);\n                        }\n                        this.setSheetPropertyOnMute(sheet_1, 'topLeftCell', getCellAddress(curCell[0], curCell[1]));\n                        this.setSheetPropertyOnMute(sheet_1, 'paneTopLeftCell', getCellAddress(paneCell[0], paneCell[1]));\n                    }\n                }\n                else {\n                    if (cellIndex[0] < this.viewport.rowCount) {\n                        cellIndex[0] = 0;\n                    }\n                    if (cellIndex[1] < this.viewport.colCount) {\n                        cellIndex[1] = 0;\n                    }\n                    this.updateTopLeftCell(cellIndex[0], cellIndex[1], null, sheet_1);\n                }\n                this.activeSheetIndex = idx;\n                this.dataBind();\n                return;\n            }\n        }\n        var indexes = getRangeIndexes(address);\n        var sheet = this.getActiveSheet();\n        var frozenRow = this.frozenRowCount(sheet);\n        var frozenCol = this.frozenColCount(sheet);\n        var insideDomCount = this.insideViewport(indexes[0], indexes[1]);\n        if (insideDomCount) {\n            this.selectRange(address);\n            var viewportIndexes = getCellIndexes(sheet.paneTopLeftCell);\n            var viewportSize = this.viewport.height - this.getScrollElement().parentElement.getBoundingClientRect().height;\n            var threshold = 0;\n            var lastRowIdx = 0;\n            if (frozenRow) {\n                var topLeftIndexes = getCellIndexes(sheet.topLeftCell);\n                for (var i = topLeftIndexes[0]; i < frozenRow; i++) {\n                    threshold += getRowHeight(sheet, i);\n                    if (threshold > viewportSize) {\n                        lastRowIdx = i;\n                        break;\n                    }\n                }\n            }\n            if (lastRowIdx === 0) {\n                for (var i = viewportIndexes[0]; i < this.viewport.bottomIndex; i++) {\n                    threshold += getRowHeight(sheet, i);\n                    if (threshold > viewportSize) {\n                        lastRowIdx = i;\n                        break;\n                    }\n                }\n            }\n            viewportIndexes[2] = lastRowIdx;\n            var lastColIdx = 0;\n            threshold = 0;\n            viewportSize = this.viewport.width - this.sheetModule.getScrollSize();\n            if (frozenCol) {\n                var topLeftIndexes = getCellIndexes(sheet.topLeftCell);\n                for (var i = topLeftIndexes[1]; i < frozenCol; i++) {\n                    threshold += getColumnWidth(sheet, i);\n                    if (threshold > viewportSize) {\n                        lastColIdx = i;\n                        break;\n                    }\n                }\n            }\n            if (lastColIdx === 0) {\n                for (var i = viewportIndexes[1]; i < this.viewport.rightIndex; i++) {\n                    threshold += getColumnWidth(sheet, i);\n                    if (threshold > viewportSize) {\n                        lastColIdx = i;\n                        break;\n                    }\n                }\n            }\n            viewportIndexes[3] = lastColIdx;\n            if (indexes[0] >= viewportIndexes[0] && indexes[0] < viewportIndexes[2] && indexes[1] >= viewportIndexes[1] &&\n                indexes[1] < viewportIndexes[3]) {\n                return;\n            }\n            if (frozenRow || frozenCol) {\n                viewportIndexes = [].concat(getCellIndexes(sheet.topLeftCell), [frozenRow, viewportIndexes[3]]);\n                if (indexes[0] >= viewportIndexes[0] && indexes[0] < viewportIndexes[2] && indexes[1] >= viewportIndexes[1] &&\n                    indexes[1] < viewportIndexes[3]) {\n                    return;\n                }\n                viewportIndexes[2] = lastRowIdx;\n                viewportIndexes[3] = frozenCol;\n                if (indexes[0] >= viewportIndexes[0] && indexes[0] < viewportIndexes[2] && indexes[1] >= viewportIndexes[1] &&\n                    indexes[1] < viewportIndexes[3]) {\n                    return;\n                }\n            }\n        }\n        var content = this.getMainContent().parentElement;\n        var vTrack;\n        var cVTrack;\n        var offset;\n        var vWidth;\n        var vHeight;\n        var scrollableSize;\n        if (indexes[0] === frozenRow) {\n            offset = 0;\n        }\n        else {\n            offset = getRowsHeight(sheet, frozenRow, indexes[0] - 1, true);\n            if (this.scrollSettings.enableVirtualization) {\n                scrollableSize = offset + this.getContentTable().getBoundingClientRect().height;\n                vHeight = parseFloat(content.querySelector('.e-virtualtrack').style.height);\n                if (scrollableSize > vHeight) {\n                    scrollableSize += 10;\n                    vTrack = content.querySelector('.e-virtualtrack');\n                    vTrack.style.height = scrollableSize + \"px\";\n                    getUpdateUsingRaf(function () { vTrack.style.height = vHeight + \"px\"; });\n                }\n            }\n        }\n        content.scrollTop = offset;\n        content = this.element.getElementsByClassName('e-scroller')[0];\n        if (indexes[1] === frozenCol) {\n            offset = 0;\n        }\n        else {\n            offset = getColumnsWidth(sheet, frozenCol, indexes[1] - 1, true);\n            if (this.scrollSettings.enableVirtualization) {\n                scrollableSize = offset + this.getContentTable().getBoundingClientRect().width;\n                vWidth = parseFloat(content.querySelector('.e-virtualtrack').style.width);\n                if (scrollableSize > vWidth) {\n                    scrollableSize += 10;\n                    vTrack = content.querySelector('.e-virtualtrack');\n                    vTrack.style.width = scrollableSize + \"px\";\n                    cVTrack = this.getColumnHeaderContent().querySelector('.e-virtualtrack');\n                    cVTrack.style.width = scrollableSize + \"px\";\n                    vTrack = this.getMainContent().querySelector('.e-virtualtrack');\n                    vTrack.style.width = scrollableSize + \"px\";\n                    getUpdateUsingRaf(function () {\n                        vTrack.style.width = vWidth + \"px\";\n                        cVTrack.style.width = vWidth + \"px\";\n                    });\n                }\n            }\n        }\n        content.scrollLeft = offset;\n        if (!insideDomCount) {\n            this.selectRange(address);\n        }\n    };\n    /**\n     * @hidden\n     * @param {number} rowIndex - Specifies the row index.\n     * @param {number} colIndex - Specifies the column index.\n     * @returns {boolean} - Specifies the boolean value.\n     */\n    Spreadsheet.prototype.insideViewport = function (rowIndex, colIndex) {\n        var sheet = this.getActiveSheet();\n        if (sheet.frozenRows || sheet.frozenColumns) {\n            var frozenRow = this.frozenRowCount(sheet);\n            var frozenCol = this.frozenColCount(sheet);\n            var indexes = getCellIndexes(sheet.topLeftCell);\n            return ((rowIndex >= indexes[0] && rowIndex < frozenRow) || (rowIndex >= this.viewport.topIndex + frozenRow && rowIndex <=\n                this.viewport.bottomIndex)) && ((colIndex >= indexes[1] && colIndex < frozenCol) || (colIndex >= this.viewport.leftIndex +\n                frozenCol && colIndex <= this.viewport.rightIndex));\n        }\n        else {\n            return rowIndex >= this.viewport.topIndex && rowIndex <= this.viewport.bottomIndex && colIndex >= this.viewport.leftIndex &&\n                colIndex <= this.viewport.rightIndex;\n        }\n    };\n    /**\n     * Used to resize the Spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/resize/index.md' %}{% endcodeBlock %}\n     *\n     * @returns {void} - Used to resize the Spreadsheet.\n     */\n    Spreadsheet.prototype.resize = function () {\n        this.renderModule.setSheetPanelSize();\n        if (this.scrollSettings.enableVirtualization) {\n            this.renderModule.refreshSheet();\n        }\n    };\n    /**\n     * To cut the specified cell or cells properties such as value, format, style etc...\n     *\n     * {% codeBlock src='spreadsheet/cut/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} address - Specifies the range address to cut.\n     * @returns {Promise<Object>} - To cut the specified cell or cells properties such as value, format, style etc...\n     */\n    Spreadsheet.prototype.cut = function (address) {\n        var promise = \n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        new Promise(function (resolve, reject) { resolve((function () { })()); });\n        this.notify(cut, address ? {\n            range: getIndexesFromAddress(address),\n            sId: this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))] ?\n                this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))].id : this.getActiveSheet().id,\n            promise: promise\n        } : { promise: promise });\n        return promise;\n    };\n    /**\n     * To copy the specified cell or cells properties such as value, format, style etc...\n     *\n     * {% codeBlock src='spreadsheet/copy/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} address - Specifies the range address.\n     * @returns {Promise<Object>} - To copy the specified cell or cells properties such as value, format, style etc...\n     */\n    Spreadsheet.prototype.copy = function (address) {\n        var promise = \n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        new Promise(function (resolve, reject) { resolve((function () { })()); });\n        this.notify(copy, address ? {\n            range: getIndexesFromAddress(address),\n            sId: this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))] ?\n                this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))].id : this.getActiveSheet().id,\n            promise: promise\n        } : { promise: promise });\n        return promise;\n    };\n    /**\n     * This method is used to paste the cut or copied cells in to specified address.\n     *\n     * {% codeBlock src='spreadsheet/paste/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} address - Specifies the cell or range address.\n     * @param {PasteSpecialType} type - Specifies the type of paste.\n     * @returns {void} - used to paste the cut or copied cells in to specified address.\n     */\n    Spreadsheet.prototype.paste = function (address, type) {\n        this.notify(paste, {\n            range: address ? getIndexesFromAddress(address) : address,\n            sIdx: address ? getSheetIndex(this, getSheetNameFromAddress(address)) : address,\n            type: type, isAction: false, isInternal: true\n        });\n    };\n    /**\n     * To update the action which need to perform.\n     *\n     * {% codeBlock src='spreadsheet/updateAction/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} options - It describes an action and event args to perform.\n     * @param {string} options.action - specifies an action.\n     * @param {string} options.eventArgs - specifies an args to perform an action.\n     * @returns {void} - To update the action which need to perform.\n     */\n    Spreadsheet.prototype.updateAction = function (options) {\n        updateAction(options, this);\n    };\n    Spreadsheet.prototype.setHeight = function () {\n        if (this.height.toString().indexOf('%') > -1) {\n            this.element.style.minHeight = '400px';\n        }\n        this.element.style.height = formatUnit(this.height);\n    };\n    Spreadsheet.prototype.setWidth = function () {\n        if (this.width.toString().indexOf('%') > -1 || this.width === 'auto') {\n            this.element.style.minWidth = '300px';\n        }\n        this.element.style.width = formatUnit(this.width);\n    };\n    /**\n     * Set the width of column.\n     *\n     * {% codeBlock src='spreadsheet/setColWidth/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} width - To specify the width\n     * @param {number} colIndex - To specify the colIndex\n     * @param {number} sheetIndex - To specify the sheetIndex\n     * @returns {void} - Set the width of column.\n     */\n    Spreadsheet.prototype.setColWidth = function (width, colIndex, sheetIndex) {\n        if (width === void 0) { width = 64; }\n        if (colIndex === void 0) { colIndex = 0; }\n        var colThreshold = this.getThreshold('col');\n        var lastIdx = this.viewport.leftIndex + this.viewport.colCount + (colThreshold * 2);\n        var sheet = isNullOrUndefined(sheetIndex) ? this.getActiveSheet() : this.sheets[sheetIndex];\n        if (sheet) {\n            var mIndex = colIndex;\n            var colWidth = (typeof width === 'number') ? width + 'px' : width;\n            colIndex = isNullOrUndefined(colIndex) ? getCellIndexes(sheet.activeCell)[1] : colIndex;\n            if (sheet === this.getActiveSheet()) {\n                if (colIndex >= this.viewport.leftIndex && colIndex <= lastIdx) {\n                    if (this.scrollSettings.enableVirtualization) {\n                        colIndex = colIndex - this.viewport.leftIndex;\n                    }\n                    var trgt = void 0;\n                    if (sheet.showHeaders) {\n                        trgt = this.getColumnHeaderContent().getElementsByClassName('e-header-cell')[colIndex];\n                    }\n                    else {\n                        trgt = this.getContentTable().getElementsByClassName('e-row')[0]\n                            .getElementsByClassName('e-cell')[colIndex];\n                    }\n                    var eleWidth = getColumnWidth(sheet, colIndex, null, true);\n                    var threshold = getDPRValue(parseInt(colWidth, 10)) - eleWidth;\n                    if (threshold < 0 && eleWidth < -(threshold)) {\n                        getCellIndexes(sheet.activeCell);\n                        threshold = -eleWidth;\n                    }\n                    var oldIdx = parseInt(trgt.getAttribute('aria-colindex'), 10) - 1;\n                    if (this.getActiveSheet() === sheet) {\n                        this.notify(colWidthChanged, { threshold: threshold, colIdx: oldIdx });\n                        setResize(colIndex, colIndex, colWidth, true, this);\n                    }\n                }\n                else {\n                    var oldWidth = getColumnWidth(sheet, colIndex);\n                    var threshold = void 0;\n                    if (parseInt(colWidth, 10) > 0) {\n                        threshold = -(oldWidth - parseInt(colWidth, 10));\n                    }\n                    else {\n                        threshold = -oldWidth;\n                    }\n                    this.notify(colWidthChanged, { threshold: threshold, colIdx: colIndex });\n                }\n            }\n            getColumn(sheet, mIndex).width = parseInt(colWidth, 10) > 0 ? parseInt(colWidth, 10) : 0;\n            sheet.columns[mIndex].customWidth = true;\n        }\n    };\n    /**\n     * Set the height of row.\n     *\n     * {% codeBlock src='spreadsheet/setRowHeight/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} height - Specifies height needs to be updated. If not specified, it will set the default height 20.\n     * @param {number} rowIndex - Specifies the row index. If not specified, it will consider the first row.\n     * @param {number} sheetIndex - Specifies the sheetIndex. If not specified, it will consider the active sheet.\n     * @param {boolean} edited - Specifies the boolean value.\n     * @returns {void} - Set the height of row.\n     */\n    Spreadsheet.prototype.setRowHeight = function (height, rowIndex, sheetIndex, edited) {\n        if (height === void 0) { height = 20; }\n        if (rowIndex === void 0) { rowIndex = 0; }\n        var sheet = isNullOrUndefined(sheetIndex) ? this.getActiveSheet() : this.sheets[sheetIndex - 1];\n        if (sheet) {\n            var mIndex = rowIndex;\n            var rowHeight = (typeof height === 'number') ? height + 'px' : height;\n            rowIndex = isNullOrUndefined(rowIndex) ? getCellIndexes(sheet.activeCell)[0] : rowIndex;\n            if (sheet === this.getActiveSheet()) {\n                if (rowIndex <= this.viewport.bottomIndex && rowIndex >= this.viewport.topIndex) {\n                    if (this.scrollSettings.enableVirtualization) {\n                        rowIndex = rowIndex - this.viewport.topIndex;\n                    }\n                    var trgt = void 0;\n                    if (sheet.showHeaders) {\n                        trgt = this.getRowHeaderContent().getElementsByClassName('e-header-cell')[rowIndex].parentElement;\n                    }\n                    else {\n                        trgt = this.getContentTable().getElementsByClassName('e-row')[rowIndex];\n                    }\n                    var eleHeight = getRowHeight(sheet, rowIndex, true);\n                    var threshold = getDPRValue(parseInt(rowHeight, 10)) - eleHeight;\n                    if (threshold < 0 && eleHeight < -(threshold)) {\n                        threshold = -eleHeight;\n                    }\n                    var oldIdx = parseInt(trgt.getAttribute('aria-rowindex'), 10) - 1;\n                    if (this.getActiveSheet() === sheet) {\n                        this.notify(rowHeightChanged, { threshold: threshold, rowIdx: oldIdx });\n                        if (isNullOrUndefined(edited)) {\n                            edited = false;\n                        }\n                        if (!edited) {\n                            setResize(rowIndex, rowIndex, rowHeight, false, this);\n                            edited = false;\n                        }\n                    }\n                }\n                else {\n                    var oldHeight = getRowHeight(sheet, rowIndex);\n                    var threshold = void 0;\n                    if (parseInt(rowHeight, 10) > 0) {\n                        threshold = -(oldHeight - parseInt(rowHeight, 10));\n                    }\n                    else {\n                        threshold = -oldHeight;\n                    }\n                    this.notify(rowHeightChanged, { threshold: threshold, rowIdx: rowIndex });\n                }\n            }\n            setRowHeight(sheet, mIndex, parseInt(rowHeight, 10) > 0 ? parseInt(rowHeight, 10) : 0);\n            sheet.rows[mIndex].customHeight = true;\n        }\n    };\n    /**\n     * This method is used to autofit the range of rows or columns\n     *\n     * {% codeBlock src='spreadsheet/autoFit/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} range - range of rows or columns that needs to be autofit.\n     *\n     * @returns {void} - used to autofit the range of rows or columns\n     * ```html\n     * <div id='Spreadsheet'></div>\n     * ```\n     * ```typescript\n     * let spreadsheet = new Spreadsheet({\n     *      allowResizing: true\n     * ...\n     * }, '#Spreadsheet');\n     * spreadsheet.autoFit('A:D'); // Auto fit from A to D columns\n     * Spreadsheet.autoFit('1:4'); // Auto fit from 1 to 4 rows\n     *\n     * ```\n     */\n    Spreadsheet.prototype.autoFit = function (range) {\n        var values = this.getIndexes(range);\n        var startIdx = values.startIdx;\n        var endIdx = values.endIdx;\n        var isCol = values.isCol;\n        var maximumColInx = isCol ? getColIndex('XFD') : 1048576;\n        if (startIdx <= maximumColInx) {\n            if (endIdx > maximumColInx) {\n                endIdx = maximumColInx;\n            }\n        }\n        else {\n            return;\n        }\n        for (startIdx; startIdx <= endIdx; startIdx++) {\n            this.notify(setAutoFit, { idx: startIdx, isCol: isCol });\n        }\n    };\n    /**\n     * @hidden\n     * @param {string} range - specify the range.\n     * @returns {number | boolean} - to get the index.\n     *\n     */\n    Spreadsheet.prototype.getIndexes = function (range) {\n        var startIsCol;\n        var endIsCol;\n        var start;\n        var end;\n        if (range.indexOf(':') !== -1) {\n            var starttoend = range.split(':');\n            start = starttoend[0];\n            end = starttoend[1];\n        }\n        else {\n            start = range;\n            end = range;\n        }\n        if (!isNullOrUndefined(start)) {\n            var startValues = this.getAddress(start);\n            start = startValues.address;\n            startIsCol = startValues.isCol;\n        }\n        if (!isNullOrUndefined(end)) {\n            var endValues = this.getAddress(end);\n            end = endValues.address;\n            endIsCol = endValues.isCol;\n        }\n        var isCol = startIsCol === true && endIsCol === true ? true : false;\n        var startIdx = isCol ? getColIndex(start.toUpperCase()) : parseInt(start, 10);\n        var endIdx = isCol ? getColIndex(end.toUpperCase()) : parseInt(end, 10);\n        return { startIdx: startIdx, endIdx: endIdx, isCol: isCol };\n    };\n    Spreadsheet.prototype.getAddress = function (address) {\n        var isCol;\n        if (address.substring(0, 1).match(/\\D/g)) {\n            isCol = true;\n            address = address.replace(/[0-9]/g, '');\n            return { address: address, isCol: isCol };\n        }\n        else if (address.substring(0, 1).match(/[0-9]/g) && address.match(/\\D/g)) {\n            return { address: '', isCol: false };\n        }\n        else {\n            address = (parseInt(address, 10) - 1).toString();\n            return { address: address, isCol: isCol };\n        }\n    };\n    /**\n     * To add the hyperlink in the cell\n     *\n     * {% codeBlock src='spreadsheet/addHyperlink/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string | HyperlinkModel} hyperlink - to specify the hyperlink\n     * @param {string} address - to specify the address\n     * @returns {void} - To add the hyperlink in the cell\n     */\n    Spreadsheet.prototype.addHyperlink = function (hyperlink, address) {\n        this.insertHyperlink(hyperlink, address, '', true);\n    };\n    /**\n     * To remove the hyperlink in the cell\n     *\n     * {% codeBlock src='spreadsheet/removeHyperlink/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} range - To specify the range\n     * @returns {void} - To remove the hyperlink in the cell\n     */\n    Spreadsheet.prototype.removeHyperlink = function (range) {\n        var rangeArr;\n        var sheet = this.getActiveSheet();\n        var sheetIdx;\n        if (range && range.indexOf('!') !== -1) {\n            rangeArr = range.split('!');\n            var sheets = this.sheets;\n            for (var idx = 0; idx < sheets.length; idx++) {\n                if (sheets[idx].name === rangeArr[0]) {\n                    sheetIdx = idx;\n                }\n            }\n            sheet = this.sheets[sheetIdx];\n            range = rangeArr[1];\n        }\n        var rangeIndexes = range ? getRangeIndexes(range) : getRangeIndexes(this.getActiveSheet().activeCell);\n        var cellMod;\n        for (var rowIdx = rangeIndexes[0]; rowIdx <= rangeIndexes[2]; rowIdx++) {\n            for (var colIdx = rangeIndexes[1]; colIdx <= rangeIndexes[3]; colIdx++) {\n                if (sheet && sheet.rows[rowIdx] && sheet.rows[rowIdx].cells[colIdx]) {\n                    var prevELem = this.getCell(rowIdx, colIdx);\n                    var classList = [];\n                    for (var i = 0; i < prevELem.classList.length; i++) {\n                        classList.push(prevELem.classList[i]);\n                    }\n                    this.notify(deleteHyperlink, { sheet: sheet, rowIdx: rowIdx, colIdx: colIdx });\n                    for (var i = 0; i < classList.length; i++) {\n                        if (!this.getCell(rowIdx, colIdx).classList.contains(classList[i])) {\n                            this.getCell(rowIdx, colIdx).classList.add(classList[i]);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @hidden\n     * @param {string | HyperlinkModel} hyperlink - specify the hyperlink\n     * @param {string} address - To specify the address\n     * @param {string} displayText - To specify the displayText\n     * @param {boolean} isMethod - To specify the bool value\n     * @returns {void} - to insert the hyperlink\n     */\n    Spreadsheet.prototype.insertHyperlink = function (hyperlink, address, displayText, isMethod) {\n        if (this.allowHyperlink) {\n            //let value: string;\n            var addrRange = void 0;\n            var sheetIdx = void 0;\n            var cellIdx = void 0;\n            var sheet = this.getActiveSheet();\n            // let isEmpty: boolean;\n            address = address ? address : this.getActiveSheet().activeCell;\n            cellIdx = getRangeIndexes(address);\n            var prevELem = this.getCell(cellIdx[0], cellIdx[1]);\n            var classList = [];\n            for (var i = 0; i < prevELem.classList.length; i++) {\n                classList.push(prevELem.classList[i]);\n            }\n            var befArgs = { hyperlink: hyperlink, cell: address, cancel: false };\n            var aftArgs = { hyperlink: hyperlink, cell: address };\n            if (!isMethod) {\n                this.trigger(beforeHyperlinkCreate, befArgs);\n            }\n            if (!befArgs.cancel) {\n                hyperlink = befArgs.hyperlink;\n                address = befArgs.cell;\n                _super.prototype.addHyperlink.call(this, hyperlink, address);\n                if (address && address.indexOf('!') !== -1) {\n                    addrRange = address.split('!');\n                    var sheets = this.sheets;\n                    for (var idx = 0; idx < sheets.length; idx++) {\n                        if (sheets[idx].name === addrRange[0]) {\n                            sheetIdx = idx;\n                        }\n                    }\n                    sheet = this.sheets[sheetIdx];\n                    address = addrRange[1];\n                }\n                if (!sheet) {\n                    return;\n                }\n                address = address ? address : this.getActiveSheet().activeCell;\n                cellIdx = getRangeIndexes(address);\n                // if (typeof (hyperlink) === 'string') {\n                //     value = hyperlink;\n                // } else {\n                //     value = hyperlink.address;\n                // }\n                var mCell = sheet.rows[cellIdx[0]].cells[cellIdx[1]];\n                if (isNullOrUndefined(mCell.value) || mCell.value === '') {\n                    // isEmpty = true;\n                    if (!isNullOrUndefined(displayText) && displayText !== '') {\n                        mCell.value = displayText;\n                    }\n                }\n                else {\n                    if (mCell.value !== displayText) {\n                        mCell.value = displayText;\n                    }\n                }\n                if (!isMethod) {\n                    this.trigger(afterHyperlinkCreate, aftArgs);\n                }\n                if (sheet === this.getActiveSheet()) {\n                    this.serviceLocator.getService('cell').refreshRange(cellIdx);\n                    for (var i = 0; i < classList.length; i++) {\n                        if (!this.getCell(cellIdx[0], cellIdx[1]).classList.contains(classList[i])) {\n                            this.getCell(cellIdx[0], cellIdx[1]).classList.add(classList[i]);\n                        }\n                    }\n                    this.notify(refreshRibbonIcons, null);\n                }\n            }\n        }\n    };\n    /**\n     * This method is used to add data validation.\n     *\n     * {% codeBlock src='spreadsheet/addDataValidation/index.md' %}{% endcodeBlock %}\n     *\n     * @param {ValidationModel} rules - specifies the validation rules like type, operator, value1, value2, ignoreBlank, inCellDropDown, isHighlighted arguments.\n     * @param {string} range - range that needs to be add validation.\n     * @returns {void} - used to add data validation.\n     */\n    Spreadsheet.prototype.addDataValidation = function (rules, range) {\n        _super.prototype.addDataValidation.call(this, rules, range);\n    };\n    /**\n     * This method is used for remove validation.\n     *\n     * {% codeBlock src='spreadsheet/removeDataValidation/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} range - range that needs to be remove validation.\n     * @returns {void} - This method is used for remove validation.\n     */\n    Spreadsheet.prototype.removeDataValidation = function (range) {\n        _super.prototype.removeDataValidation.call(this, range);\n    };\n    /**\n     * This method is used to highlight the invalid data.\n     *\n     * {% codeBlock src='spreadsheet/addInvalidHighlight/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} range - range that needs to be highlight the invalid data.\n     * @returns {void} - This method is used to highlight the invalid data.\n     */\n    Spreadsheet.prototype.addInvalidHighlight = function (range) {\n        _super.prototype.addInvalidHighlight.call(this, range);\n    };\n    /**\n     * This method is used for remove highlight from invalid data.\n     *\n     * {% codeBlock src='spreadsheet/removeInvalidHighlight/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} range - range that needs to be remove invalid highlight.\n     * @returns {void} - This method is used for remove highlight from invalid data.\n     */\n    Spreadsheet.prototype.removeInvalidHighlight = function (range) {\n        _super.prototype.removeInvalidHighlight.call(this, range);\n    };\n    /**\n     * This method is used to add conditional formatting.\n     *\n     * {% codeBlock src='spreadsheet/conditionalFormat/index.md' %}{% endcodeBlock %}\n     *\n     * @param {ConditionalFormatModel} conditionalFormat - Specify the conditionalFormat.\n     * @returns {void} - used to add conditional formatting.\n     */\n    Spreadsheet.prototype.conditionalFormat = function (conditionalFormat) {\n        _super.prototype.conditionalFormat.call(this, conditionalFormat);\n    };\n    /**\n     * This method is used for remove conditional formatting.\n     *\n     * {% codeBlock src='spreadsheet/clearConditionalFormat/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} range - range that needs to be remove conditional formatting.\n     * @returns {void} - used for remove conditional formatting.\n     */\n    Spreadsheet.prototype.clearConditionalFormat = function (range) {\n        range = range || this.getActiveSheet().selectedRange;\n        _super.prototype.clearConditionalFormat.call(this, range);\n    };\n    /**\n     * @hidden\n     * @returns {void} - set Panel Size.\n     */\n    Spreadsheet.prototype.setPanelSize = function () {\n        if (this.height !== 'auto') {\n            var panel = document.getElementById(this.element.id + '_sheet_panel');\n            panel.style.height = this.element.getBoundingClientRect().height - getSiblingsHeight(panel) + \"px\";\n        }\n    };\n    /**\n     * Opens the Excel file.\n     *\n     * {% codeBlock src='spreadsheet/open/index.md' %}{% endcodeBlock %}\n     *\n     * @param {OpenOptions} options - Options for opening the excel file.\n     * @returns {void} - Open the Excel file.\n     */\n    Spreadsheet.prototype.open = function (options) {\n        this.isOpen = true;\n        _super.prototype.open.call(this, options);\n        if (this.isOpen) {\n            this.showSpinner();\n        }\n    };\n    /**\n     * @hidden\n     * @param {number} startIndex - specify the start index\n     * @param {number} endIndex - specify the end index.\n     * @param {boolean} hide - Specify the bool value.\n     * @returns {void} - To hide the row\n     */\n    Spreadsheet.prototype.hideRow = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        var sheet = this.getActiveSheet();\n        if (this.renderModule && !sheet.frozenRows && !sheet.frozenColumns) {\n            this.notify(hideShow, { startIndex: startIndex, endIndex: endIndex, hide: hide });\n        }\n        else {\n            _super.prototype.hideRow.call(this, startIndex, endIndex, hide);\n        }\n    };\n    /**\n     * @hidden\n     * @param {number} startIndex - specify the start index\n     * @param {number} endIndex - specify the end index.\n     * @param {boolean} hide - Specify the bool value\n     * @returns {void} - To hide the column\n     */\n    Spreadsheet.prototype.hideColumn = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        var sheet = this.getActiveSheet();\n        if (this.renderModule && !sheet.frozenRows && !sheet.frozenColumns) {\n            this.notify(hideShow, { startIndex: startIndex, endIndex: endIndex, hide: hide, isCol: true });\n        }\n        else {\n            _super.prototype.hideColumn.call(this, startIndex, endIndex, hide);\n        }\n    };\n    /**\n     * This method is used to Clear contents, formats and hyperlinks in spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/clear/index.md' %}{% endcodeBlock %}\n     *\n     * @param {ClearOptions} options - Options for clearing the content, formats and hyperlinks in spreadsheet.\n     * @returns {void} -  Used to Clear contents, formats and hyperlinks in spreadsheet\n     */\n    Spreadsheet.prototype.clear = function (options) {\n        this.notify(clearViewer, { options: options, isPublic: true });\n    };\n    /**\n     * Used to refresh the spreadsheet in UI level.\n     *\n     * {% codeBlock src='spreadsheet/refresh/index.md' %}{% endcodeBlock %}\n     *\n     * @param {boolean} isNew - Specifies `true` / `false` to create new workbook in spreadsheet.\n     * @returns {void} -  Used to refresh the spreadsheet.\n     */\n    Spreadsheet.prototype.refresh = function (isNew) {\n        if (this[isReact]) {\n            this[clearTemplate]();\n        }\n        if (isNew) {\n            this.notify(blankWorkbook, {});\n        }\n        else {\n            _super.prototype.refresh.call(this);\n        }\n    };\n    /**\n     * Used to set the image in spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/insertImage/index.md' %}{% endcodeBlock %}\n     *\n     * @param {ImageModel} images - Specifies the options to insert image in spreadsheet.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns {void} -  Used to set the image in spreadsheet.\n     */\n    Spreadsheet.prototype.insertImage = function (images, range) {\n        var i;\n        for (i = 0; i < images.length; i++) {\n            this.notify(createImageElement, {\n                options: images[i],\n                range: range ? range : this.getActiveSheet().selectedRange, isPublic: true\n            });\n        }\n    };\n    /**\n     * Used to delete the image in spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/deleteImage/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} id - Specifies the id of the image element to be deleted.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns {void} - Used to delete the image in spreadsheet.\n     */\n    Spreadsheet.prototype.deleteImage = function (id, range) {\n        this.notify(deleteImage, { id: id, range: range ? range : this.getActiveSheet().selectedRange });\n    };\n    /**\n     * Gets the row header div of the Spreadsheet.\n     *\n     * @returns {Element} - Gets the row header div of the Spreadsheet.\n     * @hidden\n     */\n    Spreadsheet.prototype.getRowHeaderContent = function () {\n        return this.sheetModule.getRowHeaderPanel();\n    };\n    /**\n     * Gets the column header div of the Spreadsheet.\n     *\n     * @returns {HTMLElement} - Gets the column header div of the Spreadsheet.\n     * @hidden\n     */\n    Spreadsheet.prototype.getColumnHeaderContent = function () {\n        return this.sheetModule.getColHeaderPanel();\n    };\n    /**\n     * Gets the main content div of the Spreadsheet.\n     *\n     * @returns {HTMLElement} - Gets the main content div of the Spreadsheet.\n     * @hidden\n     */\n    Spreadsheet.prototype.getMainContent = function () {\n        return this.sheetModule.getContentPanel();\n    };\n    /**\n     * Get the select all div of spreadsheet\n     *\n     * @returns {HTMLElement} - Get the select all div of spreadsheet\n     */\n    Spreadsheet.prototype.getSelectAllContent = function () {\n        return this.sheetModule.getSelectAllContent();\n    };\n    /**\n     * Gets the horizontal scroll element of the Spreadsheet.\n     *\n     * @returns {HTMLElement} - Gets the column header div of the Spreadsheet.\n     * @hidden\n     */\n    Spreadsheet.prototype.getScrollElement = function () {\n        return this.sheetModule.getScrollElement();\n    };\n    /**\n     * Get the main content table element of spreadsheet.\n     *\n     * @returns {HTMLTableElement} -Get the main content table element of spreadsheet.\n     * @hidden\n     */\n    Spreadsheet.prototype.getContentTable = function () {\n        return this.sheetModule.getContentTable();\n    };\n    /**\n     * Get the row header table element of spreadsheet.\n     *\n     * @returns {HTMLTableElement} - Get the row header table element of spreadsheet.\n     * @hidden\n     */\n    Spreadsheet.prototype.getRowHeaderTable = function () {\n        return this.sheetModule.getRowHeaderTable();\n    };\n    /**\n     * Get the column header table element of spreadsheet.\n     *\n     * @returns {HTMLTableElement} - Get the column header table element of spreadsheet.\n     * @hidden\n     */\n    Spreadsheet.prototype.getColHeaderTable = function () {\n        return this.sheetModule.getColHeaderTable();\n    };\n    /**\n     * To get the backup element count for row and column virtualization.\n     *\n     * @param {'row' | 'col'} layout -  specify the layout.\n     * @returns {number} - To get the backup element count for row and column virtualization.\n     * @hidden\n     */\n    Spreadsheet.prototype.getThreshold = function (layout) {\n        var threshold = Math.round((this.viewport[layout + 'Count'] + 1) / 2);\n        return threshold < 15 ? 15 : threshold;\n    };\n    /**\n     * @hidden\n     * @returns {boolean} - Returns the bool value.\n     */\n    Spreadsheet.prototype.isMobileView = function () {\n        return ((this.cssClass.indexOf('e-mobile-view') > -1 || Browser.isDevice) && this.cssClass.indexOf('e-desktop-view') === -1)\n            && false;\n    };\n    /**\n     * @hidden\n     * @param {number} sheetId - Specifies the sheet id.\n     * @param {number} rowIndex - specify the row index.\n     * @param {number} colIndex - specify the col index.\n     * @returns {string | number} - to get Value Row Col.\n     */\n    Spreadsheet.prototype.getValueRowCol = function (sheetId, rowIndex, colIndex, formulaCellReference, refresh) {\n        return _super.prototype.getValueRowCol.call(this, sheetId, rowIndex, colIndex, formulaCellReference, refresh);\n    };\n    /**\n     * To update a cell properties.\n     *\n     * {% codeBlock src='spreadsheet/updateCell/index.md' %}{% endcodeBlock %}\n     *\n     * @param {CellModel} cell - Cell properties.\n     * @param {string} address - Address to update.\n     * @returns {void} - To update a cell properties.\n     */\n    Spreadsheet.prototype.updateCell = function (cell, address) {\n        address = address || this.getActiveSheet().activeCell;\n        _super.prototype.updateCell.call(this, cell, address);\n        this.notify(activeCellChanged, null);\n    };\n    /**\n     * Used to get a row data from the data source with updated cell value.\n     *\n     * {% codeBlock src='spreadsheet/getRowData/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} index? - Specifies the row index.\n     * @param {number} sheetIndex? - Specifies the sheet index. By default, it consider the active sheet index.\n     * @returns {Object[]} - Return row data.\n     */\n    Spreadsheet.prototype.getRowData = function (index, sheetIndex) {\n        return _super.prototype.getRowData.call(this, index, sheetIndex);\n    };\n    /**\n     * Sorts the range of cells in the active sheet.\n     *\n     * {% codeBlock src='spreadsheet/sort/index.md' %}{% endcodeBlock %}\n     *\n     * @param {SortOptions} sortOptions - options for sorting.\n     * @param {string} range - address of the data range.\n     * @returns {Promise<SortEventArgs>} - Sorts the range of cells in the active sheet.\n     */\n    Spreadsheet.prototype.sort = function (sortOptions, range) {\n        var _this = this;\n        if (!this.allowSorting) {\n            return Promise.reject();\n        }\n        return _super.prototype.sort.call(this, sortOptions, range).then(function (args) {\n            _this.notify(sortComplete, args);\n            return Promise.resolve(args);\n        });\n    };\n    /**\n     * @hidden\n     * @param {number} sheetIndex - specify the sheet index.\n     * @param {string | number} value - Specify the value.\n     * @param {number} rowIndex - Specify the row index.\n     * @param {number} colIndex - Specify the col index.\n     * @returns {void} - To set value for row and col.\n     */\n    Spreadsheet.prototype.setValueRowCol = function (sheetIndex, value, rowIndex, colIndex) {\n        if (value === 'circular reference: ') {\n            var circularArgs = {\n                action: 'isCircularReference', argValue: value\n            };\n            this.notify(formulaOperation, circularArgs);\n            value = circularArgs.argValue;\n        }\n        _super.prototype.setValueRowCol.call(this, sheetIndex, value, rowIndex, colIndex);\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        this.notify(editOperation, {\n            action: 'refreshDependentCellValue', rowIdx: rowIndex, colIdx: colIndex,\n            sheetIdx: sheetIndex\n        });\n    };\n    /**\n     * Get component name.\n     *\n     * @returns {string} - Get component name.\n     * @hidden\n     */\n    Spreadsheet.prototype.getModuleName = function () {\n        return 'spreadsheet';\n    };\n    /**\n     * @hidden\n     * @param {Element} td - Specify the element.\n     * @param {RefreshValueArgs} args - specify the args.\n     * @returns {void} - to refresh the node.\n     */\n    Spreadsheet.prototype.refreshNode = function (td, args) {\n        var value;\n        if (td) {\n            var spanElem = select('#' + this.element.id + '_currency', td);\n            var alignClass = 'e-right-align';\n            if (args) {\n                args.result = isNullOrUndefined(args.result) ? '' : args.result.toString();\n                if (spanElem) {\n                    detach(spanElem);\n                }\n                if (args.type === 'Accounting' && isNumber(args.value)) {\n                    if (td.querySelector('a')) {\n                        td.querySelector('a').textContent = args.result.split(args.curSymbol).join('');\n                    }\n                    else {\n                        td.innerHTML = '';\n                    }\n                    td.appendChild(this.createElement('span', {\n                        id: this.element.id + '_currency',\n                        innerHTML: \"\" + args.curSymbol,\n                        styles: 'float: left'\n                    }));\n                    if (!td.querySelector('a')) {\n                        td.innerHTML += args.result.split(args.curSymbol).join('');\n                    }\n                    td.classList.add(alignClass);\n                    return;\n                }\n                else {\n                    if (args.result && (args.result.toLowerCase() === 'true' || args.result.toLowerCase() === 'false')) {\n                        args.result = args.result.toUpperCase();\n                        alignClass = 'e-center-align';\n                        args.isRightAlign = true; // Re-use this to center align the cell.\n                    }\n                    value = args.result;\n                }\n                if (args.isRightAlign) {\n                    td.classList.add(alignClass);\n                }\n                else {\n                    td.classList.remove(alignClass);\n                }\n            }\n            value = !isNullOrUndefined(value) ? value : '';\n            if (!isNullOrUndefined(td)) {\n                var node = td.lastChild;\n                var wrapContent = td.querySelector('.e-wrap-content');\n                if (td.querySelector('.e-databar-value')) {\n                    node = td.querySelector('.e-databar-value').lastChild;\n                }\n                if (td.querySelector('.e-hyperlink')) {\n                    node = td.querySelector('.e-hyperlink').lastChild;\n                }\n                if (wrapContent) {\n                    if (!wrapContent.lastChild) {\n                        wrapContent.appendChild(document.createTextNode(''));\n                    }\n                    node = wrapContent.lastChild;\n                }\n                if (node && (node.nodeType === 3 || node.nodeType === 1)) {\n                    node.nodeValue = value;\n                }\n                else {\n                    td.appendChild(document.createTextNode(value));\n                }\n            }\n        }\n    };\n    /**\n     * @hidden\n     * @param {CellStyleModel} style - specify the style.\n     * @param {number} lines - Specify the lines.\n     * @param {number} borderWidth - Specify the borderWidth.\n     * @returns {number} - To calculate Height\n     */\n    Spreadsheet.prototype.calculateHeight = function (style, lines, borderWidth) {\n        if (lines === void 0) { lines = 1; }\n        if (borderWidth === void 0) { borderWidth = 1; }\n        var fontSize = (style && style.fontSize) || this.cellStyle.fontSize;\n        var threshold = style.fontFamily === 'Arial Black' ? 1.44 : 1.24;\n        return ((fontSize.indexOf('pt') > -1 ? parseInt(fontSize, 10) * 1.33 : parseInt(fontSize, 10)) * threshold * lines) +\n            (borderWidth * threshold);\n    };\n    /**\n     * @hidden\n     * @param {number} startIdx - specify the start index.\n     * @param {number} endIdx - Specify the end index.\n     * @param {string} layout - Specify the rows.\n     * @returns {number[]} - To skip the hidden rows.\n     */\n    Spreadsheet.prototype.skipHidden = function (startIdx, endIdx, layout) {\n        if (layout === void 0) { layout = 'rows'; }\n        var sheet = this.getActiveSheet();\n        var totalCount;\n        if (this.scrollSettings.isFinite) {\n            totalCount = (layout === 'rows' ? sheet.rowCount : sheet.colCount) - 1;\n        }\n        for (var i = startIdx; i <= endIdx; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                if (sheet.frozenColumns || sheet.frozenRows) {\n                    if (layout === 'rows') {\n                        setRow(sheet, i, { hidden: false });\n                    }\n                    else {\n                        setColumn(sheet, i, { hidden: false });\n                    }\n                    continue;\n                }\n                if (startIdx === i) {\n                    startIdx++;\n                }\n                endIdx++;\n                if (totalCount && endIdx > totalCount) {\n                    endIdx = totalCount;\n                    break;\n                }\n            }\n        }\n        return [startIdx, endIdx];\n    };\n    /**\n     * @hidden\n     * @param {HTMLElement} nextTab - Specify the element.\n     * @param {string} selector - Specify the selector\n     * @returns {void} - To update the active border.\n     */\n    Spreadsheet.prototype.updateActiveBorder = function (nextTab, selector) {\n        if (selector === void 0) { selector = '.e-ribbon'; }\n        var indicator = select(selector + \" .e-tab-header .e-indicator\", this.element);\n        indicator.style.display = 'none';\n        setStyleAttribute(indicator, { 'left': '', 'right': '' });\n        setStyleAttribute(indicator, {\n            'left': nextTab.offsetLeft + 'px', 'right': nextTab.parentElement.offsetWidth - (nextTab.offsetLeft + nextTab.offsetWidth) + 'px'\n        });\n        indicator.style.display = '';\n    };\n    /**\n     * To perform the undo operation in spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/undo/index.md' %}{% endcodeBlock %}\n     *\n     * @returns {void} - To perform the undo operation in spreadsheet.\n     */\n    Spreadsheet.prototype.undo = function () {\n        this.notify(performUndoRedo, { isUndo: true, isPublic: true });\n    };\n    /**\n     * To perform the redo operation in spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/redo/index.md' %}{% endcodeBlock %}\n     *\n     * @returns {void} - To perform the redo operation in spreadsheet.\n     */\n    Spreadsheet.prototype.redo = function () {\n        this.notify(performUndoRedo, { isUndo: false, isPublic: true });\n    };\n    /**\n     * To update the undo redo collection in spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/updateUndoRedoCollection/index.md' %}{% endcodeBlock %}\n     *\n     * @param {object} args - options for undo redo.\n     * @returns {void} - To update the undo redo collection in spreadsheet.\n     */\n    Spreadsheet.prototype.updateUndoRedoCollection = function (args) {\n        this.notify(updateUndoRedoCollection, { args: args, isPublic: true });\n    };\n    /**\n     * Adds the defined name to the Spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/addDefinedName/index.md' %}{% endcodeBlock %}\n     *\n     * @param {DefineNameModel} definedName - Specifies the name, scope, comment, refersTo.\n     * @returns {boolean} - Return the added status of the defined name.\n     */\n    Spreadsheet.prototype.addDefinedName = function (definedName) {\n        var eventArgs = {\n            action: 'addDefinedName',\n            isAdded: false,\n            definedName: definedName\n        };\n        this.notify(formulaOperation, eventArgs);\n        return eventArgs.isAdded;\n    };\n    /**\n     * Removes the defined name from the Spreadsheet.\n     *\n     * {% codeBlock src='spreadsheet/removeDefinedName/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} definedName - Specifies the name.\n     * @param {string} scope - Specifies the scope of the defined name.\n     * @returns {boolean} - Return the removed status of the defined name.\n     */\n    Spreadsheet.prototype.removeDefinedName = function (definedName, scope) {\n        return _super.prototype.removeDefinedName.call(this, definedName, scope);\n    };\n    Spreadsheet.prototype.mouseClickHandler = function (e) {\n        this.notify(click, e);\n    };\n    Spreadsheet.prototype.mouseDownHandler = function (e) {\n        this.notify(mouseDown, e);\n    };\n    Spreadsheet.prototype.keyUpHandler = function (e) {\n        if (closest(e.target, '.e-find-dlg')) {\n            this.notify(findKeyUp, e);\n        }\n        else {\n            this.notify(keyUp, e);\n        }\n    };\n    Spreadsheet.prototype.keyDownHandler = function (e) {\n        if (!closest(e.target, '.e-findtool-dlg')) {\n            this.notify(keyDown, e);\n        }\n    };\n    Spreadsheet.prototype.freeze = function (e) {\n        var args = { row: e.row, column: e.column,\n            cancel: false, sheetIndex: this.activeSheetIndex };\n        this.notify(beginAction, { eventArgs: args, action: 'freezePanes' });\n        if (args.cancel) {\n            return;\n        }\n        this.on(contentLoaded, this.freezePaneUpdated, this);\n        // const indexes: number[] = getCellIndexes(this.getActiveSheet().topLeftCell);\n        if (e.row || e.column) {\n            var hasFilter = false;\n            this.notify(getFilteredCollection, null);\n            if (this.filterCollection) {\n                for (var i = 0, len = this.filterCollection.length; i < len; i++) {\n                    if (this.filterCollection[i].sheetIndex === this.activeSheetIndex) {\n                        hasFilter = true;\n                        break;\n                    }\n                }\n            }\n            if (hasFilter) {\n                this.clearFilter();\n            }\n        }\n        this.freezePanes(e.row, e.column);\n        this.notify(refreshRibbonIcons, null);\n    };\n    Spreadsheet.prototype.freezePaneUpdated = function () {\n        this.off(contentLoaded, this.freezePaneUpdated);\n        var sheet = this.getActiveSheet();\n        this.notify(completeAction, { eventArgs: { row: sheet.frozenRows, column: sheet.frozenColumns,\n                sheetIndex: this.activeSheetIndex }, action: 'freezePanes' });\n    };\n    /**\n     * Binding events to the element while component creation.\n     *\n     * @returns {void} - Binding events to the element while component creation.\n     */\n    Spreadsheet.prototype.wireEvents = function () {\n        EventHandler.add(this.element, 'click', this.mouseClickHandler, this);\n        EventHandler.add(this.element, getStartEvent(), this.mouseDownHandler, this);\n        EventHandler.add(this.element, 'keyup', this.keyUpHandler, this);\n        EventHandler.add(this.element, 'keydown', this.keyDownHandler, this);\n        EventHandler.add(this.element, 'noderefresh', this.refreshNode, this);\n        this.on(freeze, this.freeze, this);\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     *\n     * @returns {void} - Destroys the component\n     */\n    Spreadsheet.prototype.destroy = function () {\n        if (this[isReact]) {\n            this[clearTemplate]();\n        }\n        this.unwireEvents();\n        this.notify(spreadsheetDestroyed, null);\n        _super.prototype.destroy.call(this);\n        this.element.innerHTML = '';\n        this.element.removeAttribute('tabindex');\n        this.element.removeAttribute('role');\n        this.element.style.removeProperty('height');\n        this.element.style.removeProperty('width');\n        this.element.style.removeProperty('min-height');\n        this.element.style.removeProperty('min-width');\n    };\n    /**\n     * Unbinding events from the element while component destroy.\n     *\n     * @returns {void} - Unbinding events from the element while component destroy.\n     */\n    Spreadsheet.prototype.unwireEvents = function () {\n        EventHandler.remove(this.element, 'click', this.mouseClickHandler);\n        EventHandler.remove(this.element, getStartEvent(), this.mouseDownHandler);\n        EventHandler.remove(this.element, 'keyup', this.keyUpHandler);\n        EventHandler.remove(this.element, 'keydown', this.keyDownHandler);\n        EventHandler.remove(this.element, 'noderefresh', this.refreshNode);\n        this.off(freeze, this.freeze);\n    };\n    /**\n     * To add context menu items.\n     *\n     * {% codeBlock src='spreadsheet/addContextMenu/index.md' %}{% endcodeBlock %}\n     *\n     * @param {MenuItemModel[]} items - Items that needs to be added.\n     * @param {string} text - Item before / after that the element to be inserted.\n     * @param {boolean} insertAfter - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     * @returns {void} - To add context menu items.\n     */\n    Spreadsheet.prototype.addContextMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        this.notify(addContextMenuItems, { items: items, text: text, insertAfter: insertAfter, isUniqueId: isUniqueId });\n    };\n    /**\n     * To remove existing context menu items.\n     *\n     * {% codeBlock src='spreadsheet/removeContextMenuItems/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string[]} items - Items that needs to be removed.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     * @returns {void} - To remove existing context menu items.\n     */\n    Spreadsheet.prototype.removeContextMenuItems = function (items, isUniqueId) {\n        this.notify(removeContextMenuItems, { items: items, isUniqueId: isUniqueId });\n    };\n    /**\n     * To enable / disable context menu items.\n     *\n     * {% codeBlock src='spreadsheet/enableContextMenuItems/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     * @returns {void} - To enable / disable context menu items.\n     */\n    Spreadsheet.prototype.enableContextMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableContextMenuItems, { items: items, enable: enable, isUniqueId: isUniqueId });\n    };\n    /**\n     * To enable / disable file menu items.\n     *\n     * {% codeBlock src='spreadsheet/enableFileMenuItems/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId - Set `true` if the given file menu items `text` is a unique id.\n     * @returns {void} - To enable / disable file menu items.\n     */\n    Spreadsheet.prototype.enableFileMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableFileMenuItems, { items: items, enable: enable, isUniqueId: isUniqueId });\n    };\n    /**\n     * To show/hide the file menu items in Spreadsheet ribbon.\n     *\n     * {% codeBlock src='spreadsheet/hideFileMenuItems/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string[]} items - Specifies the file menu items text which is to be show/hide.\n     * @param {boolean} hide - Set `true` / `false` to hide / show the file menu items.\n     * @param {boolean} isUniqueId - Set `true` if the given file menu items `text` is a unique id.\n     * @returns {void} - To show/hide the file menu items in Spreadsheet ribbon.\n     */\n    Spreadsheet.prototype.hideFileMenuItems = function (items, hide, isUniqueId) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideFileMenuItems, { items: items, hide: hide, isUniqueId: isUniqueId });\n    };\n    /**\n     * To add custom file menu items.\n     *\n     * {% codeBlock src='spreadsheet/addFileMenuItems/index.md' %}{% endcodeBlock %}\n     *\n     * @param {MenuItemModel[]} items - Specifies the ribbon file menu items to be inserted.\n     * @param {string} text - Specifies the existing file menu item text before / after which the new file menu items to be inserted.\n     * @param {boolean} insertAfter - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId - Set `true` if the given file menu items `text` is a unique id.\n     * @returns {void} - To add custom file menu items.\n     */\n    Spreadsheet.prototype.addFileMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        this.notify(addFileMenuItems, { items: items, text: text, insertAfter: insertAfter, isUniqueId: isUniqueId });\n    };\n    /**\n     * To show/hide the existing ribbon tabs.\n     *\n     * {% codeBlock src='spreadsheet/hideRibbonTabs/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string[]} tabs - Specifies the tab header text which needs to be shown/hidden.\n     * @param {boolean} hide - Set `true` / `false` to hide / show the ribbon tabs.\n     * @returns {void} - To show/hide the existing ribbon tabs.\n     */\n    Spreadsheet.prototype.hideRibbonTabs = function (tabs, hide) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideRibbonTabs, { tabs: tabs, hide: hide });\n    };\n    /**\n     * To enable / disable the existing ribbon tabs.\n     *\n     * {% codeBlock src='spreadsheet/enableRibbonTabs/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string[]} tabs - Specifies the tab header text which needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the ribbon tabs.\n     * @returns {void} - To enable / disable the existing ribbon tabs.\n     */\n    Spreadsheet.prototype.enableRibbonTabs = function (tabs, enable) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableRibbonTabs, { tabs: tabs, enable: enable });\n    };\n    /**\n     * To add custom ribbon tabs.\n     *\n     * {% codeBlock src='spreadsheet/addRibbonTabs/index.md' %}{% endcodeBlock %}\n     *\n     * @param {RibbonItemModel[]} items - Specifies the ribbon tab items to be inserted.\n     * @param {string} insertBefore - Specifies the existing ribbon header text before which the new tabs will be inserted.\n     * If not specified, the new tabs will be inserted at the end.\n     * @returns {void} - To add custom ribbon tabs.\n     */\n    Spreadsheet.prototype.addRibbonTabs = function (items, insertBefore) {\n        this.notify(addRibbonTabs, { items: items, insertBefore: insertBefore });\n    };\n    /**\n     * Enables or disables the specified ribbon toolbar items or all ribbon items.\n     *\n     * {% codeBlock src='spreadsheet/enableToolbarItems/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} tab - Specifies the ribbon tab header text under which the toolbar items need to be enabled / disabled.\n     * @param {number[]} items - Specifies the toolbar item indexes / unique id's which needs to be enabled / disabled.\n     * If it is not specified the entire toolbar items will be enabled / disabled.\n     * @param  {boolean} enable - Boolean value that determines whether the toolbar items should be enabled or disabled.\n     * @returns {void} - Enables or disables the specified ribbon toolbar items or all ribbon items.\n     */\n    Spreadsheet.prototype.enableToolbarItems = function (tab, items, enable) {\n        this.notify(enableToolbarItems, [{ tab: tab, items: items, enable: enable === undefined ? true : enable }]);\n    };\n    /**\n     * To show/hide the existing Spreadsheet ribbon toolbar items.\n     *\n     * {% codeBlock src='spreadsheet/hideToolbarItems/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items needs to be hidden / shown.\n     * @param {number[]} indexes - Specifies the toolbar indexes which needs to be shown/hidden from UI.\n     * @param {boolean} hide - Set `true` / `false` to hide / show the toolbar items.\n     * @returns {void} - To show/hide the existing Spreadsheet ribbon toolbar items.\n     */\n    Spreadsheet.prototype.hideToolbarItems = function (tab, indexes, hide) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideToolbarItems, { tab: tab, indexes: indexes, hide: hide });\n    };\n    /**\n     * To add the custom items in Spreadsheet ribbon toolbar.\n     *\n     * {% codeBlock src='spreadsheet/addToolbarItems/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items will be inserted.\n     * @param {ItemModel[]} items - Specifies the ribbon toolbar items that needs to be inserted.\n     * @param {number} index - Specifies the index text before which the new items will be inserted.\n     * If not specified, the new items will be inserted at the end of the toolbar.\n     * @returns {void} - To add the custom items in Spreadsheet ribbon toolbar.\n     */\n    Spreadsheet.prototype.addToolbarItems = function (tab, items, index) {\n        this.notify(addToolbarItems, { tab: tab, items: items, index: index });\n    };\n    /**\n     * Selects the cell / range of cells with specified address.\n     *\n     * {% codeBlock src='spreadsheet/selectRange/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} address - Specifies the range address.\n     * @returns {void} - To select the range.\n     */\n    Spreadsheet.prototype.selectRange = function (address) {\n        this.notify(selectRange, { address: address });\n    };\n    /**\n     * Start edit the active cell.\n     *\n     * {% codeBlock src='spreadsheet/startEdit/index.md' %}{% endcodeBlock %}\n     *\n     * @returns {void} - Start edit the active cell.\n     */\n    Spreadsheet.prototype.startEdit = function () {\n        this.notify(editOperation, { action: 'startEdit', isNewValueEdit: false });\n    };\n    /**\n     * Cancels the edited state, this will not update any value in the cell.\n     *\n     * {% codeBlock src='spreadsheet/closeEdit/index.md' %}{% endcodeBlock %}\n     *\n     * @returns {void} - Cancels the edited state, this will not update any value in the cell.\n     */\n    Spreadsheet.prototype.closeEdit = function () {\n        this.notify(editOperation, { action: 'cancelEdit' });\n    };\n    /**\n     * If Spreadsheet is in editable state, you can save the cell by invoking endEdit.\n     *\n     * {% codeBlock src='spreadsheet/endEdit/index.md' %}{% endcodeBlock %}\n     *\n     * @returns {void} - If Spreadsheet is in editable state, you can save the cell by invoking endEdit.\n     */\n    Spreadsheet.prototype.endEdit = function () {\n        this.notify(editOperation, { action: 'endEdit' });\n    };\n    /**\n     * Called internally if any of the property value changed.\n     *\n     * @param  {SpreadsheetModel} newProp - Specify the new properties\n     * @param  {SpreadsheetModel} oldProp - Specify the old properties\n     * @returns {void} - Called internally if any of the property value changed.\n     * @hidden\n     */\n    Spreadsheet.prototype.onPropertyChanged = function (newProp, oldProp) {\n        var _this = this;\n        _super.prototype.onPropertyChanged.call(this, newProp, oldProp);\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            var header = void 0;\n            var addBtn = void 0;\n            switch (prop) {\n                case 'enableRtl':\n                    header = this.getColumnHeaderContent();\n                    if (header) {\n                        header = header.parentElement;\n                    }\n                    if (!header) {\n                        break;\n                    }\n                    if (newProp.enableRtl) {\n                        header.style.marginLeft = getScrollBarWidth() + 'px';\n                        header.style.marginRight = '';\n                        document.getElementById(this.element.id + '_sheet_panel').classList.add('e-rtl');\n                    }\n                    else {\n                        header.style.marginRight = getScrollBarWidth() + 'px';\n                        header.style.marginLeft = '';\n                        document.getElementById(this.element.id + '_sheet_panel').classList.remove('e-rtl');\n                    }\n                    this.renderModule.refreshSheet();\n                    break;\n                case 'cssClass':\n                    if (oldProp.cssClass) {\n                        removeClass([this.element], oldProp.cssClass.split(' '));\n                    }\n                    if (newProp.cssClass) {\n                        addClass([this.element], newProp.cssClass.split(' '));\n                    }\n                    break;\n                case 'activeSheetIndex':\n                    this.renderModule.refreshSheet();\n                    this.notify(activeSheetChanged, { idx: newProp.activeSheetIndex });\n                    break;\n                case 'width':\n                    this.setWidth();\n                    this.resize();\n                    break;\n                case 'height':\n                    this.setHeight();\n                    this.resize();\n                    break;\n                case 'showRibbon':\n                    this.notify(ribbon, { uiUpdate: true });\n                    break;\n                case 'showFormulaBar':\n                    this.notify(formulaBar, { uiUpdate: true });\n                    break;\n                case 'showSheetTabs':\n                    this.notify(sheetTabs, null);\n                    break;\n                case 'cellStyle':\n                    this.renderModule.refreshSheet();\n                    break;\n                case 'allowEditing':\n                    if (this.allowEditing) {\n                        this.notify(editOperation, { action: 'renderEditor' });\n                    }\n                    break;\n                case 'allowInsert':\n                    addBtn = this.element.getElementsByClassName('e-add-sheet-tab')[0];\n                    if (addBtn) {\n                        addBtn.disabled = !this.allowInsert;\n                        if (this.allowInsert) {\n                            if (addBtn.classList.contains('e-disabled')) {\n                                addBtn.classList.remove('e-disabled');\n                            }\n                        }\n                        else {\n                            if (!addBtn.classList.contains('e-disabled')) {\n                                addBtn.classList.add('e-disabled');\n                            }\n                        }\n                    }\n                    break;\n                case 'sheets':\n                    if (newProp.sheets === this.sheets) {\n                        this.renderModule.refreshSheet();\n                        this.notify(refreshSheetTabs, null);\n                        break;\n                    }\n                    Object.keys(newProp.sheets).forEach(function (sheetIdx, index) {\n                        var sheet = newProp.sheets[sheetIdx];\n                        if (sheet.ranges && Object.keys(sheet.ranges).length) {\n                            var ranges_1 = Object.keys(sheet.ranges);\n                            var newRangeIdx_1;\n                            ranges_1.forEach(function (rangeIdx, idx) {\n                                if (!sheet.ranges[rangeIdx].info) {\n                                    newRangeIdx_1 = idx;\n                                }\n                            });\n                            ranges_1.forEach(function (rangeIdx, idx) {\n                                if (sheet.ranges[rangeIdx].dataSource && (isUndefined(newRangeIdx_1)\n                                    || (!isUndefined(newRangeIdx_1) && newRangeIdx_1 === idx))) {\n                                    _this.notify(dataSourceChanged, {\n                                        sheetIdx: sheetIdx, rangeIdx: rangeIdx,\n                                        isLastRange: ranges_1.length - 1 === idx, changedData: sheet.ranges[rangeIdx].dataSource\n                                    });\n                                }\n                            });\n                        }\n                        else if (sheet.paneTopLeftCell && oldProp.sheets && oldProp.sheets[sheetIdx] &&\n                            oldProp.sheets[sheetIdx].paneTopLeftCell) {\n                            if (_this.activeSheetIndex !== Number(sheetIdx)) {\n                                return;\n                            }\n                            var cIdx = getCellIndexes(sheet.paneTopLeftCell);\n                            var pIdx = getCellIndexes(oldProp.sheets[sheetIdx].paneTopLeftCell);\n                            if (cIdx[0] != pIdx[0]) {\n                                var frozenRow = _this.frozenRowCount(_this.getActiveSheet());\n                                var top_1 = cIdx[0] > frozenRow ? getRowsHeight(_this.getActiveSheet(), frozenRow, cIdx[0] - 1) : 0;\n                                _this.notify(updateScroll, { top: top_1 });\n                            }\n                            if (cIdx[1] != pIdx[1]) {\n                                var frozenCol = _this.frozenColCount(_this.getActiveSheet());\n                                var left = cIdx[1] > frozenCol ? getColumnsWidth(_this.getActiveSheet(), frozenCol, cIdx[1] - 1) : 0;\n                                _this.notify(updateScroll, { left: left });\n                            }\n                        }\n                        else {\n                            if (index === 0) {\n                                _this.renderModule.refreshSheet();\n                            }\n                            if (_this.showSheetTabs && sheet.name) {\n                                _this.notify(sheetNameUpdate, {\n                                    items: _this.element.querySelector('.e-sheet-tabs-items').children[sheetIdx],\n                                    value: sheet.name,\n                                    idx: sheetIdx\n                                });\n                            }\n                        }\n                    });\n                    break;\n                case 'locale':\n                    this.refresh();\n                    break;\n                case 'password':\n                    if (this.password.length > 0) {\n                        if (this.showSheetTabs) {\n                            this.element.querySelector('.e-add-sheet-tab').setAttribute('disabled', 'true');\n                            this.element.querySelector('.e-add-sheet-tab').classList.add('e-disabled');\n                        }\n                    }\n                    break;\n                case 'isProtected':\n                    if (this.isProtected) {\n                        var addBtn_1 = this.element.getElementsByClassName('e-add-sheet-tab')[0];\n                        if (addBtn_1) {\n                            addBtn_1.disabled = this.isProtected;\n                            if (this.isProtected) {\n                                if (addBtn_1.classList.contains('e-disabled')) {\n                                    addBtn_1.classList.add('e-disabled');\n                                }\n                            }\n                            else {\n                                if (!addBtn_1.classList.contains('e-disabled')) {\n                                    addBtn_1.classList.remove('e-disabled');\n                                }\n                            }\n                        }\n                    }\n            }\n        }\n    };\n    /**\n     * To provide the array of modules needed for component rendering.\n     *\n     * @returns {ModuleDeclaration[]} - To provide the array of modules needed for component rendering.\n     * @hidden\n     */\n    Spreadsheet.prototype.requiredModules = function () {\n        return getRequiredModules(this);\n    };\n    /**\n     * Appends the control within the given HTML Div element.\n     *\n     * {% codeBlock src='spreadsheet/appendTo/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string | HTMLElement} selector - Target element where control needs to be appended.\n     * @returns {void} - Appends the control within the given HTML Div element.\n     */\n    Spreadsheet.prototype.appendTo = function (selector) {\n        _super.prototype.appendTo.call(this, selector);\n    };\n    /**\n     * Filters the range of cells in the sheet.\n     *\n     * @hidden\n     * @param {FilterOptions} filterOptions - specifiy the FilterOptions.\n     * @param {string} range - Specify the range\n     * @returns {Promise<FilterEventArgs>} - Filters the range of cells in the sheet.\n     */\n    Spreadsheet.prototype.filter = function (filterOptions, range) {\n        if (!this.allowFiltering) {\n            return Promise.reject();\n        }\n        range = range || this.getActiveSheet().selectedRange;\n        return _super.prototype.filter.call(this, filterOptions, range);\n    };\n    /**\n     * Clears the filter changes of the sheet.\n     *\n     * {% codeBlock src='spreadsheet/clearFilter/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} field - Specify the field.\n     * @returns {void} - To clear the filter.\n     */\n    Spreadsheet.prototype.clearFilter = function (field) {\n        if (field) {\n            this.notify(clearFilter, { field: field });\n        }\n        else {\n            _super.prototype.clearFilter.call(this);\n        }\n    };\n    /**\n     * Applies the filter UI in the range of cells in the sheet.\n     *\n     * {% codeBlock src='spreadsheet/applyFilter/index.md' %}{% endcodeBlock %}\n     *\n     * @param {PredicateModel[]} predicates - Specifies the predicates.\n     * @param {string} range - Specify the range.\n     * @returns {void} - to apply the filter.\n     */\n    Spreadsheet.prototype.applyFilter = function (predicates, range) {\n        this.notify(initiateFilterUI, { predicates: predicates, range: range });\n    };\n    /**\n     * To add custom library function.\n     *\n     *  {% codeBlock src='spreadsheet/addCustomFunction/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} functionHandler - Custom function handler name\n     * @param {string} functionName - Custom function name\n     * @returns {void} - To add custom function.\n     */\n    Spreadsheet.prototype.addCustomFunction = function (functionHandler, functionName) {\n        _super.prototype.addCustomFunction.call(this, functionHandler, functionName);\n        this.notify(refreshFormulaDatasource, null);\n    };\n    var Spreadsheet_1;\n    __decorate([\n        Property('')\n    ], Spreadsheet.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowScrolling\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowResizing\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableClipboard\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableContextMenu\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableKeyboardNavigation\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableKeyboardShortcut\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowUndoRedo\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowWrap\", void 0);\n    __decorate([\n        Complex({}, SelectionSettings)\n    ], Spreadsheet.prototype, \"selectionSettings\", void 0);\n    __decorate([\n        Complex({}, ScrollSettings)\n    ], Spreadsheet.prototype, \"scrollSettings\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeCellRender\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"select\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuBeforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dialogBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuBeforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeDataBound\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dataBound\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dataSourceChanged\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellEdit\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellEditing\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellSave\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeCellSave\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeSort\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeHyperlinkCreate\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"afterHyperlinkCreate\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeHyperlinkClick\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"afterHyperlinkClick\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeConditionalFormat\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"actionBegin\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"actionComplete\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"openComplete\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"sortComplete\", void 0);\n    Spreadsheet = Spreadsheet_1 = __decorate([\n        NotifyPropertyChanges\n    ], Spreadsheet);\n    return Spreadsheet;\n}(Workbook));\nexport { Spreadsheet };\n"],"names":["getRangeIndexes","range","cellindexes","indexes","indexOf","split","forEach","address","getCellIndexes","push","parseInt","match","getColIndex","toUpperCase","text","colIdx","i","reverse","join","length","charCodeAt","Math","pow","getCellAddress","sRow","sCol","getColumnHeaderText","getRangeAddress","isNullOrUndefined","colIndex","floor","String","fromCharCode","getIndexesFromAddress","getRangeFromAddress","getAddressFromSelectedRange","sheet","name","selectedRange","getAddressInfo","context","sIdx","getSheetIndex","getSheetNameFromAddress","activeSheetIndex","sheetIndex","indices","getSwapRange","clonedRange","slice","swap","x","y","tmp","isSingleCell","executeTaskAsync","taskFn","callbackFn","data","preventCallback","WorkerHelper","toFraction","val","strVal","toString","top_1","bottom","replace","abs","getGcd","a","b","Number","intToDate","startDate","Date","startDateUTC","UTC","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","toUTCString","dateToInt","isTime","isTimeOnly","date","isDateTime","diffDays","Object","prototype","call","isNaN","valueOf","isNumber","parseFloat","toDate","intl","locale","format","defaultDateFormats","IntlBase","getDependables","cldrData","dateObject","availabelDateTimeFormat","dateTimeFormats","availableFormats","dObj","dateObj","isCustom","type","parseDate","_i","_a","keys","dateFormats","key","skeleton","_b","_c","time","toLocaleTimeString","_d","_e","timeFormats","parseIntValue","value","test","getFormatFromType","code","getTypeFromFormat","getSkeletonVal","getModules","modules","includeBasicFormulas","member","args","getValue","nameSpace","obj","splits","j","isUndefined","setValue","keyValues","start","fromObj","undefined","getAlphalabel","col","cols","n","aCharNo","chs","getWorkbookRequiredModules","allowSave","allowOpen","allowEditing","allowNumberFormatting","allowCellFormatting","allowSorting","allowHyperlink","allowFiltering","allowFindAndReplace","allowInsert","allowDelete","allowDataValidation","allowMerge","allowImage","allowChart","checkIsFormula","isEditing","isCellReference","rangeSplit","isValidCellReference","isChar","inRange","rowIdx","isInRange","testRange","isModify","isLocked","cell","column","endNum","numArr","cellText","textLength","cellTextLength","substring","cellNumber","getUpdatedFormula","currIndexes","prevIndexes","prevCell","cIdxValue","getCell","formula","formulaOperators","splitArray","newAddress","newRef","refObj","newRange","includes","splice","objKey","RegExp","getDataRange","prevleftIdx","prevrightIdx","topReached","btmReached","leftReached","rightReached","topIdx","btmIdx","leftIdx","rightIdx","rowIndex","isInitRow","returnEmptyObjIfNull","row","getRow","cells","rows","setCell","isExtend","extend","skipDefaultValue","style","defaultKey","defaultProps","fontFamily","verticalAlign","textIndent","backgroundColor","color","textAlign","fontSize","fontWeight","fontStyle","textDecoration","border","borderLeft","borderTop","borderRight","borderBottom","changedProps","propName","wrap","addressInfo","rng","getSheet","setProperties","sheets","notify","wrapEvent","getData","columnWiseData","valueOnly","frozenIndexes","filterDialog","formulaCellRef","idx","skipHiddenRows","Promise","resolve","reject","Map","sheetIdx","index","promise","updateSheetFromDataSource","then","frozenRow","frozenRowCount","frozenCol","frozenColCount","isHiddenRow","getDisplayText","isDate","checkDateFormat","getValueFromFormat","eventArgs","trigger","queryCellInfo","cellObj","assign","colSpan","rowSpan","len","k","len_1","isHiddenCol","set","processIdx","model","isSheet","cnt","out_i_1","diff","_loop_1","createSheet","id","getMaxSheetId","properties","setSheetPropertyOnMute","getSheetNameCount","cellCnt_1","max","clearRange","sCIdx","eCIdx","cellValue","sRIdx","eRIdx","cellIdx","isUnique","uniqueRange","checkUniqueRange","skip","rangeIndex","cFDelete","hyperlink","workbookFormulaOperation","action","toLowerCase","getSheetIndexFromId","getSheetIndexByName","info","updateSelectedRange","isMultiRange","getSingleSelectedRange","sheetNameCount","initSheet","rowCount","colCount","topLeftCell","activeCell","usedRange","ranges","columns","showHeaders","showGridLines","state","maxHgts","protectSettings","selectCells","formatCells","formatRows","formatColumns","insertLink","isProtected","paneTopLeftCell","frozenRows","frozenColumns","initRow","getSheetName","moveSheet","position","sheetIndexes","needRefresh","startIndex","isPrevious","getNextPrevVisibleSheetIndex","cancel","moveOrDuplicateSheet","refresh","duplicateSheet","originalSheet","name_1","sheetNames_1","sheetName","visibleName","isDuplicate","setRow","hidden","getRowHeight","checkDPR","hgt","height","window","devicePixelRatio","pointValue","setRowHeight","getRowsHeight","startRow","endRow","getColumn","setColumn","curColumn","getColumnWidth","skipHidden","width","customWidth","getColumnsWidth","startCol","endCol","getRequiredModules","showRibbon","showFormulaBar","showSheetTabs","enableContextMenu","selectionSettings","mode","enableKeyboardNavigation","enableKeyboardShortcut","enableClipboard","allowResizing","allowUndoRedo","allowWrap","allowConditionalFormat","pushBasicModules","getUpdateUsingRaf","fn","requestAnimationFrame","removeAllChildren","parent","firstChild","removeChild","getColGroupWidth","getScrollBarWidth","scrollAreaWidth","htmlDivNode","document","createElement","result","cssText","body","appendChild","offsetWidth","clientWidth","getSiblingsHeight","element","classList","classes","getHeightFromDirection","direction","sibling","some","contains","offsetHeight","inView","scrollSettings","enableVirtualization","inView_1","viewport","topIndex","leftIndex","bottomIdx","getThreshold","getActiveSheet","insideViewport","getCellPosition","frozenColumn","freezeScrollHeight","freezeScrollWidth","rowHdrWidth","offset","size","top","left","setPosition","ele","cls","content_1","frozenRow_1","frozenCol_1","display","rangeEle","getSelectAllContent","getColumnHeaderContent","getRowHeaderContent","querySelector","cloneNode","locateElem","enableRtl","beforeFreezeHeight","beforeFreezeWidth","sheetModule","colGroupWidth","removeRangeEle","swapRange","add","ranges_1","removeEle_1","getMainContent","subRng","getElementsByClassName","detach","parentElement","remove","content","checkElement","checkActiveCell","isRtl","isActiveCell","cellPosition","skipHiddenIdx","attrs","getDPRValue","setStyleAttribute","styles","setBaseStyleAttribute","getStartEvent","Browser","isPointer","getMoveEvent","getEndEvent","isTouchStart","e","pointerType","isTouchMove","isTouchEnd","isMouseDown","isMouseMove","isMouseUp","getClientX","changedTouches","clientX","getClientY","clientY","preventDecrease","setAriaOptions","target","options","setAttribute","config","destroyComponent","component","compObj","getComponent","destroy","setResize","isCol","curEle","curEleH","curEleC","preEle","preEleH","preEleC","nxtEle","nxtEleH","nxtEleC","header","getElementsByTagName","getRowHeaderTable","hdrFntSize","hdrRow","hdrClone","findMaxValue","contentRow","contentClone","idx_1","cntFntSize","getContentTable","fntSize","lineHeight","removeProperty","previousElementSibling","nextElementSibling","setWidthAndHeight","nxtIndex","getAttribute","getColHeaderTable","DPRValue","trgt","table","prevData","isWrap","myTableDiv","className","myTable","myTr","tr","offsetWidthValue","offsetHeightValue","tableMaxWidth","getBoundingClientRect","tableMaxHeight","ceil","updateAction","spreadsheet","isRedo","undoCollections","chartElement","sortArgs","cellEvtArgs","sortOptions","initiateSort","serviceLocator","getService","refreshRange","updateCell","requestType","borderType","cellFormat","setBorder","numberFormat","copiedInfo","isCut","cut","copiedRange","copy","paste","pastedRange","isShow","hide","setColWidth","hideColumn","hideRow","removeSheetTab","isAction","count","sheetCount","clicked","endIndex","compareVal","initiateFilterUI","predicates","delete","modelType","insertModel","end","checkCount","deletedModel","columnCellsModel","deletedCellsModel","rules","operator","value1","value2","ignoreBlank","inCellDropDown","setValidation","removeValidation","rIdx","rCnt","cIdx","cCnt","setMerge","clearViewer","isPublic","conditionalFormat","cFColor","setCFRule","isUndoRedo","clearCFRule","undoCollIdx","cFUndo","isClearCF","clearCells","conditionalFormats","cFormats","oldRange","createImageElement","src","imageData","imageHeight","imageWidth","imageId","deleteImage","getElementById","refreshImgCellObj","prevTop","currentTop","prevLeft","currentLeft","currentHeight","prevHeight","currentWidth","prevWidth","chartOptions","theme","isSeriesInRows","setChart","chart","isInitCell","posRange","deleteChart","chartOpts","refreshChartSize","overlayEle","hasTemplate","workbook","template","startCell","setRowEleHeight","hRow","notifyRowHgtChange","prevHgt","dprHgt","rowHeightChanged","threshold","getTextHeight","lines","cellStyle","getLineHeight","getTextWidth","parentStyle","getContext","font","measureText","getLines","colwidth","textArr","spaceWidth","txt","lWidth","cWidth","getBorderHeight","bottomSideCell","getExcludedColumnWidth","startColIdx","endColIdx","rightSideCell","getBorderWidth","getTextHeightWithBorder","setMaxHgt","getMaxHgt","maxHgt","rowHgt","increase","layout","focus","activeElement","isIE","scrollX_1","scrollX","scrollY_1","scrollY","scrollTo","preventScroll","isLockedCells","rangeIndexes","hasLockCell","task","defaultListener","taskData","this","workerTask","workerData","initWorker","terminate","worker","URL","revokeObjectURL","workerUrl","taskBlob","Blob","getFnCode","createObjectURL","Worker","onmessage","messageFromWorker","bind","onerror","onError","postMessage","apply","message","workerCode","workerFunction","isHaveFunction","getMessageFn","getCallbackMessageFn","workbookDestroyed","dataSourceChanged","dataChanged","triggerDataChange","workbookOpen","beginSave","sortImport","ribbonFind","getFilteredCollection","getUniqueRange","removeUniquecol","saveCompleted","applyNumberFormatting","getFormattedCellObject","refreshCellElement","setCellFormat","findAllValues","textDecorationUpdate","applyCellFormat","updateUsedRange","workbookEditOperation","getFormattedBarText","activeCellChanged","openSuccess","openFailure","sheetCreated","sheetsDestroyed","aggregateComputation","sortComplete","beforeHyperlinkCreate","afterHyperlinkCreate","beforeHyperlinkClick","afterHyperlinkClick","setLinkModel","initiateFilter","filterRangeAlert","clearAllFilter","onSave","insert","deleteAction","deleteModel","isValidation","addHighlight","findNext","findPrevious","goto","replaceHandler","replaceAllHandler","showDialog","findUndoRedo","findKeyUp","removeHighlight","protectSheetWorkBook","updateToggle","protectsheetHandler","replaceAllDialog","unprotectsheetHandler","setLockCells","applyLockCells","applyMerge","mergedRange","activeCellMergedRange","insertMerge","pasteMerge","cFInitialCheck","cFRender","clear","clearCF","setImage","initiateChart","refreshRibbonIcons","refreshChart","updateChart","deleteChartColl","focusChartBorder","saveError","validationHighlight","dataRefresh","updateFilter","beforeInsert","beforeDelete","deleteHyperlink","refreshClipboard","updateView","WorkbookNumberFormat","localeObj","getNumericObject","decimalSep","decimal","groupSep","group","addEventListener","numberFormatting","getFormattedCell","fResult","rightAlign","option","Internationalization","getNumberFormat","currencySymbol","getNumberDependable","currency","dateEventArgs","updatedVal","processFormats","isRightAlign","curSymbol","onLoad","setUsedRange","formattedText","currencyCode","autoDetectGeneralFormat","curCode","applyNumberFormat","currencyFormat","percentageFormat","accountingFormat","shortDateFormat","longDateFormat","timeFormat","fractionFormat","scientificFormat","res","trim","getPercentageFormat","findSuffix","zeros","resultSuffix","suffixLen","substr","isCustomFormat","formatArr","formatDecimalLen","replaceString","formatNumber","getFormatForOtherCurrency","symbol","shortDate","formatDate","longDate","prefix","findDecimalPlaces","toExponential","fractionResult","suffix","eIndex","decIndex","checkedDate","checkCustomDateFormat","dateArr","months","filter","month","state_1","formattedBarText","beforeText","on","removeEventListener","isDestroyed","off","getModuleName","DataBind","requestedInfo","updateSheetFromDataSourceHandler","dataSourceChangedHandler","dataChangedHandler","triggerDataChangeHandler","flds","sCellIdx","remoteUrl","dataManager","sRowIdx","sColIdx","loadedInfo","_this","requestedRange","sRanges","deferred","Deferred","sRange","eRange","dataSource","DataManager","url","isLocalData","showFieldAsHeader","isEndReached","insertRowCount","this_1","initRangeInfo","getMaxCount","getLoadedInfo","unloadedRange","insertRowRange","isNotLoaded","query","Query","clone","executeQuery","requiresCount","fldLen","insertColumnRange","insertCount_1","insertRange","field","dataSourceChange","curSheetIdx_1","item","getCellDataFromProp","checkDataForFormat","loadedRange","rangeSettingCount","unloadedArgs","pop","notfyFormulaCellRefresh","checkResolve","formulaRefCell","refreshing","resolved","isSameRng","JSON","stringify","isLoaded","prop","queries","min","nos","rangeIdx","checkRangeHasChanges","showFieldAsHeader_1","indexes_1","refreshRange_1","bottomIndex","rightIndex","checkWrap","changedData","isAngular","changedRangeIdx","dataRange","inRangeCut","deleteRowDetails","cellIndices","cutIndices","isNewRow","concat","insertType","isDataRequest","dataRangeIndices","addedCutData_1","_loop_2","fld","getFormattedValue","_loop_3","isUndo","ribbon","formulaBar","sheetTabs","refreshSheetTabs","isFormulaBarEdit","initialLoad","contentLoaded","mouseDown","spreadsheetDestroyed","editOperation","formulaOperation","formulaBarOperation","click","keyUp","keyDown","onVerticalScroll","onHorizontalScroll","beforeContentLoaded","beforeVirtualContentLoaded","virtualContentLoaded","cellNavigate","mouseUpAfterSelection","selectionComplete","cMenuBeforeOpen","insertSheetTab","renameSheetTab","ribbonClick","enableToolbarItems","tabSwitch","selectRange","clearCopy","beforeDataBound","addContextMenuItems","removeContextMenuItems","enableContextMenuItems","enableFileMenuItems","hideFileMenuItems","addFileMenuItems","hideRibbonTabs","enableRibbonTabs","addRibbonTabs","addToolbarItems","hideToolbarItems","beforeRibbonCreate","colWidthChanged","onContentScroll","deInitProperties","activeSheetChanged","renameSheet","initiateCustomSort","applySort","collaborativeUpdate","hideShow","autoFit","updateToggleItem","initiateHyperlink","editHyperlink","openHyperlink","createHyperlinkElement","sheetNameUpdate","hideSheet","performUndoRedo","updateUndoRedoCollection","setActionData","getBeforeActionData","clearUndoRedoCollection","renderFilterCell","reapplyFilter","filterByCellValue","clearFilter","getFilteredColumn","completeAction","beginAction","filterCellKeyDown","getFilterRange","setAutoFit","refreshFormulaDatasource","setScrollEvent","initiateDataValidation","invalidData","protectSheet","applyProtect","protectCellFormat","gotoDlg","findDlg","findHandler","created","editAlert","setUndoRedo","enableFormulaInput","protectSelection","hiddenMerge","checkPrevMerge","checkMerge","removeDataValidation","showAggregate","initiateConditionalFormat","checkConditionalFormat","setCF","initiateFormulaReference","initiateCur","clearCellRef","editValue","addressHandle","initiateEdit","forRefSelRender","blankWorkbook","insertImage","refreshImgElem","getRowIdxFromClientY","getColIdxFromClientX","refreshChartCellObj","refreshImagePosition","updateTableWidth","focusBorder","clearChartBorder","insertChart","chartRangeSelection","insertDesignChart","removeDesignChart","chartDesignTab","addChartEle","isReact","renderReactTemplates","clearTemplate","protectWorkbook","unProtectWorkbook","getPassWord","importProtectWorkbook","selectionStatus","freeze","overlayEleSize","updateScroll","WorkbookOpen","open","jsonObject","fetchSuccess","formData","FormData","file","append","passWord","password","requestData","method","fetch","openUrl","response","ok","json","status","statusText","catch","error","fetchFailure","isOpen","impData","parse","Workbook","updateModel","removeAttribute","workbookModel","setSelectAllRange","definedNames","filterCollection","sortCollection","isImport","selectedIndex","SaveWorker","processSheet","Array","isArray","processSave","saveJSON","saveSettings","customParams","blob","reader","FileReader","onload","str","atob","dialog","readAsDataURL","__extends","extendStatics","d","setPrototypeOf","__proto__","p","hasOwnProperty","__","constructor","create","WorkbookSave","_super","isProcessCompleted","isFullPost","needBlobData","events.beginSave","initiateSave","events.getFilteredCollection","saveType","fileName","updateBasicSettings","processSheets","jsonStr","getStringifyObject","basicSettings","skipProps","updateSheet","getSheetLength","save","events.onSave","initiateFullPostSave","updateSaveResult","blobData","events.saveError","ClientFileDownload","events.saveCompleted","anchor","download","getFileNameWithExtension","href","formElem","inputElem","submit","skipProp","filename","fileExt","getFileExtension","lastIndexOf","CalculateCommon","ModuleLoader","loadedModules","inject","requiredModules","moduleList","reqLengthVal","clearUnusedModule","modl","moduleList_1","module","modName","isModuleLoaded","moduleObject","createInstance","memberName","getMemberName","isProperty","loadedModule","clean","classFunction","params","arrayParam","unshift","Function","moduleListName","usedModule","map","arg","removeModule_1","moduleName","deleteObject","CommonErrors","FormulasErrorsStrings","BasicFormulas","formulas","formulaName","category","description","isConcat","init","addFormulaCollection","functionName","formulaCategory","libraryFormulas","fName","handler","ComputeSUM","arguments","formulaErrorStrings","invalid_arguments","orgValue","sum","argArr","argValue","cellCollection","getCellCollection","tic","getValueFromArg","getErrorStrings","trueValue","falseValue","ComputeT","ComputeINT","num","ComputeTODAY","dt","now","calculateDate","ComputeSUMPRODUCT","mulValues","startsWith","s1","col1","col2","cellRef","getSheetReference","convertAlpha","ComputeROUNDUP","arg1","arg2","toFixed","digits","ComputeCOUNT","wrong_number_arguments","argVal","cellColl","ComputeDATE","year","day","days","getSerialDateFromDate","fromOADate","ComputeFLOOR","fnum","significance","argCount","splitArg","divzero","ComputeCEILING","cnum","ComputeDAY","serialNumber","dateVal","ComputeIF","skipTick","condition","requires_3_args","ComputeIFERROR","arithMarker","ComputePRODUCT","parseVal","product","argsHit","rangevalue","ComputeDAYS","argsArr","endDate","toDateString","d1","d2","getTime","round","ComputeUNIQUE","byCol","exactlyOne","uniqueCollection","dependencyCollection","clearDependency","endRowIdx","cellRange","colDiff","cellValues","temp","rowDiff","j_1","tmp2","exactOne","actCell","actRowIdx","actColIdx","dependencyLevel","j_2","diff2","splitValue","j_3","spill","j_4","j_5","i_1","parentObject","setValueRowCol","getSheetID","grid","i_2","formulaText","getFormulaInfoTable","get","getFormulaText","j_6","ComputeCHOOSE","cond","indexNum","ComputeSUMIF","improper_formula","computeSumIfAndAvgIf","ComputeABS","absValue","absVal","cellvalue","ComputeAVERAGE","calculateAvg","ComputeAVERAGEIF","argList","resultVal","ComputeCONCATENATE","argsList","tempStr","i_3","ComputeCONCAT","ComputeMAX","computeMinMax","ComputeMIN","ComputeRAND","random","ComputeAND","computeAndOr","ComputeOR","ComputeFIND","findText","removeTics","withinText","startNum","loc","ComputeINDEX","ref","rangeValue","rangeArr","i_4","sheetToken","ComputeIFS","na","ComputeCOUNTA","ComputeAVERAGEA","cellCol","parseValue","argArrs","ComputeSORT","order","valueCollection","eRowIdx","eColIdx","parseDouble","colSort","totalColumn","sortedVal","DataUtil","sort","fnSort","rowInc","colInc","ComputeCOUNTIF","stack","op","findWildCardValue","processLogical","ComputeSUMIFS","computeIfsFormulas","ComputeTEXT","checkArgs","argsLength","splitIndex","frtArg","scndArg","checkScndArg","s2","dTime","checkString","toOADate","formatChar","isH","isMFound","lastCharIndex","totalCharforM","c","getSkeleton","getDateFormat","dFormatter","ComputeCOUNTIFS","ComputeAVERAGEIFS","ComputeMATCH","lookupVal","matchType","indexVal","ComputeSUBTOTAL","ComputeRADIANS","radVal","PI","ComputeRANDBETWEEN","ComputeSLOPE","xPointsRange","yPointsRange","yPoints","getDataCollection","xPoints","sumXY","sumX2","sumX","sumY","ComputeINTERCEPT","yValuesRange","xValuesRange","xValues","yValues","ComputeLN","logValue","logVal","log","ComputeISNUMBER","ComputeROUND","numStr","digStr","mult","ComputePOWER","orgNumValue","orgPowValue","logNumValue","logPowValue","ComputeLOG","orgBaseValue","logBaseValue","LN10","ComputeTRUNC","orgDigitValue","normalizer","ComputeEXP","exp","ComputeGEOMEAN","dev","r","s","cellVal","cellsData","NaN","Parser","emptyStr","storedStringText","tokenAdd","tokenSubtract","tokenMultiply","tokenDivide","tokenLess","charEm","charEp","tokenGreater","tokenEqual","tokenLessEq","tokenGreaterEq","tokenNotEqual","tokenAnd","tokenEm","tokenEp","tokenOr","charAnd","charLess","charGreater","charEqual","charLessEq","charGreaterEq","charNoEqual","stringGreaterEq","stringLessEq","stringNoEqual","stringAnd","stringOr","charOr","charAdd","charSubtract","charMultiply","charDivide","fixedReference","spaceString","ignoreBracet","isError","isFormulaParsed","findNamedRange","stringsColl","tokens","charNOTop","specialSym","isFailureTriggered","fkey","isTextEmpty","getFormulaCharacter","namedRanges","storedData","checkForNamedRangeAndKeyValue","formulaString","storeStrings","indexOfAny","family","getSheetFamilyItem","sheetNameToParentObject","setTokensForSheets","getSheetToken","scopedRange","checkScopedRange","markLibraryFormulas","formulaAutoCorrection","ex","exception","isForceCalculable","formulaCorrection","computeForceCalculate","invalid_expression","FormulaError","mismatched_parentheses","empty_expression","parseSimple","exceptionArgs","errorMessage","getErrorLine","setStrings","arithemeticArr","logicalSym","form","firstOp","secondprevOp","secondnextOp","firstDigit","secondDigit","countDigit","isDigit","rightBracket","has","leftBracket","isUpperChar","getParseArgumentSeparator","v","token","sheetNameToToken","s_1","getNamedRanges","tempString","storedString","mismatched_tics","expTokenArray","mulTokenArray","addTokenArray","mulCharArray","addCharArray","compareTokenArray","compareCharArray","expCharArray","andTokenArray","andCharArray","orCharArray","orTokenArray","parseSimpleOperators","markers","operators","right","findLeftMarker","cannot_parse","bracketCount","l","period","getParseDecimalSeparator","number_contains_2_decimal_points","getCellFrom","updateDependentCell","expression_cannot_end_with_an_operator","uFound","findRightMarker","jTemp","inbracket","noCellReference","arithMarker2","isCharacter","checkLetter","oneTokenFound","textLen","ret","bracketLevel","parseFormula","fKey","bracCount","rightParens","markNamedRanges","parenCount","leftParens","libFormula","getFunction","swapInnerParens","addParensToArgs","fSubstr","rightSides","lastIndexOfAny","oneTimeOnly","getTableRange","namerangeValue","findNextEndIndex","found","__decorate","decorators","desc","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","Calculate","lFormulas","keyToRowsMap","rowsToKeyMap","emptyString","leftBrace","rightBrace","cellPrefix","treatEmptyStringAsZero","singleTic","parseDecimalSeparator","dependentCells","dependentFormulaCells","minValue","MIN_SAFE_INTEGER","maxValue","MAX_SAFE_INTEGER","categoryCollection","refreshedCells","computedValues","randomValues","isRandomVal","randCollection","errorStrings","parseArgumentSeparator","dateTime1900","isParseDecimalSeparatorChanged","isArgumentSeparatorChanged","sheetFamilyID","defaultFamilyItem","sheetFamiliesList","modelToSheetID","tokenCount","sortedSheetNames","tempSheetPlaceHolder","formulaInfoTable","oaDate","millisecondsOfaDay","parseDateTimeSeparator","moduleLoader","Calculate_1","Inject","injectedModules","parser","formulaColl","enumerable","configurable","setParseArgumentSeparator","getParseDateTimeSeparator","setTreatEmptyStringAsZero","getTreatEmptyStringAsZero","setParseDateTimeSeparator","getInjectedModules","onPropertyChanged","newProp","oldProp","charCode","resetKeys","parentObjectToToken","getDependentCells","formulaCells","addToFormulaDependentCells","cell1","getDependentFormulaCells","isSheetMember","sheetDependentCells","sheetDependentFormulaCells","getLibraryFormulas","sheetFormulaInfotable","getFormula","setParseDecimalSeparator","bad_index","grd","isLetter","CalcSheetFamilyItem","setKeyValue","FormulaInfo","fInfo","clearFormulaDependentCells","setFormulaText","getFormulaValue","setParsedFormula","setFormulaValue","dependentFormula","dependent","arrayRemove","array","getKeyValue","fText","computeFormula","getParsedFormula","addNamedRange","sheetScopeName","removeNamedRange","arrCol","aCharValue","arr","sheetTokenIndex","row1","row2","calculateFormula","parsedText","lastIndexOfq","formulatResult","fNested","nestedFormula","findLastIndexOfq","sFormula","customArgs","joinIdx","processNestedFormula","q","computeValue","spreadSheetUsedRange","criteria","isAsterisk","criteriaValue","opt","checkCriteria","criteriaRangeArray","sumRange","criteriaRange","getComputeSumIfValue","lookVal","finalText","checStr1","checStr2","newIndex","compRight","compLeft","leftVal","rightVal","getValueFromRange","sumRangeVal","tempdate","last","r1","c1","c2","r2","pFormula","textName","getParentObjectCellValue","stackValue","errIndex","getValArithmetic","countValue","num1","num2","val1","val2","localeCompare","computeStoreCells","sCell","cellRanges","criterias","argArray","isCriteria","storeCell","storedCells","isCountIfs","isCountIfS","countVal","rangeLength","tempStoredCell","newCell","newCount","cellAlpha","newCellAlpha","isAvgIfs","storedCell","avgValCount","pText","doubleNumber","setTime","isValidMonth","tempDay","dateTime","fString","pObjCVal","f","circular_reference","dateval","cellTxt","sheetToken1","containsBoth","isAlpha","isNum","charArray","sortedSheetNamesCollection","getSortedSheetNames","textSplit","tokenToParentObject","saveCell","cValue","getParentCellValue","fromCell","fromCellGrd","gridId","getValueRowCol","defineFunction","valueChanged","changeArgs","isCalculate","usedRangeCol","pgrid","isComputedValueChanged","isCompute","calcFamily","getRowIndex","randStrVal","getComputedValue","formulaValue","arr_1","errorStack","createSheetFamilyID","operation","countStrVal","sumCell","avgVal","countNum","registerGridAsSheet","refName","tempRef","unregisterGridAsSheet","unRegisterAll","modelArr","refName1","computeExpression","parsedFormula","dispose","refreshRandValues","tokenRef","stringCollection","dCell","formulaInfo","Property","Event","NotifyPropertyChanges","Base","calcID","MIN_VALUE","calcID1","ValueChangedArgs","setRowIndex","setColIndex","WorkbookFormula","uniqueOBracket","uniqueCBracket","uniqueCSeparator","uniqueCOperator","uniquePOperator","uniqueSOperator","uniqueMOperator","uniqueDOperator","uniqueModOperator","uniqueConcateOperator","uniqueEqualOperator","uniqueExpOperator","uniqueGTOperator","uniqueLTOperator","sheetInfo","initCalculate","registerSheet","calculateInstance","performFormulaOperation","collection","from","values","formulaCollection","selectCategory","selectedList","updateSheetInfo","unRegisterSheet","propertyChange","isFormula","autoCorrectFormula","refreshCalculate","isRefreshing","argumentSeparator","isAdded","addDefinedName","definedName","isRemoved","removeDefinedName","scope","initiateDefinedNames","renameUpdation","sheetId","sheetDeletion","refError","referenceError","addCustomFunction","functionHandler","calcValue","sheetID","refreshInsDelFormula","insertArgs","refreshNamedRange","getSheetInfo","cellAddr","delSheetName","rowId","colId","formulaVal","removeSheetTokenIndex","dependentCellRef","updateDataContainer","visible","savedTokens","isSheetRenamed","sheetNames","sheetData","rowData","colObj","parseSheetRef","regx","escapeRegx","regxTemp","searchIdx","valSearchIdx","regxVisible","search","cellArgs","referenceCollection","refValue","tempArgs","updatedCell","fCell","isEqual","lessEq","greaterEq","equal","lessOp","greaterOp","equalOp","definedname","refersTo","isLink","isValidate","visibleRefersTo","comment","checkIsNameExist","getIndexFromNameColl","calcName","formatedValues","actCellModel","actCellfrmt","countOnly","Count","Sum","Avg","Min","Max","clearFormula","startIdx","refreshFormula","diff1","nAlpha","fArg","ridx","pVal","actSheet","deleteIdxs","splitFormula","sheetLen","updatedFormulaVal","markSpecialChar","isUniqueChar","getUniqueCharVal","isChanged","modelDefinedNames","definedNameCnt","WorkbookSort","initiateSortHandler","sortDescriptors","containsHeader","workbookLocale","getConstant","isSameStyle","jsonData","length_1","comparerFn","sortComparer","caseSensitive","sortBy","colName","firstCellStyle","secondCellStyle","sameStyle","sortDescriptor","comparer","caseOptions","sensitivity","collator","Intl","Collator","compare","WorkbookFilter","filterRange","initiateFilterHandler","clearAllFilterHandler","filterOptions","datasource","setFilter","filterEventArgs","address_1","where","Predicate","and","result_1","executeLocal","filteredRows","rowIdxColl","sheetIdxColl","filterRows","filterSheet","WorkbookImage","oldImgData","imgRange","imgData","image","WorkbookChart","setChartHandler","refreshChartData","isPaste","chartCount","isIdAvailabe","idAvailable","dataSheetIdx","chartColl","charts","isRange","showHide","inRowColumnRange","rangeSheetIdx","chartCnt","sheetCnt","chartObj","excelFilter","chartEle","closest","isRefresh","overlayElement","WorkbookCellFormat","triggerEvent","onActionUpdate","setTypedBorder","checkAdjustantBorder","checkFullBorder","setCellBorder","setBottomBorderPriority","isFullBorder","setFullBorder","setCellStyle","lastCell","isHeightCheckNeeded","manualUpdate","refreshRibbon","pIdx","getCellStyleValue","bottomPriority","actionUpdate","style_1","textDecorationActionUpdate","changedStyle","changedValue","activeCellIndexes","removeProp","prevBorder","mergeArgs","first","clearCellObj","clrRange","preventRefresh","WorkbookEdit","performEditOperation","updateCellValue","isValueOnly","checkDecimalPoint","skipFormula","WorkbookHyperlink","setLinkHandler","WorkbookInsert","mergeCollection","isModel","freezePane","curIdx","insertCount","cellModel","sheetModel","id_1","skipHiddenSheets","updateRangeModel","isInsert","setInsertInfo","totalKey","WorkbookDelete","sheetLength","modelName","deletedCells","mergeArgsCollection","merge","skipChecking","prevCell_1","setDeleteInfo","total","WorkbookDataValidation","addValidationHandler","removeValidationHandler","addHighlightHandler","removeHighlightHandler","ValidationHandler","isRemoveValidation","onlyRange","isfullCol","maxRowCount","validation","InvalidDataHandler","td","isclearFormat","getRange","maxColCount","isRemoveHighlightedData","lastRowIdx","lastColIdx","isHighlighted","range_1","isCell","isValid","WorkbookFindAndReplace","replaceAll","totalCount","cidx","valueOfCell","activecell","endColumn","stringValue","startColumn","lcValueOfCell","ivalueOfCell","lowerCaseIndex","searchBy","findNextArgs","loopCount","findNxtRow","findNxtCol","sheetsLen","noCellfound","nextCommon","noFound","rowCol","cellType","cellval","isCSen","isEMatch","lcValue","ivalue","findPrevArgs","findPreRow","findPreCol","usedRan","sheetsLength","noValueBoolean","commonCondition","prevCommon","isTrue","currentCell","findOpt","activecel","replaceAddress","replaceAllCollection","undoRedoOpt","caseInSensitive","replaceValue","replaceAllCollection_1","newValue","replaceAllCollection_2","updateValue","replaceAllCollection_3","startSheet","addressCollection","lowerCaseValue","regExepression","Collection","countNumber","columnIndex","requiredCount","findCount","argsVal","lowerCaseVal","findAllArguments","initialSheet","findCollection","WorkbookProtectSheet","props","lockCells","WorkbookMerge","mergeHorizontally","mergeVertically","mergeAll","curCell","getCellValue","mergeCount","activeCellRange","forward","forwardReverse","reverseForward","startRowIdx","startRowIndex","colnIdx","cellIndex","rIndex","cIndex","insertHandler","pasteHandler","nextCell","prevSheet","WorkbookConditionalFormat","setCFrulHandler","clearRules","cFUndoHandler","cfrCount","frontColIdx","backColIdx","topRowIdx","bottomRowIdx","isFirst","cFRules","cFRulesIdx","isPresent","cFRule","cFRanges","cFRangeIdx","isFull","cFRangeIndexes","cFRRowIdx","cFRColIdx","rRowIdx","rColIdx","WorkbookBasicModule","WorkbookAllModule","CellStyle","ChildProperty","FilterCollection","SortCollection","DefineName","ProtectSettings","Hyperlink","Validation","Format","Complex","ConditionalFormat","LegendSettings","DataLabelSettings","MajorGridLines","MinorGridLines","Axis","Chart","Image","localeData","SortOutOfRangeError","Cell","Range","muteOnChange","parentObj","currRangeIdx","controlParent","isComplexArraySetter","setTimeout","tagObjects","instance","hasChanges","isInitChanges","rangeIdx_1","list","UsedRange","Sheet","ServiceLocator","services","register","__assign","t","isEdit","Workbook_1","commonCellStyle","initWorkbookServices","dataBind","initEmptySheet","preRender","L10n","render","getPersistData","addOnPersist","cssProps","cssProp","events.applyNumberFormatting","events.workbookFormulaOperation","removeSheet","events.workbookDestroyed","events.sheetsDestroyed","appendTo","selector","insertRow","getSheetModel","insertColumn","insertSheet","endSheet","initIdx","hiddenCount","update","formulaCellReference","errArgs","isNotLoaded_1","events.workbookEditOperation","events.workbookOpen","openFromJson","saveOptions","saveUrl","saveAsJson","addHyperlink","cellAddress","events.findNext","events.findPrevious","replaceBy","events.replaceHandler","events.replaceAllHandler","events.protectsheetHandler","unprotectSheet","events.unprotectsheetHandler","events.initiateSort","addDataValidation","events.setValidation","events.removeValidation","addInvalidHighlight","events.addHighlight","removeInvalidHighlight","events.removeHighlight","events.setCFRule","clearConditionalFormat","events.clearCFRule","getRowData","wrapText","images","filterArgs","events.initiateFilter","events.clearAllFilter","events.clear","events.getFormattedCellObject","freezePanes","updateTopLeftCell","events.dataRefresh","Unfreeze","isProtectedOnChange","Component","Row","Column","role","selected","multiselectable","busy","colcount","Clipboard","contenteditable","getClipboardEle","clearCopiedInfo","tabSwitchHandler","cMenuBeforeOpenHandler","ribbonClickHandler","initCopyIndicator","refreshOnInsertDelete","EventHandler","parentId","activeTab","copiedShapeInfo","hidePaste","l10n","delRowItems","hideRowItems","delColItems","hideColItems","actCellIndex","isCellLocked","setCopiedInfo","rfshRange","isExternal","clipboardData","copiedIdx","getCopiedIdx","copyInfo","isInternal","cSIdx","curSheet","selIdx","getExternalCells","internal","cellLength","isRepeative","beginEventArgs","notRemoveMerge","isRangeMerged","pictureElem","chartInfo","backgroundImage","pastedCell","imgLen","pasteSheetIndex","pastedPictureElement","pasteType","cRows","isRowSelected","isFinite","getConditionalFormats","toSkip","colInd","newFormula","setConditionalFormats","sId","cellElem","oldValue","displayText","cell_1","copySheet","select","isFilterCut","fRange","asc","filterCol","filteredCell","cRng","pRng","pictureElements","pictureLen","showSpinner","imgRowIdx","offsetTop","isImage","imgColIdx","offsetLeft","getChartElemInfo","execCommand","hideSpinner","setExternalCells","chartId","removeIndicator","indicator","copyIndicator","show","isModal","showCloseIcon","beforeOpen","dlgArgs","dialogName","items","enable","regex","setData","preventDefault","html","innerHTML","querySelectorAll","getStyle","textContent","cSpan","rSpan","whiteSpace","updateMergeCells","children","child","styleTagCSS","nodeList","node","tagName","tdStyle","char","charAt","defaultCellStyle","performAction","Edit","editorElem","editCellData","isCellEdit","isNewValueEdit","isAltEnter","validCharacters","formulaBarCurStartPos","curEndPos","curStartPos","selectionStart","selectionEnd","uniqueActCell","keyCodes","BACKSPACE","SPACE","TAB","DELETE","ESC","ENTER","FIRSTALPHABET","LASTALPHABET","FIRSTNUMBER","LASTNUMBER","FIRSTNUMPAD","LASTNUMPAD","SYMBOLSETONESTART","SYMBOLSETONEEND","SYMBOLSETTWOSTART","SYMBOLSETTWOEND","FIREFOXEQUALPLUS","FIREFOXMINUS","F2","dblClickHandler","mouseDownHandler","keyUpHandler","keyDownHandler","initiateCurPosition","updateFormulaBarValue","addressHandler","initiateRefSelection","refSelectionRender","renderEditor","refreshEditor","refreshFormulaBar","refreshEditorElem","isAppend","trigEvent","refreshCurPos","setCursorPosition","startEdit","endEdit","cancelEdit","editedValue","endFormulaRef","refreshDependentCellValue","getEditElement","editElement","altKey","keyCode","altEnter","updateFormulaReference","curOffset","getCurPosition","formulaRefIndicator","formulaSheetIdx","trgtElem","shiftKey","ctrlKey","metaKey","isFormulaEdit","maxWidth","overflow","isWindows","goTo","fullAddr","hasFormulaSuggSelected","isAlphabet","isNumeric","isNumpadKeys","isSymbolkeys","isFirefoxExceptionkeys","isF2Edit","isBackSpace","editingHandler","editor","contentEditable","spellcheck","preventFormulaReference","cellEle","isDelTemplate","value_1","updateEditCellDetail","initiateEditor","positionEditor","elem","selection","getSelection","createRange","setStart","collapse","removeAllRanges","addRange","suggDdlElem","visibility","uniqueColl","updateUniqueRange","reApplyFormula","cursorOffset","anchorOffset","focusOffset","focusNode","editText","curPos","actCellIdx","curPos_1","addr","tdElem","minHeight","minWidth","mainContElement","editWidth","zIndex","preventWrap","addWrap","getRowHeaderWidth","inlineStyles","updateEditedValue","tdRefresh","oldCellValue","newVal","isUniqueRange","innerText","sheet_1","cellIndex_1","getRefreshNodeArgs","refreshNode","cell_2","uniquArgs","uniqueCell","fCode","event","fSize","resetEditState","focusElement","eventName","originalEvent","anchorNode","nodeType","textBefore","textAfter","setEnd","elemRefresh","editorEle","isSelect","sheetName_1","setFormulaBarCurPosition","input","setSelectionRange","el","childNodes","valueLength","editEle","Selection","invalidOperators","formulaRange","tableRangesFormula","mouseMoveEvt","mouseMoveHandler","virtualContentLoadedHandler","cellNavigateHandler","protectHandler","initiateFormulaSelection","clearBorder","chartBorderHandler","isTouchSelectionStarted","touchSelectionStarted","getActiveCell","getSelectionElement","rowStart","rowEnd","colStart","colEnd","selectMultiRange","createSelectionElement","actRange","isInit","selectRangeByIdx","overlayElem","getSheetElement","activeIdx","isColSelected","headerEle","which","isSelected","passive","mouseUpHandler","touchEvt","topLeftIdx","isMobileView","renderModule","setSheetPanelSize","verticalContent","horizontalContent","clientRect","prevIndex","isScrollDown","isScrollUp","scrollTop","isScrollRight","isScrollLeft","scrollLeft","clearInterval","scrollUpRowIdx","scrollUpColIdx","scrollInterval","setInterval","prevRowColCnt","highlightHdr","getScrollLeft","scrollModule","prevScroll","cliRect","isScrollableArea","isclientX","sheetEle","initFormulaReferenceIndicator","forRefIndicator","isScrollRefresh","isActCellChanged","selectedRowColIdx","isMergeRange","getOffset","eArgs","selRange","selRanges","UpdateRowColSelected","updateActiveCell","disabled","selElem","isRowRefresh","isColRefresh","rowHdr","colHdr","getHdrIndexes","selectAll","removeClass","selectAll_1","selectAllHdr","selectAll_2","addClass","hiddenRowCount","hiddenColCount","processFormulaEditRange","formulaStartSheetIdx","parsedVal","ctrlKeyCount","formulaBorder","actSheetIdx","splitStr","updateFormulaEditRange","dStartCell","dEndCell","startcell","endcell","isChart","rangeReference","minr","minc","maxr","maxc","getEleFromRange","rowCells","startRIndex","startCIndex","endRIndex","endCIndex","tempCells","getRowCells","tdCol","second","borderEleColl","classArr","formulaStr","Scroll","initProps","scrollArgs","prevSize","initScrollValue","scrollRight","getColOffset","cur","prev","updateNonVirtualCols","scrollDown","getRowOffset","updateNonVirtualRows","refreshUI","Infinity","scrollTrack","updateNonVirualScrollWidth","getScrollElement","onHeaderWheel","deltaY","deltaX","onContentWheel","scrollHandler","contentPanel","setPadding","overflowY","scrollWidth","colHeader","margin","setClientX","getPointX","sheetContent","onTouchScroll","pointerUpHandler","touches","scroller","VirtualScroll","scroll","createVirtualElement","container","vTrack","initScroll","setScrollCount","translateX","translateY","rowHeader","rowVTrack","transform","colVTrack","allowScrolling","activeSheetIdx","getRowAddress","getColAddress","updateScrollCount","usedRangeCount","prevIdx","idxDiff","lastIdx","prevTopIdx","fIndexes","skippedHiddenIdx","skipUpdateOnFirst","prevColIndex","skipTranslate","translate","thresholdIdx","setThresholdHeight","finiteOffset","checkLastIdx","focusSheet","endIdx","prevLeftIdx","prevRowIndex","setThresholdWidth","scrollHeight","updateColumnWidth","isUpdate","scroll_1","newWidth","vTrackHeight","newHeight","hVTrack","getVTrackHeight","updateVTrack","heightArr","updateVTrackHeight","updateVTrackWidth","hdrVTrack","cntVTrack","hdrColumn","cntColumn","sizeStr","deInitProps","updateScrollProps","sliceScrollProps","KeyboardNavigation","isNavigate","isFilterCell","actIdxes","shiftSelection","scrollNavigation","stopPropagation","noHidden","isScroll","cont","hCont","topLeftIdxes","paneTopLeftIdxes","offsetLeftSize","offsetTopSize","getBottomIdx","getRightIdx","viewPortHeight","getColHeaderHeight","contWidth","KeyboardShortcut","applyFilter","CellFormat","checkHeight","updateMergeBorder","curStyle_1","setLeftBorder","setTopBorder","pRow","pHRow","setThickBorderHeight","firstElementChild","wrapEle","CellElem","customHeight","updateRowHeight","isLastCell","splitVal","valLength","bottomCell","rightCell","getBorderSize","calculateHeight","clearObj","removeHyperlink","Resize","wireEvents","setAutoFitHandler","isRow","trgtEle","setAutofit","wireResizeCursorEvent","setTarget","unWireResizeCursorEvent","unwireEvents","colResizeHandler","rowResizeHandler","isMouseMoved","offsetSize","offsetY","updateTarget","createResizeHandler","resizeOn","resizeHandler","updateCursor","colIndx","showHiddenColumns","rowIndx","newTrgt","tOffsetV","eOffsetV","tClass","offsetX","prevSibling","getColPrevSibling","getRowPrevSibling","resEle","lastElementChild","mainContent","contentTable","wrapCount","rowLength","colLength","contentFit","getFloatingElementWidth","autofitValue","resizeStart","getViewportIndex","threshold_1","oldWidth","threshold_2","oldHeight","clientHeight","viewportIdx","curWidth","colgroup","eleHeight","rowHeight","isCustomHgt","actualIdx","skipAppend","rTbody","tBodies","tbody","insertBefore","insertIdx","isFit","floatingWidth","hasFilter","CollaborativeEditing","refreshClients","ShowHide","hideCol","nextIdx","refreshSheet","hFrag","frag","rowRenderer","rTBody","tBody","newStartRow","createDocumentFragment","childElementCount","scrollable","hiddenIndex","beforeViewportIdx","removeCell","scrollWidth_1","appendCell","hColgrp","colgrp","hTable","modelLen","isEnd","cellRenderer","refCell","updateCol","renderColHeader","lastChild","tHead","checkNextBorder","previousSibling","SpreadsheetHyperlink","initiateHyperlinkHandler","editHyperlinkHandler","openHyperlinkHandler","hyperlinkClickHandler","createHyperlinkElementHandler","hyperlinkText","hyperlinkSpan","insertBut","dialogInst_1","cssClass","dialogInstance","hyperlinkContent","buttons","buttonModel","isPrimary","dlgClickHandler","insertHyperlink","dlgContent","dialogInst","hyperEditContent","cellIndexes","hlOpenHandler","isEmpty","rangeAddr","befArgs","aftArgs","definedNameCheck","sheetIdx_1","isDefinedNamed","rangeAddr_1","addArr","showInvalidHyperlinkDialog","isValidUrl","dlgEle","docEle","webEle","webEleText","docEleText","actEle","hasAttribute","hyperEle","isWeb","definedNamesCount","rangeCount","webContElem","docContElem","listEle","isDefinedName","isCellRef","isEnable","hl","defNamesCnt","rangeCnt","sheets_1","idx_2","idx_3","dialogElem","Tab","selectedItem","textCont","urlCont","textH","urlH","textInput","urlInput","nodeId","nodeText","expanded","nodeChild","treeObj","TreeView","fields","cellrefCont","cellrefH","cellrefInput","textCont1","textH1","textInput1","sheetCont","sheetH","refCont","UndoRedo","undoCollection","redoCollection","undoRedoStep","cutCellDetails","getCellDetails","beforeActionData","cellDetails","beforeDetails","undoRedoArgs","performOperation","undoForClipboard","undoForResize","updateUndoRedoIcons","completeArgs","actionList","beforeActionDetails","tab","actionData","checkRefreshNeeded","updateCellDetails","sheetIndex_1","pRange","argsEventArgs","WrapText","wrapTextHandler","rowHeightChangedHandler","isMerge","initial","WRAPTEXT","styleText","outerHTML","editElem","Insert","preventUpdate","refreshImgElement","Delete","activeSheetDeleted","DataValidation","dataValPopup","listOpen","initiateDataValidationHandler","invalidDataHandler","checkDataValidation","listHandler","InvalidElementHandler","parEle","valuesCont","errorEle","primaryBut","listObj","showPopup","isRemoveHighlight","tdEle_1","ddlCont","ddlEle","updateDataSource","DropDownList","setDropDownListIndex","popupHeight","change","listValueChange","popup","isDevice","dataIdx","getIndexes","listValues","isNew","dataValidationContent","cellRangeCont","allowDataCont","ignoreBlankCont","cellRangeText","cellRangeEle","allowCont","dataCont","allowText","typeData","operatorData","allowSelectEle","allowIdx","dataText","dataSelectEle","FormattedValue","dataList","userInput","ignoreBlankEle_1","CheckBox","label","checked","minimumCont","maximumCont","minimumText","maximumText","minimumInp","maximumInp","NumericTextBox","valueText","valueEle","isChecked","ignoreBlankEle","listObj1","dlgCont","placeholder","errorMsg","isValidList","dlgFooter","dlgContEle","allowData","allowEle","dataEle","rangeAdd","valArr","isSheetNameValid","isSingleCol","isSingleRow","validDlg","isDialogValidator","tdEle","formValidation","formatValidation","isValidationHandler","enterValue","validationErrorHandler","sheetPanel","formEle","inputEle","customPlacement","inputElement","number","FormValidator","validate","erroDialogInst_1","dlgModel","errorDlgHandler","errorDialogInst","buttonName","ProtectSheet","protect","protectSheetHandler","editProtectedAlert","lockCellsHandler","KeyUpHandler","isActive","createDialogue","listData","optionList","ListView","showCheckBox","dialogOpen","protectHeaderCntent","checkbox","listViewElement","headerContent","checkBoxElement","okBtnFocus","beforeClose","checkboxElement","checkBoxClickHandler","selectOption","selectMultipleItems","selectedItems","getSelectedItems","disableHomeBtnId","enableHomeBtnId","enableFrmlaBtnId","enableInsertBtnId","imageBtnId","findBtnId","dataValidationBtnId","chartBtnId","sheetElement","closeOnEscape","destroyDialog","close","passwordProtectContent","alertMessage","pwdCont","cnfrmPwdCont","pwdInput","cnfrmPwdInput","okBtn","okButton","btn","spanElem","unpotectSpanElem","importpotectSpanElem","pwd","cnfrmPwd","pwdSpan","unProtectPasswordContent","unprotectdlgOkClick","fileArgs","importProtectPasswordContent","importOkClick","textSpan","impArgs","FindAndReplace","shortValue","renderFindDlg","renderGotoDlg","gotoHandler","eventArgs_1","eventArgs_2","eventArgs_3","dlg","allowDragging","findandreplaceContent","dialogMessage","findDlgClick","prevButton","GotoContent","textFocus","findDlgArgs","findOption","findInput","gotoAlert","checkCase","checkmatch","searchitem","modeitem","find","countArgs","countOpt","replaceWith","caseCheckbox","eMatchCheckbox","searchDDL","modeDDL","replaceMode","gotoaddress","splitAddress","gotoSpan","findSpan","replaceSpan","findValue_1","findValue","findElem","findCheck","findTextE","findTextH","findTextIp","findTextBox","TextBox","replaceTextE","replaceTextH","replaceTextIp","replaceTextBox","withinData","Id","Within","withInDDL","withIn","withinTextH","searchData","Search","searchIn","searchTextH","caaseCheckbox","entirematchCheckbox","gotoElem","gotoTextE","gotoTextH","gotoTextBox","gotoTextIp","Merge","hideHandler","isFreezePane","insideFreezePane","ConditionalFormatting","cFInitialRender","cFInitialCheckHandler","checkConditionalFormatHandler","initiateCFHandler","setCFHandler","cFDeleteHandler","clearCFHandler","addClearCFHandler","clearCFormats","cCFIdx","isApply","cFIdx","sRangeIdx","newRangeIdxs","cFRowIdx","cFColIdx","sRRowIdx","sRColIdx","cFDlgContent","mainCont","inpEle","getCFColor","cFType","getType","dlgText","getDlgText","mainDiv","subDiv","value1Text","value1Inp","duplicateSelectEle","subDivText","colorSelectEle","percent","maxLength","dupData","value2Text","value2Inp","validateCfInput","colorData","checkCellHandler","cFrange","cFRIdx","triggetConditionalFormatEvent","formatStyle","cFColors","cFRCheck","setFormat","setProperty","cFRuleIdx","setColor","isActiveCF","rgb","hexToRgb","g","hex","exec","isInitial","cFRuleValue1","cFRuleValue2","valueArr","valueStr","isGreaterThanLessThan","isBetWeen","isEqualTo","isContainsText","isDuplicateUnique","isTopBottomTenValue","isTopBottomTenPercentage","isAboveBelowAverage","isDataBarColorScalesIconSets","applyDataBars","applyColorScale","applyIconSet","selIndexes","rIdx_1","cIdx_1","iconList","getIconList","rIdx_2","getNumericArray","currentSymbol","n1","n2","minPercent","percent1","percent2","percent3","cfIcon","applyIconSetIcon","activeObj","activeEle","iconName","colors","getColor","rIdx_3","hexcode","getGradient","posColor","negColor","topVal","posArr","negArr","leftStandardWidth","rIdx_4","databar","leftSpan","rightSpan","dataSpan","iconSetSpan","cfColor","colorCodeArr","colorArr","middle","large","getLinear","center","byteLinear","isGrearThan","txtRegx","input1","input2","dateEventArgs1","dateEventArgs2","dateTimeArgs","inp","isTop","dataArray","cFRuleIndexes","dataArr","considerCount","isAbove","rangeColl","average","RibbonHeader","RibbonItem","Item","Ribbon","getUniqueID","renderRibbon","expandCollapseElem","ribbonExpandCollapse","menuItems","fileMenu","toolbarObj","tabObj","getTabItems","tabItems","initMenu","menu","menuObj","Menu","showItemOnClick","parentItem","beforeItemRender","tabElement","tBarElement","Toolbar","selectedTab","getIndex","animation","next","duration","previous","selecting","selectingIndex","updateToolbar","refreshOverflow","collapseBtn","decrement","enableMenuItems","isUniqueId","enableItems","hideMenuItems","menuInstance","hideItems","showItems","addMenuItems","insertAfter","hideTabs","tabs","stateChanged","isAllHidden","getTabIndex","allHidden","enableTabs","enableTab","addTabs","addTab","headerText","tabIdx","disable","MenuItem","ColorPicker","fontColorPicker","ColorPickerComponent","showButtons","presetColors","fontColor","enableOpacity","beforeCloseHandler","openHandler","beforeModeSwitch","currentValue","rgba","previousValue","updateSelectedColor","wireFocusEvent","filColorPicker","fillColor","borderBottomColor","title","inst","modeSwitcher","fontNameIndex","numPopupWidth","preTabIdx","chartThemeIndex","RibbonColorPicker","initRibbon","createMobileView","createRibbon","getRibbonMenuItems","iconCss","getRibbonItems","prefixIcon","tooltipText","getPasteBtn","getNumFormatDDB","getFontNameDDB","getFontSizeDDB","getBtn","getBordersDBB","getMergeSplitBtn","getTextAlignDDB","getVerticalAlignDDB","getHyperlinkDlg","datavalidationDDB","getLocaleText","getCFDBB","getChartDDB","getClearDDB","getSortFilterDDB","getFindDDb","pasteSplitBtn","SplitButton","passwordProtectDlg","setClass","getLocaleProtectText","getLocaleProtectWorkbook","getAddChartEleDBB","switchRowColumn","getChartThemeDDB","ribbonElement","RibbonComponent","fileMenuItemSelect","fileMenuBeforeOpen","fileMenuBeforeClose","toolbarClicked","ribbonCreated","tabSelecting","expandCollapse","expandCollapseHandler","beforeFileMenuItemRender","beforeRenderHandler","uiUpdate","refEle","refreshRibbonContent","chartThemeBtn","chartThemeDDB","DropDownButton","getChartThemeDdbItems","chartThemeDDBSelect","tBarDdbBeforeOpen","numFormatBtn","numFormatDDB","getNumFormatDdbItems","numDDBSelect","numDDBOpen","previewNumFormat","fontSizeDdb","refreshSelected","menuClass","chartMenu","orientation","bar","area","line","pie","radar","scatter","chartSelected","column1Text","column1Cont","column2Cont","clusteredColumn","stackedColumn","stackedColumn100","clusteredColumn3D","stackedColumn3D","stackedColumn1003D","bar1Text","bar1Cont","bar2Cont","clusteredBar","stackedBar","stackedBar100","clusteredBar3D","stackedBar3D","stackedBar1003D","areaText","areaCont","defArea","stackedArea","stackedArea100","lineText","lineCont","defLine","stackedLine","stackedLine100","pieText","pieCont","defPie","doughnut","radarText","radarCont","defradar","radarMarkers","scatterText","scatterCont","defscatter","ulClass","ul","ddbIconCss","ddbCssClass","chartDdb","chartBtn","addChartMenu","addChartEleSelected","addChartDdb","addChartBtn","cFMenu","dataBars","colorScales","iconSets","cFSelected","db1","db2","bBar","gBar","rBar","oBar","lBBar","pBar","cs1","cs2","cs3","gyr","ryg","gwr","rwg","bwr","rwb","wr","rw","gw","wg","gy","yg","is1","is2","is3","is4","is5","is6","is7","is8","directional1","directional2","directional3","directional4","directional5","directional6","directional7","shapes1","shapes2","shapes3","shapes4","shapes5","indicators1","indicators2","indicators3","ratings1","ratings2","ratings3","ratings4","ratings5","cFDdb","tag","cPickerWrapper","bordersMenu","separator","colorPicker","cPickerEle","onOpen","borderSelected","inline","bordersDdb","eleId","prevStyleId_1","toggle","fontNameBtn","fontNameDdb","getFontFamilyItems","refreshFontNameSelection","bindEvent","btnObj","Button","isToggle","toggleBtnClicked","datavalidationDdb","textAlignDdb","alignItemRender","verticalAlignDdb","mergeSplitBtn","mergeSelectHandler","toggleActiveState","unMerge","itemId","isDataPresent","performMerge","sortingDdb","isFiltered","isClearAll","findToolbtn","findDdb","onclick","findToolDlg","toolbarObj_1","findTextElement","findTextInput","findSpan_1","onkeyup","nextElement","prevElement","onkeydown","findOnKeyDown","toolItemModel","findDialog","toolbarElement_1","dialogDiv","FindDialog","closeDialog","getComputedStyle","X","Y","elements","clearDdb","defaultModel","activeModel","property","refreshToggleBtn","itemKey","setPanelSize","actionArgs","refreshNumFormatSelection","refreshChartThemeSelection","chartTheme","separatorCount","viewportHeight","actualHeight","paddingTop","separatorStyle","borderBottomWidth","marginTop","elemList","popWidth","numElem","previewElem","refreshHomeTabContent","refreshDataTabContent","refreshViewTabContent","active","fontProps","getChartThemeText","selectedTheme","selectArgs","evtHArgs","evtglArgs","selectCell","showHideHeaders","toggleRibbonItems","viewtabHeader","datatabHeader","text_1","updateToggleText","len_2","len_3","len_4","updateActiveBorder","updateViewTabContent","updateRibbonItemText","showHideText","updated","updateDataTabContent","updateProtectBtn","l10n_1","protectText","updateProtectWorkbookBtn","toobar","align","renderMobileToolbar","toolbarPanel","toolbar","ddb","ddbObj","calculatePosition","wrapper","contents","li","updateMergeItem","parentElem","ribbonEle","FormulaBar","isGoto","createFormulaBar","insertFnRipple","fBarWrapper","nameBox","comboBoxInstance","ComboBox","noRecordsTemplate","nameBoxBeforeOpen","blur","nameBoxBlur","nameBoxSelect","rippleEffect","textarea","textAreaFocusIn","textAreaFocusOut","formulaPanel","tickBtn","validity","eventArg","UpdateValueAfterMouseUp","isInteracted","itemData","formulaBarUpdateHandler","editArgs","indexes1","indexes2","intDate","formulaInp","addressRange","updateComboBoxValue","disabletextarea","getFormulaBar","formulaBarScrollEdit","viewportIndexes","formulaBarClickHandler","isSheetProtected","toggleFormulaBar","names","offsetParent","formulaDescription","categoryContent","dropDownElement","descriptionContent","categoryArgs","categoryList","dropDownSelect","listArgs","formulaList","actionComplete","updateFormulaList","listSelected","dialogBeforeClose","dialogClose","selectFormula","formulaClickHandler","focusOkButton","dialogContentEle","parentNode","storeActiveElement","formulaBarObj","updateFormulaDescription","activeListFormula","firstElement","selectItem","selectedFormula","descriptionArgs","descriptionArea","editOperationHandler","Formula","isFormulaBar","isPopupOpened","isPreventClose","isSubFormula","UP","DOWN","LEFT","RIGHT","autocompleteInstance","formulaClick","renderAutoComplete","getNames","getNameFromRange","acElem","autoCompleteOptions","popupWidth","filterType","sortOrder","onSuggestionOpen","onSuggestionClose","onSelect","onSuggestionComplete","AutoComplete","relateTo","getRelateToElem","maxHeight","triggerKeyDownEvent","updatedFormulaValue","getEditingValue","parseIndex","getArgumentSeparator","hidePopUp","suggPopupElem","getSuggestionKeyFromFormula","refreshFormulaSuggestion","autoCompleteElem","isSuggestionAlreadyOpened","isNavigationKey","dispatchEvent","hidePopup","suggestValue","bracketIndex","fSplit","isAlphaNumeric","singleRange","SheetTabs","aggregateContent","isSelectCancel","selaggregateCnt","createSheetTabs","tabInstance","panel","addBtn","addSheetTab","addBtnRipple","getSheetTabItems","dropDownInstance","ddbItems","updateSheetTab","beforeOpenHandler","sheetTab","overflowMode","scrollStep","currentSheetIndex","previousSheetIndex","previousIndex","updateDropDownItems","completeEventArgs","tBarItems","spaceKeyDown","positionX","isCollide","refreshSheetTab","hideTab","switchSheetTab","required","maxlength","renameInputFocusOut","updateWidth","spaceLen","removeRenameInput","showRenameDialog","updateSheetName","textEle","sheetItems","focusRenameInput","forceDelete","sheetArgs","destroySheet","removeTab","activeIndex","btnClass","aggregateDropDown","updateAggregateContent","aggregateEle","getAggregateItems","removeAggregate","Open","renderFileUpload","openFailed","uploadID","accept","uploadBox","onchange","fileSelect","filesData","files","openError","alertSpan","Save","showErrorDialog","ContextMenu","initContextMenu","contextMenuInstance","ContextMenuComponent","selectHandler","getInsertModel","getTarget","getDataSource","insertEle","deleteEle","targetEle","setClipboardData","setFilterItems","setSortItems","setHyperLink","setInsertDeleteItems","setHideShowItems","setProtectSheetItems","clearFilterText","subItems","StartIdx","addItemsHandler","removeItemsHandler","enableItemsHandler","removeItems","NumberFormat","Sort","applySortHandler","sortCompleteHandler","initiateCustomSortHandler","isValidSortRange","sortRangeAlertHandler","customSortContent","clearError","errorElem","validateError","headercheck","headerCheckbox","hasHeader","dropDown","hasError","Set","duplicateField","errorField","count_1","dropDownList","getFields","listId","listviewObj","getCustomListview","setHeaderTab","contentElem","listview","renderListItem","fieldName","headerTabElement","addButton","footer","addItem","checkHeaderObj","fieldsMap","dropDownListObj","checkCaseObj","enableRipple","deleteHandler","removeItem","lvObj","orderRadio","isAscending","toLocaleLowerCase","radiobutton","RadioButton","setRadioBtnValue","radio","radiobutton2","radio2","beforeArgs","Filter","filterRangeAlertHandler","initiateFilterUIHandler","filterMouseDownHandler","renderFilterCellHandler","beforeFltrcMenuOpen","beforeFilterMenuOpenHandler","filterCmenuSelect","reapplyFilterHandler","filterByCellValueHandler","clearFilterHandler","getFilteredColumnHandler","filterCboxValue","filterCboxValueHandler","getFilterRangeHandler","filterCellKeyDownHandler","beforeInsertHandler","beforeDeleteHandler","deleteSheetHandler","clearHanlder","filterDialogCreated","filterDialogCreatedHandler","filterDialogClose","removeFilterClass","isInValidFilterRange","addMenuItem","removeFilter","processRange","filterSuccessHandler","refreshFilterRange","filterColl","isFilterRange","getColumnType","matchCase","filterBtnObj","getFilterSortClassName","filterButton","hasChildNodes","headerCell","filterPopup","pos","openDialog","selectSortItemHandler","xPos","yPos","parentsUntil","filterCell","displayName","checkBoxData","hideSearchbox","filteredColumns","ExcelFilterBase","getLocalizedCustomOperators","popupOpenArea","sortRange","sameIndex","filterIndex","getPredicates","predicateList","excelPredicate","CheckBoxFilterBase","getPredicate","numOptr","stringOperator","numberOperator","dateOperator","datetimeOperator","booleanOperator","fil","colCollection","predi","predicate","dataType","initLoad","predicateCol","getFilterOperator","isPredicateRemoved","sortColl","SpreadsheetImage","pictureCount","renderImageUpload","refreshInsDelImagePosition","imageSelect","binaryStringVal","overlayObj","overlay","insertOverlayElement","adjustFreezePaneSize","currCell","currCellObj","imageLen","prevImgObj","currImgObj","prevCellObj","prevRowIdx","prevColIdx","currentRowIdx","currentColIdx","prevCellImg","prevCellImgLen","imgTop","imgleft","rangeVal","imgLength","ColumnSeries","LineSeries","BarSeries","AreaSeries","StackingColumnSeries","StackingLineSeries","StackingBarSeries","ScatterSeries","StackingAreaSeries","Category","Legend","Tooltip","DataLabel","AccumulationChart","PieSeries","AccumulationTooltip","AccumulationDataLabel","AccumulationLegend","SpreadsheetChart","initiateChartHandler","updateChartHandler","insertChartHandler","chartRangeHandler","chartDesignTabHandler","updateChartElement","chartType","chartCollLen","getPropertyValue","formatObj","series","chartComp","prevChartObj","currChartObj","prevCellChart","prevCellChartLen","chartEleClassName","processChartRange","xRange","yRange","lRange","isStringSeries","trVal","blVal","tlVal","toIntrnlRange","getRangeData","pushRowData","isYvalue","isDataSrcEnsured","minCol","forArgs","toArrayData","getVirtualXValues","limit","processChartSeries","xValue","lValue","pArr","dtVal","seriesName","dataLabel","pObj","yInc","sArr","yValue","rDiff","cDiff","inc","dataLabelSettings","xName","yName","marker","shape","innerRadius","radius","retVal","primaryYAxisFormat","focusChartRange","borderIdx","borderLen","eleColl","tdIdx","eleCollLen","argsOpt","isRangeSelect","isRowLesser","reqType","shapeType","chartRange","primaryXAxis","majorGridLines","minorGridLines","minorTicksPerInterval","lineStyle","valueType","primaryYAxis","labelFormat","eleRange","legendSettings","chartContent","chartArea","tooltip","load","beforeResize","cancelResizedEvent","enableSmartLabels","enableAnimation","chartElements","isRemoveEle","chartTop","chartleft","chartLength","updateChartModel","chartCollId","isAccumulationChart","accumulationChartComp","chartsCount","chartSeries","changeCharType","titleDlgHandler","chartParEle","titleDlgContent","BasicModule","Spreadsheet","AllModule","ScrollSettings","SelectionSettings","Custom","defaultLocale","FindValue","ReplaceValue","FindReplaceTooltip","InsertingEmptyValue","ReplaceAllEnd","ByRow","ByColumn","MatchCase","MatchExactCellElements","Replace","Find","Goto","EntercellAddress","GotoSpecial","FindNextBtn","FindPreviousBtn","ReplaceBtn","ReplaceAllBtn","GotoHeader","GotoSpecialHeader","NoElements","FindWhat","ReplaceWith","Cut","Copy","Paste","PasteSpecial","Link","EditHyperlink","OpenHyperlink","RemoveHyperlink","InvalidHyperlinkAlert","InsertLink","EditLink","All","Values","Formats","Bold","Font","FontSize","Italic","Underline","Strikethrough","TextColor","FillColor","HorizontalAlignment","AlignLeft","AlignCenter","AlignRight","VerticalAlignment","AlignTop","AlignMiddle","AlignBottom","MergeCells","MergeAll","MergeHorizontally","MergeVertically","Unmerge","UnmergeCells","SelectMergeType","MergeCellsAlert","PasteMergeAlert","Borders","TopBorders","LeftBorders","RightBorders","BottomBorders","AllBorders","HorizontalBorders","VerticalBorders","OutsideBorders","InsideBorders","NoBorders","BorderColor","BorderStyle","InsertFunction","DuplicateSheet","MoveRight","MoveLeft","Rename","Hide","Unhide","NameBox","ShowHeaders","HideHeaders","ShowGridLines","HideGridLines","FreezePanes","FreezeRows","FreezeColumns","UnfreezePanes","UnfreezeRows","UnfreezeColumns","AddSheet","ListAllSheets","FullScreen","CollapseToolbar","ExpandToolbar","CollapseFormulaBar","ExpandFormulaBar","File","Home","Formulas","View","New","SaveAs","Update","ExcelXlsx","ExcelXls","CSV","SortAscending","SortDescending","CustomSort","AddColumn","ContainsHeader","CaseSensitive","SortBy","ThenBy","SelectAColumn","SortEmptyFieldError","SortDuplicateFieldError","SortAndFilter","ClearAllFilter","ClearFilterFrom","ReapplyFilter","FilterCellValue","FilterOutOfRangeError","HideRow","HideRows","UnHideRows","HideColumn","HideColumns","UnHideColumns","InsertRow","InsertRows","Above","Below","InsertColumn","InsertColumns","Before","After","DeleteRow","DeleteRows","DeleteColumn","DeleteColumns","Ok","Close","Cancel","Apply","MoreColors","StandardColors","General","Currency","Accounting","ShortDate","LongDate","Time","Percentage","Fraction","Scientific","Text","MobileFormulaBarPlaceHolder","PasteAlert","DestroyAlert","SheetRenameInvalidAlert","SheetRenameEmptyAlert","SheetRenameAlreadyExistsAlert","DeleteSheetAlert","DeleteSingleLastSheetAlert","PickACategory","Description","UnsupportedFile","InvalidUrl","SUM","SUMIF","SUMIFS","ABS","RAND","RANDBETWEEN","FLOOR","CEILING","T","PRODUCT","INT","UNIQUE","ROUNDUP","SUMPRODUCT","SORT","TODAY","AVERAGE","AVERAGEIF","AVERAGEIFS","AVERAGEA","COUNT","COUNTIF","COUNTIFS","COUNTA","MIN","MAX","DATE","DAY","DAYS","IF","IFS","CalculateAND","CalculateOR","IFERROR","CHOOSE","INDEX","FIND","TEXT","CONCATENATE","CONCAT","SUBTOTAL","RADIANS","MATCH","LN","INTERCEPT","SLOPE","DefineNameExists","DefineNameInValid","CircularReference","ShowRowsWhere","OR","AND","CustomFilterDatePlaceHolder","CustomFilterPlaceHolder","CustomFilter","Between","DateTimeFilter","Undo","Redo","DateFilter","TextFilter","NumberFilter","ClearFilter","NoResult","FilterFalse","FilterTrue","Blanks","SelectAll","GreaterThanOrEqual","GreaterThan","LessThanOrEqual","LessThan","NotEqual","Equal","Contains","EndsWith","StartsWith","ClearButton","FilterButton","CancelButton","OKButton","UnprotectSheet","LockCells","SelectCells","FormatCells","FormatRows","FormatColumns","InsertLinks","ProtectContent","ProtectAllowUser","EditAlert","SearchWithin","SearchBy","Reference","CLEARALL","APPLY","CellRange","Allow","Data","Minimum","Maximum","IgnoreBlank","WholeNumber","Decimal","TextLength","List","NotBetween","EqualTo","NotEqualTo","Greaterthan","Lessthan","GreaterThanOrEqualTo","LessThanOrEqualTo","InCellDropDown","Sources","Value","Retry","EnterValue","DialogError","ListLengthError","ValidationError","EmptyError","ClearHighlight","HighlightInvalidData","ClearValidation","HighlightCellsRules","CFEqualTo","TextThatContains","ADateOccuring","DuplicateValues","TopBottomRules","Top10Items","Top10","Bottom10Items","Bottom10","AboveAverage","BelowAverage","FormatCellsGreaterThan","FormatCellsLessThan","FormatCellsBetween","FormatCellsEqualTo","FormatCellsThatContainTheText","FormatCellsThatContainADateOccurring","FormatCellsDuplicate","FormatCellsTop","FormatCellsBottom","FormatCellsAbove","FormatCellsBelow","With","DataBars","ColorScales","IconSets","ClearRules","SelectedCells","EntireSheet","ISNUMBER","ROUND","GEOMEAN","POWER","LOG","TRUNC","EXP","Clear","ClearContents","ClearAll","ClearFormats","ClearHyperlinks","LightRedFillWithDarkRedText","YellowFillWithDarkYellowText","GreenFillWithDarkGreenText","RedFill","RedText","Duplicate","Unique","And","WebPage","ThisDocument","DisplayText","Url","CellReference","DefinedNames","EnterTheTextToDisplay","EnterTheUrl","BlueDataBar","GreenDataBar","RedDataBar","OrangeDataBar","LightblueDataBar","PurpleDataBar","GYRColorScale","RYGColorScale","GWRColorScale","RWGColorScale","BWRColorScale","RWBColorScale","WRColorScale","RWColorScale","GWColorScale","WGColorScale","GYColorScale","YGColorScale","ThreeArrowsColor","ThreeArrowsGray","ThreeTriangles","FourArrowsColor","FourArrowsGray","FiveArrowsColor","FiveArrowsGray","ThreeTrafficLights1","ThreeTrafficLights2","ThreeSigns","FourTrafficLights","RedToBlack","ThreeSymbols1","ThreeSymbols2","ThreeFlags","ThreeStars","FourRatings","FiveQuarters","FiveRatings","FiveBoxes","Bar","Area","Pie","Doughnut","PieAndDoughnut","Line","Radar","Scatter","ChartDesign","ClusteredColumn","StackedColumn","StackedColumn100","ClusteredBar","StackedBar","StackedBar100","StackedArea","StackedArea100","StackedLine","StackedLine100","AddChartElement","Axes","AxisTitle","ChartTitle","DataLabels","Gridlines","Legends","PrimaryHorizontal","PrimaryVertical","None","AboveChart","Center","InsideEnd","InsideBase","OutsideEnd","PrimaryMajorHorizontal","PrimaryMajorVertical","PrimaryMinorHorizontal","PrimaryMinorVertical","Right","Left","Bottom","Top","SwitchRowColumn","ChartTheme","ChartType","Material","Fabric","Bootstrap","HighContrastLight","MaterialDark","FabricDark","HighContrast","BootstrapDark","Bootstrap4","VerticalAxisTitle","HorizontalAxisTitle","EnterTitle","ProtectWorkbook","Password","unProtectPassword","EnterThePassword","ConfirmPassword","EnterTheConfirmPassword","PasswordAlert","UnProtectWorkbook","UnProtectPasswordAlert","InCorrectPassword","PasswordAlertMsg","ConfirmPasswordAlertMsg","IsProtected","PDF","SheetRender","refreshSelectALLContent","getSelectAllTable","headerPanel","updateLeftColGroup","getRowHeaderPanel","colGrp","setPanelWidth","setPanelHeight","scrollSize","getScrollSize","setHeaderPanelWidth","getColHeaderPanel","getContentPanel","borderTopWidth","userAgent","addOffset","frozenHeight","renderPanel","initHeaderPanel","updateHideHeaders","createHeaderTable","rowHdrEle","updateTable","renderTable","scrollPanel","cTBody","selectAllColGrp","rowHdrColGrp","selectAllHdrRow","rHdrTBody","selectAllTBody","cHdrTHead","cHdrTBody","cHdrRow","emptyRow","attributes","aria-rowcount","aria-colcount","renderRowHeader","empty","checkTableWidth","triggerCreatedEvent","createdHandler","observers","cellsWidth","refreshColumnContent","hTBody","hColGrp","checkColMerge","refreshRowContent","checkRowMerge","formatUnit","updateColContent","refChild","skipRender","hRefChild","colRefChild","hColRefChild","updateRowContent","rFrag","firstRow","cKey","firstcell","refreshPrevMerge","currTopIdx","rowHeightChange","colWidthChange","skipFreezeCheck","skipHeader","RowRenderer","isRowHeader","aria-rowindex","CellRenderer","th","tableRow","aria-colindex","tabindex","checkMerged","evtArgs","setWrapByValue","compiledTemplate","processTemplates","mergeFreezeRow","mergeFreezeCol","formatArgs","removeStyle","rowEle","spanRowTop","emptyRows","curEmptyLength","curSpan","updateSpanTop","updateColZIndex","mainPanel","emptyCols","updateRowZIndex","updateSelectAllZIndex","updatedHeaderZIndex","frozenRowEle","frozenColEle","compileCellTemplate","templateString","compile","compiledStr","clonedCell","previouseHeight","getRowHeightOnInit","tTable","rightBorder_1","bottomBorder_1","prevRowCell","prevColCell","cRange","Render","renderSheet","checkTopLeftCell","isFreezeScrolled","isTopLeftCell","paneIndexes","pIndexes","lastRow","lastCol","topLeftCell_1","roundValue","roundedValue","moveOrDuplicateSheetHandler","instantiateRenderer","Dialog","dialogModel","cancelBtn","btnContent","closeHandler","div","DialogComponent","refreshPosition","ActionEvents","initializeActionBegin","beforeCellFormat","actionEventHandler","evtFunc","actionType","eventType","beforeSave","beforeSort","initializeActionComplete","cellSave","actionBeginHandler","actionCompleteHandler","Overlay","isOverlayClicked","isResizerClicked","currenHeight","class","renderResizeHandles","originalWidth","originalHeight","startTop","startLeft","overlayClickHandler","overlayMouseMoveHandler","overlayMouseUpHandler","setOriginalSize","height1","width1","height2","width2","checkOffset","resizer","originalMouseY","originalResizeTop","resizedReorderTop","pageX","originalMouseX","pageY","originalResizeLeft","resizedReorderLeft","aX","diffX","aY","diffY","overlayElems","prevY","originalReorderTop","prevX","originalReorderLeft","currRowIdx","currColIdx","top_2","actOverlayElem","handleElem","handles","needsID","Spreadsheet_1","initServices","renderSpreadsheet","setHeight","setWidth","createSpinner","findAll","addrArr","paneCell","insideDomCount","viewportSize","cVTrack","vWidth","vHeight","scrollableSize","resize","colThreshold","mIndex","colWidth","eleWidth","oldIdx","edited","maximumColInx","startIsCol","endIsCol","starttoend","startValues","getAddress","endValues","prevELem","isMethod","addrRange","mCell","circularArgs","alignClass","wrapContent","createTextNode","nodeValue","borderWidth","nextTab","undo","redo","mouseClickHandler","freezePaneUpdated","closeEdit","marginLeft","marginRight","newRangeIdx_1","isLastRange","addBtn_1"],"mappings":"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kC,UAAW,sBAAkB,GACzC2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,qBAAiB,GACxC2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,oBAAgB,GACvC2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,iBAAa,GACpC2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,iBAAa,GACpC2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,oBAAgB,GACvC2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,sBAAkB,GACzC2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,6BAAyB,GAChD2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,2BAAuB,GAC9C2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,sBAAkB,GACzC2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,mBAAe,GACtC2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,mBAAe,GACtC2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,kBAAc,GACrC2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,2BAAuB,GAC9C2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,kBAAc,GACrC2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,kBAAc,GACrC2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,8BAA0B,GACjD2lD,IACIkpB,aAAYT,KACblqC,EAASlkC,UAAW,iBAAa,GACpC2lD,IACImP,WAAS,KACV5wB,EAASlkC,UAAW,eAAW,GAClC2lD,IACImP,WAAS,KACV5wB,EAASlkC,UAAW,eAAW,GAClC2lD,IACImP,WAAS,KACV5wB,EAASlkC,UAAW,gBAAY,GACnC2lD,IACImP,YAAS,IACV5wB,EAASlkC,UAAW,mBAAe,GACtC2lD,IACI+kB,gBAAe8D,KAChBtqC,EAASlkC,UAAW,oBAAgB,GACvC2lD,IACIoP,WACD7wB,EAASlkC,UAAW,kBAAc,GACrC2lD,IACIoP,WACD7wB,EAASlkC,UAAW,mBAAe,GACtC2lD,IACIoP,WACD7wB,EAAS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"}